{
  "course_name": "Water Resource Systems",
  "course_description": "This subject is concerned with quantitative methods for analyzing large-scale water resource problems. Topics covered include the design and management of facilities for river basin development, flood control, water supply, groundwater remediation, and other activities related to water resources. Simulation models and optimization methods are often used to support analyses of water resource problems. In this subject we will be constructing simulation models with the MATLAB® programming language and solving numerical optimization problems with the GAMS optimization package.",
  "topics": [
    "Engineering",
    "Environmental Engineering",
    "Aquatic Sciences and Water Quality Control",
    "Hydrodynamics and Coastal Engineering",
    "Hydrology and Water Resource Systems",
    "Engineering",
    "Environmental Engineering",
    "Aquatic Sciences and Water Quality Control",
    "Hydrodynamics and Coastal Engineering",
    "Hydrology and Water Resource Systems"
  ],
  "syllabus_content": "Course Meeting Times\n\nLectures: 2 sessions / week, 1.5 hours / session\n\nDescription\n\nThis subject is concerned with quantitative methods for analyzing large-scale water resource problems. Topics covered include the design and management of facilities for river basin development, flood control, water supply, groundwater remediation, and other activities related to water resources. Simulation models and optimization methods are often used to support analyses of water resource problems. In this subject we will be constructing simulation models with the\nMATLAB(r) programming language\nand solving numerical optimization problems with the\nGAMS optimization package\n. It is desirable for students taking this subject to have some background in hydrology, linear algebra and programming, although these are not strict prerequisites.\n\nGrading\n\nThere will be an in-class midterm exam and an in-class final exam. There will also be a class project which will be carried out during the second half of the semester. Homework will be designed to build skills. The grade will be based on exams, project, and homework. A detailed schedule is provided in the\ncalendar\nsection.\n\nACTIVITIES\n\nPERCENTAGES\n\nExams\n\n50%\n\nProject\n\n30%\n\nHomework\n\n20%",
  "files": [
    {
      "category": "Resource",
      "title": "projects.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/1-731-water-resource-systems-fall-2006/8f3c67cdc1a7829b260a8ba4909a145d_projects.pdf",
      "content": "MASSACHUSETTS INSTITUTE OF TECHNOLOGY\nDepartment of Civil and Environmental Engineering\n\n1.731 Water Resource Systems\n\nSuggested Project Topics\nOct. 5, 2006\n\nPlease prioritize the topics listed below and send your ranked list to me by\n\nTuesday Oct. 10, 2006. I will circulate your responses to all students so you can organize\nteams yourselves. By Oct. 17 your team should meet to focus your topic, select a\npreliminary site, and schedule an initial meeting with me. We will meet as required in\nthe last half of October to go over the information you need to compile for a detailed (2+\npp.) team project proposal due Nov. 2. A final team report on your project will be due on\nthe last day of classes. All or part of your team can meet with me during November as\nrequired to go over questions, etc.\n\nWherever possible, your project should be based on data from a real site or problem.\n\nThe effort spent on one of these projects should be about the same as 5 problem sets\n(about 45 hours), so please scope your project topic so that you can produce a satisfactory\nresult within this time constraint.\n\n1. Real-time reservoir control\n\ni) Take measurements of relevant variables (i.e. compile historical measurements for use\nin a retrospective test of your control strategy))\nii) Predict future inflows based on past data, accounting for both short and longer term\ntemporal correlation.\niii) Determine optimal reservoir releases for all time steps out to a specified time horizon\niv) Implement releases for next time step only, then repeat entire process\n\n2. Integrated water resource management for a semi-arid area\n\ni) Consider all sources and demands for water for the selected area\nii) Design a system that extracts, collects, conveys, treats, recycles, disposes water at\nvarious locations and seasons, with the overall goal of making best use of this limited\nresource\niii) Optimize your candidate system by selecting the \"best\" components, facility\ncapacities, operating policies, etc., considering both cost and performance.\n\ni) Formulate a well-posed parameter estimation, specifying model parameters to be\nestimated and measurements to be used, for a model of \"reasonable\" size and complexity.\nUse real data if possible.\n\nii) Simplify the model, as req uired, to make the parameter estimation procedure\ncomputationally feasible.\niii) Test and compare more than one method for estimating the parameters for your\nproblem.\niv) Analyze the computational feasibility/scalability and performance of your approach\nfor larger problems.\n\n4. Capacity expansion\n\ni) Formulate alternative options for meeting growing water demands in a large city.\nii) Decide on the best way to expand capacity/develop these options over time,\nconsidering the time value of money, economy of scale, and demand uncertainty.\n\n5. Management of a common pool resource\n\ni) Formulate a problem where multiple users each have an incentive to deplete a shared\nresource (e.g. a common pool).\nii) Construct an optimization model that reproduces individual (self-interested) behavior\nand analyze the resulting impact on the common pool resource.\niii) Construct an alternative model that maximizes community benefit (summed over all\nindividuals). Evaluate the associated individual benefits.\niv) Formulate and evaluate an institutional mechanism (e.g. externality charges, water\ntrading, etc.) that approaches the community and individual benefits of iii) by changing\nthe constraints of ii).\n\n3. Parameter estimation"
    },
    {
      "category": "Resource",
      "title": "survey.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/1-731-water-resource-systems-fall-2006/8bbdb7a054bdb53b0f6eab98a8f86acb_survey.pdf",
      "content": "MASSACHUSETTS INSTITUTE OF TECHNOLOGY\nDepartment of Civil and Environmental Engineering\n\n1.731 Water Resource Systems\n\nClass Survey\nDue: Tuesday, Sept. 12, 2006\n\nPlease submit responses to these questions in writing and be sure to include your name\nand email.\n\nEducation and Work Experience:\n\n1. Summarize in a few sentences your educational background (topics studied and out-\nof-classroom research experience).\n\n2. Summarize in a few sentences your engineering-related work experience (outside of a\nuniversity setting).\n\nTechnical Skills:\n\nI know that most of you could carry out the following, given appropriate references and\nenough time. I am interested primarily in 1) whether you have ever done any of these\nthings already and 2) if you could do them relatively easily now without lots of research\nand effort.\n\n1. Could you write a MATLAB code to simulate runoff from a watershed if you were\ngiven a spatially lumped description of the rainfall-runoff process in the form of an\nordinary differential equation?\n\n2. Could you fit (by hand) a quadratic curve to a set of (x,y) data and construct\nconfidence intervals that extend beyond the range of the data?\n\n3. Could you perform an eigen decomposition of a 3 by 3 matrix by hand? On\nMATLAB?\n\n4. Could you generate, in MATLAB, a random autregressive type 2, AR(2), time series\nto simulate daily variations in an environmental variable such as air temperature?\n\n5. Could you find (by hand) the relative maxima of a specified differentiable function of\n3 unknowns, subject to 2 specified linear equality constraints in these unknowns? What\nif the constraints are inequalities?\n\n6. Do you know the difference between a local and global minimum?\n\n7. Have you used optimization software? What kind?\n\n8. Could you find an equilibrium price, given supply and demand curves for a\ncommodity?\n\n9. Could you find the net present value of a stream of annual costs, given a specified\ninterest rate and time horizon?\n\n10. Are you familiar with the term \"Pareto frontier\"?\n\nInterests\n\n1. Water resource systems traditionally covers a range of topics, from optimization\nmethods such as stochastic dynamic programming, through economic cost-benefit\nanalysis, to political considerations involved in water-related negotiations and\nenvironmental protection. Please assess the nature of your \"policy\" orientation on a scale\nof 0-10, where 0 is no interest in policy (you only care about mathematical analysis) and\n10 is interest only in policy aspects (you would rather avoid mathematics). Realizing that\nsuch a rating is simplistic, please feel free to elaborate in a few sentences.\n\n2. How do you feel about a subject that derives your grade from a large individualized\nproject vs. one that relies on frequent (e.g. weekly) problem sets?\n\n3. Please summarize in a few sentences your expectations for this subject. Indicate what\nskills, insights, etc. you would like to take away from your experience."
    },
    {
      "category": "Resource",
      "title": "assn1.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/1-731-water-resource-systems-fall-2006/986432c3971698bab5e67ebde8a4aee6_assn1.pdf",
      "content": "MASSACHUSETTS INSTITUTE OF TECHNOLOGY\nDepartment of Civil and Environmental Engineering\n\n1.731 Water Resource Systems\n\nProblem Set 1 - Linear Algebra Review\nDue: Tuesday, Sept. 19, 2006\n\nPlease work out these problems by hand and check with MATLAB for your own\ninformation (do not submit MATLAB programs or results). Make sure that you explain\nwhat you are doing and why.\n\n1. Put the following matrix into echelon form by using elementary row operations\n(indicate the operations explicitly). What are the rank and determinant of this matrix?\n\n⎥\n⎥\n⎥\n⎥\n⎦\n⎤\n⎢\n⎢\n⎢\n⎢\n⎣\n⎡\n\n2. Determine the existence and uniqueness of the solutions of the following systems of\nequations by evaluating the ranks of the appropriate matrices. Also, give the solution (if\nthere is one).\n\na)\n\ny\nx-\n\ny\nx\n\ny\nx\n=\n=\n+\n=\n+\n\nb)\n\nz\nx-y\n\nz\ny\nx\n=\n+\n=\n+\n+\n\n3. Find all nontrivial solutions to the following homogeneous equations. Why are they\nunique or non-unique?\n\nx\nx\nx\n\nx\nx\n-\nx\n=\n+\n+\n=\n+\na)\n\nb)\n\nx\nx\nx\n\nx\nx\nx\n\nx\n-x\nx\n=\n+\n-\n=\n+\n+\n=\n+\n\n4. Determine whether the following vectors are linearly dependent or linearly\nindependent:\n\n⎥\n⎥\n⎥\n⎥\n⎦\n⎤\n⎢\n⎢\n⎢\n⎢\n⎣\n⎡\n-\n-\n⎥\n⎥\n⎥\n⎥\n⎦\n⎤\n⎢\n⎢\n⎢\n⎢\n⎣\n⎡-\n⎥\n⎥\n⎥\n⎥\n⎦\n⎤\n⎢\n⎢\n⎢\n⎢\n⎣\n⎡\n/\n/\n/\n/\n\n5. Find the eigenvalues and eigenvectors of the following matrix:\n\n⎥\n⎥\n⎥\n⎦\n⎤\n⎢\n⎢\n⎢\n⎣\n⎡\n-\n\n6. Write the following quadratic form as a product of the form\n, where A\nj\nij\nA\ni\nx\nx 1\nij is a\nsymmetric matrix. Compute the eigenvalues of Aij and determine the definiteness of the\nquadratic form:\n\n)\n,\n,\n(\nx\nx\nx\nx\nx\nx\nx\nx\nf\n-\n+\n+\n="
    },
    {
      "category": "Resource",
      "title": "assn2.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/1-731-water-resource-systems-fall-2006/27001a62b58d4e8b33638a2d4b4b04c4_assn2.pdf",
      "content": "MASSACHUSETTS INSTITUTE OF TECHNOLOGY\nDepartment of Civil and Environmental Engineering\n\n1.731 Water Resource Systems\n\nProblem Set 2 - Optimality Conditions, GAMS\nDue: Tuesday, Sept. 26, 2006\n\n1. Put all of the following optimization problems in a consistent standard form (i.e.\nmaximize the objective function and write all constraints in the form gi (x)≤ 0).\n\n2. Provide GAMS and graphical solutions to each problem. Please append GAMS code\nand output to document your GAMS solutions. Note that GAMS may produce much\nmore output than really needed. Please excerpt only those parts needed to document your\ncalculations.\n\n3. Explicitly show that all applicable necessary (Kuhn-Tucker) conditions are met at each\nlocal minimum or local maximum you identify (make sure that these conditions are\nrelevant for each problem before trying to apply them). Use MATLAB to check\ndefiniteness for the Kuhn-Tucker curvature condition.\n\n4. Use the theorem relating local and global optima to determine if the local optimum you\nhave identified is also a global optimum.\n\nIf you are unfamiliar with GAMS I suggest that you reproduce the example problem in\nthe GAMS Tutorial in the GAMS documentation (download from\nhttp://www.gams.com/docs/document.htm) and also that you look over the rest of the\nmaterial in the tutorial. There are also some examples and good discussion in Bruce\nMcCarl's GAMS Users Guide at the same link.\n\n1. Minimize: x1\n2 + x2\nsuch that: x1x2 ≥ 1\nx1, x2 ≥ 0\n\n2. Minimize: x1\n2 + x2\nsuch that: x2 ≥ 2 - 3 x1\nx2 ≥ 1/5\nx1, x2 ≥ 0\n\n3. Minimize: (x1-1)2 + 2x2\n2+ x3\nsuch that: x3 = 2 x1\n1/2\n\nx2 + 2 x1 ≥ 2\nx1, x2 ≥ 0\n\n4. Maximize: x1 + 2x2\nsuch that: x1 + x2\n≤ 1\n2x2 ≤ x1 + 2\nx1, x2 ≥ 0\n\n5. Maximize: 3x1 + 7x2\nsuch that: x1 - x2\n≥ 0\nx1 + x2 ≤ 7/2\nwhere x1and x2 are nonnegative integers\n\nYou should use GAMS' integer programming capabilities in this problem."
    },
    {
      "category": "Resource",
      "title": "assn3.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/1-731-water-resource-systems-fall-2006/913c2dcaca07d846e59e670967e096d3_assn3.pdf",
      "content": "MASSACHUSETTS INSTITUTE OF TECHNOLOGY\nDepartment of Civil and Environmental Engineering\n\n1.731 Water Resource Systems\n\nProblem Set 3 - Reservoir Capacity-Yield Tradeoffs\nDue: Thursday, Oct. 5, 2006\n\nSuppose that variations in the average monthly storage of a reservoir are described by the\nfollowing set of cyclical mass balance equations:\n\ns\n\ns\n\n,\n,\n\nt\nr\n-\ny\n-\ni\ns\ns\nt\nt\nt\nt\n=\n=\n+\n=\n+\nK\n\nwhere:\n\nst = storage at the beginning of month t (m3)\nit = known average reservoir inflow over month t (m3)\ny = assured reservoir yield for each month (m3)\nrt = excess reservoir release over month t (m3)\n\nThe assured reservoir yield (a decision variable) depends on the known reservoir inflow\nsequence (a problem input), the excess reservoir release and storage (decision variables),\nand the reservoir volume (V) or capacity (an input that constrains the monthly storage).\nSuppose that you want to find the decision strategy that maximizes the assured yield\nobtained for a particular reservoir volume.\n\nThe average monthly inflows for months 1 -12 are:\n\n259, 143, 91, 57, 47, 26, 65, 109, 148, 194, 220, 233 106 m3/month (for months\n1 through 12, respectively).\n\nDerive a set of yield and capacity demand curves for this reservoir by carrying out the\nsteps listed below.\n\n1. Formulate the linear program for this problem in equation form. Define all\ndecision variables, the objective function, and all constraints.\n\n2. Use the GAMS looping capability to generate a plot of reservoir yield vs.\ncapacity. This yield-capacity plot may be constructed by repeatedly solving the\noptimization problem for a range of discretized capacity values, starting at zero\ncapacity and ending at the capacity where yield ceases to increase.\n\n3. The discretization interval should be small enough to properly resolve the shape\nof the yield-capacity curve.\n\n4. Use the results of your parametric analysis to construct a capacity benefit plot\nwhich shows how the value (measured in m3 additional yield/ m3 additional\ncapacity) of additional capacity changes as capacity increases from zero to its\nmaximum value.\n\n5. Reevaluate the yield-capacity and capacity benefit curves when the low flow\nvalue occurring in Month 6 is raised to 46 106 m3. Give a physical explanation for\nthe result.\n\nPrepare a set of easy-to-read plots (using MATLAB, EXCEL, or similar software) which\nsummarize your results."
    },
    {
      "category": "Resource",
      "title": "assn4.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/1-731-water-resource-systems-fall-2006/0fd6c59b9025c68afb1ef8593e56eb90_assn4.pdf",
      "content": "MASSACHUSETTS INSTITUTE OF TECHNOLOGY\nDepartment of Civil and Environmental Engineering\n\n1.731 Water Resource Systems\n\nProblem Set 4 - Groundwater Management, Quadratic Programming\nDue: Tuesday, Oct. 17, 2006\n\nThe problem is to determine the optimum (highest net benefit) amount of groundwater to\npump from four wells screened in a confined groundwater aquifer. The decision variables\nare the pumping rates and pumping lifts (depths to the water table) at the four wells:\n\nx = [ x1 , x2 , x3 , x4 ]\nPumping rates (m3/sec) at wells 1, 2, 3, and 4\n\ny = [ y1 , y2 , y3 , y4 ]\nPumping lifts (m.) at wells 1, 2, 3, and 4\n\nNet benefit is measured in terms of the difference between the annual revenues obtained\nfrom irrigated crops and the annual costs associated with pumping and delivery:\n\nObjective: F = R - C\nRevenue:\n\nCost:\n\n∑\n=\n-\n=\n)\n(\ni\ni\ni\nx\nb\nax\nR\n∑\n=\n=\ni\ni\ni y\nex\nC\n\nNote that the marginal revenue dR/dxi for each well decreases to zero as the quantity\npumped increases to b/2. This reflects the decreasing demand for increasing amounts of\npumped water. The water cost is proportional to the electrical energy required to pump at\na rate xi over a depth yi for a growing season of 4 months.\n\nPumping at each well affects the drawdown at the other wells. This effect may be\nquantified with a groundwater model or through pumping tests. In either case, there is a\nlinear relationship between the vectors x and y if the aquifer is confined (as we assume\nhere). If we also assume the groundwater system is in steady-state the pumping-lift\nrelationship may be summarized with a symmetric response matrix A. Each element Aij\nof this matrix relates the steady state lift yi at well i (in m.) to the steady-state pumping\nrate xj at well j (m3/sec):\n\nsec/m\n\nwhere\n⎥\n⎥\n⎥\n⎥\n⎦\n⎤\n⎢\n⎢\n⎢\n⎢\n⎣\n⎡\n=\n=\nA\nx\nA\ny\nj\nij\ni\n\nWhen the response matrix relationship is substituted in the objective function expressions\nabove the result is a quadratic objective. For a GAMS solution to this problem the\nresponse matrix equation and the definitions of R and C may be included as a set of\nequality constraints. Then the objective function can be written in terms of the\nintermediate decision variables R and C.\n\nAdditional problem constraints are:\n\nb\nxi ≤\n\nfor all i\n≤\niy\n≥\nix\n≥\niy\n\nAssume that:\n\na = 4.0 108 $/m6/sec2\nb = .01 m3/sec\n\nIn order to solve this problem, carry out the following tasks:\n\n1). Derive the cost coefficient e, given that the price of electricity is $ 0.20 / kwhr.\n\n2). Check to see if a local maximum for this problem is also global (i.e. is the\nobjective function concave?). To check this you will need to construct a Hessian\nmatrix and use MATLAB to test its eigenvalues for your particular set of problem\ninputs.\n\n3). Solve the problem using GAMS. If the objective function is not concave try a\nfew different initial feasible solutions to provide confidence that the GAMS\nsolution is a global maximum.\n\n4). Evaluate the shadow prices associated with any pumping lift (yi) constraints\nthat are active at the GAMS solution.\n\nPlease hand in only enough information to adequately document your solution."
    },
    {
      "category": "Lecture Notes",
      "title": "lect1.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/1-731-water-resource-systems-fall-2006/a104758a3020eae5ec6b3f64e7e31aaa_lect1.pdf",
      "content": "MASSACHUSETTS INSTITUTE OF TECHNOLOGY\nDepartment of Civil and Environmental Engineering\n\n1.731 Water Resource Systems\n\nLecture 1, Introduction, Sept. 7, 2006\n\nLogistics:\n\nStudent survey: Fill in survey (Problem Set 1)\n\nText: On-line text suggested background but not essential. You can download a legal free copy\nfrom http://www.wldelft.nl/rnd/intro/fields/water-management/book.html\n\nClass format, grading, etc.: See syllabus for details\n\nSoftware used: MATLAB, GAMS\n\nIntroduction to Water Resource Systems:\n\nKey concepts based on words: \"water\", \"resource\", and \"system\":\n- Water is viewed as a valued resource, to be beneficially managed.\n- Management frequently must deal with a complex \"system\" composed of many\ninterconnected parts -- It is often difficult to subdivide the original problem into\nindependent subproblems. How do we define the \"system\"? How large? Over what time\nscale? How much detail? Should it include social and political institutions?\n\nWe often try to find the \"best\" solution - but how do we define \"best\"?\n\nTraditional examples of water resource systems problems:\n\n- River basin management - select facilities (reservoirs, aqueducts, irrigation\ninfrastructure, etc.) to maximize benefit from resource\n- Aquifer management - focus on installation and operation of wells and recharge areas,\nlonger time scales make water quality issues especially important\n- Capacity expansion - how much should facilities be expanded, when?\n- Real-time operations - decisions are. What to do today, considering impacts on the future\n(e.g. reservoir operations)\n- Remediation - select best mix of remedies for cleaning up contamination, especially in\nsubsurface\n\nNew examples that go beyond water resources but deal with environment:\n\n- Hazard prevention/mitigation - how should we respond to hazards such as hurricanes and\nassociated flooding, rebuilding, prevention, etc.\n\n- Energy-related topics - petroleum reservoir development, carbon sequestration,\ninvestment in alternative energy sources, etc.\n- Merging of diverse types of data for environmental characterization - data fusion, data\nassimilation\n\nWhat do these problems have in common?\n\n1. Tradeoffs - optimal decision trades off opposing effects (often benefits vs. costs).\n2. Constraints - limited resources\n3. Uncertainty - many uncertainties about future events, physical processes, etc.\n4. Policy/economics - inevitable when we seek \"best\" solutions where people are involved.\n.\n\nIrrigation Example (irrigation.m)\n\nHow does irrigation efficiency affect net crop revenue? Decision variables in boldface.\n\nApplied water\n(QA , SA)\nRoot zone\nSalinity = S\nET\n(QE ,0)\nInfiltration\n(QI, S )\n\nAssume steady-state.\n\nQA, QE, QI m/yr\nSA, S gm/m3\n\nWater mass balance:\n\nSalt mass balance:\n=\n-\n-\n)\nQ\nA(\nE\nI\nA\nQ\nQ\n\n=\n-\n)\nS\nA(\nA\nS\nQ\nQ\nI\nA\n\nEfficiency:\n\nSalinity as a function of efficiency:\nA\nA\nI\nQ\nQ\nQ\ne\nE\nQ\n-\n=\n= 1\n\ne\nS\n-\nS A\n=\n\nPostulate yield as a function of salinity (and efficiency):\nmax\nmax\n/\nA\n/\n)S\n-\n(\nS\nY\nS\nY\n)\nY(\n⎥\n⎦\n⎤\n⎢\n⎣\n⎡-\n=\n⎥\n⎦\n⎤\n⎢\n⎣\n⎡-\n=\ne\nS\nS\n\nAssume revenue is linearly proportional to Y:\n\n)\npAY(\n)\nR(\nS\nY =\n\nAssume applied water cost is linearly proportional to QA:\n0.5\nRelative\nyield\nSalinity\n\ne\nQ\nQ\nA\nA\nA\nQ\nc\nc\n)\nC(\nE\n=\n=\n\nMaximize net revenue (profit) with respect to e:\n\ne\ne\ne\ne\nA\nQ\nc\n)S\n-\n(\nS\npAY\n)\nP(\nMax\nE\n/\nA\n-\n⎥\n⎦\n⎤\n⎢\n⎣\n⎡-\n=\nmax\n\n0.1\n0.2\n0.3\n0.4\n0.5\n\nnet profit\nrevenue\ncost\nEfficiency\n$\n\nOptimum efficiency = 0.31\n\nTradeoff: Crop revenue vs. applied water cost\nConstraints: Mass balances\nUncertainty: All functions & parameters are uncertain\nPolicy: What are implicit policy assumptions/implications?\n\n(Supporting file present in lecture notes section)"
    },
    {
      "category": "Lecture Notes",
      "title": "lect2.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/1-731-water-resource-systems-fall-2006/24e13cf62e1816e45f08c643a15bfe5c_lect2.pdf",
      "content": "MASSACHUSETTS INSTITUTE OF TECHNOLOGY\nDepartment of Civil and Environmental Engineering\n\n1.731 Water Resource Systems\n\nLecture 2, Linear Algebra Review, Sept. 12, 2006\n\nThe notation and some of the basic concepts of linear algebra are needed in optimization theory,\nwhich is concerned with large systems of equations in many variables.\n\nYou should learn or review the following topics. See any introductory linear algebra text for\ndetails.\n\nIndicial notation: Vector: x = [x1, x2, ..., xn] → xi\n\nMatrix:\n\nij\nmn\nm\nn\nA\nA\nA\nA\nA\nA\n→\n⎥\n⎥\n⎥\n⎦\n⎤\n⎢\n⎢\n⎢\n⎣\n⎡\n=\nL\nM\nO\nM\nL\n\nMatrix transpose and symmetry:\nMATLAB operator ′\n\nji\nT\nij\nT\nA\nA\nA\n=\n→\nA is symmetric if AT=A (no change if rows and columns are interchanged)\n\nVector & matrix operations products:\nMATLAB operators + and *\n\nVector sum\ni\nj\ni\ny\nx\nz\ny\nx\nz\n+\n=\n→\n+\n=\n\nMatrix sum\nij\nij\nij\nB\nA\nC\nB\nA\nC\n+\n=\n→\n+\n=\n\nj\ni\nax\nz\nax\nz\n=\n→\n=\nij\nij\naA\nB\naA\nB\n=\n→\n=\nScalar multiplication\n\nScalar product, x and y are orthogonal if x\nj\nj\nT\ny\nx\nz\ny\nx\nz\n=\n→\n=\nTy = 0\n\nj\nij\ni\nx\nA\ny\nAx\ny\n=\n→\n=\nMatrix-vector product, implied sum over repeated indices (j)\n\nMatrix product, implied sum over repeated indices (j)\njk\nij\nik\nB\nA\nC\nAB\nC\n=\n→\n=\n\nquadratic form, implied sum over repeated indices (i,j)\nj\nij\ni\nT\nx\nA\nx\nq\nAx\nx\nq\n=\n→\n=\n\nSystems of linear equations:\n\nm equations, n unknowns x\ni\nj\nij\nb\nx\nA\nb\nAx\n=\n→\n=\nj (i = 1,..., m j = 1,...,n)\n\nRow echelon form of a matrix\nThis is convenient for analyzing and solving systems of linear equations.\nA is in row echelon form if:\n- All rows with non-zero entries are above rows containing only zeros\n- Leading (non-zero) entry of each row is to right of leading entry in row above it\n- All entries below a leading coefficient are zero\n\nA is row echelon:\n\nA is not row echelon\n\n⎥⎦\n⎤\n⎢⎣\n⎡\n=\n/\nA\n⎥⎦\n⎤\n⎢⎣\n⎡\n=\nA\n\nReduced row echelon form of a matrix\nMATLAB function rref(A)\nAdd requirements that:\n- All leading entries = 1\n- All entries above and below leading entries = 0\nA is reduced row echelon:\n\n⎥⎦\n⎤\n⎢⎣\n⎡\n-\n=\n/\nA\n\nUsing elementary row operations to derive row and reduced row echelon forms:\n- Elementary row operations → replace a given row with weighted sum of any two\nrows.\n- Carry out elementary row operations starting from top row down to meet requirements\nfor row echelon form.\n\n⎥⎦\n⎤\n⎢⎣\n⎡\n→\n⎥⎦\n⎤\n⎢⎣\n⎡\n=\n/\nA\n\n)\n)(\n/\n(\n)\n/\n(\nr\nr\nr\n→\n-\n+\n\n- Carry out additional elementary row operations starting from top row down to meet\nrequirements for reduced row echelon form.\n\n⎥⎦\n⎤\n⎢⎣\n⎡\n-\n→\n⎥⎦\n⎤\n⎢⎣\n⎡\n=\n/\n/\nA\n\n)\n)(\n(\nr\nr\nr\n→\n-\n+\n\nGaussian elimination:\nMATLAB operator x=A\\b\nThis is a procedure for solving systems of linear equations by applying a series of elementary\nrow operations:\n-\nAugment A by appending b as last column to obtain [A | b]\n-\nPut [A | b] in reduced row echelon form\n\n-\nSolution x is last column of row echelon matrix\n\n⎥⎦\n⎤\n⎢⎣\n⎡-\n=\n⎥⎦\n⎤\n⎢⎣\n⎡\n-\n→\n⎥\n⎦\n⎤\n⎢\n⎣\n⎡\n=\n⎥⎦\n⎤\n⎢⎣\n⎡\n=\n⎥⎦\n⎤\n⎢⎣\n⎡\n=\n=\n/\n/\n]\n|\n[\nx\nb\nA\nb\nA\nb\nAx\n\nMatrix rank\nMATLAB function rank(A)\nRank of a matrix is number of non-zero rows in row echelon form:\n\n⎥⎦\n⎤\n⎢⎣\n⎡\n→\n⎥⎦\n⎤\n⎢⎣\n⎡\n=\nA\n\nRank = number of non-zero rows = 1\n\nConsistency and uniqueness\n- System of linear equations\nb\nx\nA\n=\nis consistent if\n])\n|\n([\n)\n(\nb\nA\nRank\nA\nRank\n=\n\n- The m by n homogeneous system Ax=0 always has the trivial solution x = 0.\n- An m by n consistent non-homogeneous system Ax=b has a unique solution if Rank(A)\n= n = number of unknowns.\n- An m by n consistent non-homogeneous system Ax=b has a non-trivial non-unique\nsolution if Rank(A) = r < n = number of unknowns. The number of free parameters in\nthe solution is n - r.\n\nDeterminant of a square matrix:\nMATLAB function det(A)\nDeterminant |A| of A is a scalar matrix property useful for solving eigen problems.\n\nDeterminant can be evaluated from row echelon form (which is upper triangular for a square\nmatrix). Apply the following rules:\n-\nIf an elementary row operation that transforms A to B has the form ciri+cjrj → rj , then\n|A|= |B| / cj.\n-\n|A|= product of the leading (diagonal) terms of the final row echelon form.\nIn this example row echelon is produced by an elementary row operation that replaces row 2\nusing c2 =1:\n\n/)\n(\n/)\n(\n-\n=\n-\n=\n-\n=\n-\n→\nc\n\n)\n(\n=\n→\n+\n-\nc\nr\nr\nr\n\nIn this example row echelon is produced by an elementary row operation that replaces row 2\nusing c2 =-1/2:\n\n)\n/\n/(\n)1(\n/)1(\n-\n=\n-\n=\n=\n→\nc\n\n/\n)\n)(\n/\n(\n)\n/\n(\n-\n=\n→\n-\n+\nc\nr\nr\nr\n\nInverse of a square matrix:\nMATLAB function inv(A)\n\n[\n]\nik\njk\nij A\nA\nI\nAA\nA\nA\nδ\n=\n→\n=\n=\n-\n-\n-\n\nFind A-1 by solving A[A-1] = I using Gaussian elimination (with A given and each column of A-1\nconsidered to be an unknown vector).\n\nIf Rank(A) = r < n then |A|=0 and matrix is singular and has no inverse\n\nLinear Dependence/Independence\nLinear combination of a set of m n-dimensional vectors x1j, ..., xmj is:\n\n; x\nij\nj\nm\nj\nij\nj\nx\na\nx\na\n=\n∑\n=1\nij is an n by m matrix whose columns are the xi1, ..., xjim vectors\n\nThe vectors xj1, ..., xjm are linearly independent if ajxij has a unique (trivial) solution aj = 0.\nIf the aj's can be non-zero the vectors are linearly dependent.\n\nLinear Vector Spaces, Subspaces, and Projections\nThe set of all possible n-dimensional vectors [x1, x2 ... xn] forms a linear vector space Vn since\nit is closed under vector addition and scalar multiplication (i.e. any vector a1xi1 + a2xi2 is in Vn\nif the vectors xi1 and xi2 are in Vn).\n\nConsider the n by m matrix Aij with columns consisting of the m vectors Ai1, ..., Aim from Vn.\nThe set of vectors that are linear combinations of these m column vectors form a linear vector\nspace Vm which is a subspace (subset) of Vn . The subspace Vm is spanned by the Ai1, ..., Aim.\nIf the m spanning vectors are linearly independent they form a basis for Vm . The dimension of\nVm is the rank of Aij, which will be equal to m if the spanning vectors are linearly independent\nand form a basis. If m = n = Rank (A) then Vm = Vn.\n\nIf the m columns of Aij are linearly independent the n-m solutions of the system Aij xi = 0 form\na basis for an n-m dimensional subspace Vn-m of Vn. Vn-m is the null space of Vm and vice versa.\nEvery vector in Vn-m is orthogonal to every vector in Vm.\n\nEach basis vector of Vm may be viewed as the normal vector to a n-1 dimensional hyperplane.\nThe intersection of all m such hyperplanes is an n-m hyperplane that contains all vectors in the\nnull space Vn-m.\n\nThe projection Pij xj of any vector xi in Vn onto the subspace Vm is a vector that 1) lies in Vm\nand 2) obeys the property\ni\nj\nij\ni\nx\nx\nP\nx\n⊥\n+\n=\n, where\nlies in the null space V\ni\nx⊥\nn-m .(i.e. xi - Pijxj\nis orthogonal to all the vectors in Vm). It follows from these properties that the n by n projection\nmatrix Pij is:\n\nT\nT\nA\nA\nA\nA\nP\n]\n[\n-\n=\nThe matrix m by m [ATA] is invertible since A has rank m.\n\nEigen problems\nEigen problem seeks a set of scalar eigenvalues λk and eigenvectors uk, for k = 1,..., n\nassociated with the n by n matrix A.\n\nThe eigenvalues and eigenvectors satisfy:\n\nunknown\n\nare\n\nand\n\n,...\n\nk\nk\ni\nk\ni\nk\nk\nj\nij\nu\nn\nk\nu\nu\nA\nλ\nλ\n=\n=\n\nThe n eigenvalues are found by solving nth order polynomial in λ for n roots :\n\nn\nI\nA\nλ\nλ\nλ\nλ\n,...,\n,\n→\n=\n-\n\nThe corresponding n eigenvectors are found by substituting each λk into\nand\nsolving for the corresponding\n.\n\nk\ni\nk\nk\nj\nij\nu\nu\nA\nλ\n=\n\nk\niu\n\nExample:\n\n⎥⎦\n⎤\n⎢⎣\n⎡\n=\nA\nEigenvalues:\n,1\n)\n)(\n1(\n=\n=\n→\n-\n-\n=\n-\n-\nλ\nλ\nλ\nλ\nλ\nλ\n\nEigenvector 1:\n\na\na\na\nu\nu\nu\nu\nu\nu\nany\nfor\n\n⎥⎦\n⎤\n⎢⎣\n⎡\n-\n=\n⎥\n⎥\n⎦\n⎤\n⎢\n⎢\n⎣\n⎡\n→\n⎥\n⎥\n⎦\n⎤\n⎢\n⎢\n⎣\n⎡\n⎥⎦\n⎤\n⎢⎣\n⎡\n=\n⎥\n⎥\n⎦\n⎤\n⎢\n⎢\n⎣\n⎡\n⎥\n⎥\n⎦\n⎤\n⎢\n⎢\n⎣\n⎡\n-\n-\nλ\nλ\nEigenvector 2:\n\na\na\nu\nu\nu\nu\nu\nu\nany\nfor\n\n⎥⎦\n⎤\n⎢⎣\n⎡\n=\n⎥\n⎥\n⎦\n⎤\n⎢\n⎢\n⎣\n⎡\n→\n⎥\n⎥\n⎦\n⎤\n⎢\n⎢\n⎣\n⎡\n⎥⎦\n⎤\n⎢⎣\n⎡-\n=\n⎥\n⎥\n⎦\n⎤\n⎢\n⎢\n⎣\n⎡\n⎥\n⎥\n⎦\n⎤\n⎢\n⎢\n⎣\n⎡\n-\n-\nλ\nλ\n\nQuadratic Forms/Definiteness:\nQuadratic form\n(or the matrix A that it depends upon) can be\nclassified as follows:\nj\nij\ni\nT\nx\nA\nx\nq\nAx\nx\nx\nq\n=\n→\n=\n)\n(\n- q(x), A positive definite if q(x) > 0 for all - if A symmetric all eigenvalues of A > 0\n- q(x), A positive semidefinite if q(x) ≥ 0 for all x - if A symmetric all eigenvalues of A ≥ 0\n- q(x), A negative definite if q(x) < 0 for all x - if A symmetric all eigenvalues of A < 0\n- q(x), A negative semi-definite if q(x) ≤ 0 for all x - if A symmetric all eigenvalues of A ≤ 0\n- otherwise q(x) and A are indefinite"
    },
    {
      "category": "Lecture Notes",
      "title": "lect3.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/1-731-water-resource-systems-fall-2006/0fe8e2d7d97675c787447437af929025_lect3.pdf",
      "content": "MASSACHUSETTS INSTITUTE OF TECHNOLOGY\nDepartment of Civil and Environmental Engineering\n\n1.731 Water Resource Systems\n\nLecture 3, General Optimization Concepts 1, Sept. 14, 2006\n\nProblem Formulation:\n\n,...,\n\n)\n,...,\n,\n(\n\n,...,\n\n)\n,...,\n,\n(\n:\nsuch that\n)\n,...,\n,\n(\n\nMaximize\nm\nr\ni\nx\nx\nx\ng\nr\ni\nx\nx\nx\ng\nx\nx\nx\nF\nn\ni\nn\ni\nn\nn\n,...,x\n,x\nx\n+\n=\n≤\n=\n=\n\nStrict equality constraints\n\nInequality constraints\n\nBasic components:\n- n decision variables\n]\n,...,\n,\n[\nn\ni\nx\nx\nx\nx\nx\n=\n→\n, collectively define a decision strategy.\n- Scalar objective function\nmeasures performance of decision\nstrategy\n)\n,...,\n,\n(\n)\n(\nn\nx\nx\nx\nF\nx\nF\n→\n- r equality constraints gi(x), i=1,..., r\n- n-r inequality constraints gi(x), i= r + 1,...,m\n\nNote:\n- Minimization of F(x) is maximization of -F(x)\n- g(x) > 0 is same as -g(x) < 0\n\nFeasible region F : Set of x that satisfies constraints (depends only on gi(x)).\n\nDiscrete optimization: F consists of a finite number of feasible solutions\n\nx2\nA B C\nA\n\nB\n\nC\nF consists of 7 discrete x1 and x2 values,\nindicated by circles\n\nx1\nF\nF\nF\nF\nF\nF\nF\n\ng1(x) = -1 for (x1, x2) = {AA, AB, AC, BA, BB, CB, CC}\ng1(x) = +1 otherwise\n\nContinuous (non-discrete) optimization: F consists of an infinite number of feasible solutions\n\nx2\nx1\n\nSolving Optimization Problems\n\nObjective in optimization is to find the best decision strategy among all feasible possibilities:\n\n→ We seek a global optimum\n\nMost common way to find optimum for large problems is to use an iterative search:\n\nAn iterative search algorithm needs:\n-\nA method for selecting an initial feasible solution - Can be formulated as a secondary\noptimization problem\n-\nA stopping criterion that detects following:\n1. No feasible solution - no way to satisfy all constraints\n2. Optimal solution found - satisfies optimality conditions\n3. Objective function unbounded over feasible region - Objective can be infinite\nwithin feasible region.\nF is bounded by curves corresponding\nto gi(x) = 0.\nInterior of F is set of points that satisfy\ngi(x) < 0.\nF\ng2(x) ≤ 0\ng1(x) ≤ 0\ng3(x) ≤ 0\ng1(x) = 0\ng2(x) = 0\ng3(x) = 0\nEvaluate\nobjective\nfunctio\nMove to a\nbetter feasible\nsolutio\nSto\nFeasibl\n?\nTry\nagain\nPick initial\nsolutio\nStart\nYes\nNo\nYes\nNo\nEvaluate\nobjective\nfunctio\nMove to a\nbetter feasible\nsolutio\nSto\nFeasibl\n?\nTry\nagain\nPick initial\nsolutio\nEvaluate\nobjective\nfunction\nMove to a\nbetter feasible\nsolution\nStop\nFeasible\n?\nTry\nagain ?\nPick initial\nsolution\nYes\nExit\nNo\n\n-\nA solution improvement mechanism - challenging for nonlinear problems, often based\n\non optimality conditions, sometimes ad hoc.\n\nTypes of search procedures:\n-\nExhaustive Searches - For discrete problems:\nMove methodically through all (or sometimes a subset) of the feasible solutions to\ndetermine which has best objective value.\n-\nSelective Searches - For continuous problems:\nUse information from current and past candidate solutions (e.g. objective value or\nobjective gradient) to determine next feasible solution.\n\nFor now, focus on continuous problems and selective searches.\n\nGlobal vs. Local Maxima for Continuous Problems\nIn practice, it is much easier to find local optima:\nx* is a local maximum if F(x*) ≥ F(x) for all feasible x near x*\nx* is a local minimum if F(x*) ≤ F(x) for all feasible x near x*\n\nTwo key questions:\n1. When is a local optimum also global optimum?\n2. How do we know when a particular candidate solution x* is a local optimum?\n\nWhat can we say about global optimality based on local properties (near x*) ?\n\nGlobal optima cannot be\nidentified from local properties !\nExcept in certain special cases\nFeasible Region\nF(x)\nLocal max\nNonunique local min\nGlobal max\nInflection pt\nGlobal min\ndF(x)/dx=0\ndF(x)/dx = 0\nx"
    },
    {
      "category": "Lecture Notes",
      "title": "lect4.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/1-731-water-resource-systems-fall-2006/7a22991f8d32b8fe83ee77f69638a03d_lect4.pdf",
      "content": "MASSACHUSETTS INSTITUTE OF TECHNOLOGY\nDepartment of Civil and Environmental Engineering\n\n1.731 Water Resource Systems\n\nLecture 4, General Optimization Concepts 2, Sept. 19, 2006\n\nWhen is a local optimum also a global optimum?\n\nA local maximum/ minimum is a global maximum/minimum over the feasible region F if:\n1. The feasible region is convex\n2. The objective function is convex (for a maximum) or concave (for a minimum)\nIf the objective function is strictly convex or concave, the optimum is unique.\n\nWe need to define terms to apply this criterion.\n\nVector functions and derivatives:\nUse vector notation used to represent multiple functions of multiple variables:\n\nm\ni\nx\nx\nx\ng\nx\ng\nx\ng\ny\nn\ni\nj\ni\n,...,\n)\n,...,\n,\n(\n)\n(\n)\n(\n=\n=\n→\n=\n\nSelected derivatives of scalar and vector functions:\n\nGradient vector of scalar function f(x):\ni\nn\nx\nx\nx\nf\n∂\n∂\n)\n,...,\n( 1\n\nHessian matrix of scalar function f(x):\nj\ni\nn\nx\nx\nx\nx\nf\n∂\n∂\n∂\n)\n,...,\n( 1\n(symmetric)\n\nJacobian matrix of vector function gi(x)\nj\nn\ni\nx\nx\nx\ng\n∂\n∂\n)\n,...,\n( 1\n\nConvex/concave functions\nConvexity of functions can be defined geometrically or in terms of Hessian:\n\nf(x)\nx\n\nf(x) is a convex function if:\n]\n[\n)\n1(\n]\n[\n]\n)\n1(\n[\nB\nA\nB\nA\nx\nf\nx\nf\nx\nx\nf\nα\nα\nα\nα\n-\n+\n≤\n-\n+\nHessian positive semi-definite ∀ x\ni\ni\nij\nx\nx\nx\nf\nConcave\nConvex\nFunction lies below line connecting 2 points\n∂\n∂\n∂\n=\n)\n(\nH\nxA\nxB\n\nf(x) is a concave function if:\n\nLinear functions are both\nconvex and concave !\n]\n[\n)\n1(\n]\n[\n]\n)\n1(\n[\nB\n\nConvex feasible region F:\nF is convex if line connecting any pair of points (xA, xB) lies completely inside region:\n\n[0,1]\n\nin\n)\n,\n(\nall\nfor\n\n)\n1(\n∈\n∈\n-\n+\nα\nα\nα\nF\nF\nB\nA\nB\nA\nx\nx\nx\nx\n\nConvex feasible region may be constructed from m constraints that meet following\nrequirements:\n\nAll gi(x) are convex when gi(x) ≤ 0\nOr:\n\nAll gi(x) are concave when gi(x) ≥ 0\n\nFeasible regions constructed from linear\nfunctions are always convex.\n\nSummary:\nA local maximum/ minimum is a global maximum/minimum over the feasible region F if:\n1. The feasible region is convex\n2. The objective function is convex (for a maximum) or concave (for a minimum)\nIf the objective function is strictly convex or concave, the optimum is unique.\n\nx2\nx1\nxA\nxB\nY\nConvex\nx2\nx1\nxA\nxB\nY\nNon-convex\nA\nB\nA\nx\nf\nx\nf\nx\nx\nf α\nα\nα\n+\n≥\n-\n+\n-α\nFunction lies\nline connecting 2 points\nabove\nHessian negative semi-definite ∀ x\ni\ni\nij\nx\nx\nx\nf\nH\n∂\n∂\n∂\n=\n)\n(\nx\ng(x) ≤ 0\ng(x)\ng(x) convex → F convex\n\n1D Examples:\n\n1. Objective is convex/concave, feasible region is convex → local maxima/minima are global\nmaxima/minima.\n\nf(x) convex\nover F\nx\nf(x)\nConvex F\nLocal = global min\nf(x) concave\nover F\nx\nf(x)\nConvex F\nLocal = global max\n\n2. Objective is convex/concave, feasible region is not convex → local maxima/minima are not\nnecessarily global maxima/minima.\n\nLocal =\nglobal max\nf(x) concave\nover F\nx\nf(x)\nNon-convex F\nLocal = global max\nf(x) convex over F\nx\nf(x)\nNon-convex F\nLocal =\nglobal min\nLocal = global\nmin\n\n3. Objective is not convex/concave, feasible region is convex → local maxima/minima are not\nnecessarily global maxima/minima.\n\nf(x) not convex\nover F\nx\nf(x)\nConvex F\nLocal =\nglobal min\nLocal = global min\nLocal = global max\nf(x) not concave\nover F\nx\nf(x)\nConvex F\nLocal = global max"
    },
    {
      "category": "Lecture Notes",
      "title": "lect5_6.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/1-731-water-resource-systems-fall-2006/805fed5182cc0626bbeac6b4586997e7_lect5_6.pdf",
      "content": "MASSACHUSETTS INSTITUTE OF TECHNOLOGY\nDepartment of Civil and Environmental Engineering\n\n1.731 Water Resource Systems\n\nLecture 5 & 6, Optimality Conditions, Sept. 21 & 26, 2006\n\nHow do we know when a particular candidate solution x* is a local maximum?\n\nNecessary (Kuhn-Tucker) conditions for a candidate solution x* to be a local maximum are:\n1. Feasibility\n2. Stationarity\n3. Inequality Lagrange multipliers\n4. Curvature\n\nPreliminaries:\nx* is a local maximum if F(x*) ≥ F(x) for all feasible x near x*\n\n*\nA\nm\n(x* )= 0\ni ∈ C (x*) = active set\nactive constraints at x*:\ng\n\ni\n*\nI\nm\n(x* ) < 0 i ∈ C (x*)\ninactive constraints at x*:\ng\n\ni\nm\nm\nm\nI\nA\n=\n+\n*\n*\n\n*\nA\nm\n*\nA\nm\nby n matrix with rows the gradient vectors\nForm an\nof the\nj\ni\nx\nx\ng\n∂\n∂\n/\n*)\n(\nconstraint\nfunctions active at x* . If Rank [\n*\n*\nA\nA\nm\n<\nρ\n] =\nj\ni\nx\nx\ng\n∂\n∂\n/\n*)\n(\nthe problem is degenerate.\nOtherwise\n*\n*\nA\nA\nm\n=\nρ\nand the problem is non-degenerate.\n\n*\nA\nm\n* ≥\n-\nA\nn\nρ\nconstraints active at x* define an\nThe set of\ndimensional constraint surface in\nthe n dimensional decision space.\n\n*\nA\nρ\n*\nA\nρ\nlinearly independent gradient vectors form a basis for a\nAny\ndimensional gradient\nspace. Any\n*\nA\nn\nρ\n-\n*\nA\nn\nρ\n-\ntangent vectors p (i = 1,...,\ni\n) normal to all the gradient vectors form\na basis for an\n*\nA\nn\nρ\n-\ndimensional tangent space.\n\nOrthogonality condition satisfied by any vector pi in tangent space:\n*)\n(\n*)\n(\n=\n∂\n∂\n→\n∂\n∂\n⊥\ni\nj\ni\ni\nj\ni\nx\nx\ng\np\nx\nx\ng\np\n\ni ∈ C (x*)\n\n*\nA\nn\nρ\n-\nThe tangent space can be viewed as a plane that intersects the\nconstraint surface at x* .\nThis plane approximates the constraint surface for x sufficiently close to x* .\n\nIntersection of active\nconstraint surfaces\nx\nConstraint tangent space\nConstraint gradient space\n*\n)\n(\nρ\n=\n∂\n∂\nDim\nx\nx\ng\nj\ni\n*\n)\n(\nρ\n-\n=\n∂\n∂\n⊥\nn\nDim\nx\nx\ng\np\nj\ni\ni\n\nStatement of Necessary Conditions for a Local Maximum:\n1. Feasibility\nx* must lie in the feasible region F:\ng (x* ) = 0\ni = 1,...r\ni\ng (x* ) ≤ 0 i = r+1, ..., m\ni\n\n2. Stationarity\nObjective function gradient at x* must lie in the constraint gradient space (i.e. it has no\nprojection onto the constraint tangent plane).\n\nFor non-degenerate problems this implies:\nxj\nx\ng\nxj\nx\nF\ni\ni\n∂\n∂\n=\n∂\n∂\n*)\n(\n*)\n(\nλ\n\ni ∈ C (x*)\n\nThe λi are Lagrange multipliers for the active constraints at x*.\n*\n*\nA\nA\nm\n=\nρ\nIf x* is a local maximum this system of n linear equations in the\nunknown λi's\nmust have a solution (i.e. it must be consistent).\n\n*\n*\nA\nA\nm\n<\nρ\nFor degenerate problems include only\nlinearly independent constraints and set\nλi = 0 for the remaining redundant constraints\n\nAdopt convention that λi = 0 for inactive constraints as well as redundant constraints\n\nso the stationarity condition can include all constraints:\nxj\nx\ng\nx\nx\nF\ni\ni\nj\n∂\n∂\n=\n∂\n∂\n*)\n(\n*)\n(\nλ\n\n0 for each i ∈ C (x*) (no sum over i)\n*)\n(\n=\nx\ngi\niλ\n\nDefine Lagrangian function to be:\n*)\n(\n*)\n(\n)\n*,\n(\nx\ng\nx\nF\nx\nL\ni\niλ\nλ\n-\n=\n\nThen stationarity condition requires:\n)\n*,\n(\n=\n∂\n∂\nj\nx\nx\nL\nλ\n\n3. Inequality Lagrange multipliers\n\nIf x* is a local maximum then the Lagrange multipliers for all inequality constraints\n\nactive at x* must be non-negative: λ ≥ 0, i ∈ C (x*).\ni\n\n4. Curvature\n\nProjection of Lagrangian onto the constraint tangent space must have a negative semi-\n\ndefinite Hessian.\n\n*\nA\nn\nρ\n-\n*\nA\nn\nρ\n-\nProjection operator is an n by\nmatrix Zik with columns composed of the\n\nconstraint tangent space basis vectors. These basis vectors are linearly independent\nsolutions p of:\ni\n*)\n(\n*)\n(\n=\n∂\n∂\n→\n∂\n∂\n⊥\ni\nj\ni\nj\ni\ni\nx\nx\ng\np\nx\nx\ng\np\n\n⎥⎦\n⎤\n⎢⎣\n⎡\n=\n-\n*\nA\nn\ni\ni\nik\np\np\nZ\nρ\nK\n:\n\nHessian of the projected Lagrangian is Wkl:\n)\n*,\n(\n=\n∂\n∂\n∂\n=\nlj\nik\ni\nj\nkl\nZ\nZ\nx\nx\nx\nL\nW\nλ\n\nIf x* is a local maximum, Wkl must be negative semidefinite → Wkl ≤ 0.\n\nExample:\nConsider an two-dimensional example with 2 inequality constraints and 3 candidate solutions\n(0,2)\n*\nA\nx\n=\nF\nx1\nx2\n-1\n-2\n-\nx\n(x)\ng\nx\nx\n(x)\ng\nx\n-\n-x\nF(x)\n≤\n=\n≤\n+\n-\n=\n=\n-1\n-4\ng1(x)≤0\ng2(x)≤0\n(0,1)\n*\nB\nx\n=\n(1,2)\n*\nC\nx\n=\n)\n2,0\n(\n* =\nA\nx\n,\n.,\n)\n2,1(\n* =\nC\nx\n)1,0\n(\n* =\nB\nx\n\nGradients are:\n\nLagrangian and its Hessian are:\n=\n∂\n∂\n=\n∂\n∂\n-\n=\n∂\n∂\n=\n∂\n∂\n-\n=\n∂\n∂\n-\n=\n∂\n∂\nx\ng\nx\ng\nx\ng\nx\nx\ng\nx\nx\nF\nx\nx\nF\n⎥⎦\n⎤\n⎢⎣\n⎡\n-\n-\n-\n=\n∂\n∂\n∂\n-\n+\n+\n-\n-\n-\n-\n=\n)\n,\n(\n]\n[\n]1\n[\n)\n,\n(\nλ\nλ\nλ\nλ\nλ\nj\ni x\nx\nx\nL\nx\nx\nx\nx\nx\nx\nL\n\nEvaluate gradients at candidate solutions\n*\nA\nm\n*\nA\nρ\n*\nA\nn\nρ\n-\n\nj\nx\nx\nF\n∂\n∂\n/\n*)\n(\nj\nx\nx\ng\n∂\n∂\n/\n*)\n(\nj\nx\nx\ng\n∂\n/\n*)\n(\n\nij\nZ\n∂\n)\n2,0\n(\n* =\nA\nx\n\n1 1 1\n⎥⎦\n⎤\n⎢⎣\n⎡\na\n⎥⎦\n⎤\n⎢⎣\n⎡\n-4\n⎥⎦\n⎤\n⎢⎣\n⎡\n-1\n⎥⎦\n⎤\n⎢⎣\n⎡\n)1,0\n(\n* =\nB\nx\n\n1 1 1\n⎥⎦\n⎤\n⎢⎣\n⎡\na\n⎥⎦\n⎤\n⎢⎣\n⎡\n-2\n⎥⎦\n⎤\n⎢⎣\n⎡\n-1\n⎥⎦\n⎤\n⎢⎣\n⎡\n)\n2,1(\n* =\nC\nx\n\n2 2 0\nNone\n⎥⎦\n⎤\n⎢⎣\n⎡\n-\n-\n⎥⎦\n⎤\n⎢⎣\n⎡\n-1\n⎥⎦\n⎤\n⎢⎣\n⎡\n\nCheck necessary conditions for a local maximum at each x*:\n\n1. Feasibility:\nAll 3 candidate solutions are feasible.\n\n2. Stationarity\nConsider for all active constraints:\n\nW\n\nConsistent ?\n\nλ\nλ\nkl\n)\n2,0\n(\n* =\nA\nx\n\nYes\n\n-4\n-2a2 < 0\n)1,0\n(\n* =\nB\nx\n\nYes\n\n+2\n-6a2 < 0\n)\n2,1(\n* =\nC\nx\n\nYes\n\n-1\n-5\nNone\n\n3. Inequality Lagrange Multipliers\nOnly\nhas non-negative Lagrange multipliers for active inequalities.\n*\nB\nx\n\n4. Curvature:\nBoth *\nA\nx and\nsatisfy the curvature condition. This condition does not apply to\n.\n*\nC\nx\n*\nB\nx\n\nExample Summary:\nOnly\nis a local maximum.since it is the only solution that satisfies all 4 conditions. For this\nproblem\nis also a global maximum (why?)\n*\nB\nx\n*\nB\nx\n\nQuick Outline of Derivation:\nDerivation of necessary conditions is based on Taylor series approximations of g (x) and F(x):\ni\n\nAn infinitesimal feasible arc from x* to x lies wholly inside the feasible region.\nLet θ be distance along this arc from x* to x.\nx* = x(0) x = x(θ)\nThe vector tangent to this arc at x(0) is\nθ\n∂\n∂\n/)\n(\nj\nx\n.\n\nInfinitesimal arcs originating at x(0) are feasible [i.e.\n)]\n(\n[\n=\nθ\nx\ngi\n] if the corresponding\nθ\n∂\n∂\n/)\n(\nj\nx\nlies in the constraint tangent space. To see this use a Taylor series expansion of\n)]\n(\n[ θ\nx\ngi\n:\n)\n(\n)]\n(\n[\n)]\n(\n[\n)]\n(\n[\n=\n+\n∂\n∂\n∂\n∂\n+\n=\nK\nθ\nθ\nθ\nj\nj\ni\ni\ni\nx\nx\nx\ng\nx\ng\nx\ng\n\ni ∈ C (x*)\nThe first term on the right is zero because constraint i is active at x* = x(0).\nThe second term on the right is zero since\nθ\n∂\n∂\n/)\n(\nj\nx\nis orthogonal to all the active constraint\nvectors if it lies in constraint tangent space.\n\nThe Taylor series expansion of F[x(θ)] along an infinitesimal arc is:\n\nK\nK\n+\n∂\n∂\n∂\n∂\n∂\n∂\n∂\n+\n∂\n∂\n∂\n∂\n+\n=\n=\n+\n∂\n∂\n+\n∂\n∂\n+\n=\n)\n(\n)\n(\n*]\n[\n)\n(\n*]\n[\n*]\n[\n)]\n(\n[\n)]\n(\n[\n)]\n(\n[\n)]\n(\n[\n)]\n(\n[\nθ\nθ\nθ\nθ\nθ\nθ\nθ\nθ\nθ\nθ\nθ\nj\ni\nj\ni\ni\ni\nx\nx\nx\nx\nx\nF\nx\nx\nx\nF\nx\nF\nx\nF\nx\nF\nx\nF\nx\nF\nx\nF\n\nIf x* is a local maximum F(x) = F[x(θ)] must be ≤ F[x(0)] = F(x*) for all values of θ along the\narc. This implies:\n)\n(\n*]\n[\n)]\n(\n[\n=\n∂\n∂\n∂\n∂\n=\n∂\n∂\nθ\nθ\nj\nj\nx\nx\nx\nF\nx\nF\n1).\n\n)\n(\n)\n(\n*]\n[\n)]\n(\n[\n≤\n∂\n∂\n∂\n∂\n∂\n∂\n∂\n=\n∂\n∂\nθ\nθ\nθ\nj\ni\nj\ni\nx\nx\nx\nx\nx\nF\nx\nF\n\n2).\nThe stationarity condition follows from 1). and the curvature condition follows from 2), if the\nrequirement that\nθ\n∂\n∂\n/)\n(\nix\nlies in the constraint tangent space and the definition of the\nLagrangian are invoked.\n\nThe stationarity condition takes care of feasible arcs that lie in the tangent space, which are the\nonly directions that are feasible for equality constraints.\n\nIf the constraint is an inequality the feasible arc may also point into the feasible region, away\nfrom the tangent space. Directions into the feasible region are defined by::\n\n3).\n)]\n(\n[\n)\n(\n<\n∂\n∂\n∂\n∂\nj\ni\nj\nx\nx\ng\nx\nθ\n\nfor i an inequality constraint ∈ C (x*)\nThe objective function cannot increase along this feasible arc if x* is a local maximum. So:\n\n4).\n)\n(\n)]\n(\n[\n≤\n∂\n∂\n∂\n∂\nθ\nj\nj\nx\nx\nx\nF\n\nfor i an inequality constraint ∈ C (x*)\n\nThe inequality Lagrange multiplier condition follows from 3) and 4)."
    },
    {
      "category": "Lecture Notes",
      "title": "lect7.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/1-731-water-resource-systems-fall-2006/c5b8053500c7257275d093376da49565_lect7.pdf",
      "content": "MASSACHUSETTS INSTITUTE OF TECHNOLOGY\nDepartment of Civil and Environmental Engineering\n\n1.731 Water Resource Systems\n\nLecture 7, Linear Programming Overview, Sept. 28, 2006\n\nLinear Programming Problems (LPP)\nObjectives and constraints are all linear functions of decision variables:\n\nTotal constraints = mT +mN = m\n\nOptimal Solutions of Linear Programming Problems:\nFor LPP:\nLinear objective and constraint functions are both convex and concave so:\n-\nFeasible region F for LP is convex (i.e. constructed from convex functions gi(x)≤0)\n-\nObjective function for LP is concave\nTherefore:\nA candidate LPP solution x* that is a local maximum is also a global maximum.\n\nTo check whether x* is a local/global maximum use necessary conditions:\n\nFocus on constraints that are active at x*:\n\nRow i of\n*\nA\nG = Aij if i is a technological constraint\nRow i of\n= b\n*\nAi\nb\ni if i is a technological constraint\nRow i of\n*\nA\nG = -δij if i is a non-negativity constraint\nRow i of\n= 0 if i is a non-negativity constraint\n*\nAi\nb\n\n,...,\n\n)\n(\n\n,...,\n\n)\n(\n)\n,...,\n,\n(\n\nN\nT\nT\nm\ni\nNi\nT\ni\nj\nij\nTi\nj\nj\nn\nn\n,...,x\n,x\nx\nm\nm\nm\ni\nx\nx\ng\nm\ni\nb\nx\nA\nx\ng\nsuch that:\nx\nc\nx\nx\nx\nF\nMaximize\n+\n+\n=\n≤\n-\n=\n=\n≤\n=\n=\n-\nTechnological constraints (may be\nequalities or inequalities)\nNon-negativity constraints\n*)\n(\n\n*\n*\n*\nx\ni\nb\nx\nG\nAi\nj\nAij\nC\n∈\n=\n-\n\n1. Feasibility\nx* is chosen to be feasible\n\n2. Stationarity\nIf x* is a local maximum then:\n\n*\n*\n*\n]\n[\n]\n[\n*)\n(\nAij\ni\nj\nAi\nj\nAij\ni\nj\nj\nj\nj\nj\nG\nx\nb\nx\nG\nc\nx\nx\nc\nx\nx\nF\nλ\nλ\n=\n∂\n+\n∂\n=\n=\n∂\n∂\n=\n∂\n∂\n\nFor LPP stationarity condition reduces to a set of linear equations in unknown λi's\n\nj\nAij\ni\nc\nG\n=\n*\nλ\nThe stationarity condition is satisfied if this set of linear equations is consistent so:\n]\n[\n]\n[\n*\n*\n*\nj\nAij\nAij\nc\nG\nRank\nG\nRank\n=\n=\nρ\n\nThere are four ways this can occur:\n1). Corner solution: x* lies at intersection of n linearly independent constraints.\n\nn\nmA =\n=\n*\n*\nρ\n.\n2). Trivial interior solution: occurs only if cj =0.\n\n*\n*\n=\n=\nA\nm\nρ\n\n3). Non-corner boundary solution: x* lies along a boundary but not at a corner.\n\nn\nmA <\n=\n*\n*\nρ\n\n4). Degenerate solution: Constraints are linearly dependent (i.e. number of constraints\n\nexceeds rank of\n).\n*\nAij\nG\n\n*\n*\nA\nm\n<\nρ\n\n3. Inequality Lagrange multiplier\nIf x* is a local maximum then:\n\n*)\n(\n\nx\ni\ni\nC\n∈\n≥\nλ\n\nIn case 1) above there will be only one solution that satisfies this condition.\n\n4. Curvature\nIn LLP curvature condition applies for any x* since Lagrangian Hessian is always zero.\n\n)]\n(\n[\n)\n*,\n(\n*\n*\n*\n=\n∂\n∂\n-\n-\n∂\n=\n∂\n∂\n∂\n=\n=\nlj\nik\nx\nx\nk\nj\nAi\nj\nAij\ni\nj\nj\nlj\nik\nk\nj\nkl\nZ\nZ\nx\nx\nb\nx\nG\nx\nc\nZ\nZ\nx\nx\nx\nL\nW\nλ\nλ\n\nCrop Allocation Example\nProblem is to maximize revenue from two crops, given constraints on available land and water\nand on minimum total crop grown.\n\nDecision variables:\nx1 = mass of crop 1 grown (tonnes = 103 kg)\nx2 = mass of crop 2 grown (tonnes = 103 kg)\n\nconstraint\n\nnegativity\n-\nnon\n\n-\n\nconstraint\n\nnegativity\n-\nnon\n\n-\n\n(tonnes)\n\nconstraint\n\nproduction\n\nMinimum\n\n-\n\n(ha)\n\nconstraint\n\nLand\n\n/season)\nm\n\n(10\n\nconstraint\nWater\n\n:\nsuch that\n\nMaximize\nx\nx\nx\nx\nx\nx\nx\nx\nx\nx\nx\nx\n,x\nx\n≤\n≤\n-\n≤\n-\n≤\n+\n≤\n+\n+\n\nObjective, right-hand side, and technological coefficients:\n\ncj -- Crop values ($/tonne)\n\nb1 -- Water available (m3/season)\n\nb2 -- Land available (ha)\nA1j -- Water requirements (103 m3/(season tonne) ) = (unit water requirement in 10-1\nm/season)/(yield in tonnes/ha)\n\nA2j -- Land requirement (ha/tonne) = (yield in tonnes/ha)-1\n\nx1\nx2\n(76,0)\n(52,0)\n(25,0)\n(0,25)\n(0,38)\n(44,16)\nIncreasing F(x)\ng1(x) water\n\ng2(x) land\ng3(x)\nproduction\ng4(x)\nnon-neg\nF\ng5(x) non-neg\n\nPairs of constraints active at the 5 corners of the feasible solution are all linearly independent\n(i.e. corresponding\nhave rank\n*\nAij\nG\n*\n*\n=\n=\n=\nn\nmA\nρ\n).\nSo\nis consistent and stationarity condition is satisfied at each of these corner\npoints.\nj\nAij\ni\nc\nG\n=\n*\nλ\n\nThere are no interior, non-corner boundary, or degenerate solutions for this example.\nSo we need only consider the Lagrange multipliers at the 5 corner solutions:\nCandidate\nActive\nLagrange Multipliers\nSolution\nConstraints\n(25, 0)\n3, 5\n\nλ3 = -6\nλ5 = -5\n(52, 0)\n5, 1\n\nλ1 = +3\nλ5 = -8\n(44, 16)\n1, 2\n\nλ1 = +1/3\nλ2 = +16/3\n(0, 38)\n2, 4\n\nλ2 = +11/2\nλ4 = -1/2\n(0, 25)\n4, 3\n\nλ4 = -11\nλ3 = +5\n\nx* = (44, 16) is the local/global maximum since it is the only corner solution with positive\nLagrange multipliers for all active constraints.\n\nIn this problem the optimum crop allocation mixes Crop 1 and Crop 2 in a way that uses all\navailable land and water while giving maximum revenue.\n\nIt is possible to generate a non-corner (non-unique) boundary solution to this problem by\nchanging the objective function to F(x) = 6x1 + 12x2. Then\nn\nmA <\n=\n*\n*\nρ\n\n(\n,1\n,1\n*\n*\n=\n=\n=\nn\nmA\nρ\n). The objective function contours are parallel to g1(x) and any feasible\nsolution along g1(x) is local/global maximum.\n\nIt is possible to generate a degenerate solution to this problem by changing the water constraint\nto g1(x) = 2x1 + x2.≤ 152. Then\n*\n*\nA\nm\n<\nρ\n(\n)\n,2\n,2\n*\n*\n=\n=\n=\nA\nm\nn\nρ\nat the new corner (76, 0).\nThere is not a unique set of λi's satisfying stationarity condition at this corner.\nSo the inequality Lagrange multiplier condition cannot be checked."
    },
    {
      "category": "Lecture Notes",
      "title": "lect9.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/1-731-water-resource-systems-fall-2006/183e2a9963998820d6502515840e61d2_lect9.pdf",
      "content": "MASSACHUSETTS INSTITUTE OF TECHNOLOGY\nDepartment of Civil and Environmental Engineering\n\n1.731 Water Resource Systems\n\nLecture 9, Linear Programming Sensitivity Analysis, Oct. 5, 2006\n\nOverview\nAn LPP depends on 3 types of problem inputs:\n-\nRight-hand side values (e.g resource limits)\n\nb\ni\n-\nObjective function coefficients (e.g. unit costs)\n\ncj\n-\nTechnological coefficients (e.g. resource requirements)\nAij\n\nAll may be uncertain or subject to change.\nWe wish to investigate sensitivity of optimal solution to these coefficients.\n\nn\nmA =\n=\n*\n*\nρ\nSuppose that optimal solution x* lies at a feasible region corner defined by\n\nlinearly independent constraint gradients, with a corresponding set of active constraints C(x*).\n\nWhen the problem inputs are changed slightly the active set C (x*) may remain the same while\nthe optimum solution may or may not change. As the input change becomes greater C (x*) may\nalso change. Each input type behaves somewhat differently.\n\nRight-hand Side Values\nAs the right-hand side values change:\n-\nThe position but not the gradient of the corresponding constraint function changes.\n-\nThe shape of the feasible region changes.\n-\nThe optimum objective function value and optimum solution x* change\n-\nEventually the active set C (x*) also changes.\n\nFocus on example when b1 (water availability) changes:\n\ng1(x) = 2 x1 + x2 ≤ b1 = 104\n\nchange b1 → b1 + δ b1\n\nIf 38 ≤ b1+ δ b ≤ 152 the water g\n1(x) constraints and land g2(x) constraints remain active so\nC (x*) = {1, 2} does not change. Outside this range the land constraint is no longer active, so the\nconstraint set changes to either C (x*) = {1, 4} or C (x*) = {1, 5}.\nAs b1 increases water is eventually no longer limiting and only Crop 1 is grown because\nit uses less land.\nAs b1 decreases water is eventually too limited to permit all the land to be used and only\nCrop 2 is grown because it uses less water.\n\nThe objective function changes continuously as b1 changes. Slope is constant and equal to\niλ so\nlong as C (x*) remains the same;\n\nIn general, slope of each segment =\ni\nib\nx\nF\nλ\n=\n∂\n∂\n/)\n(\n= sensitivity of objective to bi. for a given\nC (x*). For this example, this sensitivity has units of $/tonnes of water, which measures the value\nof additional water. Accordingly,\niλ is called the shadow price of water.\n\nIn the crop allocation example the\ni\nib\nx\nF\nλ\n=\n∂\n∂\n/)\n(\nvs. b1 plot shows how the water shadow price\ndecreases as available water increases. This plot is called a derived demand, since it indicates\nhow the demand for water (price that farmer is willing to pay) changes as more water becomes\navailable. For b1 > 152 additional water cannot be used and shadow price drops to λi = 0.\n\nShadow price for a resource always decreases as more resource becomes available.\nb1\n1/3\n11/1\nOriginal optimum\nF(x)\nNot to scale\ng3(x)\nsupply\ng1(x)\nwater\ng2(x)\nland\ng4(x)\nnon-neg\ng5(x) non-neg\nb1→ b1 + δb\nx2\n(0,38)\n\nx*\n(0,25)\nx\n(25,0)\n(52,0)\n(76,0)\n\nNote some constraint gradients become linearly dependent at point where C (x*) changes.\n\nChanges in C (x*)\nλ1\nb\n1/3\nNot to scale\n\nObjective Function Coefficients\nWhen a LPP objective function coefficient c changes\ni\n-\nThe objective function contourn planes rotate.\n-\nThe feasible region does not change.\n-\nThe optimum objective function value changes but the optimum solution x* does not\nchange so long as the active constraint set C (x*) remains the bsame\n-\nEventually C (x*) also changes.\n\nFocus on example when c1 (price of Crop 1) changes:\n\nF (x) = c1 x + c\n2 x2 = 6 x1 + 11 x2\nchange c1 → c1 + δ c1\n\ng4(x)\nnon-neg\nx2\n(76,0)\n(52,0)\n(25,0)\n(0,25)\n(0,38)\ng1(x)\nwater\ng2(x)\nland\nci → ci + δci\ng5(x)\nnon-neg\ng3(x)\nsupply\n\nIf 11/2 ≤ c + δ c ≤ 22 the land g\n2(x) and water g1(x) constraints remain active so C (x*) = {1,\n2} does not change. Outside this range the active constraint set changes to either C (x*) = {2, 4}\nor C (x*) = {1, 5} and the optimum solution changes to either (0, 38) or (152, 0).\nAs c1 increases Crop 1 becomes more valuable and eventually all water is devoted to\nCrop 1 while some land goes unused.\nAs b1 decreases Crop 2 becomes more valuable and eventually all land is devoted to\nCrop 2 while some water goes unused.\nThe objective function changes continuously as c1 changes. Slope is constant and equal to\nso\nlong as C (x*) .\n*\n1x\n\nIn general, slope of each segment =\n= sensitivity of objective to c\n*\n/)\n(\ni\ni\nx\nc\nx\nF\n=\n∂\n∂\ni. for a given\nC (x*).\n\nObjective function and some constraint gradients become linearly dependent at point where C\n(x*) changes.\n\nTechnological Coefficients\n\nWhen a LPP technological coefficient Aij changes\n-\nThe corresponding constraint function gradients (and tangent planes) rotate.\n-\nThe shape of the feasible region changes.\n-\nThe optimum objective function value and optimum solution x* change\n-\nEventually the active constraint set C (x*) also changes.\n\nSome constraint gradients become linearly dependent at point where C (x*) changes.\n\nWhen the technological coefficients are resource requirements (as in this example) coefficient\nchanges favor one or another decision variable and the solution changes accordingly. Details can\nbe worked out following an approach similar to that outlined above.\n\nParametric analysis\nSome LPP optimization software automatically determines sensitivities and all values where the\nactive constraint set C (x*) over the feasible range of problem input values. In GAMS this must\nbe done by looping through discrete values of the changing input, re-solving the optimization\nproblem each time."
    },
    {
      "category": "Lecture Notes",
      "title": "lect11.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/1-731-water-resource-systems-fall-2006/96c5a5c6b3c1637ff5271441060aea19_lect11.pdf",
      "content": "MASSACHUSETTS INSTITUTE OF TECHNOLOGY\nDepartment of Civil and Environmental Engineering\n\n1.731 Water Resource Systems\n\nLecture 11, Differential Constraints and Response Matrices, Oct. 5, 2006\n\nStandard formulation of optimization problem relies on algebraic constraints. In many\nenvironmental applications constraints arise most naturally as differential equations. How\nshould these differential constraints be handled?\n\nExample - Allocation of waste heat discharges along a stream\nProblem is to select heat discharges WA and WB at 2 locations xA and xB along stream in order to\nmaximize total heat discharged WA + WB, subject to upper limit (Tmax) on water temperature T.\n\nQ\nT(x)\nx\nT\nx\nx\nWA\nWB\nTmax\nL\nHeat sources\nStream temperature\nprofile\n\nIncorporate model based on stream energy balance (relates heat discharges and stream\ntemperature):\n)\n(\n;\n)\n(\n)\n(\n)\n(\nT\nT\nx\nx\nW\nx\nx\nW\nT\nT\nA\nk\ndx\ndT\nQ\ndt\ndE\nB\nB\nA\nA\ne\n=\n-\n+\n-\n+\n-\n+\n=\n=\nδ\nδ\nργ\nργ\n\nE = Energy per unit length [Joules/m]\nρ = Density of water [kg/m3]\nγ = Specific heat of water [Joules/(kg ° C)]\nQ = Stream flow [m3/day]\nT = Water temperature [° C]\nT0 = Air temperature [° C]\nA = Stream cross-section [m2]\nke = Exchange rate [1/day]\n\nWA , WB Source heat flux [Joules/ day]\nδ(x - xA), δ(x - xB) = Dirac delta function at xA or xB [1/m], defined by:\n\notherwise\n\n'\n)'\n(\n)'\n(\n)\n(\n=\n≤\n<\n=\n-\n∫\nU\nx\nL\nx\nU\nL\nx\nx\nx\nx\nf\ndx\nx\nx\nx\nf\nδ\n\nAssume steady state (dE/dt = 0) and simplify to:\n)\n(\n;\n)\n(\n)\n(\n)\n(\nT\nT\nx\nx\nW\nx\nx\nW\nT\nT\ndx\ndT\nB\nB\nA\nA\n=\n-\n+\n-\n+\n-\n-\n=\nδ\nδ\nα\n\nQ\nQ\nA\nke\nργ\nβ\nα\n=\n=\n\nSuppose solution to this equation at any x is T(x, WA, WB). Then optimization problem is:\n\nx\n\nT\nW\nW\nx\nT\nW\nW\nMaximize\nmax\nB\nA\nB\nA\nB\nW\nA\nW\n∀\n≤\n+\n;\n)\n,\n,\n(\n:\nsuch that\n,\n\nNote that the temperature constraint as given here is evaluated at every x (infinite number of\nalgebraic constraints).\n\nThere are three ways to write the constraint\nmax\nB\nA\nT\nW\nW\nx\nT\n≤\n)\n,\n,\n(\nin a practical (finite) form:\n1. Analytical solution -\n)\n,\n,\n(\nB\nA W\nW\nx\nT\nis written as an explicit function of WA and WB.\n2. Imbedding -\n)\n,\n,\n(\nB\nA W\nW\nx\nT\nis defined implicitly, by a set of discretized model\nequations.\n3. Response matrix -\n)\n,\n,\n(\nB\nA W\nW\nx\nT\nis approximated by a Taylor series expressed in\nterms of model sensitivity derivatives.\n\nAnalytical solution\nSolution to stream equation with upstream boundary condition imposed:\nξ\nξ\nδ\nβ\nξ\nξ\nδ\nβ\nξ\nα\nξ\nα\nd\nx\ne\nW\nd\nx\ne\nW\nT\nW\nW\nx\nT\nx\nB\nx\nB\nx\nA\nx\nA\nB\nA\n∫\n∫\n-\n+\n-\n+\n=\n-\n-\n-\n-\n)\n(\n)\n(\n)\n(\n)\n(\n)\n,\n,\n(\n\nApply definition of δ function to get:\nB\nA\nT\nW\nW\nx\nT\n=\n)\n,\n,\n(\n\nx ≤ xA\n)\n(\n)\n,\n,\n(\nA\nx\nx\nA\nB\nA\ne\nW\nT\nW\nW\nx\nT\n-\n-\n+\n=\nα\nβ\n\nxA < x ≤ xB\nB\n)\n(\n)\n(\n)\n,\n,\n(\nB\nx\nx\nB\nA\nx\nx\nA\nB\nA\ne\nW\ne\nW\nT\nW\nW\nx\nT\n-\n-\n-\n-\n+\n+\n=\nα\nα\nβ\nβ\n\nx > xB\nB\n\nNote that temperature is highest at the discharge points xA and xB. Therefore, we can apply\ntemperature constraint only at xA and xB rather than at all points x:\nB\nmax\nB\nA\nx\nB\nx\nA\nA\nmax\nA\nB\nA\nB\nW\nA\nW\nx\nT\nW\ne\nW\nT\nx\nT\nW\nT\nW\nW\nMaximize\nat\n\nat\n\n:\nsuch that\n)\n(\n,\n≤\n-\n+\n+\n≤\n-\n+\n+\n-\n-\nβ\nβ\nβ\nα\n\nThis is in standard form, with algebraic rather than differential constraints. This approach is best\nwhen analytical solution is available, but that is not usually the case.\n\nImbedding\nWhen an analytical solution is not available an approximate numerical solution can be obtained\nby discretizing the differential equation over a computational grid of equally spaced points x1, x2,\n..., xN..\n\nIn this example use either of two approximations for the spatial derivative at each computational\ngrid point:\nx\nT\nT\nx\nx\nT\nx\nT\nx\nT\ni\ni\ni\ni\nix\nΔ\n-\n=\nΔ\n-\n≈\n∂\n∂\n+\n+\n)\n(\n)\n(\n\nForward difference (explicit)\nx\nT\nT\nx\nx\nT\nx\nT\nx\nT\ni\ni\ni\ni\nix\nΔ\n-\n=\nΔ\n-\n≈\n∂\n∂\n-\n-\n1)\n(\n)\n(\n\nBackward difference (implicit)\nThe Dirac delta function is approximated by 1/Δx.\n\nThe explicit discretization yields a set of N coupled equations as follows:\n\nx\nT\nTi =\ni = x0\n)\n(\ni\ni\ni\nT\nT\nx\nT\nT\n-\nΔ\n-\n=\n+\nα\n\nx0 < xi ≤ xA\nA\ni\ni\ni\nW\nT\nT\nx\nT\nT\nβ\nα\n+\n-\nΔ\n-\n=\n+\n)\n(\n\nxA < xi ≤ xB\nB\nB\ni\ni\ni\nW\nT\nT\nx\nT\nT\nβ\nα\n+\n-\nΔ\n-\n=\n+\n)\n(\n\nxi > xB\nB\n\nThese first-order difference equations have the same general form as the reservoir storage\nequation in Problem Set 3.\n\nThe system of equations obtained from the implicit discretization is most conveniently\nexpressed in matrix form:\nN\nk\ni\nW\nW\nb\nT\nA\nB\nA\nk\ni\nki\n,\n,1\n,\n)\n,\n(\nK\n=\n=\n\nwhere Aii = 1\n\nfor i =1,..., N\n\nAi,i-1 = αΔx-1\nfor i =2,..., N\n\nAi,k =0\n\notherwise\n\nbi = T0\n\nfor i =1\n\nbi = αΔxT0\n\nfor i >1 and xi = xA or xB\nB\n\nbi = βWΑ + αΔxT0\nfor xi = xA\n\nbi = βWΒ + αΔxT0\nfor xi = xB\nB\n\nBoth the explicit and implicit discretizations are in a form that can be inserted directly into\noptimization software such as GAMS (note that the implicit matrix equation does need not be\nsolved and the decision variables only appear on the right-hand side - the implicit constraints\nrelating each Ti to WA and WB are sufficient).\nB\n\nThe disadavantage of imbedding is the large number of decision variables and constraints it\nproduces (one for each grid point for each scalar differential equation). This is particularly\ninefficient in the example problem since we really only care about the temperature solutions at\nthe two points xA and xB . Solutions at all the other upstream points need to be computed in order\nto obtain these two temperatures.\nB\n\nResponse Matrix\nResponse matrix methods represent differential constraints with efficient linear approximations.\n\nAssume we have a numerical model available to evaluate temperatures\n)\n,\n(\nA\nA W\nx\nT\nand\n)\n,\n,\n(\nB\nA\nB\nW\nW\nx\nT\nat the discrete locations xA and xB, for any set of decision variables W\nB\nA and WB\nB.\n\nNumerical Model\n(\"Black Box\")\nWA, WB\nTA=T(xA ,WA)\nTB=T(xB ,WA ,WB)\nOther inputs:\nα,β,T0\n\nExpand these temperatures in a Taylor series around nominal decision values (e.g. WA = WB = 0):\nB\n\nK\n+\n∂\n∂\n+\n=\n=\nA\nA\nW\nA\nA\nA\nA\nA\nA\nW\nW\nW\nx\nT\nx\nT\nW\nx\nT\n)\n,\n(\n)\n0,\n(\n)\n,\n(\n\nK\n+\n∂\n∂\n+\n∂\n∂\n+\n=\n=\n=\nB\nB\nW\nB\nB\nB\nA\nA\nW\nA\nA\nB\nB\nB\nA\nB\nW\nW\nW\nx\nT\nW\nW\nW\nx\nT\nx\nT\nW\nW\nx\nT\n)\n,0,\n(\n)\n0,\n,\n(\n)\n0,0,\n(\n)\n,\n,\n(\n\nRBA\nRBB\nRAA\n\nAssociate the sensitivity derivatives with the elements of a response matrix R and rearrange equations:\n\n⎥⎦\n⎤\n⎢⎣\n⎡\n=\n⎥⎦\n⎤\n⎢⎣\n⎡\n⎥⎦\n⎤\n⎢⎣\n⎡\n+\n⎥⎦\n⎤\n⎢⎣\n⎡\nB\nA\nB\nA\nBB\nBA\nAA\nT\nT\nW\nW\nR\nR\nR\nT\nT\n\nResulting constraints for the optimization problem are:\n\n⎥⎦\n⎤\n⎢⎣\n⎡\n≤\n⎥⎦\n⎤\n⎢⎣\n⎡\n⎥⎦\n⎤\n⎢⎣\n⎡\n+\n⎥⎦\n⎤\n⎢⎣\n⎡\nmax\nmax\nT\nT\nW\nW\nR\nR\nR\nT\nT\nB\nA\nBB\nBA\nAA\n\nIn this example the response matrix approximation is exact because the differential constraints\nare linear in the decision variables. Consequently, the response matrix elements can be identified\ndirectly from the analytical solutions above.\n\nMore generally, we derive the sensitivity derivatives numerically, from multiple model\nevaluations. For example:\n\nε\nε\n)\n0,0,\n(\n)\n0,\n,\n(\nB\nB\nBA\nx\nT\nx\nT\nR\n-\n≈\n\nThis approach does not require knowledge of the model equations (i.e. the model can be a \"black\nbox\").\n\nThe response matrix approach can also be used to approximate nonlinear differential\nconstraints, so long as the Taylor series expansion is sufficiently accurate."
    }
  ]
}