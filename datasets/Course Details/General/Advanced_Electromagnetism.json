{
  "course_name": "Advanced Electromagnetism",
  "course_description": "In 6.635, topics covered include: special relativity, electrodynamics of moving media, waves in dispersive media, microstrip integrated circuits, quantum optics, remote sensing, radiative transfer theory, scattering by rough surfaces, effective permittivities, random media, Green’s functions for planarly layered media, integral equations in electromagnetics, method of moments, time domain method of moments, EM waves in periodic structures: photonic crystals and negative refraction.",
  "topics": [
    "Science",
    "Physics",
    "Atomic, Molecular, Optical Physics",
    "Electromagnetism",
    "Quantum Mechanics",
    "Science",
    "Physics",
    "Atomic, Molecular, Optical Physics",
    "Electromagnetism",
    "Quantum Mechanics"
  ],
  "syllabus_content": "Course Meeting Times\n\nLectures: 2 sessions / week, 1.5 hours / session\n\n6.635 Advanced Electromagnetism\n\nMaterials covered include: special relativity, electrodynamics of moving media, waves in dispersive media, microstrip integrated circuits, quantum optics, remote sensing, radiative transfer theory, scattering by rough surfaces, effective permittivities, random media, Green's functions for planarly layered media, integral equations in electromagnetics, method of moments, time domain method of moments, EM waves in periodic structures: photonic crystals and negative refraction.\n\nText\n\nKong, J. A.\nElectromagnetic Wave Theory\n. Cambridge, MA: EMW Publishing, 2000. ISBN: 0966814398.",
  "files": [
    {
      "category": "Resource",
      "title": "Mar03.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-635-advanced-electromagnetism-spring-2003/be2e3d960ea741a50e6247c590739de2_Mar03.pdf",
      "content": "Green's functions for planarly layered media (continued)\nMassachusetts Institute of Technology\n6.635 lecture notes\nWe shall here continue the treatment of multilayered media Green's functions, starting from\nthe TE/TM decomposition we have presented in the previous document.\nFor the sake of illustration, let us consider a one layer medium with a reflection and trans-\nmission region, as shown in Fig. 1.\nPSfrag replacements\n#0: (ε0, μ0)\n#1: (ε1, μ1)\n#2: (ε0, μ0)\nJ( r′)\nx\nz\nz′\n-d\nFigure 1: Geometry of the problem.\n.\nWe have shown before that the Green's functions in various layers are expressed as:\nGl0 =\ni\n8π2\nZZ\nd k⊥\nk0z\n·\nKe(klz)ˆe(-k0z) e-i\nK· r′ + Kh(klz)ˆh(-k0z) e-i\nK· r′\n,\n(1)\nwhere\nl= 0 , z < z′ :\nKe(k0z) = ˆe(-k0z) ei\nK· r + RTEˆe(k0z) ei k· r ,\n(2a)\nKh(k0z) = ˆh(-k0z) ei\nK· r + RTMˆh(k0z) ei k· r ,\n(2b)\nl= 1 :\nKe(k1z) = A ˆe(k1z) ei k1· r + B ˆe(-k1z) ei\nK1· r ,\n(2c)\nKh(k1z) = C ˆh(k1z) ei k1· r + D ˆh(-k1z) ei\nK1· r ,\n(2d)\nl= 2 :\nKe(k2z) = T TE ˆe(-k0z) ei\nK· r ,\n(2e)\nKh(k2z) = T TM ˆh(-k0z) ei\nK· r .\n(2f)\n\nSection 1. Transmission line analogy for multilayered media\nBy satisfying the boundary conditions at z = 0 and z = -d, we obtain the following system\n(for TE waves, TM waves can be solved similarly):\n1 + RTE =A + B\n(3a)\nk0z\nμ0\n(-1 + RTE) = k1z\nμ1\n(A -B) ,\n(3b)\nA e-ik1z d + Beik1z d = T TE eik0z d ,\n(3c)\nk1z\nμ1\n(Ae-ik1z d -Beik1z d) = -k0z\nμ0\nT TEeik0z d .\n(3d)\nUpon solving, we obtain:\nRTE =\n1 -e2ik1z d\n1 + RTE\n01 RTE\n10 e2ik1z d RTE\n01 ,\n(4a)\nT TE =\n4ei(k1z -k0z )d\n(1 + pTE\n01 ) (1 + pTE\n10 ) (1 + RTE\n01 RTE\n10 e2ik1z d) .\n(4b)\nRTM =\n1 -e2ik1z d\n1 + RTM\nRTM\ne2ik1z d RTM\n,\n(5a)\nT TM =\n4ei(k1z -k0z )d\n(1 + pTM\n01 ) (1 + pTM\n10 ) (1 + RTM\nRTM\ne2ik1z d) .\n(5b)\nA =1 -pTE\n1 + RTE\n01 RTE\n1 + RTE\n01 RTE\n10 e2ik1z d e2ik1z d ,\n(6a)\nB =\n1 + RTE\n1 + RTE\n01 RTE\n10 e2ik1z d ,\n(6b)\nC =μ1k0\nμ0k1\n2RTM\n(1 + pTM\n01 ) (1 + RTM\nRTM\ne2ik1z d) e2ik1z d ,\n(6c)\nD =μ1k0\nμ0k1\n(1 + pTM\n01 ) (1 + RTM\nRTM\ne2ik1z d) .\n(6d)\nTransmission line analogy for multilayered media\nLet us consider a plane wave incident from region 0, with its plane of incidence parallel to the\n(xz) plane. The medium it is incident upon is multilayered.\nAll fields vectors are independent on y, so that\n∂\n∂y = 0 in Maxwell's equations. Thus, we\ncan decompose the electromagnetic field into TE/TM components.\nWe get, in region l(for TE waves):\n\nEly =[Aleikzz + Ble-ikzz] eikxx ,\n(7a)\nHlx = -kzl\nωμl\n[Aleikzz -Ble-ikzz] eikxx ,\n(7b)\nHlz = kx\nωμl\n[Aleikzz -Ble-ikzz] eikxx .\n(7c)\nFollowing standard notation in transmission line the-\nory, we shall use here the j notation!!\nFrom 6.630, we know that a transmission line is characterized by its length d, characteristic\nimpedance Z(p)\nc\nand wavenumber kz, as defined in Fig. 2.\nd\n[Z(p)\nc , kz]\nV (p)\nV (p)\nI(p)\nI(p)\nFigure 2: Transmission line circuit.\nIn a source-free region, the transmission line equations are written as\n∂\n∂z V (p) = -jkzZ(p)\nc I(p) ,\n(8a)\n∂\n∂z I(p) = -jkz\nZ(p)\nc\nV (p) ,\n(8b)\nwhere p refers to the polarization (TE or TM), and\nZTE\nc\n= ωμ\nkz\n,\n(9a)\nZTM\nc\n= kz\nωε .\n(9b)\nThe solution to Eqs. (8) is:\nV (p) =A(p)e-ikzz + B(p)eikzz ,\n(10a)\nI(p) = 1\nZ(p)\nc\n[A(p)e-ikzz -B(p)eikzz] ,\n(10b)\nAs it can be seen, there is a direct analogy between the voltage/current in a transmission\nline and the components of the electric and magnetic fields. For example, referring back to\nEq. (7), we write:\n\nSection 1. Transmission line analogy for multilayered media\nEly =V TE\nl\n(z)eikxx ,\n(11a)\nHlx = -ITE\nl\n(z)eikxx .\n(11b)\nTherefore, the problem of computing the fields in multilayered media in the spectral domain\ncomes down to determining the voltage/current in equivalent transmission line network. The\nanalogy is illustrated in Fig. 3.\n\nFigure 3: Transmission line analogy for horizontal electric source and vertical mag-\nnetic source. Other cases are obtained by duality.\nThe treatment of the source will not be demonstrated here and we shall just state the\nfinal results (details can be found in the literature). Thus, depending on the source type and\norientation, different generators will have to be placed in the transmission line network. The\nvarious cases are (magnetic sources can be obtained by duality):\nHorizontal electric source\ncurrent generator\nvalue: 1/2π\nVertical electric source\nvoltage generator\nvalue: 1/2π\nThe algorithm is therefore as follows:\n1. Write the field components in terms of voltage and current. Locate the source and obser-\nvation point.\n2. Compute the equivalent transmission line network. Locate the source (type and position)\nand observation.\n3. Starting from the source replace all the layers above and below the source by equivalent\nimpedances (see Fig. 4).\nTo do this, start with the extreme boundary conditions and propagate back to the source\nusing:\n\nZup\nZdown\nFigure 4: Equivalent upper and lower impedance.\nZin(p) = Z(p)\nc\nZ(p)\nL\n+ jZ(p)\nc\ntan(kzd)\nZ(p)\nc\n+ jZ(p)\nL tan(kzd)\n.\n(12)\n4. Using standard circuit theory, compute V (p) and I(p) at the upper and lower limits.\n5. Propagate V (p) and I(p) until the observation point using\nA\nV2\n-I2\n!\n=\nA\ncos(kzd)\n-jZ(p)\nc\nsin(kzd)\n-j/Z(p)\nc\nsin(kzd)\ncos(kzd)\n! A\nV1\nI1\n!\n.\n(13)\n6. Get the fields in the spectral domain.\nComing back to the space domain: Sommerfeld integral\nIn the rest of these notes we come back to the i notation!!\nTo come back to the space domain, we need to evaluate the inverse Fourier transform. A\ntypical integral we have to perform is:\nf( r) =\n(2π)2\nZZ\ndkxdky f(kx, ky) eikxx eikyy .\n(14)\nBy symmetry of the problem (x and y axis are equivalent), we can make a change of variables\nand integrate one integral analytically. The proper change of variables is the following:\nkx =kρ cos kφ ,\nx =ρ cos φ ,\n(15)\nky =kρ sin kφ ,\ny =ρ sin φ .\n(16)\nWe can transform the exponential part as:\neikxx eikyy = ei[kρρ cos kφ cos φ+kρρ sin kφ sin φ] = eikρρ cos(kφ-φ) ,\n(17)\nso that\nf( r) =\n(2π)2\nZ 2π\ndkφ\nZ inf\ndkρ kρ f(kρ, kφ) eikρρ cos(kφ-φ) .\n(18)\n\nSection 2. Coming back to the space domain: Sommerfeld integral\nBy rotational symmetry, f(kρ, kφ) = f(kρ). In addition, we can expand the exponential part\nusing the following identity:\neikρρ cos(kφ-φ) = eiβ cos θ =\ninf\nX\nm=-inf\n(-i)m Jm(β) eimθ ,\n(19)\n(where β and θ have just been defined to simplify the notation in the identity and have no\nconnection to physical parameters).\nAs we can see, the exponential function is the only term depending on kφ. Performing the\nintegration, we get:\nZ 2π-φ\n-φ\neimθ =\n\nif m = 0 ,\n2π\nif m = 0 .\n(20)\nTherefore, we end up with\nf( r) = 1\n2π\nZ inf\ndkρ kρ f(kρ) J0(kρρ) ,\n(21)\nwhich is known as a Sommerfeld integral.\nNote however that in Eq. (7b), the kernel is function of kx also, which adds a kρ cos kφ term\nin the integral, so that the integral in kφ cannot be performed exactly as shown above. However,\nthe generalization to this case is straightforward. Upon performing the same expansion of the\nBessel function, we see that this time the non-vanishing contribution will come from the m = 1\nterm (or ±1 depending on how the integral is written).\nWithout further details, we generalize the definition of Sommerfeld integral to the nth order\nas:\nSn[ f] =\nZ inf\ndkρJn(kρρ)kn+1\nρ\nf(kρ) ,\n(22)\nand the transformation from spectral to spatial can be summarized as follows (where A is a\nfunction of kρ only):\nspectral domain\nspace domain\nG = A\nG = S0[ A]\nG = -ikx A\nG = -cos φ S1[ A]\nG = -iky A\nG = -sin φ S1[ A]\nG = -k2\nx A\nG = cos 2φ\nρ\nS1[ A] -cos2 φ S0[k2\nρ A]\nG = -k2\ny A\nG = -cos 2φ\nρ\nS1[ A] -sin2 φ S0[k2\nρ A]\nG = -kxky A\nG = sin 2φ\nρ\nS1[ A] -1\n2 sin 2φ S0[k2\nρ A]\n\nNumerical evaluation of Sommerfeld integrals\nSommerfeld integrals are difficult (but not impossible) to evaluate for two reasons:\n1. The spectral kernel can present poles (and in general does).\n2. They have an oscillatory tail.\nFortunately these two problems appear in essentially two distinct regions.\n3.1\nPoles of the Green's function\nIt can be shown (out of the scope here) that the poles of the Green's functions are associated\nwith propagating waves (e.g. in single-mode regime, the Green's function has only one pole).\nTherefore, we must have at least one value of l(the index of the region) where klz is real, i.e.\nklz =\nq\nk2\nl -k2ρ =\nq\nk2\n0εlμl-k2ρ\n(23)\nmust be real. Since this needs to happen in at least one layer, it yields the condition:\nkρ < k0 max\nl\n(√εlμl) ,\n(24)\nwhich puts an upper limit for the location of the poles. Although it can also be shown that poles\nhave to correspond to kρ > k0, we do not need this constraint here and we can limit ourselves\nto the interval [0, k0 maxl(√εlμl)].\nIn the lossless situation, the poles lie on the real axis, which renders the integral impossible\nto evaluate as is. We therefore need to deform the contour in the complex kρ-plane:\n- At infinity, convergence is ensured by Sommerfeld's radiation condition.\n- On [0, k0 maxl(√εlμl)], we perform the integration over an ellipse, as shown in Fig. 5.\na\nb\nR(kρ)\nI(kρ)\nFigure 5: Contour deformation in the complex kρ-plane.\n\n3.2\nOscillatory tail\n3.2\nOscillatory tail\nThe problem in this case is not the divergence of the integral (it does not diverge) bu the\nconvergence, which is very slow because of the oscillatory behavior of the kernel. Yet, we can\napply acceleration techniques to sum the series (these acceleration techniques belong to the\nfamily of extrapolation techniques).\nFor the sake of illustration, we can mention Euler's transformation, which is one of the best\nknown acceleration technique:\nS′\nn = Sn + Sn+1\n,\n(25)\nwhere Sn = Pinf\ni=0 ui is the partial sum (ui being the terms of the original series).\nBy applying the formula repeatedly, we get:\nSk+1\nn\n= S(k)\nn\n+ S(k)\nn+1\n.\n(26)\nA direct improvement of Euler technique is to weight the partial sums and write:\nS′\nn = wnSn + wn+1Sn+1\nwn + wn+1\n.\n(27)\nIn our specific situation, we need to evaluate integrals of the form:\nS =\nZ inf\nα\nf(x)dx ,\n(28)\nwhere α is related to k0 maxl(√εlμl). In order to transform this integral in a series, we apply\nthe approach of \"integration then summation\". Thus, we define:\nui =\nZ xi\nxi-1\nf(x)dx ,\n(29a)\nS =\ninf\nX\ni=0\nui ,\n(29b)\nSn =\nn\nX\ni=0\nui .\n(29c)\nThe break points xi have to be well chosen, and may for example be chosen based on the\nasymptotic behavior of f. If we refer back to Sommerfeld integrals, we can take the asymptotic\nexpansion of the Bessel function:\nJν(kρρ) ≃\ns\nπkρρ cos(kρρ -ν π\n2 -π\n4 ) .\n(30)\nHence, the easiest/simplest choice of break points will be\nxn = kρn = x0 + nπ\nρ ,\n(31)\n\nwhere x0 is the first break point greater than α. We will then approximate S by Sn as\nSn =\nZ xn\nα\nf(x)dx .\n(32)\nThe problem of Sommerfeld's integrals is that the remainder\nrn = S -Sn = -\nZ inf\nxn\nf(x)dx\n(33)\ndecays slowly, so that we want to accelerate the series from which Sn is evaluated (see Eq. (29c)).\nFor Sommerfeld-type integrals, we write the generic form as:\nI =\nZ inf\nα\ng(kρρ) f(kρ) dkρ ,\n(34)\nand the partial integral as\nI(n) =\nZ xn\nα\ng(kρρ) f(kρ) dkρ .\n(35)\nThe remainder is therefore\nI -I(n) =\nZ inf\nxn\ng(kρρ) f(kρ) dkρ .\n(36)\nThis integral can be expanded into an infinite series of inverse powers of ρ by integration by\npart. For example, with g(kρρ) = eikρρ (which is a generic form for Sommerfeld integrals), we\ncan write:\nI -I0(n) = i\nρ eianρ\n·\nfn + i\nρf′\nn + ( i\nρ)2f\n′′\nn + . . .\n\n,\n(37)\nwhere fn = f(xn), f′\nn = f′(xn), etc. Note that if the right-hand side term converges (and it\ndoes in our case), the dominant term is O(ρ-1). Yet, if we now construct\nI1(n) = fn+1I0(n) + fnI0(n + 1)\nfn + fn+1\n,\n(38)\nit appears to be a better estimate of I since the error is in O(ρ-2).\nIf, in addition,\nf(kρ) ∼Ckα\nρ e-βkρ ,\n(39)\nwe can approximate fn and fn+1 and write\nI1(n) = I0(n) + η0I0(n + 1)\n1 + η0\n,\n(40)\nwhere η0 = [n/(n + 1)]α eβπ/ρ. At higher orders, a better approximation is given by:\nI2(n) = I1(n) + η1I1(n + 1)\n1 + η1\n,\n(41)\nwhere η1 = [(n -1/2)/(n + 1/2)]α-2 eβπ/ρ.\nIn practical applications, the parameters α and β may have to be adjusted for an optimum\nconvergence.\nThe technique presented briefly here is known as the \"weighted average\" method, and more\ndetails can be found in the literature under this keyword."
    },
    {
      "category": "Resource",
      "title": "Mar05.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-635-advanced-electromagnetism-spring-2003/8de172f734f19d89337fc1331ebff26f_Mar05.pdf",
      "content": "Integral Equations in Electromagnetics\nMassachusetts Institute of Technology\n6.635 lecture notes\nMost integral equations do not have a closed form solution. However, they can often be\ndiscretized and solved on a digital computer.\nProof of the existence of the solution to an integral equation by discretization was first\npresented by Fredholm in 1903.\nIn general, integral equations can be divided into two families:\n1. When the unknown is in the integral only, the integral equation is called of the first kind.\n2. When the unknown is both inside and outside the integral, the integral equation is called\nof the second kind.\nFor electromagnetic applications, we can have both scalar and vector integral equations.\nScalar integral equations\nLet us consider the situation of Fig. 1: two regions are defined in space, region 2 bounded by\nthe closed surface S and region 1 being all the remaining space, bounded by S and Sinf, in which\nsources are located.\n#1\n#2\nˆn\nJ\nS\nSinf\nFigure 1: Definition of the geometry of the problem.\nIt is already known that we can write:\n(∇2 + k2\n1) Φ1( r) = J( r) ,\n(1a)\n(∇2 + k2\n2) Φ2( r) = 0 ,\n(1b)\n\nSection 1. Scalar integral equations\nand similarly for the Green's functions\n(∇2 + k2\n1) g1( r, r′) = -δ( r - r′)\nin region 1,\n(2a)\n(∇2 + k2\n2) g2( r, r′) = -δ( r - r′)\nin region 2.\n(2b)\nUpon performing (Eq. (1a)g1( r, r′)-Eq. (2b)Φ1( r, r′)), we get:\n[g1( r, r′) ∇2Φ1( r) -Φ1( r) ∇2g1( r, r′)] = J( r)g1( r, r′) + δ( r - r′)Φ1( r) .\n(3)\nUpon integrating Eq. (3) over the entire volume and using the identity ∇· (g∇Φ -Φ∇g) =\ng∇2Φ -Φ∇2g, we get:\nZ\nV\ndv ∇· [g1( r, r′)Φ1( r) -Φ1( r)∇g1( r, r′)] =\nZ\nV\ndvJ( r) g( r, r′) + Φ1( r′) .\n(4)\nBy Gauss theorem, we reduce the left-hand side integral to a surface integral. Also\nZ\nV\ndvJ( r)g1( r, r′) = -Φinc( r′) .\n(5)\nWe therefore obtain\n-\nZ\nS+Sinf\nds ˆn · [g1( r, r′)∇Φ1( r) -Φ1( r)∇g1( r, r′)] = -Φinc( r) + Φ1( r′) ,\nr′ ∈V .\n(6)\nBy invoking the radiation condition, the integral over Sinfvanishes, leaving (and exchanging\nr and r′ so that primed coordinates correspond to sources and unprimed ones to observation):\nΦ1( r) = Φinc( r) -\nZ\nS\nds′ ˆn · [g1( r, r′)∇′Φ1( r′) -Φ1( r′)∇′g1( r, r′)]\nr ∈V1 .\n(7)\nFor r ∈V2, the wave equation has no source and therefore the integration of the delta\nfunction yields a zero value. Performing the same steps for this second case, we get the generic\nrelation:\nΦinc( r) -\nZ\nS\nds′ ˆn · [g1( r, r′)∇′Φ1( r′) -Φ1( r′)∇′g1( r, r′)] =\n\nΦ1( r)\nr ∈V1\nr ∈V2\n(8)\nThis is directly evocative of Huygens' principle:\n- For r ∈V1: the total field Φ1( r) is the sum of the incident field plus the field due to the\nsurface currents on the surface S.\n- For r ∈V2: the surface source on S produces a field that exactly opposes Φinc, yielding\nthe extinction theorem.\nApplying the same reasoning to region 2, we write (where there is no incident field):\nZ\nS\nds′ ˆn · [g2( r, r′)∇′Φ2( r′) -Φ2( r′)∇′g2( r, r′)] =\n\nr ∈V1\nΦ2( r)\nr ∈V2\n(9)\n\nNote that the sign reversal is due to the definition of the normal vector ˆn which has to point\noutward from the surface. Here, since we use the same ˆn as before, we have to take it as being\nnegative.\nEqs. (8) and (9) have four independent unknowns:\nΦ1, Φ2 ; ˆn · ∇Φ1, ˆn · ∇Φ2 ,\n(10)\nwhich can be related by the boundary conditions. Here, g( r, r′) and ˆn · ∇g( r, r′) are the kernel\nof the integral equation.\nVector integral equation\nFor the sake of completeness, we shall write the vector wave equation as well, although we will\nnot use it here directly.\nConsidering the same situation as above, we know that the fields have to satisfy:\n∇× ∇× E1( r) -ω2ε1μ1 E1( r) =iωμ1 J( r) ,\n(11a)\n∇× ∇× E2( r) -ω2ε2μ2 E2( r) =0 ,\n(11b)\nand the Green's functions:\n∇× ∇× G1( r, r′) -ω2ε1μ1G1( r, r′) = Iδ( r - r′) ,\n(12a)\n∇× ∇× G2( r, r′) -ω2ε2μ2G2( r, r′) = Iδ( r - r′) .\n(12b)\nBy the same technique as before (\nR\nV dv [Eq. (11a) · G1( r, r′) -Eq. (12a) · E1( r)]dv)\nZ\nV\ndv\n·\n∇×∇× E1( r)·G1( r, r′)- E1( r)·∇×∇×G1( r, r′)\n\n= iωμ1\nZ\nV\ndv J( r)·G1( r, r′)- E1( r) .\n(13)\nThe left-hand side can be transformed into a surface integral (left as exercise) and the right-hand\nside written in terms of incident field, yielding:\nE1( r′) = Einc( r′)+\nZ\nS+Sinf\nds ˆn·\n1⁄2\n[∇× E1( r)]×G1( r, r′)+ E1( r)×∇×G1( r, r′)\n3⁄4\n,\nr′ ∈V1 . (14)\nBy reciprocity of the Green's functions, we can transform\nˆn · [∇× E1( r)] × G1( r, r′) = ˆn × [∇× E1( r)] · G1( r, r′)\n= iωμ1G1( r, r′) · ˆn × H1( r) .\n(15)\nIn addition, for an unbounded homogeneous medium (∇× G( r, r′) is reciprocal):\nˆn · E1( r) × ∇× G1( r, r′) = ˆn × E1( r) · ∇× G1( r, r′)\n= -[∇× G1( r, r′)] · ˆn × E1( r) .\n(16)\n\nSection 3. Problem with the internal resonance\nFor Green's functions that satisfy the radiation condition, Eq. (14) becomes:\nE1( r′) = Einc( r′) +\nZ\nS\nds ˆn ·\n1⁄2\niωμ1G1( r, r′) · ˆn × H1( r) -[∇× G1( r, r′)] · ˆn × E1( r)\n3⁄4\n.\n(17)\nWe perform the same steps for the other region to eventually obtain (and again interchanging r\nand r′):\nEinc( r) +\nZ\nS\nds′\n1⁄2\niωμ1G1( r, r′) · ˆn × H1( r′) -[∇′ × G1( r, r′)] · ˆn × E1( r′)\n3⁄4\n=\n\nE1( r)\nr ∈V1\nr ∈V2\n(18a)\n-\nZ\nS\nds′\n1⁄2\niωμ2G2( r, r′) · ˆn × H2( r′) -[∇′ × G2( r, r′)] · ˆn × E2( r′)\n3⁄4\n=\n\nr ∈V1\nE2( r)\nr ∈V2\n(18b)\nTogether with the boundary conditions\nˆn × H1( r) = ˆn × H2( r) ,\n(19a)\nˆn × E1( r) = ˆn × E2( r) ,\n(19b)\nthis system can be solved for ˆn × E1( r) and ˆn × H1( r).\nNote also that Eqs. (18) can be written in terms of electric and magnetic currents, and\nmagnetic Green's functions:\nJeq( r′) = ˆn × H1( r′) ;\n-\nMeq( r′) = ˆn × E1( r′) ,\n(20a)\nso that for example:\nEinc( r) +\nZ\nS\nds′\n1⁄2\niωμ1Ge1( r, r′) · J( r′) + Gm1( r, r′) ·\nM( r′)\n3⁄4\n=\n\nE1( r)\nr ∈V1\nr ∈V2\n(21)\nProblem with the internal resonance\nA question arises: is the integral equation equivalent to Maxwell's equations? Or asked differ-\nently, if we solve the integral equation and Maxwell's equations, do we get the same solution?\nThe answer is actually \"no\", that is they are not always equivalent to each-other.\nThe\nproblem comes from spurious solutions at frequencies corresponding to the eigenfrequencies of\nthe cavity enclosed by the surface S. This problem is generally referred to as the \"internal\nresonance of the integral equation\".\nHowever, this lack of complete equivalence between the physical problem and its defining\nintegral equation is rather minor and infrequent phenomenon, and is therefore often tolerated\nin practice.\n\nScattering by a rough surface\nLet us consider the 2D problem (for which we shall use a scalar integral equation) depicted in\nFig. 2.\nz\nx\nf(x)\nε0\nε1\nFigure 2: Rough surface S separating two media.\nThe integral equation in scalar form is given by:\nΦinc( r) +\nZ\nS\nds′ˆn · [Φ( r′)∇g( r, r′) -g( r, r′)∇Φ( r′)] =\n\nΦ( r)\nr ∈V0\nr ∈V1\n(22)\n4.1\nDirichlet boundary conditions: EFIE\nFor a TE wave ( E = Eˆy) and PEC surface, the boundary condition is\nΦ( r) = 0 ,\nfor r ∈S .\n(23)\nThe integral equation becomes, for r ∈S , r′ ∈S:\nΦinc( r) -\nZ\nS\nds′ g( r, r′) ˆn · ∇Φ( r′) =\n\nΦ( r)\n(24)\nThis equation, in which Φ represent the electric field, is referred to as the electric field integral\nequation (EFIE).\nNote that as r gets closer to the surface, Φ( r) →0 (from the boundary condition) so that\nwe do not need to distinguish between approaching the surface from one side or the other. In\nfact, we can unify the equations and write:\nΦinc( r) -\nZ\nS\nds′ g( r, r′) ˆn · ∇Φ( r′) = 0 ,\nr ∈S , r′ ∈S .\n(25)\nIn addition, g( r, r′) has an integrable singularity as r → r′. Let us consider the surface\ndepicted in Fig. 2, with z = f(x):\nds =\np\ndx2 + dz2 = dx\ns\n1 +\nμdf\ndx\n¶2\n,\n(26)\nsuch that the integral equation becomes:\nΦinc( r) =\nZ\n∆x\ndx′\ns\n1 +\nμdf\ndx\n¶2\ng(x, f(x), x′, f(x′)) (ˆn · ∇Φ( r′)) ,\nat z′ = f(x′) ,\n(27)\n\n4.2\nNeumann boundary conditions: MFIE\nwhere we can limit ∆x to [-L/2, L/2].\nBy letting\ns\n1 +\nμdf\ndx\n¶2\n(ˆn · ∇Φ( r′))|z′=f(x′) = U(x′) ,\n(28a)\nΦinc(x, f(x)) = b(x) ,\n(28b)\nK(x, x′) = g(x, f(x), x′, f(x′)) ,\n(28c)\nwe can rewrite the integral equation as\nZ L/2\n-L/2\ndx′ K(x, x′) U(x′) = b(x) ,\n(29)\nwhich has to be solved numerically.\nBefore doing this, we shall write the integral equation with Neumann boundary conditions.\n4.2\nNeumann boundary conditions: MFIE\nThis corresponds to a TM case with H = H ˆy with a PEC surface. In this case, the boundary\ncondition is\nˆn · ∇Φ( r) = 0 ,\n(30)\nand the integral equation becomes\nΦinc( r) +\nZ\nS\nds′ Φ( r) ˆn · ∇g( r, r′) =\n\nΦ( r)\nr ∈V0\nr ∈V1\n(31)\nIn this case, it makes a difference if we approach the surface from the top or from the bottom.\nIn fact\nΦinc( r+) +\nZ\nS\nds′Φ( r′) ˆn · ∇g( r+, r′) = Φ( r+) ,\n(32a)\nΦinc( r-) +\nZ\nS\nds′Φ( r′) ˆn · ∇g( r-, r′) = 0 .\n(32b)\nThese two equations seems inconsistent with one another. We shall show that in fact, they\nare actually consistent with each-other, due to the singularity of the Green's functions.\nWe shall examine what happens when we let r approach the surface. Fig. 3 is an illustration\nof the situation at the immediate vicinity of the surface. The integral part of the equation can\nbe written as:\nZ\nS\nds′Φ( r′) ˆn · ∇g( r, r′) = PV\nZ\nS\nds′Φ( r′) ˆn · ∇g( r, r′) +\nZ\npiece\nds′Φ( r′) ˆn · ∇g( r, r′) ,\n(33)\nwhere PV denotes the principal value and 'piece' refers to the integration over the local domain\nshown in Fig. 3. For this integral, we use the local coordinates:\nds′ = dX′ ,\nˆn = ˆZ′ , etc\n(34)\n\n-a\na\nr\nr = (0, Z)\nX′\nZ′\nFigure 3: Zoom on the rough surface.\nThe integral becomes:\nZ\npiece\nds′Φ( r′) ˆn · ∇g( r, r′) = lim\na→0\nlim\n|Z|→0 Φ( r)\nZ a\n-a\ndX′ ∂\n∂Z′ g( r, r′) .\n(35)\nOver the small piece, we have:\n| r - r′| =\np\nX′2 + (Z -Z′)2 ,\n(36a)\ng = i\n4 H(1)\n0 (| r - r′|) →-1\n2π ln(| r - r′|\n) ,\n(36b)\nμ ∂g\n∂Z′\n¶\nZ′=0\n=\nZ\n2π(X′2 + Z2) .\n(36c)\nThus, the integral becomes\nZ\npiece\n= lim\na→0\nlim\n|Z|→0 Φ( r)\nZ a\n-a\ndX′ 1\n2π\nZ\nX′2 + Z2\n= lim\na→0\nlim\n|Z|→0\nΦ( r)\n2π\n·\ntan-1 X′\nZ\na\n-a\n=\n\n2 Φ( r)\nfor Z > 0\n-1\n2 Φ( r)\nfor Z < 0\n(37)\nThe two parts of the integral then become:\nΦinc( r) + PV\nZ\nS\nds′Φ( r′) ˆn · ∇g( r, r′) + 1\n2Φ( r) = Φ( r) ,\n(38a)\nΦinc( r) + PV\nZ\nS\nds′Φ( r′) ˆn · ∇g( r, r′) -1\n2Φ( r) = 0 ,\n(38b)\n(38c)\nwhich is cast into one equation:\nΦinc( r) + PV\nZ\nS\nds′Φ( r′) ˆn · ∇g( r, r′) = 1\n2Φ( r) .\n(39)\nEq. (39) is called the magnetic field integral equation (since Φ represents the magnetic field)\nand is an integral equation of the second kind.\n\nSection 5. Solving the EFIE\nIn the same way as before, we can define the kernel as\nK(x, x′) =\ns\n1 +\nμdf\ndx\n¶2\nˆn · ∇g( r, r′)|z=f(x),z′=f(x′) ,\n(40)\nand write the MFIE as\nΦinc( r) + PV\nZ inf\n-inf\ndx′ Φ(x′) K(x, x′) = 1\n2 Φ(x) .\n(41)\nSolving the EFIE\nUpon using the notation introduced in Section 4.1, the problem is reduced to solving the following\nintegral equation:\nZ L/2\n-L/2\ndx′ K(x, x′) U(x′) = b(x) .\n(42)\nLet us subdivide the integration domain into N small elements, each of length ∆= L/N,\nand centered at xm (m ∈[1, N]). Thus, constraining the observation at these discrete locations,\nthe integral equation becomes\nZ L/2\n-L/2\ndx′ K(xm, x′) U(x′) = b(xm) .\n(43)\nNext, if we suppose that U(x) is constant in each interval, we replace the integral by a sum over\nall segments, excluding the singular term:\n∆x\nX\nn=1\nn=m\nK(xm, xn) U(xn) + U(xm)\nZ\nm\ndx′K(xm, x′) = b(xm) .\n(44)\nNote that we have to single out the singularity, i.e. the mth interval because K(xm, x′) is\nsingular at x′ = xm. This part is known as the self-patch contribution.\nFor a 2D problem, we have:\nK(xm, x′) = i\n4 H(1)\n0 (k\np\n(xm -x′)2 + (f(xm) -f(x′))2) .\n(45)\nUpon approximating f(x′) -f(xm) ≃f′(xm)(x′ -xm), we write:\nK(xm, x′) = i\n4 H(1)\n0 (k|x′ -xm|\np\n1 + f′(xm)2) .\n(46)\nFor small argument: H(1)\n0 (α) ≈1 + i 2\nπ ln(αγ/2) where γ is the Euler constant (γ ≃1.78).\nTherefore:\nK(xm, x′) = i\n·\n1 + i 1\nπ ln\nμγ\n2k(x′ -xm)\np\n1 + f′2(xm)\n¶\n.\n(47)\n\nTherefore, the integral becomes:\nZ\nm\ndx′K(xm, x′) = 2\nZ xm+∆x/2\nxm\ndx′K(xm, x′) = 2\nZ ∆x/2\ndx′K(xm, x′ + xm)\n≃i\nZ ∆x/2\ndx′\n·\n1 + i 1\nπ ln\nμγ\n2kx′p\n1 + f ′2(xm)\n¶\n= i∆x\n1⁄2\n1 + i 2\nπ ln\nμγk\n4e ∆x\np\n1 + f ′2(xm)\n¶3⁄4\n,\n(48)\nwhere ln(e) = 1.\nWe can therefore cast the integral equation into a matrix equation of the form:\nN\nX\nn=1\nAmnUn = bm ,\n(49)\nwhere\nUn = U(xn) is the unknown,\n(50a)\nbm = b(xm) ,\n(50b)\nAmn =\n\n∆x K(xm, xn)\nfor m = n\ni∆x\n1⁄2\n1 + i 2\nπ ln\nμ\nγk\n4e ∆x\np\n1 + f ′2(xm)\n¶3⁄4\nfor m = n\n(50c)\nThe system can now easily be solved numerically."
    },
    {
      "category": "Resource",
      "title": "Mar10.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-635-advanced-electromagnetism-spring-2003/849906869bb53f7f3bec8f91ef3e2bb2_Mar10.pdf",
      "content": "The Method of Moments in Electromagnetics\nMassachusetts Institute of Technology\n6.635 lecture notes\nIntroduction\nIn the previous lecture, we wrote the EFIE for an incident TE plane wave on a PEC surface.\nThe solution was then obtained by some types of \"intuitive\" arguments, such as dividing the\nintegration domain into small elements and supposing that the unknown does not vary too much\nover each elementary cell.\nWe shall now see more rigorously what we actually did, and show that it was in fact a simple\nversion of the Method of Moments.\nR. F. Harrington was the first to use the method of moments (MoM) in electromagnetics\nand his book remains a fundamental reference (and very easy to read!):\nR. F. Harrington, \"Field Computation by Moment Method\" (is now available from IEEE Press).\nPEC surface with TE incident wave: EFIE\nThe situation we studied last time is depicted in Fig. 1.\nThe integral equation (EFIE) we\nz\nx\nf(x)\nε0\nε1\nFigure 1: Rough surface S separating two media.\neventually obtained was:\nΦinc( r) =\nZ L/2\n-L/2\ndx′\ns\n1 +\nμdf\ndx\n¶2\ng(x, f(x), x′, f(x′)) [ˆn · ∇Φ( r′)]|z′=f(x′) ,\n(1)\nwhich we rewrote as\nb(x) =\nZ L/2\n-L/2\ndx′K(x, x′) U(x′) ,\n(2)\n\nSection 2. PEC surface with TE incident wave: EFIE\nwhere\ns\n1 +\nμdf\ndx\n¶2\n[ˆn · ∇Φ( r′)]|z′=f(x′) = U(x′) ,\n(3a)\nΦinc(x, f(x)) = b(x) ,\n(3b)\nK(x, x′) = g(x, f(x), x′, f(x′)) ,\n(3c)\nwhere U(x′) is the unknown we are solving for.\nThe important step we did from this integral, although it probably appeared straightforward,\nwas to say that x can only take discrete values on the surface, thus defining N intervals of length\n∆x:\nx ∈{xi} ,\ni = 1, . . . , N,\n(4)\nThe assumptions were therefore:\n1. x ∈{xi} ,\ni = 1, . . . , N.\n2. U(x′) is constant on each interval.\nwhich eventually yielded the following system of equations (supposing that the problem related\nto the singularity of the Green's function has been accounted for):\nN\nX\nn=1\nAmn Un = bm .\n(5)\nThis is a matrix equation with the two indices m and n corresponding to:\nm: observation point →unprimed coordinates.\nn: source point →primed coordinates.\nPhysical interpretation:\n- element (m, n) represents the effect of cell n on cell m.\n- element (m, m) represents the self-term.\nMathematically:\nThe steps we had to perform to from Eq. (2) to Eq. (5) are\n1. Write the unknown as\nU(x′) =\nX\nn\nUnδ(xn)∆x ,\n(6)\nstating that now the unknowns become {Un} which are the amplitudes of the function.\nThe integral equation becomes:\nZ L/2\n-L/2\ndx′K(x, x′)U(x′) = ∆x\nX\nn\nUnK(x, xn) = b(x) .\n(7)\n\n2. Dot-multiply both sides by δ(xm):\n∆x\nX\nn\nUn K(xm, xn) = b(xm).\n(8)\nThese two steps are at the basis of the method of moments:\n1. First step can actually be decomposed into two steps:\n(a) Mesh the structure (i.e. choose the intervals over which Un will be defined).\n(b) Expand the unknown U(x) into basis functions.\n2. The second steps concerns the observation: dot-multiply both sides of the equation by a\ntest function (or weighting function).\nIn the previous example:\n- basis functions: pulse basis function.\n- testing functions: we point-patch the integral equation at x = xm (the method is therefore\ncalled point matching).\nThis is a very simple, yet very widely used version of the method of moments.\nGeneral considerations on MoM\nLet us consider the inhomogeneous equation:\nL(f) = g ,\n(9)\nwhere L is a linear operator, g is known, and f is to be determined. We shall now perform the\ntwo essential steps we have highlighted above.\n1. Let f be expanded in a series of functions:\nf =\nX\nn\nαn fn ,\n(10)\nwhere αn are constant. The set fn is called expansion function, or basis functions.\nNote that for an exact solution, the summation should be taken to inf, but has to be\ntruncated in practice.\n2. It is assumed that a suitable inner product has been defined for the problem. Now, we\ndefine a set of weighting functions, or testing functions, w1 , w2 , . . . , wN in the range of\nL, and take the inner product of the previous equation with wm:\nX\nn\nαn < wm, Lfn >=< wm, g > .\n(11)\n\nSection 4. A simple example for electrostatic\nThe system can now be written in matrix form as:\n[Amn] [αn] = [gm] ,\n(12)\nwhere\n[Amn] =\n\n< w1, Lf1 >\n< w1, Lf2 >\n. . .\n< w2, Lf1 >\n< w2, Lf2 >\n. . .\n...\n...\n...\n\n,\n[αn] =\n\nα1\nα2\n...\n\n,\n[gm] =\n\n< w1, g >\n< w2, g >\n...\n\n.\n(13)\nIf the matrix [Amn] is not singular, the unknowns αn are simply given by:\n[αn] = [Amn]-1 [gm] ,\n(14)\nand the original function f can be reconstructed using Eq. (10). We can now generalize the\nfollowing definitions:\n- The basis functions used previously are defined as:\nPulse basis functions: fn =\n\nif x belongs to the interval n\notherwise\n(15)\n- The testing (or weighting functions):\nPoint matching = taking Dirac δ functions as testing functions.\nA simple example for electrostatic\nThe example is taken from the reference mentioned at the beginning of this document.\nLet us consider a square plate of side 2a lying on the z = 0 plane with its center at the\norigin (see Fig. 2. Let σ(x, y) represent the surface density on the plate, assumed to have zero\nthickness. The electrostatic potential Φ at any point in space is given by\n2a\n2a\n2b\n2b\nx\ny\nz\nFigure 2: Discretized square plate.\n\nΦ(x, y, z) =\nZ a\n-a\ndx′\nZ a\n-a\ndy′ σ(x′, y′) g( r, r′) ,\n(16a)\ng( r, r′) =\n4πεR ,\n(16b)\nR =\np\n(x -x′)2 + (y -y′)2 + z2 .\n(16c)\nThe boundary condition is Φ = V = constant on the plate.\nThe integral equation for the\nproblem is therefore\nV =\nZ a\n-a\ndx′\nZ a\n-a\ndy′\n4πε\nσ(x′, y′)\np\n(x -x′)2 + (y -y′)2 + z2 ,\n(17)\nwhere the unknown to determine is σ(x′, y′). Let us perform the three steps mentioned before:\n1. Mesh the structure: divide the plate into N squares of size 2b (see Fig. 2).\n2. Basis functions: let us choose\nσ(x′, y′) ≃\nN\nX\nn=1\nαn fn(x′, y′)\nwith fn(x′, y′) =\n\non ∆Sn\non ∆Sm, m = n.\n(18)\n3. Test functions: we choose to satisfy the integral equation at the mid-point (xm, ym) of\neach ∆Sm:\nwm = δ(x -xm)δ(y -ym).\n(19)\nWith these three steps, we construct the matrix as (z = 0):\n[Amn] =\nZ\n∆xn\ndx′\nZ\n∆yn\ndy′\n4πε\np\n(xm -x′)2 + (ym -y′)2 .\n(20)\nIt is obvious to see that this integral is singular at (xm, ym) ∈∆Sm. In this simple case\nfortunately, we can perform the integration analytically (this is not always the case), and write:\nAnn =\nZ b\n-b\ndx′\nZ b\n-b\ndy′\n4πε\np\nx′2 + y′2 = 2b\nπε ln(1 +\n√\n2) ,\n(21a)\nAmn ≃\n∆Sn\n4πεRmn\n=\nb2\nπε\np\n(xm -x′)2 + (ym -y′)2 ,\nm = n .\n(21b)\nTo rewrite this with the language of linear space:\nf(x, y) = σ(x, y) ,\n(22a)\ng(x, y) = V on the plate (the discretization gives: gm =\n\nV\nV\n...\n\n)\n(22b)\nL(f) =\nZ a\n-a\ndx′\nZ a\n-a\ndy′ 1\n4πε\nf(x′, y′)\np\n(x -x′)2 + (y -y′)2 .\n(22c)\nNote: if we add another plate under the existing one, at z = -2d, with a potential -V , we\nbuild a new problem that can be analyzed in two ways:\n\nSection 5. Vectorial MoM\n1. By meshing both plates (i.e. meshing everything, which is of course always possible). This\nwill yield matrix twice as big as the previous one, to solve for twice as many unknowns.\n2. By using the image theory, and saying that the new problem is equivalent to the one of a\nunique plate on top of a ground plane at z = -d. In that case, we only have to change\nthe Green's function to take the ground plane into account, and we keep the same number\nof unknowns as in the initial problem.\nWhen possible, this solution is better because\ncomputationally less expensive (analytically more expensive).\nBasically, a general trend is to have a Green's function that represents as much as possible\nthe environment and to mesh only those parts that are external to the environment. This is in\nfact the reason why people are looking for Green's functions in layered media, periodic media,\netc.\nVectorial MoM\nWe can of course apply the MoM to the vectorial case, like for example the equation:\nE( r) = iωμ\nZ\nS\nds′ Ge( r, r′) · J( r′) .\n(23)\nThe general expansion of the current will be:\nJ( r′) =\nX\nn\nαn fn( r′) ,\n(24)\nyielding\nE( r) = iωμ\nX\nn\nαn\nZ\nSn\nds′ Ge( r, r′) · fn( r′) .\n(25)\nThe third step is to dot-multiply the equation with a testing function hm and integrate over\nthe cell surface (i.e. perform the inner product):\nZ\nSm\nE( r) · hm( r) = iωμ\nX\nn\nαn\nZ\nSn\nds′\nZ\nSm\nds hm( r) · Ge( r, r′) · fn( r′) .\n(26)\nThe double double-integral on the right-hand side of this equation is known as the\n\"impedance term\" since we can cast this system of equation into a matrix representation as:\n[Em] = [Zmn] [αn] .\n(27)\nOther basis and testing functions\nThe advantage of the MoM over purely numerical methods is that there is still a large part that\nremains analytic (like the Green's functions for example). Yet, it remains a numerical method\nbased on a matrix inversion technique and therefore, convergence issues need to be examined.\nThe convergence of the MoM is closely related to the choice of basis functions and, although\nto a lesser extend, to the choice of testing functions. There are essentially two families of basis\nfunctions:\n\n1. Entire domain basis functions: using these functions to expand the unknowns is analogous\nto a Fourier expansion or to a modal expansion. These types of functions yield a good\nconvergence of the method but are not versatile since the geometry need be regular in order\nto have the modes defined. Note that in this case there is no use to mesh the geometry.\n2. Sub-domain basis functions: they rely on a proper meshing of the geometry, which can be\nrectangular, triangular, etc. The choice of basis functions is here very wide, from Dirac δ\n(like for the weighting functions shown in this document), pulses (basis functions shown\nin this document), piecewise linear, etc.\nFinally, we can mention that point matching, which is easy to grasp and straightforward to\nimplement, may not yield an optimal convergence. In most of the applications, the Galerkin\ntechnique is better, which consists in choosing the same testing functions as the basis functions.\nThis applies to both sub-domain and entire domain functions."
    },
    {
      "category": "Resource",
      "title": "Mar12.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-635-advanced-electromagnetism-spring-2003/4db413175ea6de6e18c4e4a6d21c227a_Mar12.pdf",
      "content": "Time Domain Method of Moments\nMassachusetts Institute of Technology\n6.635 lecture notes\nIntroduction\nThe Method of Moments (MoM) introduced in the previous lecture is widely used for solving\nintegral equations in the frequency domain. Yet, some attempts have been made recently at the\nuse of the MoM in the time domain. We shall briefly expose this approach here.\nTime domain equations\nThe first step is of course to write Maxwell's equation and all other relations (constitutive\nrelations and continuity) in time domain:\n∇× E( r, t) = -∂\n∂t\nB( r, t) -\nM( r, t) ,\n∇× H( r, t) = ∂\n∂t\nD( r, t) + J( r, t) ,\n(1a)\n∇· B( r, t) = m( r, t) ,\n∇· D( r, t) = ρ( r, t) ,\n(1b)\nD( r, t) = ε E( r, t) ,\nB( r, t) = μ H( r, t) ,\n(1c)\n∇· J( r, t) + ∂\n∂tρ( r, t) = 0 ,\n∇·\nM( r, t) + ∂\n∂tm( r, t) = 0 .\n(1d)\nFor the time-domain MoM, it is easier to work with the potentials, and make use of the\nwell-known \"retarded potentials\" theory. In view of doing this, we write the definition:\nH( r, t) = 1\nμ0\n∇× A( r, t)\n(2a)\nE( r, t) = -∇φ( r, t) -∂\n∂t\nA( r, t) .\n(2b)\nBoth the vector potential A and the scalar potential φ satisfy the wave equation which, in\ntime-domain domain, writes:\n∇2 A( r, t) -ε0μ0\n∂2\n∂t2 A( r, t) = -μ0 J( r, t) ,\n(3a)\n∇2φ( r, t) -ε0μ0\n∂2\n∂t2 φ( r, t) = -ρ( r, t)\nε0\n.\n(3b)\nThese potentials are linked by the time-domain Lorentz gauge:\n∇· A( r, t) + ε0μ0\n∂\n∂tφ( r, t) = 0 .\n(4)\n\nSection 2. Time domain equations\nWe can defined also a time-domain Green's function which satisfies the time-domain scalar\nequation:\n(∇2 -1\nc2\n∂2\n∂t2 )g( r, r′, t, t′) = -δ( r - r′) δ(t -t′) ,\n(5)\nwhich solution is (in free-space):\ng( r, r′, t, t′) =\n\n4π| r- r′| δ(t -t′ -| r- r′|\nc\n)\nt > t′,\nt < t′.\n(6)\nFrom this, the solution to the wave equation for A and φ can be written as:\nA( r, t) =μ0\nZ\nV\ndv′\nZ inf\n-inf\ndt′ J( r′, t′) g( r, r′, t, t′) = μ0\nZ\nV\ndv′ J( r′, t -R/c)\n4πR\n,\n(7a)\nφ( r, t) =\nZ\nV\ndv′ ρ( r, t -R/c)\n4πε0R\n,\n(7b)\nwhere R = | r - r′|.\nThese wave equations are known as the time retarded potentials, and\nessentially say that the potential (either A or φ) can be calculated at a given point in space r\nand given time t from all previous times.\nFrom these equations, we can calculate the space-time electromagnetic fields:\nH( r, t) = 1\n4π\nZ\ndv′ ∇×\nJ( r′, τ)\nR\n,\nτ = t -R/c ,\n(8a)\nE( r, t) = -\n4πε0\nZ\nV\ndv′ ∇ρ( r, τ)\nR\n-μ0\n4π\nZ\ndv′ ∂\n∂t\nJ( r′, τ)\nR\n.\n(8b)\nLet us continue with the electric field first:\nE( r, t) = -\n4πε0\nZ\nV\ndv′\n· 1\nR∇ρ( r′, τ) + ρ( r′, τ)∇1\nR\n\n-μ0\n4π\nZ\nV\ndv′ 1\nR\n∂\n∂t\nJ( r′, τ) .\n(9)\nAt this point, we need to use the following relations:\n∇R =\nR\nR ,\n(10a)\n∇1\nR = -\nR\nR3 ,\n(10b)\n∇ρ( r′, τ) = ∂\n∂τ ρ( r′, τ)∇τ = -1\nc∇R ∂\n∂τ ρ( r′, τ) = -1\nc\nR\nR\n∂\n∂τ ρ( r, τ) .\n(10c)\nWe can therefore continue with the electric field as:\nE( r, t) =\n4πε0\nZ\ndv′\n·1\nc\nR\nR2\n∂\n∂τ ρ( r′, τ) +\nR\nR3 ρ( r′, τ)\n\n-μ0\n4π\nZ\ndv′ 1\nR\n∂\n∂τ\nJ( r′, τ)\n=\n4πε0\nZ\ndv′\n·1\nc\n∂\n∂τ ρ( r′, τ) + 1\nRρ( r′, τ)\nR\nR2 -μ0\n4π\nZ\ndv′ 1\nR\n∂\n∂τ\nJ( r′, τ) .\n(11)\n\nWe can perform the same type of calculations for the magnetic field using the relation\n∇× J( r′, τ) = -1\nc\nR\nR × ∂\n∂τ\nJ( r′, τ) .\n(12)\nWe get:\nH( r, t) = 1\n4π\nZ\ndv′\n·\n-1\nc\nR\nR2 × ∂\n∂τ\nJ( r′, τ) -\nR\nR3 × J( r′, τ)\n\n.\n(13)\nUpon gathering the expressions for the electric and magnetic field, we eventually get:\nE( r, t) = 1\n4π\nZ\ndv′\n1⁄2·1\nc\n∂\n∂τ ρ( r′, τ) + 1\nRρ( r′, τ)\n\nR\nε0R2 -μ0\nR\n∂\n∂τ\nJ( r′, τ)\n3⁄4\n(14a)\nH( r, t) = 1\n4π\nZ\ndv′\n·1\nc\n∂\n∂τ\nJ( r′, τ) + 1\nR\nJ( r′, τ)\n\n×\nR\nR2 .\n(14b)\nUpon using the boundary conditions for the electric and magnetic field, we construct the\nintegral equations in a standard way:\n- EFIE: ˆn × ( Ei + Escat) = 0 on PEC surface\n⇒ˆn × Ei( r, t) + 1\n4π ˆn ×\nZ\nds′ [. . .]\n(15)\n- MFIE: ˆn × ( Hi + Hscat) = Js.\nAs we have seen before (in a previous class), this integral equation is expressed in terms\nof the principal value of the integral with a 1/2 additional factor. Thus:\nJ( r, t) = ˆn × Hi( r, t) + 1\n4π ˆn × PV\nZ\nds′ [. . .]\n(16)\nFor the sake of comparison, we can write the MFIE in the frequency domain and in the time\ndomain:\nJ( r) = 2ˆn × Hi( r) + 2ˆn × PV\nZ\nds′ J( r′) × ∇′g( r, r′)\nr ∈S ,\n(17a)\nJ( r, t) = 2ˆn × Hi( r) + 1\n2π ˆn × PV\nZ\nds′\n·1\nc\n∂\n∂τ\nJ( r′, τ) + 1\nR\nJ( r′, τ)\n\n×\nR\nR2 .\n(17b)\nNote that in the principal value, we essentially exclude the part for which R = 0. Since\nτ = t -R/c and R = 0, we always have that τ < t. The time domain equations therefore\nstate that the current at location r and time t is equal to a known term 2ˆn × Hi( r, t) plus a\nterm (integral) known from the past history of J. This is the basis for solving the time domain\nintegral equation by iterative methods, the most well-known one being the marching-on-in-time.\n\nSection 3. The marching-on-in-time technique\nThe marching-on-in-time technique\n3.1\nGeneral equations\nThe integral equation can often be cast in the following form:\nJ( r, t) = Ji( r, t) +\nZ\nS\ndv′\nZ τ\ndt′ K( r, r′, t -t′) · J( r′, t′) .\n(18)\neq.10\nNote that we have a time integral also as in Eq. (\neq.10\n18), J( r′, t′) has not yet been set to satisfy\nany causality condition. Hence, we must then impose Ji( r, t) = 0 for t < 0, r ∈S.\nIn order to apply the MoM, we discretize the current both in space and in time:\nJ( r′, t′) =\nM\nX\nm′=1\nN\nX\nn′=0\nJp(m′, n′) Ps( r′ - rm′) Pt(t′ -tn′) ,\n(19)\nwhere P denotes the simple pulse function. In addition, we also apply point-matching, which\nmeans that we take the following testing functions:\nWmn( rm, tn) = δ( r - rm) δ(t -n∆t) = δ( r - rm) δ(t -tn) ,\n(20)\nwhere we take ∆t = min{Rmm′/c}, Rmm′ = | rm - r′\nm|. The method is best illustrated on the\nfollowing example.\n3.2\nExample\nLet us consider a 1D example governed by the following integral equation:\ng(x, t) =\nZ x0\n-x0\nK(x, x′) f(x′, τ)dx′ ,\nx ∈[-x0, x0],\nτ = τ(x, x′, t) = t -|x -x′|\nc\n.\n(21)\nLet us chose the following expansion for f:\nf(x′, τ) ≃\nN\nX\ni′=1\nJ\nX\nj′=1\nai′j′Pi′j′(x′, τ) ,\n(22)\nwhere the pulse basis functions are defined as\nPi′j′ =\n\nfor x′ ∈[xi′ -dx\n2 , xi′ + dx\n2 ] and t ∈[tj′ -dt\n2 , tj′ + dt\n2 ]\nelsewhere.\n(23)\nNote that we use the definitions: xi′ = i′dx, tj′ = j′dt, and dx = cdt. In order to apply point\nmatching, we take the following testing functions:\nwij(x, t) = δ(x -xi) δ(t -tj) .\n(24)\n\nUpon expanding and testing, we get:\ng(xi, tj) = gij =\nZ x0\n-x0\nK(xi, x′)\nN\nX\ni′=1\nJ\nX\nj′=1\nai′j′Pi′j′(x′, τ)δ(t -tj)\n=\nN\nX\ni′=1\nZ (i′+ 1\n2 )dx\n(i′-1\n2)dx\ndx′\nJ\nX\nj′=1\nai′j′Pi′j′(x′, τ)K(idx, x′)δ(t -tj) .\n(25)\nComing back to the definition of τ, we write (with the test and the expansion):\nτ = tj -|xi -xi′|\nc\n= jdt -|i -i′|dx\nc = (j -|i -i′|)dt ,\n(26)\nsuch that the coefficient ai′j′ becomes ai′,j-|i-i′|. The integral equation becomes:\ngij =\nN\nX\ni′=1\nai′,j-|i-i′|\nZ (i′+ 1\n2 )dx\n(i′-1\n2 )dx\ndx′K(idx, x′) .\n(27)\nWe can define the term\nZii′ =\nZ (i′+ 1\n2 )dx\n(i′-1\n2)dx\ndx′K(idx, x′)\n(28)\nand rewrite the previous system as\ngij =\nN\nX\ni′=1\nZii′ ai′,j-|i-i′|\n= Zii aij + Zi,i-1 ai-1,j-1 + Zi,i-2 ai-2,j-2 + . . . + Zi1 a1,j-i+1\n+ Zi,i+1 ai+1,j-1 + Zi,i+2 ai+2,j-2 + . . . + Z1,N aN,j-N+i .\n(29)\nIn this equation, only the first term involves time step j, all the others terms being at j -1,\nj -2, . . . Therefore, we can solve for aij:\naij = 1\nZii\n·\ngij -\nN\nX\ni′=1\ni′=i\nZii′ ai′,j-|i-i′|\n\n.\n(30)\nThe value of all aik are known for k < j, so that aij is completely specified in closed form by\nthose and the present value of gij. This process is known as a 1D march-on-in-time approach.\nTime-domain MoM is nowadays in its early stage and, although it has been successfully\napplied to various simple situations, still suffers from numerical instabilities. More work is in\nprogress..."
    },
    {
      "category": "Resource",
      "title": "Feb19.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-635-advanced-electromagnetism-spring-2003/ae6d31b703caed523c7780f4e1495e84_Feb19.pdf",
      "content": "Characterization of Left-Handed Materials\nMassachusetts Institute of Technology\n6.635 lecture notes\nIntroduction\n1. How are they realized?\n2. Why the denomination \"Left-Handed\"?\n3. What are their properties?\n4. Does it really work?\nIt has already been shown (see previous classes) that rings, or split-rings, can realize a\nnegative permeability (μ < 0) over a certain frequency band.\nIn addition to this, we need to realize a negative permittivity (ε < 0).\nIt has also been shown (see previous classes) that:\n- lossless:\nεmetal = 1 -ω2\np\nω2 ,\nwhere ωp = ne2\nε0me\n(n: electron density, e: electron charge, me: effective mass of electrons).\n- lossy:\nεmetal = 1 -\nω2\np\nω(ω + iγ) .\nA typical transmission curve looks like shown in Fig. 1.\nPSfrag replacements\nT\nω\nωp\nno transmission\n(ε < 0)\ntransmission\n(ε > 0)\nFigure 1: Transmission curve for a plasma-like medium.\n.\n\nSection 2. Why \"left-handed\"?\nWith these characteristics, ε < 0 has been realized already at infrared frequencies (where\nmetals behave like plasmas).\nProblem:\nhow to realize it at GHz frequencies?\nSolution:\nby reducing n, the electron density.\nOne way of doing this is to confine the electrons in space. This can be achieved by an array\nof rods for example, as shown in Fig. 2.\na\nr\nFigure 2: Array of rods confining the electrons in space.\nNote: it is important that the wires are thin, so as to reduce the radiation interaction and\nallow penetration into the structure.\nEffect of the wires: to reduce n to\nneff= nπr2\na2 .\n(1)\nFinally, note also that the rods have to be parallel to the electric field. This, plus the (known\nalready) fact that rings have to be perpendicular to the magnetic field, gives an idea on how to\nrealize physically LH metamaterials (see Fig. 3).\nWhy \"left-handed\"?\nAt this point, we have a metamaterial which can realize\nε < 0, μ < 0 .\n(2)\nWe shall now see what does it imply on the electromagnetic fields.\nLet us write Maxwell's curl equations for plane wave solutions and time harmonic notations:\nk × E( r) = ωμ H( r) ,\n(3a)\nk × H( r) = -ωε E( r) .\n(3b)\n\n5 mm\nFRONT\nBACK\n1.3 cm\n0.5 mm\nz\nx\ny\nx\nεs\n1 mm\nεs\n(a)\n(b)\nFigure 3: A realization for LH material.\nIn standard materials, Eq. (3) implies that the tryad ( E, H, k) forms a right-handed system.\nHowever, under Eq. (2), we will have:\n( E, H, k) form a left-handed (LH) tryad.\nHowever, the time average Poynting power is still\n< S( r) >= 1\n2R{ E( r) × H⋆( r)}\n(4)\nand remains in the same direction so that we have the set up shown in Fig. 4.\nCharacteristics:\n- k is in the phase velocity direction.\n- phase velocity and energy flux are in opposite directions.\nProperties of LH media\nSome know characteristics are:\n- Reversed Doppler effect (track the phase),\n- Reversed ˇCerenkov radiation (cf. 6.632),\n\n3.1\nReversed Snell's law\nE\nH\nk\nS\nFigure 4: Electric field ( E), magnetic field ( H), wave-vector ( k) and Poynting power\n( S) in an LH medium.\n- Negative index of refraction.\nThis last item is very significant, and we shall spend some time discussing it.\nThe index of refraction of a medium is defined as\nn = √εr μr ,\n(5)\nor, writing explicitly the frequency dependence (cf. later),\nn(ω) =\np\nεr(ω) μr(ω) .\n(6)\nFor those frequencies inside the left-handed band (i.e. in the band where ε < 0 and μ < 0),\nwe can write:\nε(ω) < 0\n⇒\nε(ω) = |ε(ω)| eiπ ,\n(7a)\nμ(ω) < 0\n⇒\nμ(ω) = |μ(ω)| eiπ ,\n(7b)\nEventually, we write n from Eq. (6):\nn =\np\n|ε(ω)μ(ω)| eiπ = -\np\n|ε(ω)μ(ω)| .\n(8)\n3.1\nReversed Snell's law\nAn important consequence of this fact is the reversal of Snell's law.\n- Ray diagram:\n\nθi\nθr\n-θr\nn > 0\nn < 0\n- k diagram for an LH medium:\nS\nkx\nkx\nk1z\nk2z\nk1\nk2\n3.2\nEnergy\nTraditionally, the energy is given by\nW = εE2 + μH2 .\n(9)\nWhat happens if ε < 0 and μ < 0? Is W < 0?\nActually no, but this direct conclusion from Eq. (9) shows that this equation is not valid\nas is.\nIn fact, these materials have to be modeled by frequency dispersive permittivity and\npermeability.\nIn that case, the relation of Eq. (9) becomes (from Poynting's theorem):\nW = ∂(εω)\n∂ω\nE2 + ∂(μω)\n∂ω\nH2\n(10)\nand we must have:\n∂(εω)\n∂ω\n> 0 ,\n(11a)\n∂(μω)\n∂ω\n> 0 .\n(11b)\n\n3.3\nProperties of an LHM slab\nWhen LH materials are studies as bulk materials, two models are commonly used for the\npermittivity/permeability:\n1. Drude model:\nεr = 1 -\nω2\nep\nω(ω + iγe) ,\n(12a)\nμr = 1 -\nω2\nmp\nω(ω + iγm) ,\n(12b)\nwhich is schematically represented in Fig. 5.\n0.2\n0.4\n0.6\n0.8\n1.2\n1.4\n1.6\n1.8\n-50\n-40\n-30\n-20\n-10\nw/w0\nReal(eps/eps0)\nwp = 100 GHz\nwp = 266.5 GHz\nwp = 500 GHz\nwp = 1000 GHz\n(a) R(ε).\n0.2\n0.4\n0.6\n0.8\n1.2\n1.4\n1.6\n1.8\n-0.02\n-0.015\n-0.01\n-0.005\n0.005\n0.01\n0.015\n0.02\nw/w0\nImag(eps/eps0)\nwp = 100 GHz\nwp = 266.5 GHz\nwp = 500 GHz\nwp = 1000 GHz\n(b) I(ε).\nFigure 5: Permittivity for various values of ωep in the Drude model (f0 = 30 GHz,\nωep = ωp).\n2. Resonant model:\nεr = 1 -\nω2\nep -ω2\neo\nω2 -ω2eo + iγeω ,\n(13a)\nμr = 1 -\nω2\nmp -ω2\nmo\nω2 -ω2mo + iγmω ,\n(13b)\nwhere ω(em)o are the electric/magnetic resonant frequencies and ω(em)p are the elec-\ntric/magnetic plasma frequencies. An illustration of this model is given in Fig. 6.\n3.3\nProperties of an LHM slab\nLet us consider the situation depicted in Fig. 7.\n\n0.2\n0.4\n0.6\n0.8\n1.2\n1.4\n1.6\n1.8\n-100\n-80\n-60\n-40\n-20\nw/w0\nReal(eps/eps0)\nwp = 266.5 GHz\nwp = 500 GHz\n(a) R(ε).\n0.2\n0.4\n0.6\n0.8\n1.2\n1.4\n1.6\n1.8\n-1\n-0.8\n-0.6\n-0.4\n-0.2\n0.2\n0.4\n0.6\n0.8\nw/w0\nImag(eps/eps0)\nwp = 266.5 GHz\nwp = 500 GHz\n(b) I(ε).\nFigure 6: Permittivity for various values of ωep in the resonant model of Eq. (13a)\n(f0 = 30 GHz, ωep = ωp, ω0 = 100GHz).\nx\ny\nz\nFigure 7: LH slab in free-space.\n\n3.3\nProperties of an LHM slab\nLet us consider the case for which εr = μr = -1 (working at the right frequency).\n1. From simple ray diagrams, using the reversed Snell's law:\n#0\n#1\n#2\nx\nz\nd\nS\nI1\nI2\nWe see that is the source is close enough to the slab (distance< d), the slab will produce\ntwo images, one inside the slab and one outside.\nThe distance from source to the second image is\nS -I2 = 2d .\n2. Rigorous calculation:\nLet us consider a TE wave impinging on this slab. We write, for a single interface:\nE0 =ˆyE0 eikxx-iωt[eikzz + re-ikzz] ,\n(14a)\nE1 =ˆyE0 eikxx-iωt teik′\nzz .\n(14b)\nWe need to match the boundary conditions and, for simplicity, we set the boundary to be\nat z = 0. We get:\n- Tangential E field:\neikzz + re-ikzz = teik′\nzz .\n- Tangential H field ( H =\niωμ∇× E):\neikzz -re-ikzz = μ0k′\nz\nμ1kz\nteik′\nzz .\nUpon solving, we get the reflection/transmission coefficient from free-space to the medium:\nt =\n2μ1kz\nμ1kz + μ0k′z\n,\n(15a)\nr =μ1kz -μ0k′\nz\nμ1kz + μ0k′z\n.\n(15b)\n\nIn a similar way, the reflection/transmission coefficients from the medium to free-space are:\nt′ =\n2μ0k′\nz\nμ1kz + μ0k′z\n,\n(16a)\nr′ =μ0k′\nz -μ1kz\nμ1kz + μ0k′z\n.\n(16b)\nIn order to obtain the field inside the slab, we shall compute the transmission coefficient as:\nT = teik′\nzd t′ + teik′\nzd r′eik′\nzd r′eik′\nzd t′ + tt′(r′2)2e5ik′\nzd + · · ·\n= tt′eik′\nzd\ninf\nX\nn=0\n(r′2)n e2ink′\nzd =\ntt′eik′\nzd\n1 -r′2e2ik′zd .\n(17)\nUsing the previous expressions, we obtain\nT =\n4μμ1kzk′\nzeik′\nzd\n(μ1kz + μ0k′z)2 -(μ0k′z -μ1kz)e2ik′zd .\n(18)\nFor the specific case of εr = μr = -1:\nT =\n-4kzk′\nzeik′\nzd\n(-kz + k′z)2 -(k′z + kz)e2ik′zd .\n(19)\nAt this point, we need to define kz and k′\nz:\nPropagating waves (k > kρ)\nEvanescent waves (k < kρ)\nkz\nkz =\nq\nk2 -k2ρ\nkz = i\nq\nk2ρ -k2\nk′\nz\nk′\nz = -\nq\nk2 -k2ρ\nk′\nz = i\nq\nk2ρ -k2\nRelation\nk′\nz = -kz\nk′\nz = kz\nPerforming the calculation, we get:\n- Propagating waves (k′\nz = -kz):\nT = 4k2\nze-ikzd\n4k2z\n= e-ikzd .\n- Evanescent waves (k′\nz = kz):\nT = -4k2\nzeikzd\n-4k2ze2ikzd = e-ikzd .\n\nSection 4. Does it really work?\nTherefore, for all waves, we get:\nT = e-ikzd .\n(20)\nConclusions:\n- Evanescent waves are amplified by the medium.\n- Propagating waves are \"backward waves\".\n- Taking an infinite amount of those creates a source.\n- Two images can be formed, like shown in the ray diagram of the previous subsection.\nDoes it really work?\nThe theoretical predictions have been verified in experiments.\nTo date, essentially two experiments have been done:\n1. Prism,\n2. Gaussian beam.\n4.1\nPrism experiment\nFirst experiment (2001). Later reproduced.\nRHM\nLHM\n4.2\nGaussian beam experiment\nFirst publication was theoretical. Later experiments followed, but still need to be improved.\n\nRHM\nLHM"
    },
    {
      "category": "Resource",
      "title": "Mar19_1.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-635-advanced-electromagnetism-spring-2003/6e61f3e62deeca98dfb079e96dd90b96_Mar19_1.pdf",
      "content": "Study of EM waves in Periodic Structures\nwith addenda: \"Study of EM waves in Periodic Structures (mathematical details)\"\nMassachusetts Institute of Technology\n6.635 lecture notes\nIntroduction\nWe will study here the distribution of electromagnetic fields in dielectric periodic media. The\nmain difference with the previous topic comes from the word \"dielectric\". Obviously, even a 2D\nperiodic dielectric medium cannot be studied with the Green's functions presented in a previous\nlecture, since the Green's function was for periodic metallic structures.\nIn this topic, we will study the EM fields in media where:\n- The material is macroscopic and isotropic.\n- Since the material is constituted of real dielectric, we suppose we work in a small enough\nfrequency band such that we can ignore the frequency dispersive behavior of ε.\n- The dielectric are lossless, so that ε is purely real.\nWave equations\n2.1\nWave equations for H\nStarting from Maxwell's equations and using a permittivity ε = ε( r), it is straightforward to\nshow that we can write the following equations:\n∇×\n· 1\nε( r)∇× H( r)\n\n=\nμω\nc\n¶2\nH( r) ,\n(1a)\n∇· H( r) = 0 .\n(1b)\nIn this approach, the strategy is therefore:\n1. Find the modes of H( r).\n2. Find those of E( r) by solving Maxwell's equations.\n\n2.2\nWave equations for E\nNote that we can rewrite Eq. (1a) as an eigenvalue problem:\nΘ H( r) =\nμω\nc\n¶2\nH( r) ,\n(2)\nwhere\nΘ = ∇×\n· 1\nε( r)∇×\n\n.\n(3)\nUpon solving, we get the eigenvectors which correspond to the field patterns of the harmonic\nmodes, and the eigenvalues which are proportional to the squared frequencies of these modes.\nNote that Θ is a linear operator and that it is Hermitian. The demonstration of the last\nproperty is straightforward:\nDefine a scalar product < F, G >=\nR\nd r F ⋆( r) · G( r) and show that (by\nintegration by part for example): < F, Θ G >=< Θ F, G >, which is the\ndefinition of a Hermitian operator. The consequence of this property is of\ncourse that Θ has real eigenvalues.\n2.2\nWave equations for E\nAnother approach to get the fields would be of course to write the wave equation for E instead\nof for H:\n∇× ∇× E( r) =\nμω\nc\n¶2\nε( r) E( r) .\n(4)\nHowever, this system cannot be cast in a simple eigenvalue problem. Although it can still\nbe solved for, it is far more complicated to get accurate results since the operator we would have\nto define would not be Hermitian. For this reason, this approach is in general avoided.\n2.3\nBloch states\nIn a periodic medium, we know that the fields can be written as:\nHk( r) = ei k· r uk( r),\nuk( r + R) = uk( r) .\n(5)\nInserting into Eq. (2) yields:\n(i k + ∇) ×\n· 1\nε( r) (i k + ∇) × uk( r)\n\n=\nμω( k)\nc\n¶2\nuk( r) ,\n(6)\nso that the operator becomes:\nΘ = (i k + ∇) ×\n· 1\nε( r) (i k + ∇)×\n\n(7)\nNote that because uk( r + R) = uk( r), the eigenvalue problem can be restricted to a small\nzone in space, which would necessarily imply a discrete spectrum of eigenvalues. Therefore, we\nexpect a set of discrete modes for each k.\n\nFundamentals of photonic crystals\nWe shall briefly explain some terminology here related essentially to solid state physics, but\nwhich is of prime importance for the study of the structures we are dealing with here.\n3.1\nDirect lattice (some details are given in the \"mathematical details\" addenda)\nA photonic crystal is a periodic structure (that we will take to be dielectric here) in 1D, 2D or\n3D.\nAny vector r′ in space can be written as\nr′ = r + R ,\n(8)\nwhere R is the translational vector in space defined by\nR = α1 a1 + α2 a2 + α3 a3 ,\n(9)\nwhere α1,2,3 ∈{. . . , -2, -1, 0, 1, 2, 3, . . .} and a1, a2 and a3 are the lattice vectors.\nFrom the lattice, we can construct the Wigner-Seitz cell as shown in Fig. 1.\nFigure 1: Wigner-Seitz cell for an arbitrary position of points: the cell is constructed\nby joining the center element to its closest neighbors and drawing perpendicular lines\nfrom to the center of these segments. The polygon thus created is the smallest repeat-\nable cell of the periodic lattice, and is defined as the Wigner-Seitz cell.\nNote that there exist only one type of lattice for a 1D photonic crystal, five distinct types\nfor 2D photonic crystals (rectangular, square, hexagonal or triangle, centered rectangular and\noblique), and fourteen for 3D photonic crystals.\n3.2\nReciprocal lattice (some details are given in the \"mathematical details\" addenda)\nWe will use here the same notation as [Joannopoulos, Meade, and Winn, \"Photonic Crystals\"]\nand write the reciprocal translational vector as G:\nG = β1 b1 + β2 b2 + β3 b3 ,\n(10)\nwhere β1,2,3 ∈{. . . , -2, -1, 0, 1, 2, 3, . . .} and b1, b2 and b3 are the lattice vectors in the spectral\ndomain.\nFor the sake of illustration, Tab. 1 gives the definition of vectors a and b for square and\ntriangular lattices.\n\n3.3\nBloch-Floquet theorem\nSquare lattice\na1 = aˆx\nb1 = 2π/a ˆx\na2 = aˆy\nb2 = 2π/a ˆy\nTriangular lattice\na1 = aˆx\nb1 = 2π/a (ˆx -\n√\n3/3 ˆy)\na2 = (ˆx +\n√\n3ˆy)\nb2 = 2π/a 2\n√\n3/3 ˆy\nTable 1: Definition of a and b vectors for square and triangular (or hexagonal) lattice.\n3.3\nBloch-Floquet theorem\nFrom Bloch-Floquet theorem, we know that we can write the electric and magnetic fields as a\nsummation over reciprocal vectors G (see the \"mathematical details\" part of the notes). This\nmeans that different k do not necessarily correspond to different modes and that therefore there\nis a redundancy in the label k: we can therefore reduce the study to what is called the first\nBrillouin zone (which is the Wigner-Seitz cell in the reciprocal lattice).\nSome examples of\nBrillouin zones are given in Fig. 2 and Fig. 3.\na1\na2\nb1\nb2\nFigure 2: Direct square lattice and corresponding reciprocal lattice with highlighted\nBrillouin zone.\na1\na2\nb1\nb2\nFigure 3: Direct triangular (or hexagonal) lattice and corresponding reciprocal lattice\nwith highlighted Brillouin zone.\nBragg-like diffraction\nThe standard Bragg diffraction is illustrated in Fig. 4. Here, we will derive another diffraction\ncondition, equivalent to Bragg, and shall see that the diffraction is entirely governed by the\nreciprocal vector G.\n\nθ\nθ\nθ\na\nFigure 4: Schematic representation of Bragg diffraction. Maximal diffraction occurs\nat 2a sin θ = nλ where λ is the wavelength of the electromagnetic wave and n is an\ninteger.\nReferring to Fig. 5, we can write the scattering amplitude in terms of the reflection coefficient\nΓ at position r times a phase factor.\nr\nk\nk′\nO\nFigure 5: Diffraction from an elementary volume of a periodic medium: k is the\nwavevector of the incident wave whereas k′ is the wavevector of the diffracted wave.\nUpon integrating over the whole volume, we get:\nF( k, k′) =\nZ\nΓ( r)ei( k- k′)· rdv .\n(11)\nSince the medium is periodic, we can write:\nΓ( r + R) = Γ( r) =\nX\nG\nΓ( G)ei G· r ,\n(12)\nsuch that\nF( k, k′) =\nX\nG\nZ\nΓ( G)ei( G-∆ k)· rdv ,\n(13)\n\nSection 4. Bragg-like diffraction\nwhere ∆ k = k′ - k. This amplitude is maximal when G -∆ k = 2mπ or, when m = 0,\nG = ∆ k.\n(14)\nThis is an important relation which, again, is a condition for maximal diffraction. Upon ex-\npanding back in terms of k and k′ and rising to the square, we write (noting that | k| = | k′| = k):\nk2 = k2 + 2 k · G + G2 ,\n(15)\nor (taking - k instead of k):\n2 k · G = G2 .\n(16)\nAs an exercise, it is interesting to show that this condition is equivalent to the standard\nBragg diffraction.\nUpon dividing both terms of Eq. (16) by 4, we eventually write\nk · (\nG\n2 ) = (\nG\n2 )2 .\n(17)\nThis last equation has a nice geometrical interpretation shown in Fig. 6 which shows that\nthe vectors k that satisfy the maximum diffraction condition are actually those which lie on the\nedge of the Brillouin zone.\nO\nC\nD\nGC/2\nGD/2\nFigure 6: Graphical representation of Eq. (17): each vector k (black vector) with its\ntip on a dashed line (not all represented) will satisfy the equation. Graphically: all\nthose k have the same projection on the generating vector G/2 (red vector).\nTherefore:\nThe edge of the Brillouin zone plus its center ( G = 0) satisfy the maximum\ndiffraction condition.\nThis condition can also be rewritten in terms of group velocity: for those k which tip lie on\nthe edge of the Brillouin zone and k = 0, the component of the group velocity normal to the\n\nBragg diffraction planes tends to zero since the electromagnetic wave tends to be completely\nreflected for these k:\nvnorm\ng\n( k ∈BZ tip) =\nμ\n∇kω( k)\n¶norm\n( k ∈BZ tip) →0 .\n(18)\nFor the symmetry points, the diffracted wave is reflected in the direction of the incident wave so\nthat for these points, the total group velocity is zero. This can be directly seen on the dispersion\ncurves where, at the symmetry points of the crystal, the tangent to the curve is horizontal\n(except possibly for those points corresponding to a zero frequency).\nMathematical details\nUsing all the principles shown before, we can construct the eigenvalue system for H and then\nsolve for E. The detailed mathematical manipulations are given in the annex document \"Study\nof EM waves in Periodic Structures (mathematical details)\".\nNote that to build the system, we need to evaluate the Fourier coefficients of the permittivity\n(or the inverse of the permittivity, κ). We shall show how to get these coefficients for the case\nof infinite dielectric rods εa of circular cross-section organized in a square lattice, embedded in\na background of εb. We therefore place ourselves in a 2D situation where the G vector will be\nwritten Gρ to denote that it does not depend on z (and similarly R will be noted Rρ).\nAs a reminder, we write the permittivity as:\nε(ρ) =\nX\nGρ\nε( Gρ)ei Gρ·ρ,\nε( Gρ) = 1\nΩ\nZ\nΩ\nε(ρ)e-i Gρ·ρ ,\n(19)\nwhere Ωdenotes the surface of the elementary cell.\nThe idea is to write the permittivity as\nε(ρ) = εb + (εa -εb)\nX\nRρ\nS(Rc -|ρ - Rρ|) ,\n(20)\nwhere again the subscript ρ in Rρ denotes a dependency on x and y only, Rc is the radius of the\ndielectric rods and S denotes the step function. Merging these two equations, we get:\nε( Gρ) = 1\nΩ\nZ\nΩ\n·\nεb + (εa -εb)\nX\nRρ\nS(Rc -|ρ - Rρ|)\n\ne-i Gρ·ρdρ ,\n= 1\nΩ\nZ\nΩ\nεbe-i Gρ·ρdρ + 1\nΩ\nZ\nΩ\n(εa -εb)\nX\nRρ\nS(Rc -|ρ - Rρ|)e-i Gρ·ρdρ .\n(21)\nLet us call the first integral I1( Gρ) and the second integral I2( Gρ), and evaluate them separately.\nEvaluation of I1(ρ)\n\nSection 5. Mathematical details\nThe first integral is easily evaluated as:\nI1( Gρ) =\n\nεb\nif Gρ = 0\nelsewhere\n(22)\nEvaluation of I2(ρ)\nFor the second integral, we can make the change of variable ρ′ = ρ - Rρ. Since ρ spans the\nwhole domain Ωand Rρ is the translational vector, ρ′ spans the whole space. We can therefore\nreplace the sum of integrals over Ωby a single integral over the whole 2D space. We write then:\nIf Gρ = 0:\nI2( Gρ) = εa -εb\nΩ\nZZ\ndρ′S(Rc -|ρ - Rρ|) = (εa -εb) πR2\nc\nΩ\n= fr(εa -εb),\n(23)\nwhere fr = πR2\nc\nΩ\nis the fractional volume.\nIf Gρ = 0:\nI2( Gρ) = 1\nΩ(εa -εb)\nZZ\ninf\n-inf\ndρ′ S(Rc -|ρ - Rρ|) e-i Gρ·ρ′\n= εa -εb\nΩ\nZ Rc\ndρ′ρ′\nZ 2π\ndφe-iGρρ′ cos(φ-θ)\n= εa -εb\nΩ\n2π\nZ Rc\ndρ′ρ′J0(ρ′Gρ),\n(24)\nwhere we have used the change of variable (now standard) x′ = ρ′ sin φ, y′ = ρ′ cos φ,\nGx = Gρ sin θ, Gy = Gρ cos θ, and the well-known identity for the Bessel function.\nUpon\nusing\nR\nxJ0(αx)dx = x/α J1(αx), we continue with\nI2( Gρ) = 2π\nΩ(εa -εb)\n· ρ′\nGρ\nJ1(Gρρ′)\nRc\n= fr(εa -εb) 2J1(GρRc)\nGρRc\n.\n(25)\nThis lead to the final result that:\nε(Gρ) =\n\nεafr + εb(1 -fr)\nif Gρ = 0\n(εa -εb)fr\n2J1(GρRc)\nGρRc\nelsewhere.\n(26)\nThe reconstruction of the permittivity is then straightforward, and examples of two lattice\nare given in Fig. 7.\n\n(a) Side view.\n(b) Top view.\nFigure 7: Reconstruction of the permittivity for cylindrical rods in a square lattice\nεa = 10, εb = 1, Rc/a = 0.2 (yielding a fractional volume fr = 12.5%).\n\nSection 6. Dispersion curves\nDispersion curves\nAt this point, we have everything to build the eigensystem (34) given in the additional document\n\"Study of EM waves in periodic structures (mathematical details)\". Solving it gives a set of\neigenvalues that are directly related to the dispersion curve of the material. An example is given\nin Fig. 8.\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\n0.7\n0.8\nFrequency ω a/2π c\nSquare lattice: Rc/a = 0.2 (f=12.5664%), εa=10, εb=1.\nTE\nTM\nΓ\nX\nM\nΓ\nFigure 8: Dispersion diagram for the photonic crystal of Fig. 7."
    },
    {
      "category": "Resource",
      "title": "Mar19_2.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-635-advanced-electromagnetism-spring-2003/f1baba95f3344490c8ea57f4a87f999f_Mar19_2.pdf",
      "content": "Study of EM waves in Periodic Structures (mathematical details)\nMassachusetts Institute of Technology\n6.635 partial lecture notes\nIntroduction: periodic media nomenclature\n1. The space domain is defined by a basis,(a1, a2, a3), where any vector can be written as\nr′ = r + R = r + α1a1 + α2a2 + α3a3 ,\n(1)\nwhere R is the translation vector, with α1, α2, α3 integers.\n2. The spectral domain is defined by a basis, (b1, b2, b3), and similarly, the translational vector\nis written as\nG = β1b1 + β2b2 + β3b3 ,\n(2)\nwhere β1, β2, β3 are integers.\n3. The two basis are linked since the functions (fields, permittivity) are periodic. For example,\nif we write the permittivity:\nFourier expansion:\nε(r) =\nX\nG\nε(G) eiG·r\nwhere ε(G) =\nVcell\nZZZ\ndr3ε(r) e-iG·r .\n(3)\nPeriodicity:\nε(r + R) =\nX\nG\nε(G) eiG·(r+R)\n=\nX\nG\nε(G) eiG·r eiG·R = ε(r)\n(4)\nso that eiG·R = 1 and\nG · R = 2mπ\nwhere m ∈{. . . , -1, 0, 1, 2, . . .} .\n(5)\nWe can see that condition (5) is immediately verified if we impose:\nbj · ai = 2πδij .\n(6)\n\nSection 1. Introduction: periodic media nomenclature\n4. Bloch-Floquet theorem:\nSince EM fields are periodic, we can write them as a propagating function times a function\nwith the same periodicity as the medium:\nξk(r) = eik·r ζk(r)\nwhere\nζk(r + R) = ζk(r) ,\n(7)\nand where ξ can represent either the electric or magnetic fields, E or H.\nSince ζ(r) is periodic, we can Fourier expand it:\nζk(r) =\nX\nG\nζG eiG·r ,\n(8)\nso that we shall write:\nEk(r) =\nX\nG\neG ei(k+G)·r ,\n(9a)\nHk(r) =\nX\nG\nhG ei(k+G)·r .\n(9b)\n5. Wave equation in source-free region:\nFrom Maxwell's equation, we can easily obtain the following wave equations in source-free\nregions (with ε = ε(r)):\n∇× ∇× E(r) =\nμω\nc\n¶2\nμrεr(r) E(r) ,\n(10a)\n∇×\n·\nεr(r)∇× H(r)\n\n=\nμω\nc\n¶2\nμr H(r) ,\n(10b)\nTo make these equations more symmetrical, we shall work with 1/εr(r) instead of εr(r)\ndirectly, so that we define\nκr(r) =\nεr(r) =\nX\nG\nκr(G) eiG·r .\n(11)\nThe wave equations are rewritten as:\nκr(r)∇× ∇× E(r) =\nμω\nc\n¶2\nμr E(r) ,\n(12a)\n∇×\n·\nκr(r)∇× H(r)\n\n=\nμω\nc\n¶2\nμr H(r) .\n(12b)\n\nTreatment of the E field\n2.1\nMethod 1: direct expansion of the permittivity\nWe want to write Eq. (10a) with the decomposition of Eq. (9a). First, let us compute the first\ncurl (taking G\n′ as the variable for the expansion):\n∇× Ek(r) =\nX\nG\n′\n∇×\n·\neG\n′ ei(k+G\n′\n)·r\n\n= i\nX\nG\n′\n(k + G\n′) × eG\n′ ei(k+G\n′\n)·r .\n(13)\nTaking the curl one more time gives\n∇× ∇× Ek(r) = -\nX\nG\n′\n(k + G\n′) ×\n·\n(k + G\n′) × eG\n′\n\nei(k+G\n′\n)·r .\n(14)\nUpon using Eq. (3) but changing the index G into G\n′′, we write\nεr(r)E(r) =\nX\nG\n′\nX\nG\n′′\nεr(G\n′′) eG\n′ ei(k+G\n′\n+G\n′′\n)·r .\n(15)\nBy changing the variables G = G\n′ + G\n′′:\nεr(r)E(r) =\nX\nG\nX\nG\n′\nεr(G -G\n′) eG\n′ ei(k+G)·r .\n(16)\nThe wave equation (see Eq. (10a)) can therefore be rewritten as:\n-\nX\nG\n′\n(k + G\n′) ×\n·\n(k + G\n′) × eG\n′\n\nei(k+G\n′\n)·r =\nμω\nc\n¶2\nμr\nX\nG\nX\nG\n′\nεr(G -G\n′) eG\n′ ei(k+G)·r . (17)\nWe can simplify by exp (ik · r) and multiply by exp (-iG\n′′ · r) to get:\n-\nX\nG\n′\n(k+G\n′)×\n·\n(k+G\n′)×eG\n′\n\nei(G\n′\n-G\n′′\n)·r =\nμω\nc\n¶2\nμr\nX\nG\nX\nG\n′\nεr(G-G\n′) eG\n′ ei(G-G\n′′\n)·r . (18)\nIf we integrate this equation over the entire space, we can pull all the terms out of the\nintegral, except ei(G\n′\n-G\n′′\n)·r on the left-hand side and. ei(G-G\n′′\n)·r on the right-hand side. Yet,\nwe have\nZZZ\nV\ndr3ei(G-G\n′′\n)·r =\n(2π)3 δ(G -G\n′′) ,\n(19)\nso that Eq. (18) becomes (upon substituting G\n′′ by G since these are dummy variables):\n-(k + G) ×\n·\n(k + G) × eG\n\n=\nμω\nc\n¶2\nμr\nX\nG\n′\nεr(G -G\n′) eG\n′ ,\n∀G .\n(20)\n\n2.2\nMethod 2: expansion of the inverse of the permittivity\n2.2\nMethod 2: expansion of the inverse of the permittivity\nInstead of working with Eq. (10a), we can also use Eq. (12a), which would need the expansion\nof Eq. (11).\nApplying the same method (and transforming the index of Eq. (11) from G to G\n′′), we get:\n-\nX\nG\n′′\nX\nG\n′\nκr(G\n′′)(k + G\n′) ×\n·\n(k + G\n′) × eG\n′\n\nei(k+G\n′\n+G\n′′\n)·r =\nμω\nc\n¶2\nμr\nX\nG\n′\neG\n′ei(k+G\n′\n)·r . (21)\nwhich, upon substituting G\n=\nG\n′ + G\n′′, simplifying by exp (ik · r), multiplying by\nexp (-iG\n′′ · r), integrating over the whole space, using Eq. (19) and finally substituting G\n′′\nby G, becomes:\n-\nX\nG\n′\nκr(G -G\n′)(k + G\n′) ×\n·\n(k + G\n′) × eG\n′\n\n=\nμω\nc\n¶2\nμr eG ,\n∀G .\n(22)\nTreatment of the H field\nThe H field is treated in an exactly similar way to eventually obtain very similar equations.\nHowever, these equations can still be pushed further by using the fact that ∇· Hk(r) = 0.\nUpon using this equality, we see from Eq. (9b) that (using G\n′ for the expansion of the field):\n(k + G\n′) · hG\n′ = 0 .\n(23)\nWe can therefore define three vectors (ˆe1, ˆe2, ˆe3) such that\nk + G\n′ = |k + G\n′| ˆe3 ,\n(24a)\nˆe1 · ˆe3 = ˆe2 · ˆe3 = 0 ,\n(24b)\nand (ˆe1, ˆe2, ˆe3) for an orthonormal tryad. In that case, we can decompose\nhG\n′ = h1G\n′ˆe1 + h2G\n′ˆe2 =\nX\nλ=1,2\nhλG\n′ ˆeλ .\n(25)\nWe need now to introduce this expression into Eq. (12b). First, we compute\n∇× Hk(r) = i\nX\nG\n′\nX\nλ\nhλG\n′\n·\n(k + G\n′) × ˆeλ\n\nei(k+G\n′\n)·r ,\n(26)\nso that\nκr(r)∇× Hk(r) = i\nX\nG\n′′\nX\nG\n′\nX\nλ\nhλG\n′ κr(G\n′′)\n·\n(k + G\n′) × ˆeλ\n\nei(k+G\n′\n+G\n′′\n)·r\n= i\nX\nG\nX\nG\n′\nX\nλ\nhλG\n′ κr(G -G\n′)\n·\n(k + G\n′) × ˆeλ\n\nei(k+G)·r .\n(27)\nTaking the next curl, we write:\n\n∇×\n·\nκr(r)∇×Hk(r)\n\n= -\nX\nG\nX\nG\n′\nX\nλ\nhλG\n′ κr(G-G\n′)\n·\n(k+G)×[(k+G\n′)×ˆeλ]\n\nei(k+G)·r , (28)\nso that the wave equation (see Eq. (12b)) becomes:\n-\nX\nG\nX\nG\n′\nX\nλ\nhλG\n′ κr(G-G\n′)\n·\n(k+G)×[(k+G\n′)×ˆeλ]\n\nei(k+G)·r =\nμω\nc\n¶2\nμr\nX\nG\n′\nX\nλ\nhλG\n′ ei(k+G\n′\n)·rˆeλ .\n(29)\nAlways by the same token (multiplying by the proper functions and integrating over whole\nspace), we write:\n-\nX\nG\n′\nX\nλ\nhλG\n′ κr(G -G\n′)\n·\n(k + G) × [(k + G\n′) × ˆeλ]\n\n=\nμω\nc\n¶2\nμr\nX\nλ′′\nhλ′′G ˆeλ′′\n∀G . (30)\nWe can further simplify this expression by dot-multiplying the equation by ˆeλ′ and noting\nthat (using C · (A × B) = B · (C × A))\n·\n(k + G) × [(k + G\n′) × ˆeλ]\n\n· ˆeλ′ = -\n·\n(k + G\n′) × ˆeλ\n\n·\n·\n(k + G) × ˆeλ′\n\n(31)\nTherefore, dot-multiplying Eq. (30) by ˆeλ′, we get the final result:\nX\nG\n′\nX\nλ\n1⁄2·\n(k + G\n′) × ˆeλ\n\n·\n·\n(k + G) × ˆeλ′\n3⁄4\nκr(G -G\n′) hλG\n′ =\nμω\nc\n¶2\nμrhλ′G .\n(32)\nUpon exchanging G and G\n′ (transformations: G →G\n′′, G\n′ →G, G\n′′ →G\n′), we obtain\nX\nG\nX\nλ\n1⁄2·\n(k + G) × ˆeλ\n\n·\n·\n(k + G\n′) × ˆeλ′\n3⁄4\nκr(G\n′ -G) hλG =\nμω\nc\n¶2\nμrhλ′G\n′ .\n(33)\nwhich is the relation given in [Joannopoulos et al., 1995, p. 129]. Upon using the same\nnotation, we rewrite Eq. (33) as:\nX\nλG\nΘk\n(λG),(λG)′ h(λG) =\nμω\nc\n¶2\nμrh(λG)′ ,\n(34a)\nwhere\nΘk\n(λG),(λG)′ = κr(G\n′ -G)\n·\n(k + G) × ˆeλ\n\n·\n·\n(k + G\n′) × ˆeλ′\n\n.\n(34b)\n\n3.1\nMatrix form\n3.1\nMatrix form\nWe can cast Eq. (33) in matrix form. First, we rewrite the kernel of the operator of Eq. (34b)\nas:\n·\n(k + G) × ˆeλ\n\n·\n·\n(k + G\n′) × ˆeλ′\n\n=\n(k + G)\n\n(k + G\n′)\n[ˆe3 × ˆeλ] · [ˆe3 × ˆeλ′] .\n(35)\nRemembering that ˆe3 × ˆe1 = ˆe2 and ˆe3 × ˆe2 = -ˆe1, we can write:\n[ˆe3 × ˆeλ] · [ˆe3 × ˆeλ′] =\nA\nˆe2 · ˆe2\n-ˆe2 · ˆe1\n-ˆe1 · ˆe2\nˆe1 · ˆe1\n!\n,\n(36)\nso that we write the operator as:\nΘk\n(λG),(λG)′ = κr(G\n′ -G)\n·\n(k + G) × ˆeλ\n\n·\n·\n(k + G\n′) × ˆeλ′\n\n= κr(G\n′ -G)\n(k + G)\n·\n(k + G\n′)\n\nA\nˆe2 · ˆe2\n-ˆe2 · ˆe1\n-ˆe1 · ˆe2\nˆe1 · ˆe1\n!\n,\n(37)\nused in Eq. (34a)."
    },
    {
      "category": "Resource",
      "title": "Feb24.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-635-advanced-electromagnetism-spring-2003/4c3ea09d624e8cf6cfe554b4c307724a_Feb24.pdf",
      "content": "Dispertion relations in Left-Handed Materials\nMassachusetts Institute of Technology\n6.635 lecture notes\nIntroduction\nWe know already the following properties of LH media:\n1. εr and μr are frequency dispersive.\n2. εr and μr are negative over a similar frequency band.\n3. The tryad ( E, H, k) is left-handed.\n4. The index of refraction is negative.\nFrom the past lectures, we know that these materials can be realized by a succession of wires\nand rods:\n- Periodic arrangement of rods: realizes a plasma medium with negative εr over a certain\nfrequency band. The model for the permittivity is:\nεr = 1 -\nω2\nep\nω2 + iγeω .\n(1)\n- Periodic arrangement of rings (split-rings) realizes a resonant μr modeled as\nμr = 1 -\nFω2\nmp\nω2 -ω2mo + iγmω ,\n(2)\nwhere F is the fractional area of the unit cell occupied by the interior of the split-ring\n(F < 1).\nIn the lossless case (γe = γm = 0), we can rewrite these two relations as:\nεr =ω2 -ω2\nep\nω2\n,\n(3a)\nμr =ω2 -ω2\n0 -Fω2\nω2 -ω2\n= (1 -F) ω2 -ω2\nb\nω2 -ω2\n,\n(3b)\nwhere ωb = ω0/\n√\n1 -F > ω0. Therefore:\nk2 = ω2εμ = 1\nc(1 -F)(ω2 -ω2\nep)(ω2 -ω2\nb)\nω2 -ω2\n.\n(4)\nUpon identifying the regions where εr and μr change signs, we can immediately get the\nrelation for k:\n\nSection 2. Argument on n < 0\nω\nω0\nωb\nωp\nεr\nμr\nk2\n+\n+\n+\n+\n+\n+\n-\n-\n-\n-\n-\n-\nThe region ω ∈[ω0, ωb], which also corresponds to εr < 0 and μr < 0, corresponds to\nk2 positive, which means k real. Therefore, there is propagation in this band, but not in the\nadjacent ones.\nIt may still not be clear that k is negative, even if we write\nk = ω2√εμ = ω2\nq\nε2\n0μ2\n√εrμr = k0n .\n(5)\nA demonstration of the fact that n is negative follows.\nArgument on n < 0\n2.1\nComplex Poynting theorem\nWe shall first recall the derivation of the complex Poynting theorem and the signification of the\nvarious terms.\nWe start from Maxwell's curl equation\n∇× E = iω B ,\n(6a)\n∇× H = -iω D + J .\n(6b)\nUpon multiplying Eq. (6a) by H⋆and substracting the complex conjugate of Eq. (6b) mul-\ntuplied by E we get:\nH⋆· ∇× E- E · ∇× H⋆= ∇· ( E × H⋆)\n= iω B · H⋆-iω D⋆· E - J⋆· E\n= iω[ B · H⋆- E · D⋆] - E · J⋆.\n(7)\nUpon rewriting, we get:\n- E · J⋆= ∇· ( E × H⋆) + iω[ E · D⋆- B · H⋆] .\n(8)\nOn the right-hand side of the equation, the first terms corresponds to the divergence of\nPoyting power, which is therefore positive. The second term relates to the complex EM energy,\nand is therefore also positive. Consequently, the left-hand side term must also be positive, and\nactually corresponds to the power supplied by J to the volume.\nWe shall use this result hereafter.\n\n2.2\n1D wave equation\nFor the sake of simplification, let us work with a 1D problem. The wave equation\n∇2 E( r) + k2 E( r) = -iωμ J( r) ,\n(9)\nis rewritten with\nE( r) = ˆz E(x) ,\n(10a)\nJ( r) = ˆz j0δ(x -x0) ,\n(10b)\nto yield\n∂2\n∂x2 E(x) + k2E(x) = -iωμj0δ(x -x0) .\n(11)\nThe solution to this equation is\nE(x) = α eik|x-x0| ,\n(12)\nwhere α needs to be determined. From Eq. (12), we write:\n1. First derivative:\n∂E(x)\n∂x\n= αik\n∂\n∂x2 |x -x0| eik|x-x0| .\n(13)\n2. Second derivative:\n∂2E(x)\n∂x2\n=αik ∂2\n∂x2 |x -x0| eik|x-x0| + α(-k2)( ∂\n∂x2 |x -x0|)2 eik|x-x0|\n= -αk2 eik|x-x0| + 2iαkδ(x -x0) .\n(14)\nTherefore:\n∂2E(x)\n∂x2\n+ k2E(x) =2iαkδ(x -x0) = 2iα k0 n δ(x -x0) .\n(15)\nComparing Eq. (11) to Eq. (15), we get\nα = -ωμj0\n2k0 n = -j0 η0\nμr\nn ,\n(16)\nso that finally the solution is:\nE(x) = -j0 η0\nμr\nn eik|x-x0| .\n(17)\nIf we now compute the power supplied by the current J to the volume:\nP = -1\nZ\nV\nE · J⋆dV = η0 j2\nμr\nn\n> 0 .\n(18)\nThe source must, on average, do positive work on the field. Yet, in LH regime, we have\nμr < 0 so that we must have n < 0 as well.\n\nSection 3. Dispersion relations\nFinally, we can also write the E field as:\nE(x, t) = -η\n2 j0 ei(k0n|x-x0|-ωt) .\n(19)\nThus, plane waves appear to propagate from -infand +infto the source, seemingly running\nbackward in time. Yet, the work done on the field is positive so clearly the energy propagates\noutward from the source.\nDispersion relations\nAt this point, we know that n < 0 and k < 0. The difference between phase and group velocity\ncan be directly seen on the dispersion relation diagram.\nvφ = ω\nkz\n,\n(20a)\nvg =\nμ∂kz\n∂ω\n¶-1\n.\n(20b)\n- Free-space: k = ω√εμ where ε = cte and μ = cte.\n- Metamaterial:\nLet us take the following models\nεr =1 -\nω2\np\nω2 + iγeω ,\n(21a)\nμr =1 -\nω2\nmp -ω2\nmo\nω2 -ω2mo + iγmω ,\n(21b)\n3.1\nLossless case (γe = γm = 0), ωmp = ωp\nWe rewrite\nεr =ω2 -ω2\np\nω2\n,\n(22a)\nμr =ω2 -ω2\nmp\nω2 -ω2mo\n,\n(22b)\n(22c)\nand plot the relations with\n\nωp\n=\n20e9 rad/s\nωmp\n=\n20e9 rad/s\nωmo\n=\n5e9 rad/s\nγe = γm\n=\n-2\nx 10\n-6\n-2\nx 10\n-6\nx 10\nkx\nkz\nω [rad/s]\nk surface\nx 10\n0.5\n1.5\n2.5\nx 10\n-6\nω [rad/s]\nk\nDispersion relation\nx 10\n-50\nω [rad/s]\nεr\nRelative permittivity\nx 10\n-200\n-100\nω [rad/s]\nμr\nRelative permeability\n-3\n-2\n-1\nx 10\n-6\n0.5\n1.5\n2.5\n3.5\nx 10\nk surface (Gamma= 0)\nkz\nω [rad/s]\n\n3.1\nLossless case (γe = γm = 0), ωmp = ωp\nOther cases follow.\nωp\n=\n30e9 rad/s\nωmp\n=\n20e9 rad/s\nωmo\n=\n5e9 rad/s\nγe = γm\n=\n0 rad/s\n-2\nx 10\n-6\n-2\nx 10\n-6\nx 10\nkx\nkz\nω [rad/s]\nk surface\nx 10\nx 10\n-6\nω [rad/s]\nk\nDispersion relation\nx 10\n-50\nω [rad/s]\nεr\nRelative permittivity\nx 10\n-200\n-100\nω [rad/s]\nμr\nRelative permeability\n-4\n-3\n-2\n-1\nx 10\n-6\n0.5\n1.5\n2.5\n3.5\nx 10\nk surface (Gamma= 0)\nkz\nω [rad/s]\n\nωp\n=\n30e9 rad/s\nωmp\n=\n20e9 rad/s\nωmo\n=\n5e9 rad/s\nγe = γm\n=\n10e7 rad/s\n-2\nx 10\n-6\n-2\nx 10\n-6\nx 10\nkx\nkz\nω [rad/s]\nk surface\nx 10\nx 10\n-6\nω [rad/s]\nk\nDispersion relation\nx 10\n-50\nω [rad/s]\nεr\nRelative permittivity\nx 10\n-200\n-100\nω [rad/s]\nμr\nRelative permeability\n-4\n-3\n-2\n-1\nx 10\n-6\n0.5\n1.5\n2.5\n3.5\nx 10\nk surface (Gamma= 100000000)\nkz\nω [rad/s]\n\n3.1\nLossless case (γe = γm = 0), ωmp = ωp\nωp\n=\n30e9 rad/s\nωmp\n=\n20e9 rad/s\nωmo\n=\n5e9 rad/s\nγe = γm\n=\n10e8 rad/s\n-2\nx 10\n-6\n-2\nx 10\n-6\nx 10\nkx\nkz\nω [rad/s]\nk surface\nx 10\n0.5\n1.5\n2.5\nx 10\n-6\nω [rad/s]\nk\nDispersion relation\nx 10\n-50\nω [rad/s]\nεr\nRelative permittivity\nx 10\n-40\n-20\nω [rad/s]\nμr\nRelative permeability\n-2.5\n-2\n-1.5\n-1\n-0.5\n0.5\n1.5\n2.5\nx 10\n-6\n0.5\n1.5\n2.5\n3.5\nx 10\nk surface (Gamma= 1000000000)\nkz\nω [rad/s]\n\nωp\n=\n30e9 rad/s\nωmp\n=\n20e9 rad/s\nωmo\n=\n5e9 rad/s\nγe = γm\n=\n10e9 rad/s\n-2\nx 10\n-7\n-2\nx 10\n-7\nx 10\nkx\nkz\nω [rad/s]\nk surface\nx 10\n0.5\n1.5\n2.5\nx 10\n-7\nω [rad/s]\nk\nDispersion relation\nx 10\n-8\n-6\n-4\n-2\nω [rad/s]\nεr\nRelative permittivity\nx 10\n-5\nω [rad/s]\nμr\nRelative permeability\n-4\n-3\n-2\n-1\nx 10\n-7\n0.5\n1.5\n2.5\n3.5\nx 10\nk surface (Gamma= 1.000000e+10)\nkz\nω [rad/s]\n\n3.1\nLossless case (γe = γm = 0), ωmp = ωp\nωp\n=\n30e9 rad/s\nωmp\n=\n20e9 rad/s\nωmo\n=\n5e9 rad/s\nγe = γm\n=\n10e10 rad/s\n-4\n-2\nx 10\n-7\n-4\n-2\nx 10\n-7\nx 10\nkx\nkz\nω [rad/s]\nk surface\nx 10\nx 10\n-7\nω [rad/s]\nk\nDispersion relation\nx 10\n0.96\n0.962\n0.964\n0.966\nω [rad/s]\nεr\nRelative permittivity\nx 10\n0.96\n0.962\n0.964\n0.966\nω [rad/s]\nμr\nRelative permeability\n-5\n-4\n-3\n-2\n-1\nx 10\n-7\n0.5\n1.5\n2.5\n3.5\nx 10\nk surface (Gamma= 1.000000e+11)\nkz\nω [rad/s]\n\nPlotting all the 3D curves on the same scale:\n-5\nx 10\n-6\n-5\nx 10\n-6\n0.5\n1.5\n2.5\n3.5\nx 10\nkz\nk surface (Gamma= 0)\nkx\nω [rad/s]\n\n-5\nx 10\n-6\n-5\nx 10\n-6\n0.5\n1.5\n2.5\n3.5\nx 10\nkz\nk surface (Gamma= 10000000)\nkx\nω [rad/s]\n!#\"$&%'#(*)+,\n-5\nx 10\n-6\n-5\nx 10\n-6\n0.5\n1.5\n2.5\n3.5\nx 10\nkz\nk surface (Gamma= 100000000)\nkx\nω [rad/s]\n.-/0 !#\"#1&%2'(*)+,\n-5\nx 10\n-6\n-5\nx 10\n-6\n0.5\n1.5\n2.5\n3.5\nx 10\nkz\nk surface (Gamma= 1000000000)\nkx\nω [rad/s]\n.34 !#\"5&%'#(*)+,\n-5\nx 10\n-6\n-5\nx 10\n-6\n0.5\n1.5\n2.5\n3.5\nx 10\nkz\nk surface (Gamma= 1.000000e+10)\nkx\nω [rad/s]\n.6*7 !#\"8&%2'(*)+,\n-5\nx 10\n-6\n-5\nx 10\n-6\n0.5\n1.5\n2.5\n3.5\nx 10\nkz\nk surface (Gamma= 1.000000e+11)\nkx\nω [rad/s]\n90 !#\":!&%'()+,\n;=<\n>@?4ACBED@F&G&H\nIJ@KLI2H\nM/NOLK#P\nQ:RSH\nM/N\nT\nLKQCP7UWVYX\nM/LZ:QCLH\nM/[@I\\Z:QCP\n[WKI=MCXP\nMIIK#I\\]7^=_\\`WKba0MWc*K#P\nI&QCLKCd\neSfhgji&kElYm\nnWo\nT\nlYm=prq\n]\nl\nVS^ts\nfgui&k\nT\nl\\m\nvn\nkElYm\nvw\nV\no\nT\nlYm&kElYm\nvw\np\nq\n]\nl\nVxzy=`KLSK\nl\nn\ng|{/}/~\nLSQ/c@:Ix\nl\nvn\ngC}/~\nLSQ/c@:Ix\nl\nv=w\ngC~\nLSQ/c@:I^\n\n3.1\nLossless case (γe = γm = 0), ωmp = ωp\nFor simplicity, we can study the lossy case for γe = γm amd ωmo = 0 (although we don't\nreally simulate the same medium, the fundamental behavior is similar, and simpler to carry out\nmathematically).\nThe model therefore reads:\nεr = μr = ω2 -ω2\np + iγω\nω2 + iγω\n.\n(23)\nWe compute:\n√εrμr = ω2 -ω2\np + iγω\nω2 + iγω\n= [ω2 -ω2\np + iγω] [ω2 -iγω]\nω4 + γ2ω2\n= ω2(ω2 -ω2\np) + γ2ω2 + iγωω2\np\nω4 + γ2ω2\n.\n(24a)\nThe real part is given by:\nR{√εrμr} = ω2[ω2 -(ω2\np -γ2)]\nω4 + γ2ω2\n.\n(25)\nLosses have the effect to lower the plasma frequency to\nωp′ =\nq\nω2p -γ2 .\n(26)\nIn addition, we also see that if γ is very large, the plasma effect will completey dissapear\n(cf. dispersion relation for γ = 10e10 rad/s)."
    },
    {
      "category": "Resource",
      "title": "Feb26.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-635-advanced-electromagnetism-spring-2003/71336fa7276ef390da7b9fad9dc953bf_Feb26.pdf",
      "content": "Green's functions for planarly layered media\nMassachusetts Institute of Technology\n6.635 lecture notes\nIntroduction: Green's functions\nThe Green's functions is the solution of the wave equation for a point source (dipole). For scalar\nproblems, the wave equation is written as (k0 = ω√εμ):\n(∇2 + k2\n0) g( r, r′) = -δ( r - r′) ,\n(1)\nand the solution for an unbounded medium is:\ng( r, r′) = eik0| r- r′|\n4π| r - r′| .\n(2)\nFrom Maxwell's equations in frequency domain with an eiωt dependency, the wave equation\nfor electric field E( r) is:\n∇× ∇× E( r) -k2\n0 E( r) = iω J( r) ,\n= 0\nfor source free case .\n(3)\nTherefore, the free-space dyadic Green's function satisfies\n∇× ∇× G( r, r′) -k2\n0G( r, r′) = I δ( r - r′) ,\n(4)\nwhich solution is\nG( r, r′) =\nμ\nI + 1\nk2\n∇∇\n¶\ng( r, r′) ,\n(5)\n(check using ∇× ∇× (Ig) = ∇∇g -∇· (∇g)I and Eq. (1)).\nFor the use of Green's functions in scattering problems, it is useful to express the Green's\nfunction in the same coordinates as the problem, which can be rectangular, cylindrical, spherical,\netc. Here we shall concentrate on the rectangular representation (Cartesian).\n\nSection 2. Cartesian coordinates\nCartesian coordinates\n2.1\nScalar Green's function\nThe formulae are derived from Eq. (1) and the Fourier transform of the quantities:\ng( r, r′) =\n(2π)3\nZZZ +inf\n-inf\nd k ei k·( r- r′) g( k) ,\n(6a)\nδ( r - r′) =\n(2π)3\nZZZ +inf\n-inf\nd k ei k·( r- r′) ,\n(6b)\nwhere k = kxˆx + kyˆy + kzˆz and d k = dkxdkydkz.\nUpon using Eq. (1), we write:\n(∇2 + k2\n0)\nZZZ +inf\n-inf\nd k ei k·( r- r′) g( k) = -\nZZZ +inf\n-inf\nd k ei k·( r- r′) ,\n(7)\nIntroducing the differential operator (∇2 =\n∂2\n∂x2 + ∂2\n∂y2 + ∂2\n∂z2 ) we write:\n(∇2 + k2\n0)\nZZZ +inf\n-inf\nd k ei k·( r- r′) g( k) =\nZZZ +inf\n-inf\nd k (∇2 + k2\n0)ei k·( r- r′) g( k)\n=\nZZZ +inf\n-inf\nd k (-k2\nx -k2\ny -k2\nz + k2\n0)ei k·( r- r′) g( k)\n= -\nZZZ +inf\n-inf\nd k ei k·( r- r′) ,\n(8)\nfrom which we conclude that\ng( k) =\nk2x + k2y + k2z -k2\n.\n(9)\nUsing Eq. (6a), we therefore need to evaluate the following integral:\ng( r, r′) =\n(2π)3\nZZZ +inf\n-inf\ndkxdkydkz\nk2x + k2y + k2z -k2\nei k·( r- r′) .\n(10)\nNote that Eq. (10) can be integrated along one of the three axis. In remote sensing applica-\ntion, the vertical axis is usually taken to be the z axis, (xy) being the transverse plane (planar\ncomponents). We therefore choose to evaluate Eq. (10) along kz, and we split:\nk = kxˆx + kyˆy + kzˆz = k⊥+ kzˆz ,\n(11a)\nr = r⊥+ zˆz ,\n(11b)\nr′ = r′\n⊥+ z′ˆz .\n(11c)\n\nWe will perform the integral of Eq. (10) in the complex plane, using Cauchy's theorem and\nthe Residue theorem. Before doing this, we have to be careful not to have divergent integrals.\nSince we integrate in kz, the condition is:\nlim\nkz→infeikzz < +inf.\n(12)\nIf we write kz as kz = k′\nz + ik′′\nz (k′\nz ∈R, k′′\nz ∈R), we see that\n- if z > 0, we have to choose k′′\nz > 0, which means that for complex plane integration, we\nneed to deform the contour into the upper plane.\n- if z < 0, we have to choose k′′\nz < 0, which corresponds to a deformation into the lower\nplane.\nIn addition, we see from Eq. (10) that the integrand has a pole at\nk2\n0z = k2\n0 -k2\nx -k2\ny = k2\n0 -k2\n⊥.\n(13)\nWe therefore need to evaluate Eq. (10) via the Residue theorem.\nCalculus: let us just write the integral in dkz for z > 0:\nZ +inf\n-inf\nk2z -k2\n0z\nei k·( r- r′) = 2iπ Res\n·\nk2z -k2\n0z\nei k·( r- r′)\n\n= 2iπ\nlim\nkz→k0z\nkz -k0z\n(kz -k0z)(kz + k0z) ei k⊥·( r⊥- r′\n⊥) eikz(z-z′)\n= 2iπ\n2k0z\nei k⊥·( r⊥- r′\n⊥) eik0z (z-z′) ,\n(14)\nso that\ng( r, r′) =\ni\n(2π)2\nZZ\ninf\n-inf\nd k⊥\n2k0z\nei k⊥·( r⊥- r′\n⊥) eik0z (z-z′) ,\nfor z -z′ > 0.\n(15)\nThe treatment for z < 0 follows the same reasoning so that we write for all (z -z′):\n∀(z -z′) ∈R,\ng( r, r′) =\ni\n(2π)2\nZZ\ninf\n-inf\nd k⊥\n2k0z\nei k⊥·( r⊥- r′\n⊥) eik0z |z-z′| .\n(16)\n2.2\nDyadic Green's function\nFrom Eq. (16) and Eq. (26), we can get the dyadic Green's functions.\nNote that ∇∇is a dyadic operator (give a dyad when applied to a scalar) and can be\nexchanged with the integral sign. In addition, it only applies to the exponential terms so that\nwe actually need to evaluate:\n∇∇\n·\nei k⊥·( r⊥- r′\n⊥) eik0z |z-z′|\n\n(17)\n\n2.2\nDyadic Green's function\nor, by a simple change of variables:\n∇∇\n·\nei k⊥· r⊥eik0z |z|\n\n(18)\nCalculus: Let us first consider z > 0 and\n∇∇(ei k⊥· r⊥eik0z |z|) = ∇∇f(x, y, z) .\n(19)\nVarious derivatives will be:\n-\n∂\n∂x\n∂\n∂xf(x, y, z) = -k2\nx f(x, y, z) ,\n-\n∂\n∂x\n∂\n∂yf(x, y, z) = -kxky f(x, y, z) ,\n- . . .\nand identically for z < 0. At z = 0 however,\n∂2\n∂z2 eik0z |z| = ∂\n∂z\n1⁄2\nik0z eik0z |z| ∂\n∂z |z|\n3⁄4\n= ik0z\n1⁄2\nik0z eik0z |z|\nμ ∂\n∂z |z|\n¶2\n+ ik0z eik0z |z| ∂2\n∂z2 |z|\n3⁄4\n= 2ik0zδ(z) -k2\n0z eik0z |z| .\n(20)\nUsing these results, we write:\n∂2\n∂z2 g( r) =\ni\n(2π)2\nZZ\ninf\n-inf\nd k⊥\n2k0z\nei k⊥· r⊥\n·\n2ik0zδ(z) -k2\n0z eik0z |z|\n\n= -δ(z)\n(2π)2\nZZ\ninf\n-inf\nd k⊥ei k⊥· r⊥-\ni\n8π2\nZZ\ninf\n-inf\nd k⊥k0z ei k⊥· r⊥eik0z |z|\n= -δ( r) -\ni\n8π2\nZZ\ninf\n-inf\nd k⊥k0z ei k⊥· r⊥eik0z |z| .\n(21)\nAgain, all the other terms of ∇∇applied to the integrand give - k k so that the Green's\nfunction becomes:\nG( r, r′) = -ˆzˆz δ( r)\nk2\n+\ni\n8π2\n\nZZ\ninf\n-inf\nd k⊥\nk0z\n·\nI -\nk k\nk2\n\nei k· r\nfor z > 0 ,\nZZ\ninf\n-inf\nd k⊥\nk0z\n·\nI -\nK K\nk2\n\nei\nK· r\nfor z < 0 ,\n(22)\nwhere\nk = kxˆx + kyˆy + k0z ˆz ,\n(23a)\nK = kxˆx + kyˆy -k0z ˆz .\n(23b)\nSome notes:\n\n1. The Dirac delta function is known as the singularity of the Green's function and is impor-\ntant in calculating the fields in the source region.\n2. The different signs ensure that the integral converges for evanescent waves, i.e.\nwhen\nk2\nx + k2\ny > k2\n0.\n3. The square bracket in the expression of the Green's functions can be expressed in terms\nof superposition of TE and TM waves, as we shall see.\n2.3\nSuperposition of TE and TM waves\nBased on k, we can form an orthonormal system for TE/TM polarized waves:\nTE:\nˆe(k0z) =\nk × ˆz\n| k × ˆz| =\nq\nk2x + k2y\n[ˆxky -ˆykx] = 1\nkρ\n(ˆxky -ˆykx) ,\n(24a)\nTM:\nˆh(k0z) = 1\nk0\nˆe(k0z) × k = -k0z\nkokρ\n(ˆxky + ˆykx) + kρ\nko\nˆz .\n(24b)\nThe three vectors ˆk, ˆh and ˆe form an orthonormal system, in which:\nI = ˆkˆk + ˆe(k0z)ˆe(k0z) + ˆh(k0z)ˆh(k0z) .\n(25)\nAfter translating to the origin, we get for the dyadic Green's functions:\nG( r, r′) = -ˆzˆz δ( r)\nk2\n+ i\n8π2\n\nZZ\ninf\n-inf\nd k⊥\nk0z\n·\nˆe(k0z)ˆe(k0z) + ˆh(k0z)ˆh(k0z)\n\nei k·( r- r′)\nfor z > z′ ,\nZZ\ninf\n-inf\nd k⊥\nk0z\n·\nˆe(-k0z)ˆe(-k0z) + ˆh(-k0z)ˆh(-k0z)\n\nei\nK·( r- r′)\nfor z < z′ ,\n(26)\nwhere\nˆe(-k0z) = ˆe(k0z) ,\n(27a)\nˆh(-k0z) = ˆe(-k0z) × K\nk0\n.\n(27b)\n(Note that K, ˆe(-k0z) and ˆh(-k0z) form another orthonormal set of vectors about K).\n2.4\nTreatment of layered media\nDepending upon the medium under study and the location of the source, the kernel of Eq. (26)\nwill have to be modified. To make it more clear, we can gather the terms in the Green's function\nrelative to the source (primed coordinates) and those relative to the source.\n\n2.4\nTreatment of layered media\nG( r, r′)=-ˆzˆz δ( r)\nk2\n+\ni\n8π2\n\nRR inf\n-infd k⊥\nk0z {[ˆe(k0z ) ei k· r] ˆe(k0z ) e-i k r′+[ˆh(k0z ) ei k· r] ˆh(k0z ) e-i k r′}\nfor z > z′ ,\nRR inf\n-infd k⊥\nk0z {[ˆe(-k0z ) ei\nK· r] ˆe(-k0z ) e-i\nK r′+[ˆh(-k0z ) ei\nK· r] ˆh(-k0z ) e-i\nK r′}\nfor z < z′ ,\n(28)\nIf we now consider a layered medium problem, with an arbitrary number of layers and a\nsource in the top region (incident wave), we write:\nG( r, r′)i0 =\ni\n8π2\nZZ\ninf\n-inf\ndkxdky\nk0z\n1⁄2\nKe ˆe(-k0z) e-i\nK· r′ + Kh ˆh(-k0z) e-i\nK· r′3⁄4\n(29)\nwith\n1. For z < z′, i = 0:\nKe =ˆe(-k0z) ei\nK· r + RTE ˆe(k0z) ek0z ei k· r\n(30a)\nKh =ˆh(-k0z) ei\nK· r + RTM ˆh(k0z) ek0z ei k· r\n(30b)\n2. For region l, i = l:\nKe =Alˆe(klz) ei kl· r + Blˆe(-klz) ei\nKl· r\n(31a)\nKh =Clˆh(klz) ei kl· r + Dlˆh(-klz) ei\nKl· r\n(31b)\n(31c)\n3. For region t, i = t:\nKe =T TE ˆe(-ktz) ei\nKt· r\n(32a)\nKh =T TM ˆh(-ktz) ei\nKt· r\n(32b)\n(32c)\nwhere\nklz =\nq\nk2\nl-k2x -k2y ,\n(33a)\nkl=ˆxkx + ˆyky + ˆzklz ,\n(33b)\nKl=ˆxkx + ˆyky -ˆzklz ,\n(33c)\nand the coefficients Al, Bl, Cland Dlare determined from the boundary conditions.\nThe boundary conditions apply to the tangential electric and magnetic fields. Thus, in\nterms of Green's functions, we need to satisfy the continuity of ˆz × G( r, r′) and ˆz × ∇×\n\nG( r, r′). Let us write this at the interface between media (l) and (l+ 1), by separating\nthe TE and TM components:\nAleiklz z + Ble-iklz z = Al+1 eiklz z + Bl+1 e-iklz z\n(34a)\nklz\n·\nAleiklz z -Ble-iklz z\n\n= kzl+1\n·\nAl+1 eiklz z -Bl+1 e-iklz z\n\n(34b)\nklz\nkl\n·\nAleiklz z -Ble-iklz z\n\n= kzl+1\nkl+1\n·\nAl+1 eiklz z -Bl+1 e-iklz z\n\n(34c)\nklz\n·\nCleiklz z + Dle-iklz z\n\n= kzl+1\n·\nCl+1 eiklz z + Dl+1 e-iklz z\n\n(34d)\nWith the conditions in the first and last layer as:\nA0 = RTE ,\nB0 = 1 ,\nC0 = RTM ,\nD0 = 1 ,\n(35a)\nAt = 0 ,\nBt = T TE ,\nCt = 0 ,\nDt = T TM .\n(35b)\nBefore evaluating these coefficients, we can build a recursive scheme to calculate the ampli-\ntudes from region lto region l+ 1.\nFor example, it is straightforward to build a propagation matrix for TE modes from Eq. (34a)\nand (34b):\nA\nAl+1 eikzl+1dl+1\nBl+1 e-ikzl+1dl+1\n!\n= V\nTE\nA\nAleikzldl\nBle-ikzldl\n!\n(36)\nA similar procedure of course applied to the TM modes:\nA\nCl+1 eikzl+1dl+1\nDl+1 e-ikzl+1dl+1\n!\n= V\nTM\nA\nCleikzldl\nDle-ikzldl\n!\n(37)\nIn order to end up the recursive method, we have to express the reflection and transmission\ncoefficient in the first and last regions, respectively. We shall only illustrated this point here, as\nit has been developed in previous classes.\nLet us consider a plane wave incident from region 0, with its plane of incidence parallel to\nthe (xy) plane. All fields vectors are independent on y, so that\n∂\n∂y = 0 in Maxwell's equations.\nThus, we can decompose the fields into their TE and TM components. We get in region l:\n- TE modes:\nHlx = -\niωμl\n∂\n∂z Ely ,\n(38a)\nHlz =\niωμl\n∂\n∂xEly ,\n(38b)\nμ ∂2\n∂x2 + ∂\n∂y + ω2εlμl\n¶\nEly = 0 .\n(38c)\n\n2.4\nTreatment of layered media\n- TM modes:\nElx = 1\niωεl\n∂\n∂z Hly ,\n(39a)\nElz = -\niωεl\n∂\n∂xHly ,\n(39b)\nμ ∂2\n∂x2 + ∂\n∂y + ω2εlμl\n¶\nHly = 0 .\n(39c)\nFor a TE wave inside the stratified medium:\nEly =(Aleiklz z + Ble-iklz z) eikxx ,\n(40a)\nHlx = -klz\nωμl\n(Aleiklz z -Ble-iklz z) eikxx ,\n(40b)\nHlz = kx\nωμl\n(Aleiklz z + Ble-iklz z) eikxx .\n(40c)\nBy matching the boundary conditions, and upon using the already known notation\npl(l+1) =μlkz(l+1)\nμl+1klz\n,\n(41a)\nRl(l+1) =1 -pl(l+1)\n1 + pl(l+1)\n.\n(41b)\nwe get the recursive relation:\nAl\nBl\n= e2iklz dl\nRl(l+1)\n+\n[1 -1/R2\nl(l+1)] e2i[k(l+1)z+klz ]dl\n1/Rl(l+1) e2ik(l+1)zdl+ Al+1\nBl+1\n,\n(42)\nwith the limiting condition:\nAt\nBt\n= 0, ,\nA0\nB0\n= R .\n(43)\nExample: for a two-layer medium (t = 2):\nR = R01 + R12e2ik1z (d1-d0)\n1 + R01R12e2ik1z (d1-d0) e2ikzd0 .\n(44)"
    },
    {
      "category": "Resource",
      "title": "Mar31.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-635-advanced-electromagnetism-spring-2003/fc8624536d2fb8c589402e5dd4d3a746_Mar31.pdf",
      "content": "Study of EM waves in Periodic Structures: Photonic Crystals and\nNegative refraction\nMassachusetts Institute of Technology\n6.635 lecture notes\nIntroduction\nIn the previous class, we have introduced various concepts necessary for the study of EM waves\nin photonic crystal structures. We shall now use these concepts to explain various results such\nas:\n- Reconstruction of the permittivity profile.\n- The band diagrams for rectangular and triangular lattices.\n- k-surfaces for various eigenvalues.\nIn particular, we will show an example of how a periodic structure can exhibit k-surfaces typical\nof a negative refraction material (the concept of k-surface for left-handed materials was first\nintroduced in the class of February 24, 2003).\nThis class is based on the following two references::\n[1]\nC. Luo, S. G. Johnson, and J. D. Joannopoulos, \"All-angle negative refraction with-\nout negative effective index\", Physical Review B, vol. 65, 2002, #201104.\n[2]\nJ. D. Joannopoulos, R. D. Meade, and J. N. Winn, \"Photonic Crystals, Molding the\nFlow of Light\", Princeton University Press, 1995.\nRetrieving the permittivity\nWe have presented already the way to calculate the Fourier coefficients of the permittivity for\ncylindrical inclusions, with circular cross-section (see section 5 of March 19 2003 notes). An\nexample was also given in Fig. 7. We shall just briefly comment on this.\nIt is known already that a photonic crystal is defined by a lattice (rectangular, triangular, . . . )\nand a basis (the shape of the inclusion). Both have to be incorporated in the retrieval of ε for\nexample. In the treatment presented last time (section 5 of the reference mentioned above) we\nobtained the Fourier coefficients of the permittivity for a specific lattice (square). The result\nwas:\n\nSection 2. Retrieving the permittivity\nε(Gρ) =\n\nεafr + εb(1 -fr)\nif Gρ = 0\n(εa -εb)fr\n2J1(GρRc)\nGρRc\nelsewhere.\n(1)\nYet, the information on the basis is also included in Eq. (1), since both Gρ and fr will depend\non it.\nIt is straightforward to show that:\nSquare lattice: fr = π\nμRc\na\n¶2\n(where Rc is the radius of the inclusions and a the\nlattice constant).\nTriangular lattice: fr = 2π\n√\nμRc\na\n¶2\n.\nAn illustration for square and triangular lattices is given in Fig. 1 (note that since the\npermittivity is obtained from its Fourier coefficients, a unavoidable Gibbs phenomenon will\noccur).\n(a) Square lattice (fr = 38.48%).\n(b) Triangular lattice (fr = 44.43%).\nFigure 1: Reconstruction of the permittivity for cylindrical rods of circular cross-\nsection for (a) a square lattice and (b) a rectangular lattice. Other parameters are:\nεa = 1, εb = 12, Rc/a = 0.35.\n\nBand diagrams\nThe purpose of all the mathematical developments presented so far (getting the Fourier coef-\nficients of the permittivity, building the eigensystem, etc) is to eventually obtain the eigenval-\nues and eigenvectors of the problem. Eigenvalues correspond to dispersion diagrams whereas\neigenvectors correspond to the actual field distributions. We shall limit ourselves here to the\nconsideration of eigenvalues only.\nUpon solving the eigensystem:\nΘ H( r) =\nμωk\nc\n¶2\nH( r) ,\n(2a)\nΘ = ∇×\n· 1\nε( r)∇×\n\n,\n(2b)\n(with the condition ∇· H( r) = 0 to reduce the size of the system), we get a set of eigenvalues\nfor each incident k. The band diagrams are then constructed by sweeping all possible k.\nBecause of the periodicity of the medium the \"all possible\" k can be reduced to the first\nBrillouin zone and, by symmetry, further reduced to the irreducible Brillouin zone. In addition,\nas we have seen, it is also enough to span the edge of the Brillouin zone since it corresponds to\nthe maximum diffraction condition. Again by symmetry, we further reduce the domain to the\nedge of the irreducile Brillouin zone.\nThis zone will of course depend on the lattice, as is shown in Figs 2 and 3 of the March 19\n2003 notes. For both cases, the irreducible Brillouin zone is depicted in Fig. 2.\nΓ\nX\nM\n(a) Square lattice.\nΓ\nK\nM\n(b) Triangular lattice.\nFigure 2: Irreducible Brillouin zones (red region) for (a) a square lattice and (b) a\ntriangular lattice. Each region is defined between symmetry points of the crystal.\nIn order to span the edge of the irreducible Brillouin zone, we therefore need to know the\ncoordinates of the symmetry points of the crystal. It is easy to show that:\n\nSection 3. Band diagrams\n- Square lattice:\nΓ →(kx = 0, ky = 0) ,\n(3a)\nX →(kx = π\na, ky = 0) ,\n(3b)\nM →(kx = π\na, ky = π\na) .\n(3c)\n- Triangular lattice:\nΓ →(kx = 0, ky = 0) ,\n(4a)\nK →(kx = 2π\n3a, ky = 2π\n√\n3a) ,\n(4b)\nM →(kx = 0, ky = 2π\n√\n3a) .\n(4c)\nHaving these limit points, we can sweep k, solve the eigensystem and obtain the eigenvalues.\nAn example is given in Fig. 3.\n\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\n0.7\n0.8\n0.9\nFrequency ω a/2π c\nSquare lattice: Rc/a = 0.48 (f=72.3823%), εa=1, εb=13.\nTE\nTM\nΓ\nΓ\nX\nM\n(a) Square lattice.\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\n0.7\n0.8\n0.9\nFrequency ω a/2π c\nHexagonal lattice: Rc/a = 0.48 (f=83.5799%), εa=1, εb=13.\nTE\nTM\nΓ\nΓ\nM\nK\n(b) Triangular lattice.\nFigure 3: Band diagram for TE and TM modes as function of the normalized fre-\nquency for (a) a square lattice and (b) a triangular lattice. Notice the absolute band\ngap for TM modes. Parameters are: εa = 1, εb = 13, Rc/a = 0.48. Important note:\nTE modes are here defined as transverse to the axis of the crystal (z axis), therefore\nwith an in-plane electric field!! Note also that these curves have not yet fully reached\nconvergence.\n\nSection 4. k-surfaces\nk-surfaces\n4.1\nWell-chosen example\nWe can generalize the band diagram of the previous section (which, again, spans only the edge\nof the Brillouin zone), to the entire zone or even to the entire photonic crystal.\nThe example we shall consider from now on is taken from [1] and the parameters are sum-\nmarized in Tab. 1. In addition, we shall work with TE modes (remember that in this notation,\nTE corresponds to an in-plane electric field).\nLattice:\nsquare\nInclusions:\nεa = 1\nBackground:\nεb = 12\nRadius :\nRc/a = 0.35\nTable 1: Parameters for our example [1].\nThe band diagram obtained for this case is depicted in Fig. 4.\n0.1\n0.2\n0.3\n0.4\n0.5\nFrequency ω a/2π c\nSquare lattice: Rc/a = 0.35 (f=38.4845%), εa=1, εb=12.\nTE\nX\nM\nFigure 4: Band diagram for TE modes for the structure defined in Tab. 1.\nThe\nhorizontal line is at the frequency corresponding to a change of curvature of the k-\nsurface, and the green line is the light-line shifted to M.\n.\n\nWe can also extend the plot from the edge of the irreducible Brillouin zone to the entire\nstructure, for various eigenstates. This is represented in Figs. 5 to 7.\n4.2\nNegative refraction\nFrom the k-surfaces shown in the figures of this section, we see that there is the potential of\nnegative refraction (the iso-frequency surfaces converge to a point as frequency increases). Yet,\nwe need to make sure that:\n1. We can couple to one of these surfaces from free-space.\n2. The power is bending on the same side of the normal.\nAnswer to both points is shown in Fig. 4.\n1. Light-line: the light-line gives the radius of the k-surface of an EM wave impinging on\nthe crystal from free-space. In order to have a possible coupling, whole (or part) of the\nfree-space k-surface has to be included in one of the k-surfaces of the crystal. The light-line\nis represented in Fig. 4 by the green line (it is actually the translation of the light-line to\nM). Its intersection with say the curve of the first eigenvalue gives the maximal frequency\nfor which the condition mentioned above (total inclusion of the free-space k-surface into a\nk-surface of the crystal) is satisfied.\nNote also that in order to have a negative refraction, the free-space k-surface has to be\nincluded in one of the k-surfaces converging to M and therefore, the actual crystal needs\nto be rotated by 45*.\n2. Power bending: around M, the power is converging to a single point when frequency is\nincreased. Yet, the direction of the power can be deduced from the gradient of the k-curves\nand therefore, directly from their radius of curvature. Hence, if the radius of curvature is\nsuch that the gradient is pointing toward M, the refraction will be negative.\nThe frequency at which the radius of curvature diverge is given by the horizontal line in\nFig. 4, which can be obtained by a direct inspection of Fig. 5(c).\nAs it can be seen, the power can bend on the opposite side of the normal. However, the\nphase is still propagating forward, which justifies the title of the paper: \"All-angle negative\nrefraction without negative index\".\nWe can also examine the second eigenvalue and see if a similar phenomenon can appear. The\nk-surface has been depicted in Fig. 6(b) and is shown again in Fig. 9 with less curves represented.\nIt is clear from this figure that again, there is a point at which the radius of curvature of the\nk-curves changes, and energy converges to a single point (Γ this time) as frequency increases.\nIt is therefore again possible to have a negative index of refraction. Notice that in this case\n\n4.2\nNegative refraction\n-4000\n-2000\n-4000\n-2000\n0.05\n0.1\n0.15\n0.2\n0.25\nSqu. lattice. Band of eigenvalue nb 1. Rc/a = 0.35 (f=38.4845%), εa=1, εb=12.\n(a) Brillouin cell.\n(b) All structure.\nSqu. lattice. Band of eigenvalue nb 1. Rc/a = 0.35 (f=38.4845%), εa=1, εb=12.\n0.02\n0.04\n0.06\n0.08\n0.1\n0.12\n0.14\n0.16\n0.18\n0.2\n0.22\n(c) 2D k-surface.\nFigure 5: k-surfaces for the first eigenvalue of the system.\n\n-4000\n-2000\n-4000\n-2000\n0.26\n0.28\n0.3\n0.32\n0.34\n0.36\nSqu. lattice. Band of eigenvalue nb 2. Rc/a = 0.35 (f=38.4845%), εa=1, εb=12.\n(a) Brillouin cell.\nSqu. lattice. Band of eigenvalue nb 2. Rc/a = 0.35 (f=38.4845%), εa=1, εb=12.\n0.28\n0.29\n0.3\n0.31\n0.32\n0.33\n0.34\n(b) 2D k-surface.\nFigure 6: k-surfaces for the second eigenvalue of the system.\nhowever, because of phase matching, power and phase are in directions that make an angle\ngreater than π/2. Although it is not necessarily π like in a pure left-handed regime, it is still in\nthe regime of left-handed behavior. Fig. 10 can be completed to see this phenomenon.\n\n4.2\nNegative refraction\n-4000\n-2000\n-4000\n-2000\n0.38\n0.39\n0.4\n0.41\n0.42\n0.43\n0.44\n0.45\nSqu. lattice. Band of eigenvalue nb 3. Rc/a = 0.35 (f=38.4845%), εa=1, εb=12.\n(a) Brillouin cell.\nSqu. lattice. Band of eigenvalue nb 3. Rc/a = 0.35 (f=38.4845%), εa=1, εb=12.\n0.395\n0.4\n0.405\n0.41\n0.415\n0.42\n0.425\n0.43\n0.435\n(b) 2D k-surface.\nFigure 7: k-surfaces for the third eigenvalue of the system.\n\nSqu. lattice. Band of eigenvalue nb 2. Rc/a = 0.35 (f=38.4845%), εa=1, εb=12.\n0.25\n0.26\n0.27\n0.28\n0.29\n0.3\n0.31\nFigure 9: k-surface for the second eigenvalue.\n\n4.2\nNegative refraction\nSqu. lattice. Band of eigenvalue nb 2. Rc/a = 0.35 (f=38.4845%), εa=1, εb=12.\n-0.6\n-0.4\n-0.2\n0.2\n0.4\n0.6\n0.8\n1.2\nFigure 10: k-surface for the second eigenvalue for the specific frequency where the\nradius of curvature is positive."
    }
  ]
}