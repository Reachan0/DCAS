{
  "course_name": "High Speed Communication Circuits and Systems",
  "course_description": "6.976 covers circuit and system level design issues of high speed communication systems, with primary focus being placed on wireless and broadband data link applications. Specific circuit topics include transmission lines, high speed and low noise amplifiers, VCO’s, and high speed digital circuits. Specific system topics include frequency synthesizers, clock and data recovery circuits, and GMSK transceivers. In addition to learning analysis skills for the above items, students will gain a significant amount of experience in simulating circuits in SPICE and systems in CppSim (a custom C++ simulator).",
  "topics": [
    "Engineering",
    "Computer Science",
    "Computer Design and Engineering",
    "Computer Networks",
    "Electrical Engineering",
    "Digital Systems",
    "Telecommunications",
    "Engineering",
    "Computer Science",
    "Computer Design and Engineering",
    "Computer Networks",
    "Electrical Engineering",
    "Digital Systems",
    "Telecommunications"
  ],
  "syllabus_content": "Course Meeting Times\n\nLectures: 2 sessions / week, 1.5 hours / session\n\nTextbooks\n\nRequired\n\nLee, Thomas H.\nThe Design of CMOS Radio-Frequency Integrated Circuits\n. Cambridge, UK: Cambridge University Press, 1997. ISBN: 0521835399.\n\nRazavi, Behzad.\nRF Microelectronics\n_._ Upper Saddle River, NJ: Prentice Hall, 1998. ISBN: 0138875715.\n\nAdditional References (Not Required, but Helpful)\n\nKelley, Al, and Ira Pohl.\nA Book on C\n_._ Redwood City, CA: Benjamin Cummings_,_ 1995 or later. ISBN: 0805316779.\n\nGonzalez, Guillermo.\nMicrowave Transistor Amplifiers: Analysis and Design\n_._ Upper Saddle River, NJ: Prentice Hall, 1996. ISBN: 0132543354.\n\nRabaey, Jan.\nDigital Integrated Circuits: A Design Perspective\n_._ Upper Saddle River, NJ: Prentice Hall, 1995. ISBN: 0131786091.\n\nCourse Format\n\nTwo 1 1/2 hour lectures per week. Problem sets (6 total) given out every one to two weeks - they will be project-oriented and involve a combination of analytical derivations and simulation in Hspice and CppSim (A C++ system level simulator). Project 1 will be focused on the design and SPICE simulation of a high speed frequency divider for phase-locked loop applications. Project 2 will be focused on the design and CppSim simulation of a GMSK transceiver for wireless applications. A midterm exam will be given. There is no final exam.\n\nGrades\n\nActivities\n\nPercentages\n\nQuiz\n\n35%\n\nProject 1\n\n15%\n\nProject 2\n\n15%\n\nHomework\n\n35%\n\nPrerequisites\n\n6.301 or 6.775 (or equivalent) and 6.011 or 6.341 (or equivalent).",
  "files": [
    {
      "category": "Resource",
      "title": "hw1.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/f6430f2c14b336d924c3b218d909a56d_hw1.pdf",
      "content": "Massachusetts Institute of Technology\nDepartment of Electrical Engineering and Computer Science\n6.976\nHigh Speed Communication Circuits and Systems\nSpring 2003\nHomework #1: S-parameters, transformers, ISI, and eye diagrams\nc\nCopyright 2003 by Michael H. Perrott\nReading: Chapters 4-6 of Thomas H. Lee's book, CppSim manual, Hspice toolbox manual.\n1. Consider the high speed trace and it's associated two-port model shown in Figure 1.\nIn the model, the transmission line corresponds to the RF connector and PCB trace\n(both assumed to be ideal), C1 is the capacitance of the package pin to the package\nsubstrate and adjoining pins, L1 is the bondwire inductance, C2 is the on-chip pad\ncapacitance, and RL is the on-chip termination resistor. For all calculations to follow,\nit assumed that the source driving impedance is precisely matched to the transmission\nline characteristic impedance, Ro.\nVout\nC1\nRL\nL1\nDelay = x\nCharacteristic Impedance = Ro\nIdeal Transmission Line\nRo\nVin\nTwo-Port Model\nC2\nEi1\nEr1\nEi2\nEr2\ndie\nAdjoining pins\nConnector\nControlled Impedance\nPCB trace\npackage\nOn-Chip\nDriving\nSource\nHigh Speed Trace (RF Connector to Chip Die)\nFigure 1: Example high speed trace and associated 2-port model.\nCalculate S11 and S21 for each of the following cases:\n(a) Ro = 50 Ohms, x = 0 ps, C1 = 0.0 pF, L1 = 0 nH, C2 = 0 pF, RL = 55 Ohms\n(b) Ro = 50 Ohms, x = 0 ps, C1 = 0.0 pF, L1 = 0 nH, C2 = 1 pF, RL = 55 Ohms\n(c) Ro = 50 Ohms, x = 100 ps, C1 = 0.0 pF, L1 = 0 nH, C2 = 1 pF, RL = 55 Ohms\n\n(d) Ro = Zo, x = delay, C1 = C1, L1 = L1, C2 = C2, RL = ZL\n(e) Using CppSim on Athena, verify part(c) by simulating the impulse response of the\nsystem using the hw1 1e i (C1 = 0.0 pF)and hw1 1e ii (C1=1.0 pF) cells within\nthe CppExamples Cadence library and its associated test.par files in the UNIX\ndirectory ∼/CppSim/SimRuns/CppExamples. Based on the simulation results,\nplot the magnitude and phase of S11(f ) and S21(f ) for both cases.\n2. The following problem is taken from problem 2 of Chapter 4 from Thomas Lee's book.\nSuppose we wish to deliver 1 Watt of power into a 50 Ohm load at 1 GHz, but are\nconstrained to using a power amplifier that has a peak-to-peak sinusoidal voltage of\nonly 3 V due to transistor breakdown issues. Design the following matching newworks\nto allow that 1 W to be delivered. Use lowpass versions in all cases, and assume that\nall reactive elements are ideal.\n(a) L-match\n(b) π-match (Q = 10)\n(c) T-match (Q = 10)\n(d) Tapped capacitor (Q = 10)\n(e) If the maximum allowable on-chip capacitance is 200 pF and the maximum al\nlowable on-chip inductance is 20 nH, are any of your designs amenable to a fully\nintegrated implementation? If so, which one(s)?\n3. Simulate the transformer networks computed in Problem 2 in Hspice on Athena. Be\nsure to use Cadence for design entry as specified in the documents handed out in class.\nAssume that the source driving impedance is a resistor that matches the nominal input\nimpedance of the transformer at 1 GHz. Adjust the input source voltage such that 3\nV peak-to-peak exist at the inputs of the transformer networks.\nBased on the Hspice results, compute and plot S21 of each transformer network (from\ntransformer input to output) across the frequency range of 900 MHz to 1.1 GHz. Com\nmment on the differences between the performance of each transformer. (Note: you\nshould reference the input as the signal source rather than the input to the transformer\n- why?)\n4. Now consider the high speed trace and it's associated two-port model shown in Fig\nure 2, which is similar to that examined in Problem 1. In this case, we will relate the\ntransmission line parameters to physical PCB characteristics, simulate the system, and\nobserve eye diagrams of high speed data being sent across the trace. For all parts of\nthis problem, assume that C1 and L1 are zero unless otherwise noted.\n(a) Assuming that the PCB trace is a 0.5 ounce Microstrip whose dielectric has εr =\n4.4 and a height of 10 mils, use the web-based tool at http://www.emclab.umr.edu/pcbtlc\nto perform the following calculations (note: you must use Internet Explorer).\n\nVout\nC1\nL1\nDelay = 100 ps\nCharacteristic Impedance = 50 Ω\nIdeal Transmission Line\n100 Ω\nVin\nTwo-Port Model\nEi1\nEr1\nEi2\nEr2\ndie\nAdjoining pins\nConnector\nControlled Impedance\nPCB trace\npackage\nOn-Chip\nDriving\nSource\nHigh Speed Trace (RF Connector to Chip Die)\n55 Ω\n1 pF\nFigure 2: Example high speed trace and associated 2-port model.\ni. Determine the required width of the PCB trace to achieve 50 Ohms charac\nteristic impedance.\nii. Calculate how long the trace must be to match the assumed propogation\ndelay of 100 ps.\n(b) Using CppSim on Athena, simulate the step response of the system using the\nhw1 4b cell within the CppExamples Cadence library and its associated test.par\nfile in the UNIX directory ∼/CppSim/SimRuns/CppExamples.\ni. Label the cause of the first 5 steps in the overall step response.\nii. Why does the cap cause its respective reflection to go negative?\n(c) Using CppSim on Athena, simulate the response of the system to an input data se\nquence using the hw1 4c cell within the CppExamples Cadence library and its as\nsociated test.par file in the UNIX directory ∼/CppSim/SimRuns/CppExamples.\ni. Plot the eye diagram (spanning two data periods) corresponding to Vout for a\ndata rate of 1 Gb/s. Mark the ideal sampling point assuming a hard-decision\ndetector is used, and comment on the quality of the eye.\nii. Plot the eye diagram (spanning two data periods) corresponding to Vout for a\ndata rate of 10 Gb/s. Mark the ideal sampling point assuming a hard-decision\ndetector is used, and comment on the quality of the eye.\n(d) Create a new module to support the load having C1 and L1 with nonzero values.\nNote that the symbol is already provided as trline load2 in the Cadence library\nCppModules as well as a template of the module function in modules.par under\nthe same name. So, for this part of the homework, simply turn in the appropriate\ncode for module trline load2 in modules.par."
    },
    {
      "category": "Resource",
      "title": "hw2.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/ce5b2d6c8de249f1d4120b981c293dcf_hw2.pdf",
      "content": "Massachusetts Institute of Technology\nDepartment of Electrical Engineering and Computer Science\n6.976\nHigh Speed Communication Circuits and Systems\nSpring 2003\nHomework #2: High Speed Amplifiers\nc\nCopyright 2003 by Michael H. Perrott\nReading: Chapters 3 and 8 and pages 280-283 of Thomas H. Lee's book.\n1. The following is based on Problem 8 in Chapter 8 of Thomas Lee's book. Consider\nthe zero-peaked amplifier shown in Figure 1.\nVout\nC2\nR2\nR1\nM1\nC1\nVin\nFigure 1: Zero-peaked amplifier.\n(a) Derive the transfer function expression for the small-signal gain from Vin to Vout .\nIn your derivation, assume that M1 is in saturation, and ignore Cgd , ro, and\nbackgate parasitics.\n(b) Express the bandwidth of the amplifier as a function of the output pole,1/(R2C2),\nunder the assumption that gmR1 = 9 and C1 is chosen such that the zero cancels\nthe output pole in the gain expression derived above. Recognize that the output\npole frequency corresponds to the bandwidth of the unpeaked amplifier.\n2. The following is based on Problem 7 in Chapter 8 of Thomas Lee's book. In general,\nhigh-speed followers, as shown in Figure 2, have a tendency to ring or even oscillate\nwhen driving certain loads. Your task is to identify the conditions that may cause\nthis problem and to propose a solution. For derivations, ignore Cgd , ro, and backgate\nparasitics of M1.\n(a) Consider the follower circuit in part (a) of the figure. Derive an expression for\nZin .\n\nIbias\nZin\nVout\nM1\nL1\nM1\nZin\nVout\nVin\nVin\nC1\n(a)\n(b)\nFigure 2: Source follower with a (a) capacitive load, (b) inductive load.\n(b) Over what range of load capacitance can the real part of Zin , as derived above, be\nnegative? What is the impact of having the real part of the impedance become\nnegative?\n(c) Given that the load capacitance is chosen such that the real part of Zin becomes\nnegative, modify the circuit in part (a) of the figure such that the source Vin\nalways sees an impedance whose real part is positive. In your design, be sure to\npreserve the high speed operation of the follower circuit, and provide formulas for\nthe computation of the values of any components you add.\n(d) Now consider the follower circuit with an inductor load in part (b) of the figure,\nwhose analysis will also provide intuition of the impact of inductive source degen\neration on CE and CS circuits. Derive an expression for Zin under the assumption\nthat Cgd and ro of M1 can be ignored. Examining the real part of the derived\nimpedance, comment an whether ringing or oscillation problems can occur.\n3. This problem will focus on the design of the narrowband amplifier shown in Figure 3.\nAssume that all devices are the same size with width of 100 microns and length of 0.18\nmicrons. For all hand calculations, ignore Cgd , ro, backgate effects, and overlap for all\ntransistors.\nCL=1pF\n50 Ω\nVin\nM1\nM2\nLs\nLd\nLg\nCbig\nIbias = 1mA\nM3\nVout\n5 kΩ\nZin\nx\nFigure 3: A high speed, tuned cascode amplifier.\n\n(a) Compute Cgs and gm for all the transistors at the operating point set by the bias\nconfiguration shown in the figure. Be sure to determine these parameters \"by\nhand\" based on the transistor parameters contained in the 0.18u Hspice model\nfile provided on Athena in the file /mit/6.976/Models/0.18u/mos018.mod. For\nall parts to follow, use Cgs and gm from Hspice and also include the appropriate\nCdb .\n(b) Given that the Q of all of the inductors at 10 GHz at 5, determine Ls, Lg , and\nLd to achieve 50 Ohm input impedance (Zin ) and maximum gain (Vout /Vin ) at 10\nGHz. Use a simple inductor model of a resistor in series with an inductor. State\nthe maximum gain that you achieved.\n(c) Repeat part (b) given that the Q of all of the inductors at 10 GHz is 20. How\ndoes the maximum gain change?\n(d) Build the two circuits from (b) and (c) in Cadence on Athena and use Hspice and\nMatlab to plot Zin (real and imaginary parts) and the amplifier gain (Vout /Vin )\nover the frequency range of 1 GHz to 20 GHz.\n(e) Using Hspice and Matlab, compute and plot |S11| and |S21| over the frequency\nrange of 1 GHz to 20 GHz for both circuits in (d). For these exercises, assume\nthat the input of the two-port is node x, and that the output is Vout .\n4. This problem focuses on the design of the broadband differential amplifier shown in\nFigure 4 based on the techniques described in class. Perform all computations based\non the transistor models contained in the 0.18u Hspice model file provided on Athena\nin the file /mit/6.976/Models/0.18u/mos018.mod. For simplicity, assume all devices\nare the same size with transconductance gm, all resistors are of the same value R, and\nthat Cfixed, which corresponds to wiring capacitance, equals 15 fF.\nIbias\nM4\nM1\nM2\nM3\nVin+\nR1\nVin-\nR2\nVo+\nVo-\nM5\nM6 M7\nLoad\nCfixed\nCfixed\nFigure 4: A high speed differential amplifier.\n(a) Using Hspice and Matlab, plot the gm versus Id curve for a diode-connected NMOS\ndevice of width 2.0 microns and length 0.18 microns. The value of Id should span\n\nfrom 0 to the value produced when Vgs equals 1.8 V. Use Hspice LX7() function\nto extract gm from simulation.\n(b) Compute the value of Cgs for the transistor in part (a) under the assumption that\nthe NMOS device is in saturation.\n(c) Write a Matlab script that determines the value of Id at which the gm curve\ngenerated in part (a) intersects with the line (A/Vsw )Id, where A corresponds to\nthe single-ended amplifier gain (gmR), and Vsw corresponds to the single-ended\namplifier swing (Ibias R). State the value of Id that results with A = 5 and Vsw = 1\nV.\n(d) Based on the results in part (c), compute the bandwidth of the amplifier for the\ncase where A = 5 and Vsw = 1 V under the restriction that the device size has a\nwidth of 2 microns and a length of 0.18 microns.\n(e) Based on the results in part (c), what is the maximum bandwidth that can be\nachieved for A = 5 and Vsw = 1 V when the device size can be arbitrarily set?\nWhat is the penalty to achieving the maximum bandwidth?\n(f) In practice, a good compromise is to size the amplifiers such that their input load\ncapacitance, i.e., Cgs , equals the fixed capacitance. Given this constraint, what\nis the appropriate device width and length, resistor load value R, and resulting\nbandwidth to achieve A = 5 and Vsw = 1 V?\n(g) Based on the insight gained in this problem, write a Matlab script that determines\nthe maximum gain that can be achieved with a single-stage amplifier bandwidth\nof 2.5 GHz, 5 GHz, and 10 GHz. Assume that the devices are sized according to\nthe constraint specified in part (f), and that Vsw = 1 V. State the values of gain\nthat you achieve at each bandwidth setting."
    },
    {
      "category": "Resource",
      "title": "hw3.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/28bc4aab6e79fb317c0068064eaf685c_hw3.pdf",
      "content": "Massachusetts Institute of Technology\nDepartment of Electrical Engineering and Computer Science\n6.976\nHigh Speed Communication Circuits and Systems\nSpring 2003\nHomework #3: Amplifier Noise and Nonlinearity\nc\nCopyright 2003 by Michael H. Perrott\nReading: Chapter 10 and pages 272-284 & 295-300 of Thomas H. Lee's book. Pages 11-22\nand 38-43 of Behzad Razavi's book.\n1. The following is based on Problem 5 in Chapter 11 of Thomas Lee's book. Consider\nthe resistively shunted amplifier shown in Figure 1. Vdd =1.8 volts, Ibias = 200μA,\nRL = 1kΩ.\nM1\nIbias\n0.18\nM2\nCbig2\nCbig1\nRT\n50 Ω\nVout\n0.18\nRL\nVin\nFigure 1: Amplifier with resistive input termination.\n(a) Assuming all transistors are in saturation:\ni. What voltage is Vout biased at? How much current flows through M2?\nii. Using Hspice, find gm and Cgs for M1 with 0.18 μm Hspice model file provided\nin Athena in the file /mit/6.976/Models/0.18u/mos018.mod.\n(b) Assuming that Cbig1 and Cbig2 are short circuits at the frequencies of interest,\nredraw a simplified version Figure 1 for calculating the noise figure of the amplifier.\n\n(c) Given the assumption in part (b), does the bias transistor M2 impact the noise\nfigure of the amplifier?\n(d) Derive an expression for the noise figure (factor) of the amplifier. Assumme that\nall transistors are in saturation, and ignore the impact of gate noise, Cgd, ro, and\nsource/drain capacitances in M2. Also assume for M2 that\ni2\nnd = 4kTγgdo∆f, gm/Cgs = wT ,\nwhere the excess noise factor γ = 3 and α = 0.5.\n(e) Based on your expression in part (d):\ni. Is the noise figure a function of frequency? If so, is the noise performance of\nthe amplifier better at high or low frequencies?\nii. Is the noise figure of the amplifier minimized for RT ≪ 50Ω, RT = 50Ω, or\nRT ≫ 50Ω?\nwT\niii. What is the minimum noise figure that can be achieved with\n= 10?\nw\nwT\niv. What is the noise figure for RT = 50Ω with\n= 10?\nw\n(f) Rederive the expression for noise figure (factor) of the amplifier under the same\nconditions as in part (d) except that you should now include the impact of gate\nnoise. Assume that the gate noise is described as:\nng = 4kTδgg ∆f, where gg = w 2C2\ni2\ngs /(5 ∗ gdo),\nwhere the gate noise coefficient δ = 6. Also assume that gate noise is correlated\nwith drain noise as:\nnd\nc = ing · i∗\n= j0.55\ni2\nng · ind 2\n(g) Is the noise figure a function of frequency? If so, is the noise performance of the\namplifier better at high or low frequencies?\nwT\n(h) What is the noise figure for RT = 50Ω,\n= 10?\nw\n\n2. Now consider the resistively shunted amplifier employing a cascode transistor as shown\nin Figure 2. For the questions below, assume that all transistors are in saturation and\nω ≪ ωT . Ignore the impact of gate noise, Cgd, ro, and source/drain capacitances in\nM2 and M3. Also assume for M2 and M3 that\ni2\nnd = 4kTγgdo∆f, gm/Cgs = wT ,\nVin\nM1\nIbias\nVout\n0.18\n0.18\nM2\nCbig2\nCbig1\nRT\n50 Ω\nVbias\nRL\n0.18\nM3\nCpar\nFigure 2: Cascoded amplifier with resistive input termination.\n(a) From an intuitive perspective, what is the impact of M3 on the overall noise figure\nof the amplifier if Cpar = 0? Justify your answer.\n(b) Also from an intuitive perspective, how does Cpar impact the overall noise figure\nas its value is increased above zero? Justify your answer.\n(c) Derive an expression for the noise figure (factor) of the cascoded amplifier assum\ning Cpar is nonzero.\n3. This problem focuses on estimating IIP3 and IIP2 for the single-ended and differential\namplifiers shown in Figure 3.\n(a) Enter each of the circuits into Cadence and perform a DC sweep using Hspice for\neach one as follows:\ni. Circuit (a): sweep Vin over the range of -10 mV to 10 mV. Be sure to probe\nnode Vout .\nii. Circuit (b): sweep Vid over the range of -20 mV to 20 mV. Be sure to probe\nnode Vod .\n(b) Use Matlab to curve fit a third order polynomial to each of the Hspice plots\nobtained in part (a). Specifically, derive the coefficients for the following polyno\nmials:\n\nIbias=0.5 mA\nVin\nM1\n0.18\n0.18\nM2\n1 kΩ\n1.8 V\n0 V\nV\nM1\nM2\nIbias=1mA\nVod\n0.18\n0.18\n1 kΩ\n1 kΩ\nVin+\nVin-\n1.8 V\n0 V\nid\n-Vid\nVout\nVbias=1.2 V\n(a)\n(b)\nFigure 3: Example amplifiers for nonlinearity analysis: (a) single-ended, (b) differential.\ni. Circuit (a): Vout ≈ co + c1Vin + c2V 2\nin ,\nin + c3V 3\nii. Circuit (b): Vod ≈ co + c1Vid + c2V 2\nid .\nid + c3V 3\nTo do so, create matrices (for circuit (a) in this case):\n\n.\n.\n.\n.\n.\n\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\nc0\n\nVout [i]\n, A =\nVin [i]\nV 2\nin [i]\n, h =\n\nin [i]\nV 3\n\nc1\n\ny =\n\nin [i + 1] V 3\nVout [i + 1]\n1 Vin [i + 1] V 2\nin [i + 1]\nc2\n\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\nc3\n.\n.\n.\n.\n.\nso that we have the matrix relationship:\ny = Ah.\nWe solve for the coefficients in vector h using the least squares technique by using\nthe Matlab command:\nh = A\\y\n(c) Plot the calculated polynomial versus the Hspice computed curves for Vout and\nVod over the range of Vin and Vid , respectively, specified in part (a). How well\ndoes the polynomial match its respective simulation curve?\n(d) Given the computed coefficents from part (b), calculate IIP3 for both amplifiers\nassuming that the amplifiers are shunt loaded at their inputs with a 50 Ω resistor,\nand are also driven by a source with 50 Ω source resistance (just as in problems\n(1), (2) and (4)). Does one have higher IIP3 than the other? If so, why?\n(e) Given the computed coefficents from part (b), calculate IIP2 for both amplifiers\nunder the same assumptions as in part (c). Does one have higher IIP2 than the\nother? If so, why?\n\n4. In this problem we will use CppSim to \"experimentally\" calculate IIP3 of the amplifier\nshown in Figure 4. Assume that:\nco = .5, c1 = 1, c2 = .03, c3 = -.07\nAmplifier\n50 Ω\n50 Ω\nx\nVout\nVin\nVout = co + c1x + c2x2 + c3x3\nFigure 4: Amplifier configuration for CppSim Simulation.\n(a) What is the theoretical value of IIP3 of the amplifier given the coefficents above?\n(b) Create an amplifier module symbol and schematic in CppSim that contains pa\nrameters for co, c1, c2, and c3. Create a corresponding module entry in the\nmodules.par file that implements the amplifier using the Amp class. Refer to\n/mit/CppSim/Doc/cppsimdoc.pdf for Amp Class usage and creating modules in\nCadence. Turn in the module symbol and code for Amp.\n(c) Create a gain module symbol and schematic in CppSim that contains a parameter\nfor the gain value. Set up the parameters so that you use the gain module already\nin modules.par. Turn in the module symbol.\n(d) Create a schematic in Cadence using the above modules as shown in Figure 5.\nSet the signal source signal type to a sine wave of frequency 1 GHz. Create a\ntest.par file corresponding to the circuit that specifies a sample rate of 50 GHz\nand the number of sample points as 10000.\nconstant\nsignal_source\ngain\namplifier\nout\nin\nin\nout\nphase\nout\nout\nvout\nx\nFigure 5: CppSim schematic for IIP3 computation.\nNow, \"experimentally\" calculate IIP3 for the amplifier by adjusting the gain value\nover several appropriately chosen values and then measuring the resulting funda\nmental and third order distortion products (observe these products by taking\nthe fft of the output of the amplifier and then measuring the appropriate tone\namplitudes in the frequency domain). Does your IIP3 estimate agree with the\ntheoretical calculation in part (a)? (NOTE: in the future, do this as a two tone\ntest rather than a one tone test)"
    },
    {
      "category": "Resource",
      "title": "hw4.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/c41a3be3c824c0735fe4e13a196441ba_hw4.pdf",
      "content": "Massachusetts Institute of Technology\nDepartment of Electrical Engineering and Computer Science\n6.976\nHigh Speed Communication Circuits and Systems\nSpring 2003\nHomework #4: Narrowband LNA's and Mixers\nc\nCopyright 2003 by Michael H. Perrott\nReading: Chapters 11 and 12 of Thomas H. Lee's book. Chapter 6 and pages 138-146 of\nBehzad Razavi's book.\n1. This problem will focus on design of the LNA shown in Figure 1. In the figure, Ldeg\n(Ls) is assumed to have infinite Q, but inductors Lg and Ld have associated resistances\ndue to their finite Q (i.e., the values of Rpg and Rpd are set by the Q and inductance\nvalue of Lg and Ld, respectively). Assume the following\n- Design of the LNA should be focused on its performance at frequency wo =\n(2π)2.5 GHz\n- If an external inductor is used for Lg , its Q is 40. For integrated inductors, assume\nthe Q to be 5 (other than for Ldeg ).\n- The LNA input impedance, Zin, must be designed to match that of the source\nresistance of 50 Ohms at frequency wo (Note: assume Cbig is a short at frequency\nwo, and ignore the influence of the 5 kOhm bias resistor)\n- The power dissipation of the core amplifier must be no greater than 10 mW.\n(Ignore the bias circuitry here)\n- All transistor devices are the same size and have length L=0.18 μm\n- The influence of the cascode device M2 can be ignored for noise figure and gain\ncalculations.\n- Ignore Cgd , Cdb , ro, and backgate effects for all transistors.\n- Ignore the noise contribution of transistors M2 and M3 and the 5 k Ωbias resistor.\n- Assume the following process parameters\n- c = j0.55\n- γ = 3\n- δ = 6\n- gm/gdo = 0.68\n- wt = (2π)42.8 GHz\n\n- Iden = 100 μA/μm\nW\n- gm = 1.8 0.78 mS, where W is transistor width in microns\n- Vdd= 1.8 V\nCL=1pF\n50 Ω\nVin\nM1\nM2\nLs\nLg\nCbig\nIbias\nM3\nVout\n5 kΩ\nZin\nx\nRpg\nRps\nCbig\nLd\nRpd\nFigure 1: Narrowband LNA.\n(a) Design the amplifier to achieve the minimum noise figure given the conditions\nstated above. State the resulting noise figure (at wo), Ibias, transistor widths,\ncomponent values, and gain (at wo) for the amplifier. For intermediate calcula\ntions, determine η, χd, and Zgsw .\n(b) How does the noise figure change for part (a) if c = 0? (a numerical answer is\nrequired here)\n(c) How does the noise figure change for part (a) if c = j1? (a numerical answer is\nrequired here)\n2. The following is based on Problem 4 in Chapter 12 of Thomas Lee's book. Here\nwe consider the ideal multiplying mixer shown in Figure 2, whose input RF signal is\nAsin(wrf t) and whose LO signal is either a square-wave or sinusoidal waveform.\nAsin(wrf t)\nout\nLO\nFigure 2: Ideal multiplying mixer.\n(a) Derive the conversion gain of the mixer under the following conditions:\n\ni. A square-wave LO waveform with peak-to-peak amplitude of 2B whose fre\nquency is chosen such that the mixer output occurs at a nonzero IF frequency.\nii. A sine-wave LO waveform with peak-to-peak amplitude of 2B whose fre\nquency is chosen such that the mixer output occurs at a nonzero IF frequency.\niii. A square-wave LO waveform with peak-to-peak amplitude of 2B whose fre\nquency is chosen such that the mixer output occurs at zero IF frequency.\niv. A sine-wave LO waveform with peak-to-peak amplitude of 2B whose fre\nquency is chosen such that the mixer output occurs at zero IF frequency.\n(b) Comparing the above cases, is there a difference in conversion gain if the IF output\noccurs at zero or nonzero frequency?\n(c) Which type of LO signal achieves a higher conversion gain (assuming the same\npeak-to-peak amplitude)?\n(d) Given a non-zero IF frequency, compare the relative requirements on a post-mixer\nfilter to reject undesired frequency components for square-wave and sine-wave\nLO signals. Present your arguments using pictures of the appropriate Fourier\ntransforms of the relevant signals.\n3. This problem is based on Problems 5 and 6 in Chapter 12 of Thomas Lee's book. Here\nwe focus on the double-balanced mixer shown in Figure 3. It will be assumed that a\nnonzero IF output frequency is sought in all cases.\nCL\nRL/2\nRL/2\nRS/2\nCbig\nRS/2\nCbig\nLO\nLO\nVout\nVout\n0 V\nVdd\nLO\n2Ain\nVin\nVdd\nLO\nFigure 3: A double-balanced passive CMOS mixer.\n(a) Given that RL is set equal to RS , what is the conversion gain of the mixer?\nAssume infinitely fast switching, neglect switch resistance, and assume that the\npost-mixer RC filter formed by RL and CL has higher bandwidth than the desired\nIF output.\n\n(b) Repeat part (a) given non-zero switch resistance (denoted as Rsw ). What is the\nmaximum acceptable switch resistance if the degradation in conversion gain (rel\native to part (a)) is not to exceed 1 dB?\n(c) How does the filter requirement change if the LO drive does not possess a per\nfect 50 % duty cycle? Express your answer using pictures of the appropriate\nFourier transforms where you have considered the impact of the non-50% duty\ncycle square wave. Based on this exercise, how important is the achievement of\nsymmetry in device switching for the mixer?\n4. This problem focuses on the analysis and simulation of the Weaver image rejection\nmixer architecture shown in Figure 4.\nsin(w1t)\nLPF\nLPF\ncos(w1t)\nsin(w2t)\ncos(w2t)\nRF Input\nBaseband\nOutput\nA\nB\nC\nD\nfd\nfi\nf1\n-fi\n-fd\n-f1\nf\nRF input\nDesired\nSignal\nImage\nFigure 4: The Weaver image rejection mixer architecture.\n(a) Given the RF signal Fourier transform shown in Figure 4, what condition is\nrequired for the signal centered at fi to be the image of the desired signal centered\nat fd (i.e., what is the relationship between fi, fd, and f1?).\n(b) Given the relationship in part (a), what value should be chosen for f2 so that\nthe overall mixer output is at baseband frequencies (i.e., has an IF frequency of\nzero)?\n(c) Given the conditions in part (a) and (b), sketch the Fourier transforms of the\nsignals at nodes A, B, C, D, and the overall output of the mixer.\n(d) Verify operation of the mixer by simulating the system in Figure 4 using CppSim\ngiven f1 = 1 GHz, fd = 900 MHz, the lowpass cutoff frequencies are at 150 MHz,\n\nand f2 is appropriately chosen for baseband conversion. Rather than inputing an\nRF signal as shown in the figure (which would be rather challenging), simply input\ntwo sinusoidal signals. One of the signals should be placed at the center of the\ndesired frequency band, and the other should be placed just slightly offset from its\nrespective image frequency location (offset so that you can view it distinctly from\nthe desired location if it were to not be completely rejected in the final output).\nNote that you'll need to create new CppSim module blocks for the mixers and\nlowpass filter.\nTurn in the module code and plots at A, C, and the Output. Hint: Make sure\nthat your input is real-valued.\n(e) Now modify your CppSim simulation to observe the impact of phase mismatch\nbetween the cosine and sine waves at frequency f1. Specifically, phase shift the\nsine wave by 1 degree and then measure the corresponding image rejection ratio\nat DC based on the simulation results."
    },
    {
      "category": "Resource",
      "title": "hw5.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/e9c43f007819db2465a127d315013a86_hw5.pdf",
      "content": "Massachusetts Institute of Technology\nDepartment of Electrical Engineering and Computer Science\n6.976\nHigh Speed Communication Circuits and Systems\nSpring 2003\nHomework #5: Voltage Controlled Oscillators\nc\nCopyright 2003 by Michael H. Perrott\nReading: Chapters 16 and 17 of Thomas H. Lee's book. Chapter 7 of Behzad Razavi's book.\n1. The following is based on Problem 4 in Chapter 16 of Thomas Lee's book, and considers\nthe differential CMOS VCO shown in Figure 1. Assume the bulk nodes of the PMOS\nand NMOS are tied to their respective source nodes.\nA\nM1\nM2\nM3\nVout\nCtune\n3 nH\n100/0.18\n50/0.18\nM4\n100/0.18\n50/0.18\nVout\nVin\nIbias\nVdd =1.8 V\n0 V\nFigure 1: Differential CMOS LC Oscillator.\n(a) Neglecting transistor capacitances, calculate the oscillation frequency assuming\nCtune has been adjusted to a value of 2 pF.\n(b) Using Hspice and the mos018.mod MOS models, determine the minimum value\nof bias current, Ibias, such that sustained oscillation can be achieved in the tank.\nAssume an inductor with Q=10 at the oscillation frequency is the only source of\nloss in the tank.\n\n(c) Using minimum Ibias, extract the transistor capacitances and determine the new\noscillation frequency. By how much did the frequency shift from that found in\npart (a)?\n(d) Calculate the oscillation amplitude, A, as a function of Ibias under the assumption\nthat the current waveforms through the transistors are square waves, and that\nthe oscillator is in the current-limited regime.\n(e) Assuming that the tank abruptly shifts to the voltage-limited regime when the\noscillator amplitude equals half the supply voltage (Vdd), determine the value of\nIbias for which the phase noise of the oscillator will be minimized.\n(f) Is it possible to use a series tank instead of a parallel tank here? Explain.\n2. The following combines Problem 2 and 8 in Chapter 16 and 17, respectively, of Thomas\nLee's book. Here we examine the Colpitts oscillator shown in Figure 2. Use the 0.18u\nHspice model file provided on Athena in the file /mit/6.976/Models/0.18u/mos018.mod\nfor your MOS model.\nVbias=1.2V\nM1\nLd=4nH\nVout\nIbias=100 μA\nRd=10kΩ\nC1=2pF\nC2=8pF\nFigure 2: CMOS Colpitts oscillator.\n(a) Neglecting transistor capacitances and ro, calculate the minimum W/L ratio nec\nessary for a startup gain of 2 under the assumption that the device obeys the\nsquare law for its Vgs to Id curve. What should L be set to? Explain.\n(b) Would there be an advantage to setting the startup gain to a value just slightly\nhigher than 1? If so, why not do so?\n(c) Given the same conditions as part (a), find the minimum W using Hspice. Use\nthe L value previously selected in (a). (Suggestion: If you encounter problems\npassing parameters from Cadence to the Spice netlist, consider modifying your\nSpice netlist (i.e., test.sp) file after running hspc and then running hspice.)\n(d) Suppose that the tail current source of the oscillator, Ibias is replaced by a 1.3 kΩ\nresistor and the device size chosen to achieve a startup gain of 2. For simplicity,\nassume that the transistor can be approximated by its small signal equivalent\nmodel, and that the oscillator output amplitude is 0.9 V.\n\ni. Model the noise introduced by the 1.3 kΩ resistor as an equivalent noise\ncurrent source in parallel with the inductor.\nii. Ignoring all other noise sources, calculate the phase noise of the oscillator due\nto this resistor's noise. What's the phase noise (dBc/Hz) at 1MHz offset? (Let\nT =290 K)\n3. The following problem focuses on analysis of the linearized oscillator model shown\nin Figure 3. It is assumed, for simplicity, that both of the current noise sources are\nwhite, and that the comparator is ideal (i.e., has infinite slope at its transitions, and\nno internal noise sources).\nNegative\nResistance Amplifier\n1.5 V\nL\nVout1\nC\nR\nin\ninR\n-1\ngm\nwhere:\ngm = R\n= 4kT2gm\nin\nComparator\n2.5 V\nVout2\nFigure 3: Linearized model of an oscillator feeding into a comparator.\n(a) How does the noise of the tank effective resistance, R, compare to that of the\namplifier? Do you think this observation will hold over a wide range of LC\noscillators?\n(b) How does the phase noise of Vout1 compare to the phase noise of Vout2 ?\n(c) Derive an expression for the phase noise spectrum of Vout1 using Leeson's ap\nproach.\n(d) Re-derive the expression for the phase noise spectrum of Vout1 using the LTV\n(linear, time-varying) analysis method described in Chapter 17 of Thomas Lee's\nbook. In your calculation, assume that the oscillation waveform and ISF are\nsinusoidal and that the noise sources are stationary.\n(e) Compare your answers and provide an explicit expression for F , the Leeson fitting\nparameter, based on its use in Equation 13 of Chapter 17, for the linearized\noscillator model.\n\n4. This problem introduces you to spur level calculations and simulation.\nConsider a VCO with a spurious signal entering at its input as depicted in Figure 4.\nThe voltage, vin, to frequency output, fout, characteristic of the VCO is assumed to\nbe:\nfout = (Kv vin + fo)Hz, where Kv = 10 MHz/V, fo = 100 MHz.\nvin(t)\nout(t)\nt\nout(t) = cos(2π (fo+Kvvin(τ))dτ)\nFigure 4: VCO block and associated equation.\n(a) Assuming that vin = A sin(2πfspur t), derive an expression for the magnitude (in\ndBc) of the spurs that result at the output of the VCO.\n(b) Suppose vin were changed to vin = A sin(2πfspur t) + VB , where VB is a constant\nbias voltage. Does the value of VB have any effect on the magnitude (in dBc) of\nthe spurs?\n(c) Does the magnitude (in dBc) of the spurs depend on the value of the VCO output\nvoltage swing?\n(d) Use CppSim to simulate the system depicted in Figure 4 with vin specified as\nin part (b), where VB = 0. Set the simulation sample rate to 1 GHz and the\nnumber of simulation samples to 10000, and configure the schematic according\nto the block diagram shown in Figure 5. Measure the spur levels in units of dBc\nby taking the fft (scaled in dB) of the sine wave output of the VCO and then\ncomparing the spur to the carrier tone.\nconstant\nsignal_source\ngain\nadd2\nvco\nsquareout\nsineout\nvctrl\nin\nout\nphase\nout\nout\nout\nconstant\nout\nvin\nFigure 5: CppSim block diagram of VCO spur simulation.\n\nUse CppSim and Matlab to plot the resulting spur levels for three different values\nof A and fo:\ncase (i)\nA = 100e-6 fspur = 1 MHz\ncase (ii)\nA = 100e-6 fspur = 100 kHz\ncase (iii) A = 10e-3\nfspur = 1 MHz\nLabel the magnitude of the (fundamental) spurs in dBc directly on the plots.\n(e) Using the equation you derived in part (a), calculate the theoretical spur magni\ntudes (in dBc) for each of the cases in part (d), and check that the answers agree\nwith the results from the simulation.\n(f) Why do you see harmonics of the spur tones in case (iii)?\n(g) Given the input levels of noise specified in part (d), how would the spurious\nnoise of the VCO be impacted by increasing the value of Kv ? For the best noise\nperformance, would you choose a high or low value of Kv ? Are there any negative\nconsequences of choosing that (high or low) value of Kv ?\n(h) Based on this exercise, do you think that it's easy or hard to design a synthesizer\nwith spurious performance better than -70 dBc?"
    },
    {
      "category": "Resource",
      "title": "hw6.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/57fed79da416746dab4876f4762b6df2_hw6.pdf",
      "content": "Massachusetts Institute of Technology\nDepartment of Electrical Engineering and Computer Science\n6.976\nHigh Speed Communication Circuits and Systems\nSpring 2003\nHomework #6: Phase-Locked Loop Circuits\nc\nCopyright 2003 by Michael H. Perrott\nReading: PLL Design Assistant Manual (found at\nhttp://www-mtl.mit.edu/research/perrottgroup/tools.html).\nChapter 15 of Thomas H. Lee's book.\n1. This problem focuses on a simplified method of representing a phase-locked loop circuit\nwith a given noise profile for system level simulations. We will focus on deriving the\nappropriate noise parameters to achieve a given level on noise performance, and then\ninvestigate simulation using CppSim. In all cases, assume that Kv = 20 MHz/V, K1\n= -95 (dBc/Hz), K2 = -60 (dBc), fp = 100 kHz, fs = 90 kHz, and that the carrier\nfrequency fo = 200 MHz.\nSΦout(f)\nK1 dBc/Hz\n-20 dBc/Hz/dec\nK2 dBc\nout(t) = cos(2π (fo+Kvvin(τ))dτ)\nvin\nout\nt\n1 + s/(2πfp)\nvph\nvspur = Asin(2πfst)\ns/(2πfp)\nfs fp\nfoffset\nFigure 1: Simplified frequency source simulation implementation with given phase noise and\nspurious noise.\n(a) Draw the block of the system shown in Figure 1 in which all blocks are cast as\ntransfer functions (i.e., the VCO is an integrator block).\n(b) Based on your drawing in part (a), compute the variance of the phase noise source,\nv2\nph , to achieve the specified phase noise profile at low frequencies, K1.\n\n(c) Compute the amplitude of the spurious noise source, vspur (t), to achieve the spec\nified spurious noise at frequency fs, K2.\n(d) Simulate the system in CppSim to verify your calculations using a Gaussian noise\nsource (noise module), a sine wave source (signal source, gain modules), a summer\n(add2 module), an appropriate filter (must create), and a VCO (vco module). Use\na simulation sampling frequency of 2 GHz, and simulate over 1,000,000 sample\npoints. To plot the phase noise, use the Matlab script comp psd.m located in\n/mit/6.976/CppSim/MatlabCode (be sure to change the value of Kv in the script\nto match the value assumed here).\n(e) You should notice that the plot given by the comp psd.m script matches the\nphase noise (assuming you have done things correctly), but not the spurious noise.\nMeasure the spurious noise by taking the fft of the VCO sine wave output and\ncompare the spur directly against the carrier tone. Submit resulting phase noise\nplot and also plot of fft showing the carrier and spur tones.\n(f) Why is the spurious noise improperly scaled with the comp psd.m script? What\ndoes this exercise teach with respect to proper measurement of phase noise and\nspurious noise in simulations?\n2. The following problem focuses on the design of an integer-N frequency synthesizer as\ndepicted in Figure 2. Assume that a tristate phase detector is used, Kv = 20 MHz/V,\nthe desired nominal output frequency is 200 MHz, the desired frequency resolution is\n2 MHz, and that the desired phase noise profile should closely match that in Problem\n1. Also, assume that the loop filter will be designed such that the PLL will be Type I,\nsecond order, and have a bandwidth of 100 kHz with Butterworth shape.\nT\nPFD\nLoop\nFilter\nref(t)\nout(t)\nDivider\nT\ne(t)\nvin(t)\ndiv(t)\nVCO\nN[k] = Nnom\nIcp\nFigure 2: An integer-N frequency synthesizer.\n(a) Given the assumptions stated above, draw a transfer function level block diagram\nof the synthesizer shown in Figure 2.\n(b) Download the PLL Design Assistant program available at\nhttp://www-mtl.mit.edu/research/perrottgroup/tools.html (note that it only runs\nin Windows). Use the program to calculate the required loop filter parameters\n\nto achieve the required PLL dynamics (also specify the nominal divide value and\nreference frequency). At this point, perform your calculations based on the as\nsumption that Icp = 100 μA.\n(c) Simulate your design using CppSim and verify that the (small signal) step re\nsponse of the system matches that estimated by the PLL Design Assistant pro-\ngram. Note that you can simply modify the sd synth schematic in the CppExam\nples library to implement the system -- you will need to implement the tristate\ndetector and a new version of the loop filter. Keep the noise sources in (just set\ntheir value to zero), and replace the constant input to the reference vco module\nwith a step input to examine the (small signal) step response. Submit Cadence\nschematics of PLL and tristate pfd and also the code for modules that was added\nto modules.par file.\n(d) Verify that the PLL relocks even if frequency lock is lost by stepping the divide\nvalue by a value of 1 and a value of 10. If it fails to lock in either of these cases,\nexplain why that is the case. How could you modify the circuit so that it would\nunconditionally lock? Submit Matlab plots for the synthesizer responses for both\ndivider steps.\n(e) Compute the value of charge pump noise parameters in the gated noise module\nto achieve a low frequency phase noise of -95 dBc/Hz, as shown in Figure 1.\nFor simplicity, assume that varpos equals varneg. Verify your calculation by\nsimulating the system with the appropriately set charge pump noise in CppSim,\nand use the comp psd.m script to plot the resulting phase noise.\n(f) Compute the value of the input-referred VCO noise variance (i.e. the var param\neter in the noise module) to achieve PLL output phase noise that closely matches\nthat in Figure 1 (i.e., -115 dBc/Hz at 1 MHz offset). Verify your calculation by\nsimulating the system in CppSim with both charge pump noise (computed from\nthe previous part) and input-referred VCO noise included in the simulation, with\ncomp psd.m being used to plot the overall output phase noise.\n(g) Calculate the value of the charge pump current that would be required to achieve\nthe charge pump noise specification computed in part (e). Assume that for both\nthe top and bottom charge pump currents, their current noise, i2\nch , is related to\ntheir respective current, Icp , as\ni2\nch = 8e-19 · Icp A2\n(h) Given the above charge pump computation:\ni. Redraw the transfer function block diagram of the system (as done in part\n(a)) and indicate which values are modified to accomodate the new charge\npump current value while still keeping the same PLL dynamics and phase\nnoise profile as assumed throughout this problem.\nii. Draw the loop filter circuit (including component values) -- assume that it\nis implemented without using an opamp.\n\n3. Redo problem (2) with the PLL being chosen as a Type II rather than Type I imple\nmentation. In other words, assume that a tristate phase detector is used, Kv = 20\nMHz/V, the desired nominal output frequency is 200 MHz, and the desired frequency\nresolution is 2 MHz. The loop filter will be designed such that the PLL will be Type II,\nsecond order, and have a bandwidth of 100 kHz with Butterworth shape. In addition,\nfz\nassume fo = 10 .\n(a) Use the PLL Design Assistant program to calculate the required loop filter pa\nrameters to achieve the required PLL dynamics (also specify the nominal divide\nvalue and reference frequency). At this point, perform your calculations based on\nthe assumption that Icp = 100 μA.\n(b) Simulate your design using CppSim and verify that the (small signal) step re\nsponse of the system matches that estimated by the PLL Design Assistant pro-\ngram. As with problem (2), keep the noise sources in (just set their value to zero),\nand replace the constant input to the reference vco module with a step input to\nexamine the (small signal) step response. Submit Cadence schematic of PLL.\n(c) Does the step response take a longer or shorter time to settle than its Type I\ncounterpart in problem (2)? Explain. Submit simulation step response plot with\nexplanation.\n(d) Is there a difference in the pfd output between type I and type II? If so, what\ncause this difference? Submit plots of the pfd output for both types to prove your\npoint.\n(e) Verify that the PLL relocks even if frequency lock is lost by stepping the divide\nvalue by a value of 1 and a value of 10. Submit synthesizer response plots for\nboth step values.\n(f) Draw the loop filter circuit (including component values) -- assume that it is\nimplemented without using an opamp."
    },
    {
      "category": "Exam",
      "title": "quiz.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/98ce41d6546a9055e87cb32fe8be0753_quiz.pdf",
      "content": "Massachusetts Institute of Technology\nDepartment of Electrical Engineering and Computer Science\n\n6.976 High Speed Communication Circuits and Systems\n\nMid-Term Exam\n\nCopyright (c) 2003 by Michael H. Perrott\n\nName__________________________\n\nProblem 1\n______________\n\nProblem 2\n______________\n\nProblem 3\n______________\n\nProblem 4\n______________\n\nTotal\n______________\n\n1. (20 points) Consider the circuit network connected to lossless transmission lines of\ncharacteristic impedance Z1 and Z2 as shown in the figure below. Assume in all cases\nthat Z1 and Z2 are purely real.\n\nZ1\nZ2\n2-Port for\nS-parameter calculation\nR1\nC1\nS11\nS22\n\na. Derive an expression for S11 in terms of Z1, Z2, R1, and C1.\n\nb. Derive an expression for S22 in terms of Z1, Z2, R1, and C1.\n\nc. Derive an expression for S21 in terms of Z1, Z2, R1, and C1.\n\nd. Consider the case where a pulse is launched down the left transmission line (with\nimpedance Z1). Will the initial portion of the voltage reflection back down the left\ntransmission line be positive, negative, or zero given Z1 = 50 Ohms, R1 = 75 Ohms,\nC1 = 1 pF, and Z2 = 100 Ohms? Explain your answer.\n\ne. Consider the case where a pulse is launched down the right transmission line (with\nimpedance Z2). Will the initial portion of the voltage reflection back down the right\ntransmission line be positive, negative, or zero given Z1 = 50 Ohms, R1 = 75 Ohms,\nC1 = 1pF, and Z2 = 100 Ohms? Explain your answer.\n\n2. (25 points) Now consider the linearized VCO model shown in the figure below.\n\nL\nVout\nC\nR\nNegative\nResistance Amplifier\nin\n-1\ngm\nwhere:\n= 4kT2gm\nin\n1:10\nAout\nAin\nIdeal\nTransformer\nAccompanying\nnoise source\nnot shown for R\n\na. Calculate the value of gm for the negative resistance amplifier for which steady-\nstate oscillation is achieved.\n\nb. Given the linearized VCO model illustrated on the previous page, derive an\nexpression for the phase noise of the oscillator, L(∆f). Your expression should be\na function of Ain, R, Q of the tank, and kT.\n\nc. State the difference (in dB) between the minimum phase noise that can be\nachieved with the oscillator shown in the initial figure of this problem versus the\noscillator shown below. Assume that the voltage swing at the active element\noutput, Ain, is constrained in value to 2 V for both VCO structures, whereas the\nvoltage across the tank itself is not constrained in either case.\n\nL\nVout\nC\nR\nNegative\nResistance Amplifier\nin\n-1\ngm\nwhere:\n= 4kT2gm\nin\nAin\nAccompanying\nnoise source\nnot shown for R\n\n3) (25 points) Consider the CMOS mixer shown below. Assume for all parts in this\nproblem that the frequency of the RF input, VRF, is 900 MHz, while the frequency of the\nLO output, VLO, is 1 GHz. Also assume for all parts that the opamp has zero offset\nvoltage, infinite DC gain, and infinite unity gain bandwidth.\n\nVLO\n10 kΩ\nM1\nVIF\nVRF\n0 V\n0 V\n0 V\n1.8 V\nV1\n10 pF\n\na. Calculate the conversion gain of the mixer given that the channel resistance of M1\n(from source to drain) is infinite when VLO = 0 V, and equals 1 kΩ when VLO =\n1.8 V.\n\nb. Calculate IIP3 of the mixer (in units of peak voltage squared, Vp\n2) given that the\nchannel resistance of M1 (from source to drain) is infinite when VLO = 0 V, but\nequals the following expression when VLO = 1.8 V:\n\nChannel resistance = dVds/dId = 1 kΩ/(Vgs-0.8V-Vds\n2/2)\n\n4) (30 points) Consider the distributed amplifier shown below consisting of N transistors\nwhose input and outputs are connected through lossless transmission lines with\ncharacteristic impedance Z0. For all parts to follow, ignore all loading effects of the\ntransistors (i.e., ignore Cgs, Cgd, Cdb, and ro), and assume that all transmission line\nsections have equal delay. Also, ignore induced gate noise, and assume that the drain\nnoise of each transistor is related to its transconductance as\nid\n∆f = 4kT2gm\nIn addition, assume that a fixed current density is chosen for the transistors such that the\ntransconductance for each transistor is related to its bias current as\ngm= α Ibias\n\nM1\nZo\nZo\nZo\nZo\nM2\nMN\nZo\nZo\nZo\nZo\nRL=Z0\nvout\nRL=Z0\ndelay\ndelay\nvin\nRs=Z0\nRL=Z0\nSource\nIbias\nIbias\nIbias\n\na. Compute the overall gain of the amplifier (vout/vin) as a function of the number of\nstages in the amplifier, N. Your answer should be expressed in terms of Ibias, α,\nZo, and N.\n\nb. Compute the noise factor of the overall amplifier as function of N. Your answer\nshould be expressed in terms of Ibias, α, kT, Zo, and N.\n\nSuppose that loading by the transistors can only be neglected if their individual area,\nAt, is smaller than Ao. Assume that a specific current density is desired for each\ntransistor such that its area is related to its bias current as\nAt= β Ibias\nGiven this constraint, derive expressions for the following parts (c) and (d)\n\nc. Determine the minimum number of stages, N, that are required to achieve an\noverall amplifier gain (vout/vin) of G. For simplicity, assume that N does not need\nto be expressed as an integer value.\n\nd. Suppose you desire to achieve the best noise factor given a fixed overall gain, G.\nDo you do better, worse, or the same for noise factor if you set N higher than the\nminimum value calculated in the previous part? Explain your answer."
    },
    {
      "category": "Resource",
      "title": "guest1.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/e96c618e4ffb82e691bb7e97b604593e_guest1.pdf",
      "content": "Low-Power High-Speed Links\nGu-Yeon Wei\nDivision of Engineering and Applied Sciences\nHarvard University\n6.976 Guest Lecture, Spring 2003\n\nWei\nLow-Power High-Speed Links\nOutline\n- Motivation\n- Brief Overview of High-Speed Links\n- Design Considerations for Low Power\n- DVS Link Design Example\n- Summary\n\nWei\nLow-Power High-Speed Links\nMotivation\n-\nDemand for high bandwidth communications\n-\nAdvancements in IC fabrication technology\n-\nHigher performance\n-\nMore complex functionality\nÆ Chip I/O becomes performance bottleneck\nÆ Increasing power consumption\n-\nNetwork router example\n-\n10's to 100's of links on a single crosspoint switch\nbackplane PCB\n50-Ω traces\nswitch card\nnetwork card\ndigital\ncrosspoint\ntransceivers\n\nWei\nLow-Power High-Speed Links\nHigh-Speed Links Overview\n-\nHigh-speed data communication between chips across an\nimpedance controlled channel\n- Shared communication bus (memories)\n- Point-to-point links\n-\nTypes of link architectures and implementations\n- Parallel vs. serial\n- Differential vs. single-ended\n- Low-impedance vs. high-impedance driver\n- Transmitter-only vs. receiver-only vs. double termination\n-\nWe will focus on point-to-point serial links using differential high-\nimpedance drivers with double termination for network routers\n- Techniques to reduce power applicable to other link types\n\nWei\nLow-Power High-Speed Links\nLink Components\n- High-speed links consist of 4 main components\n- Serializing transmitter driver\n- Communication channel\n- De-serializing receiver samplers\n- Timing recovery\nRX\ndata in\ntiming\nrecovery\nchannel\nTX\ndata out\n\nWei\nLow-Power High-Speed Links\nPerformance Limitations\n-\nImportant to look at performance because higher performance can lead\nto lower power by trading off performance for energy reduction\n-\nSeveral factors limit the performance of high-speed links\n-\nNon-ideal channel characteristics\n-\nBandwidth limits of transceiver circuitry\n-\nNoise from power supply, cross talk, clock jitter, device mismatches, etc.\n-\nEye diagrams - a qualitative measure of link performance\nrandom bit stream\nideal data eye\nrealistic data eye\nTbit\n\nWei\nLow-Power High-Speed Links\nChannel Impairments and ISI\n-\nOne of the dominant causes of eye closure is inter-symbol\ninterference (ISI) due to channel bandwidth limitations\n- Two ways to view channel impairments\n\nWei\nLow-Power High-Speed Links\nEqualization\n-\nPlacing a high-pass filter in the signal path can counter the roll-\noff effects of the channel\n- Preemphasis or transmit-side equalization is commonly used\n\nWei\nLow-Power High-Speed Links\nCritical Path in Links\n-\nThe critical path in links can be as short as 1~2 gate delays\n-\nTransmit path\n-\nReceive path\nD\nQ\nD\nQ\nΦ\nRterm\nZo=50Ω\nVref\nDeven\nDodd\nΦ\nD\nQ\nD\nQ\nΦ Φ\nRterm\nZo=50Ω\n\nWei\nLow-Power High-Speed Links\n-\nWhile a symbol time can be short, there is a limit to the maximum\non-chip clock frequency\n-\nMust distribute a clock driven by a buffer chain\n-\nOvercome this limitation with parallelism\nClock Frequency Limit\nCLKIN\nCLKOUT\n\nWei\nLow-Power High-Speed Links\nParallelism\n-\nParallelism can increase bit rate even with limited clock\nfrequency\n- Time-interleaved multiplexing\n- Multi-level signaling\n-\nSome performance issues to be wary of\n- Static timing offsets in multi-phase clock generator (DLL or PLL)\n- Requires higher voltage dynamic range in transmitter and receiver\n-\nParallelism can also be low power\nclk[n]\nclk[n+1]\ndata\n\nWei\nLow-Power High-Speed Links\nSources of Noise\n- Power supply noise\n- Translates into voltage and timing uncertainty\n- Cross talk\n- Near- and Far-End Cross Talk (NEXT and FEXT)\n- High-frequency coupling\n- Clock Jitter\n- Timing uncertainty in transmitted and sampled symbol\n- Probabilistic distribution of timing edges (bounded and\nunbounded components)\n- Device mismatches and systematic offsets\n- Deterministic or systematic variation in timing edges from\nmulti-phase clock generators\n\nWei\nLow-Power High-Speed Links\nConsiderations for Low Power\n- Low noise Æ low power\n- Target some signal to noise ratio (SNR)\n- Reducing noise allows for lower signal power\n- Trade speed for lower power\n- Reducing bit rate improves SNR\n- Many noise sources are fixed Æ ratio of timing uncertainty to\nbit time improves (have longer bit times)\n- Let's look at a few design choices for low power\n- Circuit level\n- Architecture level\n- System level\n\nWei\nLow-Power High-Speed Links\nOffset Calibration\n-\nTwo sets of offsets that can manifest itself as voltage and timing\nuncertainty to close the eye and may require higher power to overcome\nthem:\n-\nMulti-phase clock generator timing offsets\n-\nReceiver input voltage offsets\n-\nStatic offsets due to systematic (layout) and random (device)\nmismatches\n-\nCalibration enables more timing and voltage margins (i.e., lower noise)\nideal Tx timing\nw/ offsets\nsampling edge\nzero\nRx offset\nnon-zero\nRx offset\nlower\nmargins\nhigher\nmargins\n\nWei\nLow-Power High-Speed Links\nDifferential Signaling\n-\nDifferential communication can lead to a lower power solution\n-\nImmunity to common mode noise\n-\nInjects less noise into the supplies\n-\nBut aren't there now are two channels that switch? Yes, but...\n-\nSignal amplitudes can be smaller on both channels\n-\nAlternative is pseudo-differential signaling but needs a reference voltage which can be\nnoisy and require larger Vswing\n-\nWhat does it cost?\n-\nRequires two pins per link\nRterm\nZo=50Ω\nRterm\nZo=50Ω\nD\nVswingdiff pk2pk = 2(I*R)\nRterm\nZo=50Ω\nVswing = I*R\nVref\n\nWei\nLow-Power High-Speed Links\nSignal Multiplexing\n-\nThere are different options for choosing where to combine pulses to\ncreate sub-clock period symbols\n-\nCombine at the final transmitter stage vs. farther up stream\n-\nCload for the clocks higher when combined at the final transmitter\nvs.\n-\nNeed faster signal path after the multiplexer\n-\nBest choice depends on implementation (see Zerbe, ISSCC2003)\nRterm\nZo=50Ω\nD0\nD1\nD2\nD3\nRterm\nZo=50Ω\nhigh-speed path\n\nWei\nLow-Power High-Speed Links\nMultiplexing\nTX\nTX\nTX\nRX\nRX\nRX\nMultiphase Clocks\nParallelized Transmitter\nParallelized Receiver\nchannel\nbitrate = M.fclk\n\nWei\nLow-Power High-Speed Links\nMultiplexing = Low Power?\nWith M:1 multiplexing, fCLK = bit rate/M\n- Power = M·CV2·f = M·CV2 ·(BR/M) = C·V2·BR\n- With fixed supply, power does not vary with M\nBut wait, at lower frequencies, I can lower voltage!\n- With lower supply voltage (V ∝fCLK = BR/M),\n- Power decreases as ∝1/M2 !\n\nWei\nLow-Power High-Speed Links\nPower vs. M\n-\nLarger M\nB Can reduce voltage\nB Lower power\nB Less accurate timing\n- static phase offsets\n- jitter\n-\nCannot make M\narbitrarily large b/c there\nis a lower limit to Vdd\n-\nChoice: M= 4~6\nchoice\nLower Supply ∝1/M or fCLK\nFixed Supply\nThis begs the questions... What if we make Vdd adaptive\nw/ fCLK?\n\nWei\nLow-Power High-Speed Links\nDVS Links\n- Dynamic Voltage Scaling (DVS)\n- Technique first introduced for digital systems (e.g., uP, DSP\nchips)\n- Lot's of work done in both academia and industry\n(e.g., Intel, Transmeta)\n- Allows trade off between speed and power\n- Let's investigate DVS for high-speed links\n- Motivation and potential benefits\n- Design example from Dr. Jaeha Kim\n(ISSCC2002, JSSC2002, PhD thesis 2002)\n\nWei\nLow-Power High-Speed Links\nDVS Links\n-\nDynamic Voltage Scaling (DVS) can reduce power consumption in\ntwo ways\n1)\nDigital circuits operate at their most energy-efficient point in the\npresence of PVT variations by eliminating extra performance margins\n0.5 V\n0.8 V\n88%\n0.2\n0.4\n0.6\n0.8\n1.2\n1.5\n2.5\n3.5\nNormalized Frequency\nSupply Voltage (V)\nF\nV\nC\nP\nswitched\ndynamic\nα\n=\n\nWei\nLow-Power High-Speed Links\nTrade Performance for Energy Savings\n2)\nDVS enables trade off between performance and energy\n-\nReducing frequency alone reduces power but not energy per bit\n0.2\n0.4\n0.6\n0.8\n0.2\n0.4\n0.6\n0.8\nNormalized energy / bit\nNormalized bit rate\nV\nC\nE\n⋅\n∝\nFixed Vdd = 3.3V\nDynamically scaled Vdd\nEnergy Savings\n\nWei\nLow-Power High-Speed Links\nDVS Link Components\n-\nDVS links require two additional components\n- Mechanism to measure circuit critical path to appropriately adjust\nvoltage with respect to frequency\n- Use an on-chip performance monitor circuit (inverter delay elements of\ncore DLL)\n- Efficient supply-voltage regulator (buck converter)\n-\nOverall Block diagram (Wei et al, ISSCC2000)\nDigital\nController\nVCTRL\nRVdd\ncore DLL\nBuck Converter\nI/O Transceiver\nDTX\nDRX\nFCLK\n\nWei\nLow-Power High-Speed Links\nPerformance Monitoring DLL\n-\nReduces design complexity by enabling one to replace precision analog\ncomponents with simple digital gates. How?\n-\nInverters of the delay line model the critical path (clock distribution)\n-\nDelay of gates in I/O circuitry are fixed relative to clock period\nCP\nPD\nA\nclk\nVCTRL\nA\nVCP\nO\nO\nDN\nUP\n\nWei\nLow-Power High-Speed Links\nAdaptive Receiver Filter\n-\nFilter signal frequencies beyond the Nyquist rate at the receiver (helps\nfor dealing with cross talk)\n-\nReceiver example\n-\nFilter's corner frequency tracks fsymbol\nPreamplifier\nΦ0\nΦ1\nRegenerative\nLatch\nIN\nIN\nfsymbol\nVbias\nAdB\nf\n\nWei\nLow-Power High-Speed Links\nExample: Adaptive Supply Serial Links\n- Jaeha Kim (Ph.D. defense 2002)\nAdaptive\nSupply, V\n1:5 Demultiplexing\nReceiver\n5:1 Multiplexing\nTransmitter\nMultiphase Clock\nRecovery\nMultiphase Clock\nGeneration\nAdaptive Power\nSupply Regulator\nfref\n\nWei\nLow-Power High-Speed Links\nMulti-Phase Clock Generation\n- Must minimize static offsets between phases\n- Generate multiphase clocks locally at each pin, but\nwatch out for power and area overhead\nTX\nTX\nTX\nStatic Offsets\nJitter\n\nWei\nLow-Power High-Speed Links\nDual-Loop Clock Generation\nReference VCO\nf\nCoarse Control\nLocal VCO\nFine Control\nLocal VCO\nFine Control\nAdaptive Supply, V\n1:5 Demultiplexing\nReceiver\n5:1 Multiplexing\nTransmitter\nfref\nAdaptive Power Supply Regulator\nLocal Multiphase Clock Recovery\nLocal Multiphase Clock Generation\n\nWei\nLow-Power High-Speed Links\nDual-Loop Clock Generation (2)\n- Global loop brings the local VCO frequency close\nto lock\n- Narrow local tuning range (+/-15%) is sufficient to\ncompensate for on-chip mismatches\n- Narrow tuning range leads to low VCO gain\n- Small loop capacitor area (2.5pF)\n- Low sensitivity on Vctrl noise\n\nWei\nLow-Power High-Speed Links\nClock Recovery\n- Optimal receiver timing is recovered from the\nincoming data stream\nRX\nData\nVCO\nFilter\nPD\nClock\nRecovery\n\nWei\nLow-Power High-Speed Links\nPhase Detection\n- Phase detector made of an identical set of\nreceivers minimizes timing error\nRX\nPD\nData\nRX\nEdge Detection\n/ Majority Voting\nΨ[4:0]\nEarly/Late\n/None\nReceived Data\nRX\nPD\nPD\nRX\nPD\nRX\nPD\nRX\nPD\n\nWei\nLow-Power High-Speed Links\nChip Prototype\n- 0.25μm CMOS\n- 2.5V / 0.55Vth\n- 3.1×2.9mm2\n- 0.4~5.0Gb/s\n- 0.9~2.5V\n- 5.6~375mW\n- BER < 10-15\n- Reg. Efficiency:\n83-94%\nTX\nTX\nTX\nTX\nTX-PLL\nTX-DLL\nTesting\nInterface\nRX\nRX-DLL\nRX\nRX-\nPLL\nTX/RX\nFeedback\nBiasing\ndata gen\ndata gen\nDigital Sliding\nController\nPower\nTransistors\nPRBS\nPRBS\n\nWei\nLow-Power High-Speed Links\n3.1Gb/s,\n113mW\nPower and Performance\n\nWei\nLow-Power High-Speed Links\nPower Breakdown\n\nWei\nLow-Power High-Speed Links\nSummary\n-\nHigher performance links require low noise Æ low noise\nsolutions lead to lower power\n- Trade performance (speed) for power reduction\n-\nDVS links enable energy-efficient link operation and also have\nsome nice properties\n-\nOutstanding issues with using DVS links\n- Communication during frequency and voltage transitions\n- Supply voltage regulator slew rate limits\n- Overhead of multiple regulators"
    },
    {
      "category": "Lecture Notes",
      "title": "lec1.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/98d136569823f918e795584f23816cb8_lec1.pdf",
      "content": "6.976\nHigh Speed Communication Circuits and Systems\nLecture 1\nOverview of Course\nMichael Perrott\nMassachusetts Institute of Technology\nCopyright (c) 2003 by Michael H. Perrott\n\nM.H. Perrott\nMIT OCW\nWireless Systems\nDirect conversion architecture\nsin(wot)\n90o\nD/A\nD/A\nDigital\nProcessing\nBlock\nDigital\nProcessing\nBlock\nsin(wot)\n90o\nA/D\nA/D\nTransmit IC\nReceive IC\nLNA\nPower\nAmp\nTransmitter issues\n- Meeting the spectral mask (LO phase noise & feedthrough,\nquadrature accuracy), D/A accuracy, power amp linearity\nReceiver Issues\n- Meeting SNR (Noise figure, blocking performance, channel\nselectivity, LO phase noise, A/D nonlinearity and noise),\nselectivity (filtering), and emission requirements\n\nM.H. Perrott\nMIT OCW\nFuture Goals\nLow cost, low power, and small area solutions\n- New architectures and circuits!\nIncreased spectral efficiency\n- Example: GSM cellphones (GMSK) to 8-PSK (Edge)\nRequires a linear power amplifier!\nIncreased data rates\n- Example: 802.11b (11 Mb/s) to 802.11a (> 50 Mb/s)\nGFSK modulation changes to OFDM modulation\nHigher carrier frequencies\n- 802.11b (2.5 GHz) to 802.11a (5 GHz) to ? (60 GHz)\nNew modulation formats\n- GMSK, CDMA, OFDM, pulse position modulation\nNew application areas\n\nM.H. Perrott\nMIT OCW\nHigh Speed Data Links\nA common architecture\nDEMUX\nDigital\nProcessing\nBlock\nReceive IC\nAmp\nClock\nand Data\nRecovery\nClock\nDistribution\n10 Gb/s\nData Link\nMUX\nDriver\nDigital\nProcessing\nBlock\nTransmit IC\nClock Generation\nTransmitter Issues\n- Intersymbol interference (limited bandwidth of IC\namplifiers, packaging), clock jitter, power, area\nReceiver Issue\n- Intersymbol interference (same as above), jitter from\nclock and data recovery, power, area\n\nM.H. Perrott\nMIT OCW\nFuture Goals\nLow cost, low power, small area solutions\n- New architectures and circuits!\nIncreased data rates\n- 40 Gb/s for optical (moving to 120 Gb/s!)\nElectronics is a limitation (optical issues getting significant)\n- > 5 Gb/s for backplane applications\nThe channel (i.e., the PC board trace) is the limitation\nHigh frequency compensation/equalization\n- Higher data rates, lower bit error rates (BER), improved\nrobustness in the face of varying conditions\n- How do you do this at GHz speeds?\nMulti-level modulation\n- Better spectral efficiency (more bits in given bandwidth)\n\nM.H. Perrott\nMIT OCW\nThis Class\nCircuit AND system focus\n- Knowing circuit design is not enough\n- Knowing system theory is not enough\nCircuit stuff\n- RF issues: transmission lines and impedance transformers\n- High speed design techniques\n- Basic building blocks: amplifiers, mixers, VCO's, digital\ncomponents\n- Nonidealities: noise and nonlinearity\nSystem stuff\n- Macromodeling and simulation\n- Wireless and high speed data link principles\n- System level blocks: PLL's, CDR's, transceivers\n\nM.H. Perrott\nMIT OCW\nThe Goal - Design at Circuit/System Level\n1. Design architecture with analytical models\n\nMay require new circuits - guess what they look like\n2. Verify architectural ideas by simulating with ideal\nmacro-models of circuit blocks\n\nGuess macro-models for new circuits\n3. Add known non-idealities of circuit blocks\n(nonlinearity, noise, offsets, etc.)\n\nGo back to 1. if the architecture breaks!\n4. Design circuit blocks and get better macro-models\n\nGo back to 1. if you can't build the circuit!\n\nGo back to 1. if the architecture breaks!\n5. Verify as much of system as possible with SPICE\n6. Layout, extract, verify\n\nDo this soon for high speed systems - iteration likely!\n\nM.H. Perrott\nMIT OCW\nKey System Level Simulation Needs\nYou need a fast simulator\n- To design new things well, you must be able to iterate\n- The faster the simulation, the faster you can iterate\nYou need to be able to add non-idealities in a\ncontrolled manner\n- Fundamental issues with architectures need to be\nseparated from implementation issues\nAn architecture that is fundamentally flawed should be\nquickly abandoned\nYou need flexibility\n- Capable of implementing circuit blocks such as filters,\nVCO's, etc.\n- Capable of implementing algorithms\n- Arbitrary level of detail\n\nM.H. Perrott\nMIT OCW\nA Custom C++ Simulator Will Be Used - CppSim\nBlocks are implemented with C/C++ code\n- High computation speed\n- Complex block descriptions\nUsers enter designs in graphical form using Cadence\nschematic capture\n- System analysis and transistor level analysis in the\nsame CAD framework\nResulting signals are viewed in Matlab\n- Powerful post-processing and viewing capability\nNote: Hspice used for circuit level simulations\nCppSim is on Athena and freely downloadable at\nhttp://www-mtl.mit.edu/~perrott\n\nA Quick Preview of Homeworks and Projects\n\nM.H. Perrott\nMIT OCW\nHW1 - Transmission Lines and Transformers\nHigh speed data link application:\nVout\nC1\nRL\nL1\nDelay = x\nCharacteristic Impedance = Ro\nIdeal Transmission Line\nRo\nVin\nTwo-Port Model\nC2\nEi1\nEr1\nEi2\nEr2\ndie\nAdjoining pins\nConnector\nControlled Impedance\nPCB trace\npackage\nOn-Chip\nDriving\nSource\nHigh Speed Trace (RF Connector to Chip Die)\n\nM.H. Perrott\nMIT OCW\nHW2 - High Speed Amplifiers\nM4\nM1\nM2\nM3\nIbias\nVin+\nR1\nVin-\nR2\nVo+\nVo-\n50 Ω\nVin\nM1\nM2\nLs\nLd\nLg\nCbig\nIbias = 1mA\nM3\nVout\nCL=1pF\n5 kΩ\nZin\nx\nBroadband\nNarrowband\n\nM.H. Perrott\nMIT OCW\nHW3 - Amplifier Noise and Nonlinearity\nAmplifier circuit\nModel\nM1\nIbias\nVout\n0.18\n0.18\nM2\nRL\nVin\nCbig2\nCbig1\nRT\n50 Ω\nVin\n50 Ω\n50 Ω\nNonlinearity\nVout\nVout = co + c1x + c2x2 + c3x3\nNoise\n\nM.H. Perrott\nMIT OCW\nHW4 - Low Noise Amplifiers and Mixers\nNarrowband LNA\nPassive Mixer\nVin\nCL\nRL/2\nRL/2\nRS/2\nCbig\nRS/2\nCbig\nLO\nLO\nLO\nLO\nVout\nVout\n0 V\nVdd\nVdd\n50 Ω\nVin\nM1\nM2\nLs\nLg\nCbig\nIbias = 1mA\nM3\nVout\nCL=1pF\n5 kΩ\nZin\nRps\nRpg\nRps\nCbig\nLd\nRpd\n\nM.H. Perrott\nMIT OCW\nHW5 - Voltage Controlled Oscillators\nDifferential CMOS\nColpitts\nVbias=1.2V\nM1\nLd=4nH\nVout\nC1=2pF\nIbias=100 μA\nC2=8pF\nRd=10kΩ\nM1\nM2\nM3\nVout\nCtune\n3 nH\n100/0.18\n50/0.18\nM4\n100/0.18\n50/0.18\nVout\nVin\n1.8 V\n0 V\n\nM.H. Perrott\nMIT OCW\nProject 1 - High Speed Frequency Dividers\nHigh speed\nlatches/registers\nHigh speed dual-modulus\ndivider\nLoad\nLoad\nIN\nIN\nOUT\nOUT\nΦ\nΦ\n2/3\nCore\nControl\nQualifier\nCON\nIN\nOUT\nA\nB\n2/3\nIN\nA\nB\nOUT\nCON*\n8 + CON Cycles\nCON*\nCON\n\nM.H. Perrott\nMIT OCW\nHW6 - Phase Locked Loop Design\nInteger-N synthesizer\nPhase noise simulation\nPFD\nLoop\nFilter\nref(t)\nout(t)\nDivider\nT\nT\ne(t)\nvin(t)\ndiv(t)\nVCO\nN[k] = Nnom\nIcp\nout(t) = cos(2π (fo+Kvvin(τ))dτ)\nvin\nout\nt\ns\n1 + s/(2πfp)\nvph\nSΦout(f)\nfoffset\n-20 dBc/Hz/dec\nvspur = Asin(2πfst)\nK2 dBc\nK1 dBc/Hz\nfp\nfs\n\nM.H. Perrott\nMIT OCW\nProject 2 - GMSK Transmitter for Wireless Apps\nKv = 30 MHz/V\nfo = 900 MHz\nGaussian\nLPF\nData\nGenerator\nDigital I/Q Generation\nout(t)\nT\nT\nt\nTd\nt\nT\nLoop Filter\nReference\nFrequency\nvin(t)\nPFD\nN\nRF Transmit\nSpectrum\nf\nfRF\nTrans.\nNoise\nPower\nAmp\nKph\n1 - z-1\ncos(Φ)\nsin(Φ)\nD/A\nD/A\nΦ\nfinst\n90o\nI\nQ\nPeak-to-Peak\nFrequency\nDeviation\nTd\nt\nInstantaneous\nFrequency\nData Eye\nLimit\nAmp\n(100 MHz)\n=\n1 MHz\nIncludes\nZero-Order\nHold\nIcp\nH(s)\n\nM.H. Perrott\nMIT OCW\nProject 2 - Accompanying Receiver\nf\nf\nfRF\nfRF\nReceived\nSpectrum\nReceiver\nNoise\nf\nBaseband\nSpectrum\ncos(2πfRFt)\nIR\nQR\nNR\nReceiver\nNoise\nModulation\nSignal\nTransmitter\nNoise\nS(IR+jQR)\nTrans.\nNoise\nLNA\nBand\nSelect\nFilter\nChannel\nSelect\nFilter\nsin(2πfRFt)\n\nBasics of Digital Communication\n\nM.H. Perrott\nMIT OCW\nExample: A High Speed Backplane Data Link\nSuppose we consider packaging issues at the receiver\nside (ignore transmitter packaging now for simplicity)\nVout\nDelay = 110 ps\nCharacteristic Impedance = 50 Ω\nIdeal Transmission Line\n100 Ω\nVin\nTwo-Port Model\nEi1\nEr1\nEi2\nEr2\ndie\nAdjoining pins\nControlled Impedance\nPCB trace\npackage\nOn-Chip\nDriving\nSource\n55 Ω\n0.5 pF\nM4\nM1\nM2\nM3\nIbias\nVin+\nVin-\nVo+\n100 Ω\n100 Ω\nReceiver\nTransmitter\nunintentional\nmismatch\nintentional\nmismatch\n0.5 pF\n1 nH\n\nM.H. Perrott\nMIT OCW\nModulation Format\nBinary, Non-Return to Zero (NRZ), Pulse Amplitude\nModulation (PAM)\n- Send either a zero or one in a given time interval Td\n- Time interval set by a low jitter clock\n- Ideal signal from transmitter:\n0.5\n1.5\n2.5\nx 10\n-8\n-0.05\n0.05\n0.1\n0.15\n0.2\n0.25\n0.3\n0.35\n0.4\nin\nTIME\n\nM.H. Perrott\nMIT OCW\nReceiver Function\nTwo operations\n- Recover clock and use it to sample data\n- Evaluate data to be 0 or 1 based on a slicer\nSlice\nLevel\nSampling\nInstant\nRecovered\nClock\nDetector\nData\nClock\nRecovery\nOut\nData\nOut\n0 1 1\n0 0 0\n0 0\nRecovered\nClock\n\nM.H. Perrott\nMIT OCW\nIssue: PC Board Trace is Not an Ideal Channel\nChip capacitance and inductance limits bandwidth\nTransmission line effects cause reflections in the\npresence of impedance mismatch\nExample: transmit at 1 Gb/s across link in previous\nslide (assume bondwire inductance is zero)\n- Signal at receiver termination resistor\n0.5\n1.5\n2.5\nx 10\n-8\n-0.05\n0.05\n0.1\n0.15\n0.2\n0.25\n0.3\n0.35\n0.4\nout\nTIME\n\nM.H. Perrott\nMIT OCW\nEye Diagram for 1 Gb/s Data Rate\nWrap signal back onto itself every 2*Td seconds\n- Same as an oscilloscope would do\nAllows immediate assessment of the quality of the\nsignal at the receiver (look at eye opening)\n0.2\n0.4\n0.6\n0.8\n1.2\n1.4\n1.6\n1.8\nx 10\n-9\n-0.05\n0.05\n0.1\n0.15\n0.2\n0.25\n0.3\n0.35\n0.4\nTime (seconds)\nout\nEye Diagram\n\nM.H. Perrott\nMIT OCW\nRelationship of Eye to Sampling Time and Slice Level\n0.2\n0.4\n0.6\n0.8\n1.2\n1.4\n1.6\n1.8\nx 10\n0.05\n0.05\n0.1\n0.15\n0.2\n0.25\n0.3\n0.35\n0.4\nTime (seconds)\nout\nEye Diagram\nSlice\nLevel\nSampling\nInstant\nHorizontal portion of eye indicates sensitivity to timing\njitter\nVertical portion of eye indicates sensitivity to additional\nnoise and ISI\n\nM.H. Perrott\nMIT OCW\nWhat Happens if We Increase the Data Rate?\nLimited bandwidth and reflections cause intersymbol\ninterference (ISI)\nEye diagram at 10 Gb/s for same data link\nx 10\n-10\n-0.1\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\nTime (seconds)\nout\nEye Diagram\n\nM.H. Perrott\nMIT OCW\nWhat is the Impact of the Bondwire Inductance?\nRule of thumb: 1 nH/mm for bondwire\n- Assume 1 nH\nImpact of inductance here increases bandwidth\n- less ISI occurs\nx 10\n-10\n-0.1\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\nTime (seconds)\nout\nEye Diagram\n\nM.H. Perrott\nMIT OCW\nHow High of a Data Rate Can The Channel Support?\nRaise it to 25 Gb/s\nHowever, we haven't considered other issues\n- PC board trace attenuates severely at high frequencies\nBandwidth is < 5 GHz for 48 inch PC board trace (FR4)\nx 10\n-11\n-0.1\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\nTime (seconds)\nout\nEye Diagram\n\nM.H. Perrott\nMIT OCW\nMulti-Level Signaling\nIncrease spectral efficiency by sending more than one\nbit during a symbol interval\n- Example: 4-Level PAM at 12.5 Gb/s on same channel\nEffective data rate: 25 Gb/s\n0.2\n0.4\n0.6\n0.8\n1.2\n1.4\n1.6\nx 10\n-10\n-0.2\n-0.1\n0.1\n0.2\n0.3\n0.4\n0.5\nTime (seconds)\nout\nEye Diagram\n\nM.H. Perrott\nMIT OCW\nHow Else Can We Reduce ISI?\nConsider a system level view of the link\n- Channel can be viewed as having an equivalent\nfrequency response\nAssumes linearity and time-invariance (accurate for most\ntransmission line systems)\nTransmitter\nDriver\nReceiver\nDetector\nChannel\nTransmitter\nReceiver\n\nM.H. Perrott\nMIT OCW\nEqualization\nUndo channel frequency response with an inverse\nfilter at the receiver\n- Removes ISI!\n- Can make it adaptive to learn channel\nTransmitter\nDriver\nReceiver\nDetector\nChannel\nTransmitter\nReceiver\nEqualization\n\nM.H. Perrott\nMIT OCW\nThe Catch\nEqualization enhances noise\n- Overall SNR may be reduced\nOptimal approach is to make ISI and noise\ndegradation about equal\nTransmitter\nDriver\nReceiver\nDetector\nChannel\nTransmitter\nReceiver\nEqualization\nNoise\n\nM.H. Perrott\nMIT OCW\nAlternative - Pre-emphasize at Transmitter\nPut inverse filter at transmitter instead of receiver\n- No enhancement of noise, but ...\n- Need feedback from receiver to learn channel\n- Requires higher dynamic range/power from transmitter\nTransmitter\nDriver\nReceiver\nDetector\nChannel\nTrransmitter\nReceiver\nNoise\nCompensation\n(Pre-emphasis)\n\nM.H. Perrott\nMIT OCW\nBest Overall Performance\nCombine compensation and equalization\n- Starting to see this for high speed links\nTransmitter\nDriver\nReceiver\nDetector\nChannel\nTrransmitter\nReceiver\nEqualization\nNoise\nCompensation\n(Pre-emphasis)\n\nM.H. Perrott\nMIT OCW\nWhat are the Issues with Wireless Systems?\nNoise\n- Need to extract the radio signal with sufficient SNR\nSelectivity (filtering, processing gain)\n- Need to remove interferers (which are often much larger!)\nNonlinearity\n- Degrades transmit spectral mask\n- Degrades selectivity for receiver\nMulti-path (channel response)\n- Degrades signal - nulls rather than ISI usually the issue\n- Can actually be used to advantage!\nWe will look at BOTH broadband data links and\nwireless systems in this class"
    },
    {
      "category": "Lecture Notes",
      "title": "lec2.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/71a56a4978bc9fb3a200e612af5fee91_lec2.pdf",
      "content": "6.976\nHigh Speed Communication Circuits and Systems\nLecture 2\nTransmission Lines\nMichael Perrott\nMassachusetts Institute of Technology\nCopyright (c) 2003 by Michael H. Perrott\n\nM.H. Perrott\nMIT OCW\nMaxwell's Equations\nGeneral form:\nAssumptions for free space and transmission line propagation\n- No charge buildup ⇒ρ = 0\n- No free current ⇒J = 0\nNote: we'll only need Equations 1 and 2\n\nM.H. Perrott\nMIT OCW\nAssumptions\nOrientation and direction\n- E field is in x-direction and traveling in z-direction\n- H field is in y-direction and traveling in z-direction\n- In freespace:\nFor transmission line (TEM mode)\ny\nx\nz\nEx\nHy\ndirection\nof travel\nx\nz\nEx\nHy\nb\na\ny\ndirection\nof travel\n\nM.H. Perrott\nMIT OCW\nSolution\nFields change only in time and in z-direction\n- Assume complex exponential solution\n\nM.H. Perrott\nMIT OCW\nSolution\nFields change only in time and in z-direction\n- Assume complex exponential solution\nImplications:\n\nM.H. Perrott\nMIT OCW\nSolution\nFields change only in time and in z-direction\n- Assume complex exponential solution\nImplications:\nBut, what is the value of k ?\n\nM.H. Perrott\nMIT OCW\nEvaluate Curl Operations in Maxwell's Formula\nDefinition\n\nM.H. Perrott\nMIT OCW\nEvaluate Curl Operations in Maxwell's Formula\nDefinition\nGiven the previous assumptions\n\nM.H. Perrott\nMIT OCW\nNow Put All the Pieces Together\nSolve Maxwell's Equation (1)\n\nM.H. Perrott\nMIT OCW\nNow Put All the Pieces Together\nSolve Maxwell's Equations (1) and (2)\n\nM.H. Perrott\nMIT OCW\nNow Put All the Pieces Together\nSolve Maxwell's Equations (1) and (2)\n\nM.H. Perrott\nMIT OCW\nConnecting to the Real World\nCurrent solution is complex\nBut the following complex solution is also valid\nAnd adding them together is also a valid solution that\nis now real-valued\n\nM.H. Perrott\nMIT OCW\nCalculating Propagation Speed\nThe resulting cosine wave is a function of time AND\nposition\nConsider \"riding\" one part of the wave\nVelocity calculation\ny\nx\nz\ndirection\nof travel\nz\nt\nEx(z,t)\n\nM.H. Perrott\nMIT OCW\nFreespace Values\nConstants\nImpedance\nPropagation speed\nWavelength of 30 GHz signal\n\nM.H. Perrott\nMIT OCW\nVoltage and Current\nDefinitions:\nx\ny\na\nb\nH\nt\nw\nx\nz\nEx\nHy\nb\na\ny\nI\nE\n\nM.H. Perrott\nMIT OCW\nParallel Plate Waveguide\nE-field and H-field are influenced by plates\nx\nz\nEx\nHy\nb\na\ny\n\nM.H. Perrott\nMIT OCW\nCurrent and H-Field\nAssume that (AC) current is flowing\nx\nz\nEx\nHy\nb\na\ny\nI\nI\n\nM.H. Perrott\nMIT OCW\nCurrent and H-Field\nCurrent flowing down waveguide influences H-field\nx\nz\nEx\nHy\nb\na\ny\nx\ny\nI\nI\nH\n\nM.H. Perrott\nMIT OCW\nCurrent and H-Field\nFlux from one plate interacts with flux from the other\nplate\nx\nz\nEx\nHy\nb\na\ny\nx\ny\nI\nI\n\nM.H. Perrott\nMIT OCW\nCurrent and H-Field\nApproximate H-Field to be uniform and restricted to lie\nbetween the plates\nx\nz\nEx\nHy\nb\na\ny\nx\ny\na\nb\nI\nI\n\nM.H. Perrott\nMIT OCW\nVoltage and E-Field\nApproximate E-field to be uniform and restricted to lie\nbetween the plates\nx\nz\nEx\nHy\nb\na\ny\na\nb\nJ\nJ\nx\ny\nE\nV\n\nM.H. Perrott\nMIT OCW\nBack to Maxwell's Equations\nFrom previous analysis\nThese can be equivalently written as\nWhere\n\nM.H. Perrott\nMIT OCW\nWave Equation for Transmission Line (TEM)\nKey formulas\nSubstitute (2) into (1)\nCharacteristic impedance (use Equation (1))\n\nM.H. Perrott\nMIT OCW\nConnecting to the Real World\nCurrent solution is complex\nBut the following solution is also valid\nAnd adding them together is also a valid solution\n\nM.H. Perrott\nMIT OCW\nCalculating Propagation Speed\nThe resulting cosine wave is a function of time AND\nposition\nConsider \"riding\" one part of the wave\nVelocity calculation\ny\nx\nz\ndirection\nof travel\nz\nt\nEx(z,t)\n\nM.H. Perrott\nMIT OCW\nIntegrated Circuit Values\nConstants\nImpedance (geometry dependant)\nPropagation speed (geometry independent)\nWavelength of 30 GHz signal in silicon dioxide\n\nM.H. Perrott\nMIT OCW\nLC Network Analogy of Transmission Line (TEM)\nLC network analogy\nCalculate input impedance\nL\nC\nL\nC\nL\nC\nL\nZin\n\nM.H. Perrott\nMIT OCW\nHow are Lumped LC and Transmission Lines Different?\nIn transmission line, L and C values are infinitely\nsmall\n- It is always true that\nFor lumped LC, L and C have finite values\n- Finite frequency range for\nL\nC\nL\nC\nL\nC\nL\nZin\n\nM.H. Perrott\nMIT OCW\nLossy Transmission Lines\nPractical transmission lines have losses in their\nconductor and dielectric material\n- We model such loss by including resistors in the LC\nmodel\nThe presence of such losses has two effects on\nsignals traveling through the line\n- Attenuation\n- Dispersion (i.e., bandwidth degradation)\nSee Chapter 5 of Thomas Lee's book for analysis\nZin\n1/G\nL\nC\nR\n1/G\nL\nC\nR\n1/G\nL\nC\nR\nL\nR"
    },
    {
      "category": "Resource",
      "title": "guest3.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/74927837820d5a11a2443b5b86ce0f50_guest3.pdf",
      "content": "The World Leader in High-Performance Signal Processing Solutions\nRF IF\nRF Power Amplifiers\nMay 7, 2003\n\nRF IF\nOutline\nPA Introduction\nz Power transfer characteristics\nz Intrinsic PA metrics\nz Linear and Non-linear amplifiers\nz PA Architectures\nSingle-Stage Linear PA\nz Load-line theory\nz Transistors size\nz Input and Output Matching\nz So why is this so hard?\nHigh-efficiency PAs\nz Class A, AB, B and C amplifiers\n\nRF IF\nOutline (cont.)\nReal-World Design Example\nz Selecting architecture, number of stages\nz Designing stages\nz Tuning: inter-stage match and output\nSystem specifications\nz Ruggedness: load mis-match and VSWR\nz Linearity: spectral mask (ACPR), switching transients\nz Noise in receive band\nPower Control\n\nRF IF\nPA Transfer characteristics\nDefining linearity:\nG\nPin\n(dBm)\nPout (dBm)\nPout = Pin + G\nlinear\nnon-linear (actual)\n\nRF IF\nPA Transfer characteristics\nDefining linearity:\nGain (dB)\nPin\n(dBm)\nPout (dBm)\nG\n-1\nP1dB\nPMAX\n\nRF IF\nPA Introduction: Intrinsic PA Metrics\nP1dB: Output power at which linear gain has compressed by\n1dB (measure of linear power handling)\nPMAX: Maximum output power (saturated power)\nGain: Generally taken to mean transducer gain\nPAE: Power-added Efficiency\nPower delivered to load\nPower available from source\nPower to load - Power from source\nPower from supply\n\nRF IF\nLinear and Non-linear PAs\n\"Linear PA\" generally refers to a PA which operates at\nconstant gain, needs to preserve amplitude information\nPOUT (dBm)\nPIN (dBm)\nDesigned to operate here\nNot necessarily class A (will discuss later ...) Peak\nefficiencies often only 40 to 45 %\nUseful for modulation schemes with amplitude modulation\n(QPSK, 8-PSK, QAM)\n\nRF IF\nLinear and Non-linear PAs\n\"Non-linear PA\" generally refers to a PA designed to operate\nwith constant PIN, output power varies by changing gain\nPOUT (dBm)\nPIN (dBm)\nDesigned to operate here:\nNOT fixed gain!\nPOUT adjusted through\nbias control\nOperation in saturated mode leads to high peak efficiencies\n> 50%; \"backed-off\" efficiencies drop quickly\nUseful for constant-envelope modulation schemes (GMSK)\n\nRF IF\nPA Architectures\nTypical 2-stage (6.012) design\nVB1\n50 Ω\ninput\nVPOS\n50 Ω\nMax power\ntransfer?\nIREF\nVB2\n\nRF IF\nPA Architectures\nTypical 2-stage RF PA design\nVB1\nVB2\n50 Ω\nRF input\nVPOS\nmatching\nnetwork\nmatching\nnetwork\ninductive RF choke\nallows output to rise\nabove VPOS, doesn't\ndissipate power\nMay require additional\nRF choke here to isolate\ninput from bias circuit\nL's and C's to\ntransform load\nimpedance\n\nRF IF\nPA Architectures\nTypical 2-stage RF PA design\nVB1\nVB2\n50 Ω\nRF input\nVPOS\nmatching\nnetwork\nmatching\nnetwork\nAdditional caps\nmay be required for\nmatching network,\nharmonic termination\n\nRF IF\nPA Architectures\nTypical 2-stage RF PA design\nVB1\nVB2\n50 Ω\nRF input\nVPOS\nmatching\nnetwork\nmatching\nnetwork\nbond wires (at least ...)\n\nRF IF\nPA Architectures\nTypical 2-stage RF PA design\nVB1\nVB2\n50 Ω\nRF input\nVPOS\nmatching\nnetwork\nmatching\nnetwork\nConsider this ...\n\nRF IF\nPA Architectures\n\"Gain stage\" is one transistor with passive elements\n\"Active\" components often limited to 2 or 3 transistors (gain\nstages) in signal path\nTransistor design very important!\nz Many parallel transistors - often look like mini-circuits\nthemselves\nPassive components just as important as transistors!\nz Circuits must be tunable to account for uncertainties in\ndetermining values a priori (i.e. simulations stink - especially\nlarge-signal, RF simulations)\nz Q and parasitic elements of passives important\n\nRF IF\nSingle-Stage Linear PA\nLoad-line theory: the maximum power that a given transistor\ncan deliver is determined by the power supply voltage and\nthe maximum current of the transistor\nID or IC (mA/mm)\nVDS or VCE (V)\n2*VPOS\nIMAX\nRLOAD,opt. ≈\n2⋅VPOS / IMAX\n\nRF IF\nSingle-Stage Linear PA\nTransistor size chosen to deliver required output power\nPOUT ≈IMAX⋅VPOS / 4\nID or IC (mA/mm)\nVDS or VCE (V)\n2*VPOS\nIMAX\nQuiescent point:\nClass A\nIMAX/2, VPOS\nRL,opt.\n\nRF IF\nSingle-Stage, Linear PA\nDesign output match to transform 50Ωload to RL,opt at\ntransistor output; then design input match for gain (complex\nconjugate)\nVB1\n50 Ω\nCJC\noutput\nmatch\ninput\nmatch\nVPOS\n\nRF IF\nSeems simple, so why is this so hard?\nDetermining IMAX is not so easy\nz For BJTs, one reference suggested that \"the best way of\nestimating its value is to build an optimized class A amplifier\nand observe the dc supply current.\"1\nz Somewhat easier for depletion-mode GaAs FETs - IMAX often\ncorresponds to VGS = 0V\nz Values don't scale linearly with transistor size\nOptimal load resistance only a theoretical number\nz Transmission line effects, parasitic L's and C's significant at RF\nz Common practice is to vary the load of an actual transistor to\ndetermine the peak output power: the load-pull measurement\n(Noticing a distinct pattern of \"empirical\" design emerging?)\n1 RF Power Amplifiers for Wireless Communications, Steve Cripps, Artech House, Boston, 1999.\n\nRF IF\nSeems simple, so why is this so hard?\nNow consider the problem for multiple stages ... double the\ntrouble\nz Typical single-stage gain only 10 - 15 dB\nz Inter-stage match now required to match input impedance of 2nd\nstage to desired output impedance of 1st stage.\nProblems with matching circuits:\nz Large matching ratios →high Q circuits for simple L matches\nz Multi-segment matches use valuable real estate, add cost\nTransistor itself maters - a lot!\nz Many parallel transistor\nz Ballasting, balancing and layout extremely important\n\nRF IF\nHigh-efficiency PAs\nInput signal swing turns on transistor - conduction for\nonly part of sinusoidal period\nID or IC (mA/mm)\nVDS or VCE (V)\nIMAX\nQuiescent point:\nClass AB to B\nClass A\n\nRF IF\nHigh-Efficiency PAs\nωt\nID or IC\nClass A:\nπ\n2π\n3π\nID or IC\nClass AB:\nωt\nπ\n2π\n3π\nID or IC\nClass B:\nωt\nπ\n2π\n3π\nConduction\nAngle:\nα = 2π\nπ < α < 2π\nα = π\nClass C: α < π\nα\n\nRF IF\nHigh-Efficiency PAs\nAssume output match will filter out non-linearities caused by\ndiscontinuous conduction:\nVB1\n50 Ω\noutput\nmatch\ninput\nmatch\n50Ωtransformed\nto RL,opt:\nAll harmonics\nfiltered out\n\nRF IF\nHigh-Efficiency PAs\nIf all harmonics filtered out, then voltage output at load is a\npure sinusoid, despite discontinuous conduction\nωt\nVOUT\nπ\n2π\n3π\nIC\nωt\nπ\n2π\n3π\nIMAX\nEnergy stored in reactive elements delivers current to the\nload during transistor off-portion of cycle\n\nRF IF\nHigh-Efficiency PAs\nNow consider peak efficiencies\nCalculate fundamental component of current*\n* There are many texts which cover reduced-conduction angle calculations. See for example Principles\nOf Power Electronics, Kassakian, Schelcht and Verghese, Ch. 3.\nIC\nωt\n2π\nα/2\nIpk = IMAX -IQ\nIMAX\nIQ\n(1/2π)∫\nα/2\n-α/2\nIQ + Ipk cos(ωt) dωt\nIdc =\n(1/π) ∫\nα/2\n-α/2\nIpk cos(ωt) cos(nωt) dωt\nIn =\n\nRF IF\nHigh-Efficiency PAs\nFrom phasor plot: cos(α/2) = -IQ / Ipk = -IQ / (IMAX - IQ)\nPut it all together and do the math, you get:\nAssume VOUT the same for all classes:\nI1,0-p =\nα - sinα\n1 - cos(α/2)\nIMAX\n2π\nIdc =\n2sin(α/2) - αcos(α/2)\n1 - cos(α/2)\nIMAX\n2π\nV1,0-p = VPOS\n\nRF IF\nHigh-Efficiency PAs\nSummary of PA \"ideal\" peak efficiencies\nClass A:\n(IMAX /2) /√2 ⋅VPOS /√2\n(IMAX /2) ⋅VPOS\nP1\nPdc\n=\n= 50 %\nClass B:\n(IMAX /2) /√2 ⋅VPOS /√2\n(IMAX /π) ⋅VPOS\nP1\nPdc\n=\n= 78 %\nClass C:\nIdeally can go to 100%, but P1 drops\nsteadily beyond α=π, goes to 0 at 100%!\n\nRF IF\nHigh-Efficiency PAs\nWhat happened to our load line?\nz For class B fundamental RL,opt = VPOS/(IMAX/2) - Didn't change\nID or IC (mA/mm)\nVDS or VCE (V)\nIMAX\nClass A\n2VPOS\nVPOS\n?\nClass B is here!\n\nRF IF\nHigh-Efficiency PAs\nWhat happened to our load line?\nz For class B fundamental RL,opt = VPOS/(IMAX/2) - Didn't change\nID or IC (mA/mm)\nVDS or VCE (V)\nIMAX\nClass A\n2VPOS\nVPOS\nClass B is here!\nquasi-static\nIn quasi-static\npicture, resistance\npresented to\ntransistor output cut\nin half. But average\nresistance is the\nsame for class A\nIMAX /2\n\nRF IF\nHigh-Efficiency PAs\nNow consider \"linearity\"\nz Clearly the current waveforms are far from linear\nBUT ...\nz Overall POUT vs. PIN transfer function can still be quite linear,\nespecially for true Class B where output current waveform is\nsymmetrical with respect to input waveform\nID or IC\nωt\nπ\n2π\n3π\nBecause conduction angle is constant,\nPOUT changes proportional to PIN\n\nRF IF\nReal-World Design Example\nIDEAL: Design each stage independently\nz Determine required gain - number of stages\nz Determine POUT for each stage\nz Determine RL,opt for each stage\nz Determine input impedance for each stage\nz Design matching networks for inter-stage, load and input\nREALITY:\nz IMAX doesn't scale nicely with transistor size. Without good IMAX\nnumbers, can't determine RL,opt. Need to do load-pull.\nz Even load pull measurements have limited accuracy for very\nlarge transistors\nz Designs are very empirically driven!\n\nRF IF\nReal-World Design Example\nGSM 900 MHz, GaAs HBT PA Design\nPOUT = 33 dBm (linear) = 2 W\nVCC = 3.5V\nRLOAD = VCC\n2 / 2*POUT = 3 Ω\nIMAX = 2*VCC /RLOAD = 2.33 A\n(Note: expect saturated power to be ~ 35 dBm)\nInput power: constant-envelope +5 dBm\nGain = POUT - PIN = 27 dB.\nExpect roughly 10 dB per stage\n3 STAGE DESIGN\n\nRF IF\nReal-World Design Example\nStage 1: Gain = 10 dB →POUT = 15 dBm\nz RL1 = VCC\n2 / 2*POUT = 194 Ω\nz IMAX = 2*VCC /RLOAD = 36 mA\nz Chose class A: IDC = IMAX/2 = 18 mA\n(18 mA insignificant compared to 2.33 A)\nStage 2: Gain = 10 dB →POUT = 25 dBm\nz RL2 = 19.4 Ω\nz IMAX = 360 mA\nz Still probably class A (maybe AB): IDC = IMAX/2 = 180 mA\nStage 3: Gain = 7 dB →POUT = 33 dBm\nz RL2 = 3 Ω, IMAX = 2.33 A\nz Class B: IDC = IMAX/π = 742 mA\n\nRF IF\nReal-World Design Example\nA note on \"Gain\"\n\nTaking a very simplistic view of common emitter stages:\nz\ngm1 = IC / VTh = 18 mA / 0.025 V = 0.696 S\nz\ngm1RL1 = 0.696 ⋅194 = 135 →NOT 10 dB!\nBUT ...\nz\nre1 = 1/gm1 = 1.44 Ω\nz\nre2 = 1/gm2 = 0.144 Ω\nz\nre3 = 1/gm3 = 0.035 Ω\n1. Remember it's power gain, not voltage gain. Can lose\nvoltage at input match.\n2. It's pretty tough not to get significant degeneration!\n\nRF IF\nReal-World Design Example\nEfficiency calculations:\nz IDC1 = 18 mA, IDC2 = 180 mA, IDC3 = 742 mA\nz Total DC Current: 940 mA\nz Realistically may get as high as 55%\n(IMAX /2) /√2 ⋅VPOS /√2\nIDC⋅VPOS\nP1\nPdc\n=\n= 62 %\n\nRF IF\nReal-World Design Example: Load-Pull\nAfter initial \"guesses\" at transistor sizes, load-pull to\ndetermine actual target load for matching circuits\nVB\nRF input\nZL\nLoad pull: Vary ZL\nPlot contours of\nconstant power\nPMAX\nPMAX - 1dB\nPMAX - 2dB\n\nRF IF\nReal-World Design Example: Load-pull\nNotes on load-pulling:\nMost accurate on probe station, but insertion loss of probes\nprevents it from being useful for large transistors\n(\"Insertion loss\" is RF code word for resistance)\nBonded devices on evaluation board must be carefully de-\nembedded\nEven using electronic tuners, accuracy is poor for very large\ntransistor (i.e. for loads in the 2 - 5 Ωrange)\n\nRF IF\nReal-World Design Example: The Circuit\nVB1\nVB2\n50 Ω\nRF input\nVPOS\nVB2\nGaAs die\n\nRF IF\nReal-World Design Example: The Circuit\nVB1\nVB2\n50 Ω\nRF input\nVPOS\nVB2\nInter-stage\nmatch\n\nRF IF\nReal-World Design Example\nVB1\nVB2\n50 Ω\nRF input\nVPOS\nVB2\nLBOND\n+ TL\nprinted\ninductor\nLBOND + LVIA\nLparasitic\n+ LVIA\nLBOND\n+ TL\nLBOND\n\nRF IF\nReal-World Design Example\nVB1\nVB2\n50 Ω\nRF input\nVPOS\nVB2\nmay need\nto add feedback\nfor stability\n\nRF IF\nReal-World Design Example: Tuning\nExample of inter-stage match, 1st to 2nd stage\nRL1 = 194 Ω (?)\nZIN2 = 30 - j10 (?)\nRL1\nZIN2\nTransmission line\nBond wire\nBoth are really\njust guesses\n* Go to Winsmith: test\n\nRF IF\nReal-World Design Example: Tuning\nExample of inter-stage match, 2nd to 3rd stage\nRL2 = 19.4 Ω\nZIN3 = 2 - j2\nRL2\nZIN3\nTransmission line\nBond wire\n* Go to Winsmith: test2\nBond wires\nOff-chip\n\nRF IF\nSystem Specifications\nRuggedness\nz 50 Ωload is for antenna in free space. Place antenna on a metal\nplate and can easily get VSWR of 4:1\nz Typical PA specs are: don't oscillate at up to 4:1, survive up to\n10:1 (!)\nt = t2\nV1\n-\nV1\nz\nt = t1\nV1\n+\nV1\n-= Γ⋅V1\n+\nt\nV1\n\nRF IF\nSystem Specifications\nLinearity\nz For linear PAs, Adjacent Channel Power Ratio (ACPR) is very\nimportant\nraised cosine filter\nPower Spectral\nDensity (PSD)\n(dBm/Hz)\nch.\nA\nch.\nB\nch.\nC\nfc\nfc+∆f\nfc-∆f\n\nRF IF\nSystem Specifications\nLinearity\nz For linear PAs, Adjacent Channel Power Ratio (ACPR) is very\nimportant\nPower Spectral\nDensity (PSD)\n(dBm/Hz)\nch.\nA\nch.\nB\nch.\nC\nfc\nfc+∆f\nfc-∆f\n3rd order distortion\n\nRF IF\nSystem Specifications\nLinearity\nz For linear PAs, Adjacent Channel Power Ratio (ACPR) is very\nimportant\nPower Spectral\nDensity (PSD)\n(dBm/Hz)\nch.\nA\nch.\nB\nch.\nC\nfc\nfc+∆f\nfc-∆f\n3rd order\ndistortion\n3rd order\ndistortion\n5th order\ndistortion\n5th order\ndistortion\n\nRF IF\nSystem Specifications\nLinearity\nz For linear PAs, Adjacent Channel Power Ratio (ACPR) is very\nimportant\nPower Spectral\nDensity (PSD)\n(dBm/Hz)\nfc\nfc+∆f\nfc-∆f\n30 kHz\n∆f\nACPR =\nPwr. Ch. B\nPwr. Ch. A\n\nRF IF\nSystem Specifications\nLinearity\nz For non-linear PA in TDMA systems, harmonic spurs and\nswitching transients are most common measure of linearity\ntime\nPOUT (dBm)\n577μs\nGSM burst\nSignal ramping\nprofile must fall\nwithin time mask\n\nRF IF\nSystem Specifications\nNoise in receive band:\nz Obvious spec. in systems where Tx and Rx are operating at the\nsame time (FDD)\nPower Spectral\nDensity (PSD)\n(dBm/Hz)\n30 kHz\n30 kHz\n45 MHz\nRx\nTx\n\nRF IF\nSystem Specifications\nNoise in receive band:\nz Obvious spec. in systems where Tx and Rx are operating at the\nsame time (FDD)\nz Not so obvious spec in TDD system. Problem primarily of\nmixing by the PA (2ω2 - ω1 or ω2 - ω1 )\nPower Spectral\nDensity (PSD)\n(dBm/Hz)\n45 MHz\nRx\nTx\n\nRF IF\nPower Control\nFor linear PA, expected to operate at constant gain. Power\ncontrol is therefore a function of PIN.\nRole of bias circuitry is to maintain constant gain over PIN,\ntemperature (PTAT?).\nPower\ntransistor\n\nRF IF\nPower Control\nFor non-linear PA, expected to operate at constant PIN.\nPower control is achieved by varying gain.\nVAPC\nPower\ntransistor\nOn-chip\nbias circuitry\nExternal\ncontrol signal"
    },
    {
      "category": "Lecture Notes",
      "title": "lec3.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/00821251ca1f3e3f7988c42a61e991c4_lec3.pdf",
      "content": "6.976\nHigh Speed Communication Circuits and Systems\nLecture 3\nS-Parameters and Impedance Transformers\nMichael Perrott\nMassachusetts Institute of Technology\nCopyright (c) 2003 by Michael H. Perrott\n\nM.H. Perrott\nMIT OCW\nWhat Happens When the Wave Hits a Boundary?\nReflections can occur\nx\nz\nEx\nHy\ny\nZL\nEx\nHy\nZL\nIncident Wave\nReflected Wave\n\nM.H. Perrott\nMIT OCW\nWhat Happens When the Wave Hits a Boundary?\nAt boundary\n- Orientation of H-field flips with respect to E-field\nCurrent reverses direction with respect to voltage\nx\nz\nEx\nHy\ny\nZL\nEx\nHy\nZL\nIncident Wave\nReflected Wave\nI\nI\nI\nI\n\nM.H. Perrott\nMIT OCW\nWhat Happens At The Load Location?\nVoltage and currents at load are ratioed according to the\nload impedance\nx\nz\ny\nZL\nZL\nIncident Wave\nReflected Wave\nIi\nIi\nIr\nIr\nVi\nVr\nVoltage at Load\nCurrent at Load\nRatio at Load\n\nM.H. Perrott\nMIT OCW\nRelate to Characteristic Impedance\nFrom previous slide\nVoltage and current ratio in transmission line set by it\ncharacteristic impedance\nSubstituting:\n\nM.H. Perrott\nMIT OCW\nDefine Reflection Coefficient\nDefinition:\n- No reflection if ΓL = 0\nRelation to load and characteristic impedances\nAlternate expression\n- No reflection if ZL = Zo\n\nM.H. Perrott\nMIT OCW\nParameterization of High Speed Circuits/Passives\nCircuits or passive structures are often connected to\ntransmission lines at high frequencies\n- How do you describe their behavior?\nLinear Network\nTransmission Line 1\nTransmission Line 2\n\nM.H. Perrott\nMIT OCW\nCalculate Response to Input Voltage Sources\nAssume source impedances match their respective\ntransmission lines\nZ2\nZ1\nLinear Network\nTransmission Line 1\nTransmission Line 2\nZ1\nVin1\nVin2\nZ2\nSame value\nby definition\nSame value\nby definition\n\nM.H. Perrott\nMIT OCW\nCalculate Response to Input Voltage Sources\nSources create incident waves on their respective\ntransmission line\nCircuit/passive network causes\n- Reflections on same transmission line\n- Feedthrough to other transmission line\nZ2\nZ1\nLinear Network\nZ1\nVin1\nVin2\nZ2\nVi1\nVr1\nVr2\nVi2\n\nM.H. Perrott\nMIT OCW\nCalculate Response to Input Voltage Sources\nReflections on same transmission line are\nparameterized by ΓL\n- Note that ΓL is generally different on each side of the\ncircuit/passive network\nHow do we parameterize feedthrough to\nthe other transmission line?\nZ2\nZ1\nLinear Network\nZ1\nVin1\nVin2\nZ2\nVi1\nVr1\nVr2\nVi2\nΓL1\nΓL2\n\nM.H. Perrott\nMIT OCW\nS-Parameters - Definition\nModel circuit/passive network using 2-port techniques\n- Similar idea to Thevenin/Norton modeling\nDefining equations:\nZ2\nZ1\nLinear Network\nZ1\nVin1\nVin2\nZ2\nVi1\nVr1\nVr2\nVi2\nΓL1\nΓL2\n\nM.H. Perrott\nMIT OCW\nS-Parameters - Calculation/Measurement\nZ2\nZ1\nLinear Network\nZ1\nVin1\nVin2\nZ2\nVi1\nVr1\nVr2\nVi2\nΓL1\nΓL2\n\nM.H. Perrott\nMIT OCW\nNote: Alternate Form for S21 and S12\nZ2\nZ1\nLinear Network\nZ1\nVin1\nVin2\nZ2\nVi1\nVr1\nVr2\nVi2\nΓL1\nΓL2\n\nM.H. Perrott\nMIT OCW\nBlock Diagram of S-Parameter 2-Port Model\nKey issue - two-port is parameterized with respect to\nthe left and right side load impedances (Z1 and Z2)\n- Need to recalculate S11, S21, etc. if Z1 or Z2 changes\n- Typical assumption is that Z1 = Z2 = 50 Ohms\nZ2\nZ1\nVi1\nVr1\nVr2\nVi2\nS11\nS22\nS21\nZ2\nZ1\nS12\nZ1\nZ2\nS-Parameter Two-Port Model\n\nM.H. Perrott\nMIT OCW\nMacro-modeling for Distributed, Linear Networks\nZ3\nZ1\nZs\nVs\nZL\nLinear\nCircuits &\nPassives\n(1)\nZ2\nLinear\nCircuits &\nPassives\n(2)\nlength = d1\nlength = d2\nlength = d3\nVout\nKey parameters for a transmission line\n- Characteristic impedance (only impacts S-parameter\ncalculations)\n- Delay (function of length and μ, ε)\n- Loss (ignore for now)\nKey parameters for circuits/passives\n- S-parameters\nWe would like an overall macro-model for simulation\n\nM.H. Perrott\nMIT OCW\nMacro-modeling for Distributed, Linear Networks\nZ3\nZ1\nZs\nVs\nZL\nLinear\nCircuits &\nPassives\n(1)\nZ2\nLinear\nCircuits &\nPassives\n(2)\nlength = d1\nlength = d2\nlength = d3\ndelay1 = velocity\nd1\nLCd1\n=\nμεd1\n=\ndelay2 =\nμεd2\ndelay3 =\nμεd3\nVout\nModel transmission line as a delay element\n- If lossy, could also add an attenuation factor (which is a\nfunction of its length)\nModel circuits/passives with S-parameter 2-ports\nModel source and load with custom blocks\n\nM.H. Perrott\nMIT OCW\nMacro-modeling for Distributed, Linear Networks\nZ3\nZ1\nZs\nVs\nZL\nLinear\nCircuits &\nPassives\n(1)\nZ2\nLinear\nCircuits &\nPassives\n(2)\nlength = d1\nlength = d2\nlength = d3\ndelay1 = velocity\nd1\nLCd1\n=\nμεd1\n=\ndelay2 =\nμεd2\ndelay3 =\nμεd3\nZL=Z1\nVi1\nVr1\nVi2\nVr2\nZ1\nZ1+Zs\nVs\nZs+Z1\nZs-Z1\ndelay1\ndelay1\nZR=Z2\nS-param.\n2-port\n(1)\nZL=Z2\nVi1\nVr1\nVi2\nVr2\ndelay2\ndelay2\nZR=Z3\nS-param.\n2-port\n(2)\ndelay3\ndelay3\nZL+Z3\nZL-Z3\nVout\nVout\n\nM.H. Perrott\nMIT OCW\nNote for CppSim Simulations\nCppSim does block-by-block computation\n- Feedback introduces artificial delays in simulation\nPrevent artificial delays by\n- Ordering blocks according to input-to-output signal flow\n- Creating an additional signal in CppSim modules to\npass previous sample values\n- Note: both are already done for you in Homework #1\nZL=Z1\nVi1\nVr1\nVi2\nVr2\nZ1\nZ1+Zs\nVs\nZs+Z1\nZs-Z1\ndelay1\ndelay1\nZR=Z2\nS-param.\n2-port\n(1)\nZL=Z2\nVi1\nVr1\nVi2\nVr2\ndelay2\ndelay2\nZR=Z3\nS-param.\n2-port\n(2)\ndelay3\ndelay3\nZL+Z3\nZL-Z3\nVout\n\nM.H. Perrott\nMIT OCW\nS-Parameter Calculations - Example 1\nSet Vi2 = 0\nZ1\nZ2\nTransmission\nLine Junction\nDerive S-Parameter 2-Port\nVi1\nVr1\nVr2\nVi2\nSet Vi1 = 0\n\nM.H. Perrott\nMIT OCW\nS-Parameter Calculations - Example 2\nSame as before:\nZ1\nZ2\nTransmission Line\nJunction with Capacitor\nDerive S-Parameter 2-Port\nC\nVi1\nVr1\nVr2\nVi2\nBut now:\n\nM.H. Perrott\nMIT OCW\nS-Parameter Calculations - Example 3\nThe S-parameter calculations are now more involved\n- Network now has more than one node\nThis is a homework problem\nZ1\nZ2\nDerive S-Parameter 2-Port\nVi1\nVr1\nVr2\nVi2\nC1\nL1\nC2\n\nImpedance Transformers\n\nM.H. Perrott\nMIT OCW\nMatching for Voltage versus Power Transfer\nConsider the voltage divider network\nFor maximum voltage transfer\nFor maximum power transfer\nVs\nRS\nRL\nI\nVout\nWhich one do we want?\n\nM.H. Perrott\nMIT OCW\nNote: Maximum Power Transfer Derivation\nFormulation\nTake the derivative and set it to zero\nVs\nRS\nRL\nI\nVout\n\nM.H. Perrott\nMIT OCW\nVoltage Versus Power\nFor most communication circuits, voltage (or current)\nis the key signal for detection\n- Phase information is important\n- Power is ambiguous with respect to phase information\nExample:\nFor high speed circuits with transmission lines,\nachieving maximum power transfer is important\n- Maximum power transfer coincides with having zero\nreflections (i.e., ΓL = 0)\nCan we ever win on both issues?\nVoltage\nPower\n\nM.H. Perrott\nMIT OCW\nBroadband Impedance Transformers\nConsider placing an ideal transformer between source\nand load\nTransformer basics (passive, zero loss)\nTransformer input impedance\nVs\nRS\nRL\nVout\nIin\nIout\nRin\nVin\n1:N\n\nM.H. Perrott\nMIT OCW\nWhat Value of N Maximizes Voltage Transfer?\nDerive formula for Vout versus Vin for given N value\nTake the derivative and set it to zero\n\nM.H. Perrott\nMIT OCW\nWhat is the Input Impedance for Max Voltage Transfer?\nWe know from basic transformer theory that input\nimpedance into transformer is\nWe just learned that, to maximize voltage transfer, we\nmust set the transformer turns ratio to\nPut them together\nSo, N should be set for max power transfer into transformer\nto achieve the maximum voltage transfer at the load!\n\nM.H. Perrott\nMIT OCW\nBenefit of Impedance Matching with Transformers\nTransformers allow maximum voltage and power\ntransfer relationship to coincide\nTurns ratio for max power/voltage transfer\nResulting voltage gain (can exceed one!)\nVs\nRS\nRL\nVout\nIin\nIout\nRin\nVin\n1:N\n\nM.H. Perrott\nMIT OCW\nThe Catch\nIt's hard to realize a transformer with good\nperformance over a wide frequency range\n- Magnetic materials have limited frequency response\n- Inductors have self-resonant frequencies, losses, and\nmediocre coupling to other inductors without magnetic\nmaterial\nFor wireless applications, we only need transformers\nthat operate over a small frequency range\n- Can we take advantage of this?\n\nM.H. Perrott\nMIT OCW\nConsider Resonant Circuits (Chap. 4 of Lee's Book)\nKey insight: resonance allows Zin to be purely real\ndespite the presence of reactive elements\nZin\nRp\nZin\nLp\nCp\nRs\nLs\nCs\nParallel Resonant Circuit\nSeries Resonant Circuit\n\nM.H. Perrott\nMIT OCW\nComparison of Series and Parallel RL Circuits\nEquate real and imaginary parts of the left and right\nexpressions (so that Zin is the same for both)\n- Also equate Q values\nZin\nRp\nZin\nLp\nRs\nLs\nParallel RL Circuit\nSeries RL Circuit\n\nM.H. Perrott\nMIT OCW\nComparison of Series and Parallel RC Circuits\nEquate real and imaginary parts of the left and right\nexpressions (so that Zin is the same for both)\n- Also equate Q values\nZin\nRp\nZin\nCp\nRs\nCs\nParallel RC Circuit\nSeries RC Circuit\n\nM.H. Perrott\nMIT OCW\nA Narrowband Transformer: The L Match\nAssume Q >> 1\nSo, at resonance\nTransformer steps up impedance!\nZin\nRp\nZin\nLp\nC\nRs\nLs\nC\nSeries to Parallel\nTransformation\n\nM.H. Perrott\nMIT OCW\nAlternate Implementation of L Match\nAssume Q >> 1\nSo, at resonance\nTransformer steps down impedance!\nZin\nRp\nZin\nL\nCp\nRs\nL\nCs\nParallel to Series\nTransformation\n\nM.H. Perrott\nMIT OCW\nThe π Match\nCombines two L sections\nProvides an extra degree of freedom for choosing\ncomponent values for a desired transformation ratio\nZin\nR\nL\nC1\nC2\nZin\nR\nC1\nC2\nL1\nL2\nL1 + L2 = L\nSteps Up\nImpedance\nSteps Down\nImpedance\n\nM.H. Perrott\nMIT OCW\nThe T Match\nAlso combines two L sections\nAgain, benefit is in providing an extra degree of\nfreedom in choosing component values\nZin\nC2\nZin\nR\nC\nL1\nL2\nC1 + C2 = C\nSteps Down\nImpedance\nSteps Up\nImpedance\nL2\nL1\nC1\nR\n\nM.H. Perrott\nMIT OCW\nTapped Capacitor as a Transformer\nTo first order:\nUseful in VCO design\nSee Chapter 4 of Tom Lee's book for analysis\nZin\nL\nC2\nC1\nRL"
    },
    {
      "category": "Lecture Notes",
      "title": "lec4.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/144e9086d3a00235262acc8772a70c8b_lec4.pdf",
      "content": "6.976\nHigh Speed Communication Circuits and Systems\nLecture 4\nGeneralized Reflection Coefficient, Smith Chart,\nIntegrated Passive Components\nMichael Perrott\nMassachusetts Institute of Technology\nCopyright (c) 2003 by Michael H. Perrott\n\nM.H. Perrott\nMIT OCW\nDetermine Voltage and Current At Different Positions\nIncident and reflected waves must be added together\nx\nz\nEx\nHy\ny\nZL\nEx\nHy\nZL\nIncident Wave\nReflected Wave\nL\nz\nV+ejwtejkz\nI+ejwtejkz\nV-ejwtejkz\nI-ejwtejkz\n\nM.H. Perrott\nMIT OCW\nDetermine Voltage and Current At Different Positions\nx\nz\nEx\nHy\ny\nZL\nEx\nHy\nZL\nIncident Wave\nReflected Wave\nL\nz\nV+ejwtejkz\nI+ejwtejkz\nV-ejwtejkz\nI-ejwtejkz\n\nM.H. Perrott\nMIT OCW\nDefine Generalized Reflection Coefficient\nSimilarly:\n\nM.H. Perrott\nMIT OCW\nA Closer Look at Γ(z)\nRecall ΓL is\nWe can view Γ(z)\nas a complex\nnumber that\nrotates clockwise\nas z (distance\nfrom the load)\nincreases\nNote:\n|ΓL|\n|ΓL|\nRe{Γ(z)}\nIm{Γ(z)}\nΓL\n∆\n= 2kz\nΓL\nΓ(z)\n\nM.H. Perrott\nMIT OCW\nCalculate |Vmax| and |Vmin| Across The Transmission Line\nWe found that\nSo that the max and min of V(z,t) are calculated as\nWe can calculate this geometrically!\n\nM.H. Perrott\nMIT OCW\nA Geometric View of |1 + Γ(z)|\n|ΓL|\nRe{1+Γ(z)}\nIm{1+Γ(z)}\nΓ(z)\n|1+Γ(z)|\n\nM.H. Perrott\nMIT OCW\nReflections Cause Amplitude to Vary Across Line\nEquation:\nGraphical representation:\ndirection\nof travel\nz\nt\nV+ejwtejkz\nz\n|1 + Γ(z)|\nmax|1+Γ(z)|\nλ\nmin|1+Γ(z)|\n|1+Γ(0)|\n\nM.H. Perrott\nMIT OCW\nVoltage Standing Wave Ratio (VSWR)\nDefinition\nFor passive load (and line)\nWe can infer the magnitude of the reflection\ncoefficient based on VSWR\n\nM.H. Perrott\nMIT OCW\nReflections Influence Impedance Across The Line\nFrom Slide 4\n- Note: not a function of time! (only of distance from load)\nAlternatively\n- From Lecture 2:\n\nM.H. Perrott\nMIT OCW\nExample: Z(λ/4) with Shorted Load\nCalculate reflection coefficient\nCalculate generalized reflection coefficient\nCalculate impedance\nx\nz\ny\nZL\nL\nz\nλ/4\nZ(λ/4)\n\nM.H. Perrott\nMIT OCW\nGeneralize Relationship Between Z(λ/4) and Z(0)\nGeneral formulation\nAt load (z=0)\nAt quarter wavelength away (z = λ/4)\n- Impedance is inverted!\nShorts turn into opens\nCapacitors turn into inductors\n\nM.H. Perrott\nMIT OCW\nNow Look At Z(∆) (Impedance Close to Load)\nImpedance formula (∆very small)\n- A useful approximation:\n- Recall from Lecture 2:\nOverall approximation:\n\nM.H. Perrott\nMIT OCW\nExample: Look At Z(∆) With Load Shorted\nReflection coefficient:\nResulting impedance looks inductive!\nx\nz\ny\nZL\n∆\nz\nZ(∆)\n\nM.H. Perrott\nMIT OCW\nExample: Look At Z(∆) With Load Open\nReflection coefficient:\nResulting impedance looks capacitive!\nx\nz\ny\nZL\n∆\nz\nZ(∆)\n\nM.H. Perrott\nMIT OCW\nConsider an Ideal LC Tank Circuit\nCalculate input impedance about resonance\nL\nC\nZin\n= 0\nnegligible\n\nM.H. Perrott\nMIT OCW\nTransmission Line Version: Z(λ0 /4) with Shorted Load\nAs previously calculated\nImpedance calculation\nRelate λ to frequency\nx\nz\ny\nZL\nL\nz\nλ0/4\nZ(λ0/4)\n\nM.H. Perrott\nMIT OCW\nCalculate Z(∆f) - Step 1\nWavelength as a function of ∆f\nGeneralized reflection coefficient\nx\nz\ny\nZL\nL\nz\nλ0/4\nZ(λ0/4)\n\nM.H. Perrott\nMIT OCW\nCalculate Z(∆f) - Step 2\nImpedance calculation\nRecall\nx\nz\ny\nZL\nL\nz\nλ0/4\nZ(λ0/4)\n- Looks like LC tank circuit about frequency wo!\n\nM.H. Perrott\nMIT OCW\nSmith Chart\nDefine normalized impedance\nMapping from normalized impedance to Γ\nis one-to-one\n- Consider working in coordinate system based on Γ\nKey relationship between Zn and Γ\n- Equate real and imaginary parts to get Smith Chart\n\nM.H. Perrott\nMIT OCW\nReal Impedance in Γ Coordinates (Equate Real Parts)\n0.2\n0.5\nΓL=0\nIm{ΓL}\nRe{ΓL}\nΓL=1\nΓL=-1\nΓL=j\nΓL=-j\nZn=0.5\n\nM.H. Perrott\nMIT OCW\nImag. Impedance in Γ Coordinates (Equate Imag. Parts)\nj0.2\n-j0.2\nj0.5\n-j0.5\nj1\n-j1\nj2\n-j2\nj5\n-j5\nIm{ΓL}\nRe{ΓL}\nΓL=0\nΓL=1\nΓL=-1\nΓL=j\nΓL=-j\nZn=j0.5\nZn=-j0.5\n\nM.H. Perrott\nMIT OCW\nWhat Happens When We Invert the Impedance?\nFundamental formulas\nImpact of inverting the impedance\n- Derivation:\nWe can invert complex impedances in Γ plane by\nsimply changing the sign of Γ !\nHow can we best exploit this?\n\nM.H. Perrott\nMIT OCW\nThe Smith Chart as a Calculator for Matching Networks\nConsider constructing both impedance and\nadmittance curves on Smith chart\n- Conductance curves derived from resistance curves\n- Susceptance curves derived from reactance curves\nFor series circuits, work with impedance\n- Impedances add for series circuits\nFor parallel circuits, work with admittance\n- Admittances add for parallel circuits\n\nM.H. Perrott\nMIT OCW\nResistance and Conductance on the Smith Chart\n0.2\n0.5\nIm{ΓL}\nRe{ΓL}\nΓL=0\nΓL=1\nΓL=-1\nΓL=j\nΓL=-j\nYn=2\nYn=0.5\nZn=0.5\nZn=2\n\nM.H. Perrott\nMIT OCW\nReactance and Susceptance on the Smith Chart\nj0.2\n-j0.2\nj0.5\n-j0.5\nj1\n-j1\nj2\n-j2\nj5\n-j5\nIm{ΓL}\nRe{ΓL}\nΓL=0\nΓL=1\nΓL=-1\nΓL=j\nΓL=-j\nYn=-j2\nYn=j2\nZn=j2\nZn=-j2\n\nM.H. Perrott\nMIT OCW\nOverall Smith Chart\n0.2\n0.5\nj0.2\n-j0.2\nj0.5\n-j0.5\nj1\n-j1\nj2\n-j2\nj5\n-j5\n\nM.H. Perrott\nMIT OCW\nExample - Match RC Network to 50 Ohms at 2.5 GHz\nCircuit\nStep 1: Calculate ZLn\nStep 2: Plot ZLn on Smith Chart (use admittance, YLn)\nZin\nRp=200\nCp=1pF\nMatching\nNetwork\nZL\n\nM.H. Perrott\nMIT OCW\nPlot Starting Impedance (Admittance) on Smith Chart\n0.2\n0.5\nj0.2\n-j0.2\nj0.5\n-j0.5\nj1\n-j1\nj2\n-j2\nj5\n-j5\nYLn=0.25+j0.7854\n(Note: ZLn=0.37-j1.16)\n\nM.H. Perrott\nMIT OCW\nDevelop Matching \"Game Plan\" Based on Smith Chart\nBy inspection, we see that the following matching\nnetwork can bring us to Zin = 50 Ohms (center of\nSmith chart)\nUse the Smith chart to come up with component\nvalues\n- Inductance Lm shifts impedance up along reactance\ncurve\n- Capacitance Cm shifts impedance down along\nsusceptance curve\nZin\nRp=200\nCp=1pF\nZL\nLm\nCm\nMatching Network\n\nM.H. Perrott\nMIT OCW\nAdd Reactance of Inductor Lm\n0.2\n0.5\nj0.2\n-j0.2\nj0.5\n-j0.5\nj1\n-j1\nj2\n-j2\nj5\n-j5\nZLn=0.37-j1.16\nZ2n=0.37+j0.48\nnormalized\ninductor\nreactance\n= j1.64\n\nM.H. Perrott\nMIT OCW\nInductor Value Calculation Using Smith Chart\nFrom Smith chart, we found that the desired\nnormalized inductor reactance is\nRequired inductor value is therefore\n\nM.H. Perrott\nMIT OCW\nAdd Susceptance of Capacitor Cm (Achieves Match!)\n0.2\n0.5\nj0.2\n-j0.2\nj0.5\n-j0.5\nj1\n-j1\nj2\n-j2\nj5\n-j5\nZLn=0.37-j1.16\nZ2n=0.37+j0.48\n1.0+j0.0\nnormalized\ncapacitor\nsusceptance\n= j1.31\n(note: Y2n=1.00-j1.31)\n\nM.H. Perrott\nMIT OCW\nCapacitor Value Calculation Using Smith Chart\nFrom Smith chart, we found that the desired\nnormalized capacitor susceptance is\nRequired capacitor value is therefore\n\nM.H. Perrott\nMIT OCW\nJust For Fun\nPlay the \"matching game\" at\n- Allows you to graphically tune several matching\nnetworks\n- Note: game is set up to match source to load impedance\nrather than match the load to the source impedance\nSame results, just different viewpoint\nhttp://contact.tm.agilent.com/Agilent/tmo/an-95-1/classes/imatch.html\n\nPassives\n\nM.H. Perrott\nMIT OCW\nPolysilicon Resistors\nUse unsilicided polysilicon to create resistor\nKey parameters\n- Resistance (usually 100- 200 Ohms per square)\n- Parasitic capacitance (usually small)\nAppropriate for high speed amplifiers\n- Linearity (quite linear compared to other options)\n- Accuracy (usually can be set within ± 15%)\nA\nRpoly\nB\nB\nA\n\nM.H. Perrott\nMIT OCW\nMOS Resistors\nBias a MOS device in its triode region\nHigh resistance values can be achieved in a small\narea (MegaOhms within tens of square microns)\nResistance is quite nonlinear\n- Appropriate for small swing circuits\nA\nW/L\nRds\nB\nA\nB\n\nM.H. Perrott\nMIT OCW\nHigh Density Capacitors (Biasing, Decoupling)\nMOS devices offer the highest capacitance per unit area\n- Limited to a one terminal device\n- Voltage must be high enough to invert the channel\nKey parameters\n- Capacitance value\nRaw cap value from MOS device is 6.1 fF/μ m2 for 0.24u\nCMOS\n- Q (i.e., amount of series resistance)\nMaximized with minimum L (tradeoff with area efficiency)\nSee pages 39-40 of Tom Lee's book\nA\nW/L\nA\nC1=CoxWL\n\nM.H. Perrott\nMIT OCW\nHigh Q Capacitors (Signal Path)\nLateral metal capacitors offer high Q and reasonably\nlarge capacitance per unit area\n- Stack many levels of metal on top of each other (best\nlayers are the top ones), via them at maximum density\n- Accuracy often better than ±10%\n- Parasitic side cap is symmetric, less than 10% of cap value\nExample: CT = 1.5 fF/μm2 for 0.24μm process with 7\nmetals, Lmin = Wmin = 0.24μm, tmetal = 0.53μm\n- See \"Capacity Limits and Matching Properties of Integrated\nCapacitors\", Aparicio et. al., JSSC, Mar 2002\nB\nA\nC1\nA\nB\n\nM.H. Perrott\nMIT OCW\nSpiral Inductors\nCreate integrated inductor using spiral shape on top level\nmetals (may also want a patterned ground shield)\n- Key parameters are Q (< 10), L (1-10 nH), self resonant freq.\n- Usually implemented in top metal layers to minimize series\nresistance, coupling to substrate\n- Design using Mohan et. al, \"Simple, Accurate Expressions\nfor Planar Spiral Inductances, JSSC, Oct, 1999, pp 1419-1424\n- Verify inductor parameters (L, Q, etc.) using ASITIC\nhttp://formosa.eecs.berkeley.edu/~niknejad/asitic.html\nLm\nA\nB\nB\nA\n\nM.H. Perrott\nMIT OCW\nBondwire Inductors\nUsed to bond from the package to die\n- Can be used to advantage\nKey parameters\n- Inductance ( ≈1 nH/mm - usually achieve 1-5 nH)\n- Q (much higher than spiral inductors - typically > 40)\nCpin\nLbondwire\nCbonding_pad\ndie\nAdjoining pins\npackage\nTo chip circuits\nFrom board\n\nM.H. Perrott\nMIT OCW\nIntegrated Transformers\nUtilize magnetic coupling between adjoining wires\nKey parameters\n- L (self inductance for primary and secondary windings)\n- k (coupling coefficient between primary and secondary)\nDesign - ASITIC, other CAD packages\nA\nB\nL2\nB\nL1\nA\nCpar1\nk\nC\nD\nC\nD\nCpar2\n\nM.H. Perrott\nMIT OCW\nHigh Speed Transformer Example - A T-Coil Network\nA T-coil consists of a center-tapped inductor with\nmutual coupling between each inductor half\nUsed for bandwidth enhancement\n- See S. Galal, B. Ravazi, \"10 Gb/s Limiting Amplifier and\nLaser/Modulator Driver in 0.18u CMOS\", ISSCC 2003, pp\n188-189 and \"Broadband ESD Protection ...\", pp. 182-183\nA\nB\nX\nL2\nB\nL1\nA\nCB\nX\nk"
    },
    {
      "category": "Resource",
      "title": "guest5.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/db6aed780e7f147fe1b589bfeed05b71_guest5.pdf",
      "content": "MITOPENCOURSEWARE\nMASSACUSETTS INSTITUTE OF TECHNOLOGY\n6.976\nHigh-Speed Communication Circuits and Systems\nLecture 29\nLowpass and Bandpass Delta-Sigma Modulation\nRichard Schreier\nCopyright (c) 2003 Richard Schreier\nANALOG\nDEVICES\n\nOutline\n1 ∆Σ Basics\n1st-Order Modulator\n2 Advanced ∆Σ\nHigh-Order ∆Σ Modulators\nMulti-bit and Multi-Stage Modulation\n3 Bandpass ∆Σ Modulation\n4 Example Bandpass ADC\n\n1. ∆Σ Basics\n\nCTMOD1: A 1st-Order\nContinuous-Time ∆Σ Modulator\n-\nThe input signal, U, is converted into a sequence\nof bits, V ∈ (0,1).\nCK\nU\nR\nC\n0,I\nV\nY\n\nProperties of CTMOD1\nDC Inputs\n-\nIntegrator ensures that input current is exactly\nbalanced by the (average) feedback current\n\"Infinite resolution\"\n-\nSignals which alias to DC are rejected\n\"Inherent anti-aliasing\"\n\nNon-ideal Effects in CTMOD1\n-\nComponent shifts\nR → R+∆R or I→ I+∆I merely changes full-scale.\nC → C+∆C scales the output of the integrator,\nbut does not affect the comparator's decisions.\n-\nOp-amp offset, input bias current,\nDAC imbalance\nAll translate into a DC offset, which is unimportant in\nmany communications applications.\n-\nComparator offset & hysteresis\nOvercome by integrator.\n-\nFinite op-amp gain\nCreates \"dead-bands.\"\n\nNon-ideal Effects (cont'd)\n-\nDAC jitter\nAdds \"noise.\"\n-\nResistor nonlinearity (e.g. due to self-heating)\nIntroduces distortion.\n-\nDAC nonlinearity\nIntroduces distortion and intermodulation of shaped\nquantization noise.\n-\nCapacitor nonlinearity\nIrrelevant.\n-\nOp-amp nonlinearity\nSame effects as DAC nonlinearity, but less severe.\n\nCTMOD1 Model\n-\nNormalize R=1Ω, C=1F, I=1A, Fs=1Hz\nFull-scale range is [0,1]V.\n-\nAssume comparator and DAC are delay-free\nDAC\nuc\nv\nvc\n∫\nyc\ny\n\nWaveforms/Timing\nt\nt\nyc\nComparator\nThreshold\nvc\nu = 0.2\n-1\nv(0) v(1) v(2) v(3)\nv(4)\nV\n5---\n=\n\nCTMOD1 @ 5% 1's density\nl(r)\nl(ck)\nv(u)\n-1\n-v(yn)\n-2\n-1\nl(v)\n.1\n.2\n.3\n.4\n.5\n.6\n.7\n.8\n.9\ntime, x1e-6 Seconds\n\nCTMOD1 @ 10% 1's density\nl(r)\nl(ck)\nv(u)\n-1\n-v(yn)\n-2\n-1\nl(v)\n.1\n.2\n.3\n.4\n.5\n.6\n.7\n.8\n.9\ntime, x1e-6 Seconds\n\nCTMOD1 @ 51% 1's density\nl(r)\nl(ck)\nv(u)\n-1\n-v(yn)\n-1\nl(v)\n.1\n.2\n.3\n.4\n.5\n.6\n.7\n.8\n.9\ntime, x1e-6 Seconds\n\nCTMOD1 @1/π 1's density\nl(r)\nl(ck)\nv(u)\n-1\n-v(yn)\n-2\n-1\nl(v)\n.1\n.2\n.3\n.4\n.5\n.6\n.7\n.8\n.9\ntime, x1e-6 Seconds\n------\n3---\n\nAnalysis of CTMOD1\nyc n\n( )\nyc n\n-\n(\n)\nuc τ( )\nvc τ( )\n-\n(\n)dτ\nn\n-\nn∫\n+\n=\n1) Sample yc at integer time and identify y(n) = yc(n).\nvc τ( )dτ\nn\n-\nn∫\nv n\n-\n(\n)\n=\n2) Observe that\ny n\n( )\ny n\n-\n(\n)\nu n\n( )\nv n\n-\n(\n)\n-\n+\n=\n3) Define\nTHEN\nu n\n( )\nuc τ( )dτ\nn\n-\nn∫\n=\nFrom the diagram:\nAlso, from the diagram\nv n\n( )\nQ y n\n( )\n(\n)\n=\n\nCTMOD1 Equivalent\n-\nCTMOD1 is the same as a discrete-time first-\norder modulator (MOD1) preceded by a sinc\nfilter!\nuc\nv\nz-1\ny\nt\nd\n1∫\nu\nMOD1\nz-1\n\nCTMOD1 NTF and STF\n-\nThe NTF is the same as MOD1:\n-\nMOD1's STF is 1, so the overall STF is just the TF\nof the prefilter:\nNTF z\n( )\nz 1\n-\n-\n=\nz-plane:\nSTF s\n( )\ne st\n- gp t( ) t\nd\ninf∫\n=\ne st\n-\nt\nd\n1∫\n=\ne s\n-\n-\n(\n)\ns\n----------------------\n=\nz 1\n-\n-\n(\n)\ns\n----------------------, where z\n=\nes\n=\ns-plane:\n2π\n4π\n\nFrequency Responses\n-50\n-40\n-30\n-20\n-10\nFrequency (Hz)\ndB\nNTF\nSTF\nInherent\nAnti-Aliasing\nQ. Noise\nNotch\n\nCTMOD1 Spectra\nspec1\n-100\n-50\nspec2\n-100\n-50\nfreq, x1e6 Hertz\nu = 1/32\n-6dB peak\ndB\ndB\nu = FS sine-wave\n\nProperties of MOD1\n-\nSingle-bit quantization yields \"inherent linearity.\"\nThe DAC defines two points and two points can\nalways be joined with a line. (Not so simple in\ncontinuous-time.)\n-\nMOD1 is stable for inputs all the way up to full-scale.\nThe quantizer in MOD1 does not \"overload.\"\n-\nAssuming the quantization error is white with\npower\n, the in-band noise power is\n. ~12-bit performance at OSR=256.\nDoubling OSR reduces noise power by a factor of 8.\n\"1.5 bits increase in SNR per octave increase in\nOSR\"\nu\n≤\n≤\ny\n≤\n⇒\nσe2\nN0\nπ2σe2\n3 OSR\n(\n)3\n-------------------------\n≅\n\nMOD1 Properties (cont'd)\n-\nDC input u =\nresults in period-b behavior.\nThe spectrum of the error is not white! Spectrum\nconsists of a finite set of harmonics of\n.\n-\nIrrational DC inputs result in aperiodic behavior.\nNonetheless, the spectrum of the error is still\ndiscrete!\nSpectrum consists of an infinite number of tones\nwith frequencies that are irrational fractions of\n.\n-\nFinite op-amp gain shifts NTF zero inside the\nunit circle and allows a range of u values to\nproduce the same limit cycle.\nWorst case is around\n;\nyields \"dead bands.\"\n-\nThe behavior of MOD1 is erratic.\na\nb---\nfs b\n⁄\nfs\nu\n0 1 1\n2---\n,\n,\netc.\n=\n\n2. Advanced ∆Σ\n\nA Single-Loop ∆Σ Modulator\n-\nThe zeros in H come from the poles in L1\nE\nL1\nL0\nY\nV\nU\n, where\nInverse Relations:\nL1 = 1 - 1/H, L0 = G/H\nY\nL0U\nL1V\n+\n=\nV\nY\nE\n+\n=\nV\nGU\nHE\n+\n=\nH\nL1\n-\n---------------\n=\n& G\nL0H\n=\n\nA 5th-Order Lowpass NTF\nZeros optimized for OSR=32\n-\nPole/Zero diagram:\nOSR = 32;\nH = synthesizeNTF(5,OSR,1);\n...\n-1\n-1\nZeros spread across\nthe band-of-interest to\nminimize the rms value\nof the NTF.\noptimization\nflag\nPoles such that ||H|| = 1.5.\n\nExample: 5th-Order Modulator\nNormalized Frequency (1 →fs )\n0.5\n-120\n-100\n-80\n-60\n-40\n-20\ndBFS\n-1\nTime (sample number)\nNBW = 1.8x10-4 fs\n(8K-Point FFT)\n\nSQNR Limits for Binary\nModulators\nOSR\nPeak SQNR (dB)\nN = 4\nN = 3\nN = 2\nN = 1\nN = 6\nN = 5\nN = 7\nN = 8\n\nMulti-Bit Quantization\nToolbox Conventions\n-\nSingle-bit quantizer output interpreted as ±1\ninstead of 0,1.\nQuantizer step size, ∆, is 2; input range is [-1,+1].\n-\nConvention for multi-bit quantization is:\n∆= 2; # of Q. levels is nlev = M+1, from -M to +M;\nno-overload range (|e| ≤1) is -nlev to +nlev.\ny\nv\ne\ny\nv\ne\ny\nv\ne\nM = 1\n-1\n-2\n-1\n-3\nM = 2\nM = 3\nmid-tread quantizer;\nv: even integers\nmid-rise quantizer;\nv: odd integers\n\nSQNR Limits for 3-bit Modulators\nN = 4\nN = 3\nN = 2\nN = 1\nN = 6\nN = 5\nN = 7\nN = 8\nOSR\nPeak SQNR (dB)\n\nTheoretical SNR Limits\nfor Multi-Bit Modulators\nN = 3\nN = 2\nN = 4\nN = 5\nN = 6\nN = 7\nN = 8\nSNR (dB) @ OSR = 8\nwith 1 LSB (peak) input\nTotal RMS Noise Power (LSBs)\nH inf2\n=\nH inf\n=\nH inf\n=\nH inf\n=\nH inf\n=\nH infis the max. gain of the NTF\nover all frequencies.\n\nMulti-Bit Quantization\nPros and Cons\n-\nMulti-bit quantization overcomes stability-\ninduced restrictions on the NTF\nDramatic improvements are possible!\n-\nMulti-bit quantization loses the inherent linearity\nproperty of a binary DAC\nDAC levels are not evenly spaced and so cannot be\njoined with a straight line.\nDAC errors are effectively added to the input, and\nthus are not shaped.\nCan be overcome with calibration, digital correction\nor mismatch-shaping.\n\nDigital Correction\n-\nLookup table contains the digital equivalent of\neach DAC level\nIn practice, the look-up table only needs to store the\ndifferences between the actual and ideal DAC levels.\n-\nThus vdig = vdac, so DAC errors are now shaped\nby the loop!\nDAC\nu\nv\nvdac\n∫\nLook-up\nTable\nvdig\n\nMismatch-Shaping\n-\nShapes mismatch-induced noise by ensuring\nthat each element in a unit-element DAC is\ndriven by a shaped sequence\nTwo popular forms of mismatch-shaping are\nelement-rotation and element-swapping.\nTime\nTime\nTime\nSwapping\nRotation\nThermometer\n\nMulti-Stage Modulation\n2nd-order\nmodulator\n2nd-order\nmodulator\n4(1 - z -1)2\nmod = mod2;\nABCD = mod.ABCD;\n[v1 x] = simulateDSM(input,ABCD);\nv2 = simulateDSM(x(2,:)/4,ABCD);\nv = filter([0 2 -1],1,v1) + ...\n4*filter([1 -2 1],1,v2);\nv1\nv2\nv\nu\nx2\nG = z -1,\nz -1(2 - z -1)\n0.25\n-3\n-2\n-1\n-120\n-100\n-80\n-60\n-40\n-20\ndBFS\nNBW=1.8E-4\nH = (1 - z -1)2\nSQNR = 56 dB\nOSR=32\nv1\nv\nSQNR = 81 dB\nComposite NTF is 4H 2\n\n∆Σ Toolbox Summary\nhttp://www.mathworks.com/matlabcentral/fileexchange/\nClick on Control Systems, then delsig\nNTF (and STF) avail-\nable.\nSpecify OSR,\nlowpass/bandpass,\nno. of Q. levels.\nsynthesizeNTF\nrealizeNTF\npredictSNR,\nABCD: state-space\ndescription of the\nmodulator.\nscaleABCD\nParameters for a spe-\ncific topology.\nstuffABCD\nmapABCD\nTime-domain simula-\ntion and SNR mea-\nsurements.\nsimulateDSM,\ncalculateTF\nsimulateSNR\nfindPIS,\nfind2dPIS\nConvex positive\ninvariant set.\nAlso designLCBP\ndesignHBF\nsimulateESL...\n\n3. Bandpass ∆Σ\n\nA Bandpass ∆Σ ADC\n-\nLike a lowpass ∆Σ ADC, a bandpass ∆Σ ADC\nconverts its analog input into a bit-stream\nThe output bit-stream is essentially equal to the\ninput in the band of interest.\n-\nA digital filter removes out-of-band noise and\nmixes the signal to baseband\ndigital\nBandpass\nFilter/\nDecimator\nBandpass\n∆Σ\nModulator\nu\nv\ncomplex\noutput\nfs 2\n⁄\nshaped\nfB\nbaseband\nsignal\nfs 2\n⁄\n-\nfs 2\n⁄\nsignal\nfs 2\n⁄\n-\nanalog\n1 bit @fs\n2xn @fB\nw\nnoise\ninput\n\nBP∆Σ Perspective #1\nIt is just Filtering and Feedback\n-\nPutting the poles of the loop filter at ω0\nforces H to have zeros at ω0\n-\nExample system diagram:\nDAC\nLots of gain at ω0\nω02\ns2\nω02\n+\n-------------------\n\nBP∆Σ Perspective #2\nIt is just the result of an\n\"N-Path Transformation\"\n-\n(a \"pseudo 2-path transformation\")\napplied to\nyields\n-\nThis transformation can be applied to any\nsystem that processes DT signals, including SC\nfilters, digital filters, ∆Σ modulators and even\nmismatch-shaping logic\nBy replacing the state storage elements (registers),\nor by interleaving two copies of the original system\nand negating alternate inputs and outputs\nz\nz2\n-\n→\nH z\n( )\nz 1\n-\n-\n=\nH' z\n( )\nz 2\n-\n+\n=\n\nBP∆Σ Perspective #3\nIt is something New and Valuable\n-\nBP∆Σ offers a way to make a \"tuned\" ADC\nPossibly the only way.\nIdeally-suited to narrowband systems, i.e. radios.\n-\nBP∆Σ keeps the signal away from 1/f noise as\nwell as low-frequency distortion products\nLike regular narrowband bandpass systems,\nsecond-harmonic distortion is not problematic.\nz-1\nz-1\nz-1\n-1\nOR\nH(z)\nH(z)\n1,1,-1,-1\n1,1,-1,-1\n\nA 6th-Order Bandpass NTF\n-\nPole/Zero diagram:\nOSR = 64;\nf0 = 1/6;\nH=synthesizeNTF(6,OSR,1,[],f0);...\n-1\n-1\n\nExample Waveform\n8th-Order fs/8 Bandpass Modulator\n-1\nTime (sample number)\nu\nv\n\nExample Spectrum\n8th-Order fs/8 Bandpass Modulator\n0.1\n0.2\n0.3\n0.4\n0.5\n-140\n-120\n-100\n-80\n-60\n-40\n-20\ndBFS/NBW\nNormalized Frequency (1→fs)\nSQNR = 100 dB\n@ OSR = 64\nNBW = 1.8x10-4 fs\n\nBandpass Modulator Structure\n-\nThe loop filter consists of a cascade of\nresonators\nThe resonance frequencies determine the poles of\nthe loop filter and hence the zeros of the NTF.\n-\nMultibit and multistage variants are also\npossible\nQ\nQuantizer\nLoop Filter\nResonator\nResonator\nu\nv\n\n4. Design Example\n\nA Dual-Conversion\nSuperheterodyne Receiver\n-\nA bandpass ADC fits naturally into this\nnarrowband system\nPerfect I/Q, high dynamic range. Low power?\nRF\nLNA\nADC\n1st IF\nSample Rate\nLO1\nDSP\nCK\n2nd IF\nLO2\n50-2000 MHz\n10-300 MHz\n2-4 MHz\n10-750 ksps\nAGC\n\nSystem Partitioning\n-\nGoal: a general-purpose, high-performance,\nlow-power back-end\nFront End\nLO1\nCK\nLO2\nBack End\nCustom\nDSP\nN\n\nTraditional Implementation\nNumerous high-dynamic range blocks\nNoise and power budgets are very tight\nLarge VGA range needed\nBP ADC\nIF1\nLO2\nLNA\nMIXER\nVGA\nAAF\nIF2\n\nEliminating the AAF with a\nContinuous-Time BP Σ∆ ADC\nAnti-alias filtering is inherent\nBut still need a low-noise, linear V-I converter\ngm\nFLASH\nIDAC\nIDAC\nIF2\ngm\n\nEliminating the Input gm\nThe output of the mixer is available in\ncurrent form, so ...\nIF1\nLO2\nLNA\nMixer\nIDAC\ngm\nRemainder\nof ADC\n\nMerge ADC with Mixer!\n-\nEliminates redundant I-V & V-I conversion\n-\nGives mixer and IDAC more headroom\nLO2\nV-I CONVERTER\nIDAC\nTO/FROM\nADC\nBACKEND\nMIXER\nLNA\nIF1\nADC input is\na current!\nNo DC drop!\nADC\n\nMerge ADC with Mixer!\nLC tank effectively adds gain, without adding\nnoise, adding distortion or consuming power\nLO2\nV-I CONVERTER\nIDAC\nLNA\nIF1\nNo noise!\nNo distortion!\nNo power!\n\nNoise Analysis\n-\nNoise in the ADC backend is attenuated by gm\ntimes the tank impedance\nIn this work, gm ≈ 10 mA/V\nVin\ngmVin\nvn\nvn\nZ\nvn\ngmZ\nLNA/Mixer\nTank\nZ\n- +\n- +\n\nZeff\n-\nNear resonance, |ZL| = |ZC|\n|ZL,C| ≈ 300Ω in this design\n-\nAt resonance, |Z| ≈Q - |ZL,C|\nAbout 6kΩ for Q = 20 ⇒gmZ ≈60.\n-\nMore generally, the effective tank impedance is\nfound by integrating the input-referred noise\nover the band of interest:\nvn\ngmZ ω\n( )\n--------------------\n\nω\nd\n∫\nvn\ngm\n-------\n\nY ω\n( )2 ω\nd\n∫\nvn\ngmZeff\n------------------\n\n=\n=\nZeff\n⇒\nYrms\n(\n) 1\n-\n=\n\nZ vs. Frequency\n-\nQ = 20 reduces Zeff by about 4 dB\n0.8\n0.9\n1.1\n1.2\nf/f0\nZ\n0.07 f0\n1K\n2K\n5K\n10K\nIdeal\nZeff = 7K\nQ = 20\nZeff = 4.4K\n\nTuning the LC Tank\n-\n∆f0/f0 = 2% ⇒3 dB reduction in Zeff\nInductor accuracy is 10%, so tuning is required\nOff-chip\nNegative-gm\nCap. array\ntank\nMake an oscillator:\n\nRemainder of ADC?\n-\nAdd resonator stages until the quantization\nnoise of the flash is low enough\nIDAC\nFlash\nADC\nBackend\n\nSecond Resonator?\n-\nLC: Needs more external components plus\nassociated pins\n-\nActive-RC: 2 mA for 50 nV/\ninput-referred noise\n-\nSwitched-Cap: est. >10 mA for same noise\nIDAC\nFlash\nADC\nBackend\nHz\n\nThird Resonator?\n-\nActive-RC: Q ≈ 10 ⇒ Need 4th resonator\n-\nSwitched-Cap: Q is high & drift is low;\n<1 mA for 300 nV/\ni.r.n.\nFlash\n+\n-\n+\n-\n?\nHz\n\nComplete ADC\n-\nEliminates high-power VGA & AAF\n2/3 of the total power used by LNA, Mixer & IDAC\n-\nUses cts-time and discrete-time elements, plus\nmulti-bit quantization and mismatch-shaping\nLNA/\nIDAC\nL\nC\nRC\nSC\n9-Level\nFlash\nIF1\nData\nout\nMixer\nLO2\n2 mA\n3 mA\n1 mA\n1 mA\nDEM\n9 mA\n\nADC in More Detail\n-\nCan save power under small-signal conditions\nby reducing IDAC's full-scale\nBy a factor of 4, in this ADC\nIF1\nLNA\nfCLK = 9-36 MHz\nMixer\nIDAC\nRC\nSC\nDEM\nExternal\nLC Tank\nFull-Scale Adjust\n10-300\nElements\nTunable\nMHz\nFlash\nLO2\nOSR = 48 to 960\n\nNoise vs. Full-Scale\n-30 dBm\n-18 dBm\nLNA/Mixer\nFull-Scale\nInput-Referred Noise\nTotal\n(dB relative to a 300Ω resistor)\nRC\nIDAC Thermal\nIDAC Mismatch\nQuantization\nSC\n50 mVpp\n200 mVpp\n\nMeasured STF & NTF\nFrequency (MHz)\ndBFS/NBW\n-100\n-80\n-60\n-40\n-20\nNBW = 5.9 kHz\nSTF\nNTF (scaled)\nfCLK = 32 MHz\nMeasured\nSTF\nMeasured\nPSD\nf0 = fCLK/8\n\nIn-Band Spectrum (OSR=48)\n-150\n-100\n-50\n-140\n-120\n-100\n-80\n-60\n-40\n-20\nFrequency Offset (kHz)\ndBFS/NBW\nNBW = 200Hz\nBW = 270 kHz\nSFDR = 103dB\nSNR = 81 dB\nfIF1 = 103 MHz\nfCLK = 26 MHz\n\nIn-Band Spectrum (OSR=900)\n-10\n-5\n-120\n-100\n-80\n-60\n-40\n-20\nFrequency Offset (kHz)\ndBFS/NBW\nSFDR = 106dB\nSNR = 92 dB\nfIF1 = 73 MHz\nfCLK = 36 MHz\nNBW = 15Hz\n-125 dBc/Hz\n@ 1 kHz offset\n\nSNR vs. Input Power\n-110\n-90\n-70\n-50\n-30\n-10\nSNR (dB)\nFS range: -30 to -18 dBm\nOSR = 48\nOSR =900\nPin (dBm)\nfIF1 = 273 MHz\nfCLK = 32 MHz\nDR = 90 dB\n\nArchitectural Highlights\nMerging a mixer with a continuous-time\nbandpass ADC containing an LC tank yields a\nflexible, high-performance, low-power receiver\nbackend.\nPerforming a component-count/performance/\npower trade-off in each resonator section results\nin a multi-bit, hybrid continuous-time/discrete-\ntime architecture.\nA variable full-scale saves power and reduces\nnoise.\n\nPerformance Summary\nBandwidth\n5 - 375\nkHz\nInput Frequency\n10-300\nMHz\nClock Frequency\n9 - 36\nMHz\nFull-Scale Range\ndB\nDie Area\nmm2\n@ fIF = 73MHz, BW = 333kHz, fCLK = 32MHz, VDD = 3V:\nDynamic Range\ndB\nCurrent Consumption\n16.5\nmA\nNoise Figure @ min FS\ndB\nIIP3\ndBm\n\nBandpass ∆Σ ADCs\nBandwidth\nDynamic Range (dB)\n10 kHz\n100 MHz\n1 MHz\nSchreier 2002\nVeldhoven 2003\nJantzi/Ferguson\nHairapetian 1996\nNorman\nTabatabaei 2000\nHenkel\nSalo 2002\nSalo 2002\nUeno 2002\nRaghavan\nBulzachelli\n\nSummary\n-\n∆Σ is fun\nAll kinds of exotic behavior: limit-cycles, dead-bands\nsub-harmonic locking and even chaotic dynamics!\n-\n∆Σ is a rich field\nADCs and DACs; Single-bit and Multi-bit; Single-\nstage and Multi-stage; Lowpass and Bandpass;\nDiscrete-time and Continuous-time...\n-\nA bandpass ∆Σ ADC converts an IF signal into\ndigital form and can do so with high dynamic\nrange and low power consumption\nWith wideband or tunable modulators, conversion of\nRF to digital may soon be feasible.\nADC = \"Antenna to Digital Converter\""
    },
    {
      "category": "Lecture Notes",
      "title": "lec5.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/bd23fbc3aa12e08f55e281de1ae4332a_lec5.pdf",
      "content": "6.976\nHigh Speed Communication Circuits and Systems\nLecture 5\nHigh Speed, Broadband Amplifiers\nMichael Perrott\nMassachusetts Institute of Technology\nCopyright (c) 2003 by Michael H. Perrott\n\nM.H. Perrott\nMIT OCW\nBroadband Communication System\nExample: high speed data link on a PC board\n- We've now studied how to analyze the transmission line\neffects and package parasitics\n- What's next?\nVL\nC1\nRL\nL1\nDelay = x\nCharacteristic Impedance = Zo\nTransmission Line\nZ1\nVin\nC2\ndie\nAdjoining pins\nConnector\nControlled Impedance\nPCB trace\npackage\nOn-Chip\nDriving\nSource\n\nM.H. Perrott\nMIT OCW\nHigh Speed, Broadband Amplifiers\nThe first thing that you typically do to the input signal\nis amplify it\nFunction\n- Boosts signal levels to acceptable values\n- Provides reverse isolation\nKey performance parameters\n- Gain, bandwidth, noise, linearity\nVL\nC1\nRL\nL1\nDelay = x\nCharacteristic Impedance = Zo\nTransmission Line\nZ1\nVin\nC2\ndie\nAdjoining pins\nConnector\nControlled Impedance\nPCB trace\npackage\nOn-Chip\nDriving\nSource\nAmp\nVout\n\nM.H. Perrott\nMIT OCW\nBasics of MOS Large Signal Behavior (Qualitative)\nS\nD\nG\nCchannel = Cox(VGS-VT)\nVGS\nVDS=0\nS\nD\nG\nVGS\nVD=∆V\nS\nD\nG\nVGS\nVD>∆V\nTriode\nPinch-off\nSaturation\nVDS\nID\nID\nID\nID\nTriode\nPinch-off\nSaturation\n∆V\nOverall I-V Characteristic\n\nM.H. Perrott\nMIT OCW\nBasics of MOS Large Signal Behavior (Quantitative)\nS\nD\nG\nCchannel = Cox(VGS-VT)\nVGS\nVDS=0\nS\nD\nG\nVGS\nVD=∆V\nS\nD\nG\nVGS\nVD>∆V\nTriode\nPinch-off\nSaturation\nID\nID\nID\nID = μnCox W\nL\n(VGS - VT - VDS/2)VDS\nID\nμnCox W\nL\n(VGS - VT)VDS\nfor VDS << VGS - VT\nID =\nμnCox W\nL\n(VGS-VT)2(1+λVDS)\n(where λ corresponds to\nchannel length modulation)\n∆V = VGS-VT\n∆V =\nμnCoxW\n2IDL\n\nM.H. Perrott\nMIT OCW\nAnalysis of Amplifier Behavior\nTypically focus on small signal behavior\n- Work with a linearized model such as hybrid-π\n- Thevenin modeling techniques allow fast and efficient\nanalysis\nTo do small signal analysis:\nRS\nRG\nRD\nvin\nvout\nVbias\nID\n1) Solve for bias current Id\n2) Calculate small signal\nparameters (such as gm, ro)\n3) Solve for small signal response\nusing transistor hybrid-π small\nsignal model\nSmall Signal Analysis Steps\n\nM.H. Perrott\nMIT OCW\nMOS DC Small Signal Model\nAssume transistor in saturation:\nThevenin modeling based on the above\nRS\nRG\nRD\nRD\nRS\nRG\n-gmbvs\nvgs\nvs\nro\ngmvgs\ngm = μnCox(W/L)(VGS - VT)(1 + λVDS)\n= 2μnCox(W/L)ID (assuming λVDS << 1)\nCox\n2qεsNA\n2 2|Φp| + VSB\nγgm\nwhere γ =\ngmb =\nIn practice: gmb = gm/5 to gm/3\nλID\nro =\nID\n\nM.H. Perrott\nMIT OCW\nCapacitors For MOS Device In Saturation\nS\nD\nG\nVGS\nVD>∆V\nID\nLD\nLD\noverlap cap: Cov = WLDCox + WCfringe\nB\nCgc\nCcb\nCov\nCjdb\nCjsb\nCov\nSide View\ngate to channel cap: Cgc = CoxW(L-2LD)\nchannel to bulk cap: Ccb - ignore in this class\nS\nD\nTop View\nW\nE\nL\nE\nE\nsource to bulk cap: Cjsb =\n1 + VSB\nΦB\nCj(0)\n1 + VSB\nΦB\nCjsw(0)\nWE +\n(W + 2E)\njunction bottom wall\ncap (per area)\njunction sidewall\ncap (per length)\ndrain to bulk cap: Cjsd =\n1 + VDB\nΦB\nCj(0)\n1 + VDB\nΦB\nCjsw(0)\nWE +\n(W + 2E)\n(make 2W for \"4 sided\"\nperimeter in some cases)\nL\n\nM.H. Perrott\nMIT OCW\nMOS AC Small Signal Model (Device in Saturation)\nRS\nRG\nRD\nRD\nRS\nRG\n-gmbvs\nvgs\nvs\nro\ngmvgs\nID\nCsb\nCgs\nCgd\nCdb\nCgs = Cgc + Cov = CoxW(L-2LD) + Cov\nCgd = Cov\nCsb = Cjsb\n(area + perimeter junction capacitance)\nCdb = Cjdb\n(area + perimeter junction capacitance)\n\nM.H. Perrott\nMIT OCW\nWiring Parasitics\nCapacitance\n- Gate: cap from poly to substrate and metal layers\n- Drain and source: cap from metal routing path to\nsubstrate and other metal layers\nResistance\n- Gate: poly gate has resistance (reduced by silicide)\n- Drain and source: some resistance in diffusion region,\nand from routing long metal lines\nInductance\n- Gate: poly gate has negligible inductance\n- Drain and source: becoming an issue for long wires\nExtract these parasitics from circuit layout\n\nM.H. Perrott\nMIT OCW\nFrequency Performance of a CMOS Device\nTwo figures of merit in common use\n- ft : frequency for which current gain is unity\n- fmax : frequency for which power gain is unity\nCommon intuition about ft\n- Gain, bandwidth product is conserved\n- We will see that MOS devices have an ft that shifts with\nbias\nThis effect strongly impacts high speed amplifier\ntopology selection\nWe will focus on ft\n- Look at pages 70-72 of Tom Lee's book for discussion\non fmax\n\nM.H. Perrott\nMIT OCW\nDerivation of ft for MOS Device in Saturation\nAssumption is that input is current, output of device\nis short circuited to a supply voltage\n- Note that voltage bias is required at gate\nThe calculated value of ft is a function of this bias voltage\n-gmbvs\nvgs\nro\ngmvgs\nID+id\nCsb\nCgs\nCgd\nCdb\niin\nVbias\nRLARGE\nid\niin\n\nM.H. Perrott\nMIT OCW\nDerivation of ft for MOS Device in Saturation\n-gmbvs\nvgs\nro\ngmvgs\nID+id\nCsb\nCgs\nCgd\nCdb\niin\nVbias\nRLARGE\nid\niin\n\nM.H. Perrott\nMIT OCW\nDerivation of ft for MOS Device in Saturation\nid\niin\nf\nft\nslope = -20 dB/dec\n\nM.H. Perrott\nMIT OCW\nWhy is ft a Function of Voltage Bias?\nft is a ratio of gm to gate capacitance\n- gm is a function of gate bias, while gate cap is not (so long\nas device remains biased)\nFirst order relationship between gm and gate bias:\n- The larger the gate bias, the higher the value for ft\nAlternately, ft is a function of current density\n- So ft maximized at max current density (and minimum L)\n\nM.H. Perrott\nMIT OCW\nSpeed of NMOS Versus PMOS Devices\nNMOS devices have much higher mobility than PMOS\ndevices (in current, non-strained, bulk CMOS processes)\n- Intuition: NMOS devices provide approximately 2.5 x gm\nfor a given amount of capacitance and gate bias voltage\n- Also: NMOS devices provide approximately 2.5 x Id for a\ngiven amount of capacitance and gate bias voltage\n\nM.H. Perrott\nMIT OCW\nAssumptions for High Speed Amplifier Analysis\nAssume that amplifier is loaded by an identical\namplifier and by fixed wiring capacitance\nIntrinsic performance\n- Defined as the bandwidth achieved for a given gain\nwhen Cfixed is negligible\n- Amplifier approaches intrinsic performance as its device\nsizes (and current) are increased\nIn practice, optimal sizing (and power) of amplifier is\nroughly where Cin+Cout = Cfixed\nAmp\nAmp\nCfixed\nCin\nCin\nCtot = Cout+Cin+Cfixed\nCout\n\nM.H. Perrott\nMIT OCW\nThe Miller Effect\nConcerns impedances that connect from input to\noutput of an amplifier\nInput impedance:\nOutput impedance:\nAmp\nZin\nZf\nAv\nZL\nVout\nVin\nZout\n\nM.H. Perrott\nMIT OCW\nExample: The Impact of Capacitance in Feedback\nConsider Cgd in the MOS device as Cf\n- Assume gain is negative\nImpact on input capacitance:\nOutput impedance:\nAmp\nZin\nAv\nZL\nVout\nVin\nZout\nCf\n\nM.H. Perrott\nMIT OCW\nAmplifier Example - CMOS Inverter\nAssume that we set Vbias such that the amplifier\nnominal output is such that NMOS and PMOS\ntransistors are all in saturation\n- Note: this topology VERY sensitive to bias errors\nCfixed\nCtot = Cdb1+Cdb2 + Cgs3+Cgs4 + K(Cov3+Cov4) + Cfixed\nM2\nM1\nM4\nM3\nMiller multiplication factor\nVbias\nvin\n(+Cov1+Cov2)\nvout\n\nM.H. Perrott\nMIT OCW\nTransfer Function of CMOS Inverter\nLow Bandwidth!\nCfixed\nCtot = Cdb1+Cdb2 + Cgs3+Cgs4 + K(Cov3+Cov4) + Cfixed\nM2\nM1\nM4\nM3\nMiller multiplication factor\nVbias\nvin\n(+Cov1+Cov2)\nvout\nvout\nvin\nf\nslope = -20 dB/dec\n(gm1+gm2)(ro1||ro2)\n2πCtot(ro1||ro2)\ngm1+gm2\n2πCtot\n\nM.H. Perrott\nMIT OCW\nAdd Resistive Feedback\nBandwidth\nextended and\nless sensitivity\nto bias offset\nCfixed\nCtot = Cdb1+Cdb2 + Cgs3+Cgs4 + K(Cov3+Cov4) + CRf /2 + Cfixed\nM2\nM1\nM4\nM3\nMiller multiplication factor\nVbias\nvin\n(+Cov1+Cov2)\nvout\nRf\nvout\nvin\nf\nslope = -20 dB/dec\n(gm1+gm2)(ro1||ro2)\n2πCtot(ro1||ro2)\ngm1+gm2\n2πCtot\n(gm1+gm2)Rf\n2πCtotRf\n\nM.H. Perrott\nMIT OCW\nWe Can Still Do Better\nWe are fundamentally looking for high gm to\ncapacitance ratio to get the highest bandwidth\n- PMOS degrades this ratio\n- Gate bias voltage is constrained\nCfixed\nCtot = Cdb1+Cdb2 + Cgs3+Cgs4 + K(Cov3+Cov4) + CRf /2 + Cfixed\nM2\nM1\nM4\nM3\nMiller multiplication factor\nVbias\nvin\n(+Cov1+Cov2)\nvout\nRf\n\nM.H. Perrott\nMIT OCW\nTake PMOS Out of the Signal Path\nAdvantages\n- PMOS gate no longer loads the signal\n- NMOS device can be biased at a higher voltage\nIssue\n- PMOS is not an efficient current provider (Id/drain cap)\nDrain cap close in value to Cgs\n- Signal path is loaded by cap of Rf and drain cap of\nPMOS\nCL\nM2\nM1\nVbias\nvin\nvout\nRf\nVbias2\nIbias\nCL\nM1\nVbias\nvin\nvout\nRf\n\nM.H. Perrott\nMIT OCW\nShunt-Series Amplifier\nUse resistors to control the bias, gain, and\ninput/output impedances\n- Improves accuracy over process and temp variations\nIssues\n- Degeneration of M1 lowers slew rate for large signal\napplications (such as limit amps)\n- There are better high speed approaches - the advantage\nof this one is simply accuracy\nIbias\nM1\nVbias\nvin\nvout\nRf\nR1\nRs\nRL\nRin\nRout\nM1\nVbias\nvin\nvout\nRf\nR1\nRs\nRL\nRin\nRout\n\nM.H. Perrott\nMIT OCW\nShunt-Series Amplifier - Analysis Snapshot\nFrom Chapter 8 of Tom Lee's\nbook (see pp 191-197):\n- Gain\n- Input resistance\n- Output resistance\nM1\nVbias\nvin\nvout\nRf\nR1\nRs\nRL\nRin\nRout\nvx\nSame for Rs = RL!\n\nM.H. Perrott\nMIT OCW\nNMOS Load Amplifier\nGain set by the relative sizing of M1 and M2\nCfixed\nM1\nVbias\nvin\nvout\nM2\ngm2\nvout\nvin\nf\nslope =\n-20 dB/dec\ngm1\n2πCtot\ngm1\n2πCtot\ngm2\ngm2\nCtot = Cdb1+Csb2+Cgs2 + Cgs3+KCov3 + Cfixed\nMiller multiplication factor\n(+Cov1)\nM3\nVdd\nId\n\nM.H. Perrott\nMIT OCW\nDesign of NMOS Load Amplifier\nSize transistors for gain and speed\n- Choose minimum L for maximum speed\n- Choose ratio of W1 to W2 to achieve appropriate gain\nProblem: VT of M2 lowers the bias voltage of the next\nstage (thus lowering its achievable ft)\n- Severely hampers performance when amplifier is cascaded\n- One person solved this issue by increasing Vdd of NMOS\nload (see Sackinger et. al., \"A 3-GHz 32-dB CMOS Limiting\nAmplifier for SONET OC-48 receivers\", JSSC, Dec 2000)\nCfixed\nM1\nVbias\nvin\nvout\nM2\ngm2\nCtot = Cdb1+Csb2+Cgs2 + Cgs3+KCov3 + Cfixed\nMiller multiplication factor\n(+Cov1)\nM3\nVdd\nId\n\nM.H. Perrott\nMIT OCW\nResistor Loaded Amplifier (Unsilicided Poly)\nThis is the fastest non-enhanced amplifier I've found\n- Unsilicided poly is a pretty efficient current provider\n(i..e, has a good current to capacitance ratio)\n- Output swing can go all the way up to Vdd\nAllows following stage to achieve high ft\n- Linear settling behavior (in contrast to NMOS load)\nM1\nRL\nvout\nM2\nCfixed\nId\nVbias\nvin\nCtot = Cdb1+CRL/2 + Cgs2+KCov2 + Cfixed\nMiller multiplication factor\n(+Cov1)\nvout\nvin\nf\nslope =\n-20 dB/dec\ngm1\n2πCtot\ngm1RL\n2πRLCtot\nVdd\n\nM.H. Perrott\nMIT OCW\nImplementation of Resistor Loaded Amplifier\nTypically implement using differential pairs\nBenefits\n- Self-biased\n- Common-mode rejection\nNegative\n- More power than single-ended version\nM6\nM1\nM2\nM5\nαIbias\nVin+\nR1\nVin-\nR2\nVo+\nVo-\nM7\nM3\nM4\nCfixed\nCfixed\nIbias\nIbias/2\nVdd\n\nM.H. Perrott\nMIT OCW\nThe Issue of Velocity Saturation\nWe classically assume that MOS current is calculated as\nWhich is really\n- Vdsat,l corresponds to the saturation voltage at a given\nlength, which we often refer to as ∆V\nIt may be shown that\n- If Vgs-VT approaches LEsat in value, then the top equation is\nno longer valid\nWe say that the device is in velocity saturation\n\nM.H. Perrott\nMIT OCW\nAnalytical Device Modeling in Velocity Saturation\nIf L small (as in modern devices), than velocity\nsaturation will impact us for even moderate values\nof Vgs-VT\n- Current increases linearly with Vgs-VT!\nTransconductance in velocity saturation:\n- No longer a function of Vgs!\n\nM.H. Perrott\nMIT OCW\nExample: Current Versus Voltage for 0.18μ Device\n0.4\n0.6\n0.8\n1.2\n1.4\n1.6\n1.8\n0.2\n0.4\n0.6\n0.8\n1.2\n1.4\nVgs (Volts)\nId (milliAmps)\nId versus Vgs\nM1\nId\nVgs\nW\nL = 1.8μ\n0.18μ\n\nM.H. Perrott\nMIT OCW\n0.4\n0.6\n0.8\n1.2\n1.4\n1.6\n1.8\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\n0.7\n0.8\n0.9\nVgs (Volts)\ngm (milliAmps/Volts)\ngm versus Vgs\nExample: Gm Versus Voltage for 0.18μ Device\nM1\nId\nVgs\nW\nL = 1.8μ\n0.18μ\n\nM.H. Perrott\nMIT OCW\n0.2\n0.4\n0.6\n0.8\nCurrent Density (microAmps/micron)\nTransconductance (milliAmps/Volts)\nTransconductance versus Current Density\nExample: Gm Versus Current Density for 0.18μ Device\nM1\nId\nVgs\nW\nL = 1.8μ\n0.18μ\n\nM.H. Perrott\nMIT OCW\nHow Do We Design the Amplifier?\nHighly inaccurate to assume square law behavior\nWe will now introduce a numerical procedure based\non the simulated gm curve of a transistor\n- A look at gm assuming square law device:\n- Observe that if we keep the current density (Id/W)\nconstant, then gm scales directly with W\nThis turns out to be true outside the square-law regime\nas well\n- We can therefore relate gmof devices with different\nwidths given that have the same current density\n\nM.H. Perrott\nMIT OCW\nA Numerical Design Procedure for Resistor Amp - Step 1\nTwo key equations\n- Set gain and swing (single-\nended)\nEquate (1) and (2) through R\nM6\nM1\nM2\nM5\nαIbias\nVin+\nR\nVin-\nR\nVo+\nVo-\n2Ibias\nIbias\nVdd\nCan we relate this formula to a gm curve taken\nfrom a device of width Wo?\n\nM.H. Perrott\nMIT OCW\nWe now know:\nSubstitute (2) into (1)\nThe above expression allows us to design the resistor\nloaded amp based on the gm curve of a representative\ntransistor of width Wo!\nA Numerical Design Procedure for Resistor Amp - Step 2\n\nM.H. Perrott\nMIT OCW\nExample: Design for Swing of 1 V, Gain of 1 and 2\nAssume L=0.18μ, use previous gm plot (Wo=1.8μ)\n0.2\n0.4\n0.6\n0.8\nCurrent Density - Iden (microAmps/micron)\nTransconductance (milliAmps/Volts)\nTransconductance versus Current Density\nA=2\nA=1\ngm(wo=1.8μ,Iden)\nFor gain of 1,\ncurrent density =\n250 μA/μm\nFor gain of 2,\ncurrent density =\n115 μA/μm\nNote that current\ndensity reduced\nas gain increases!\n- ft effectively\ndecreased\n\nM.H. Perrott\nMIT OCW\nExample (Continued)\nKnowledge of the current density allows us to design\nthe amplifier\n- Recall\n- Free parameters are W, Ibias, and R (L assumed to be fixed)\nGiven Iden = 115 μA/μm (Swing = 1V, Gain = 2)\n- If we choose Ibias = 300 μA\nNote that we could instead choose W or R, and then\ncalculate the other parameters\n\nM.H. Perrott\nMIT OCW\nHow Do We Choose Ibias For High Bandwidth?\nAs you increase Ibias, the size of transistors also\nincreases to keep a constant current density\n- The size of Cin and Cout increases relative to Cfixed\nTo achieve high bandwidth, want to size the devices\n(i.e., choose the value for Ibias), such that\n- Cin+Cout roughly equal to Cfixed\nAmp\nAmp\nCfixed\nCin\nCin\nCtot = Cout+Cin+Cfixed\nCout"
    },
    {
      "category": "Lecture Notes",
      "title": "lec6.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/8885340f0efba2784f45b83fa4ac4518_lec6.pdf",
      "content": "6.976\nHigh Speed Communication Circuits and Systems\nLecture 6\nEnhancement Techniques for Broadband Amplifiers,\nNarrowband Amplifiers\nMichael Perrott\nMassachusetts Institute of Technology\nCopyright (c) 2003 by Michael H. Perrott\n\nM.H. Perrott\nMIT OCW\nResistor Loaded Amplifier (Unsilicided Poly)\nWe decided this was the fastest non-enhanced amplifier\n- Can we go faster? (i.e., can we enhance its bandwidth?)\nWe will look at the following\n- Reduction of Miller effect on Cgd\n- Shunt, series, and zero peaking\n- Distributed amplification\nM1\nRL\nvout\nM2\nCfixed\nId\nVbias\nvin\nCtot = Cdb1+CRL/2 + Cgs2+KCov2 + Cfixed\nMiller multiplication factor\n(+Cov1)\nvout\nvin\nf\nslope =\n-20 dB/dec\ngm1\n2πCtot\ngm1RL\n2πRLCtot\nVdd\n\nM.H. Perrott\nMIT OCW\nCgd is quite significant compared to Cgs\n- In 0.18μ CMOS, Cgd is about 45% the value of Cgs\nInput capacitance calculation\n- For 0.18μ CMOS, gain of 3, input cap is almost tripled\nover Cgs!\nM1\nRL\nvout\nCL\nId\nVbias\nvin\nCgd\nZin\nRs\nCgs\nMiller Effect on Cgd Is Significant\n\nM.H. Perrott\nMIT OCW\nReduction of Cgd Impact Using a Cascode Device\nThe cascode device lowers the gain seen by Cgd of M1\n- For 0.18m CMOS and gain of 3, impact of Cgd is reduced\nby 30%:\nIssue: cascoding lowers achievable voltage swing\nM1\nRL\nvout\nCL\nVbias\nvin\nCgd\nZin\nRs\nCgs\nVbias2\nM2\n\nM.H. Perrott\nMIT OCW\nSource-Coupled Amplifier\nRemove impact of Miller effect by sending signal\nthrough source node rather than drain node\n- Cgd not Miller multiplied AND impact of Cgs cut in half!\nThe bad news\n- Signal has to go through source node (Csb significant)\n- Power consumption doubled\nM1\nVbias\nvin\nCgd\nRs\nM2\nRL\nCgd\n2Ibias\nvout\nZin\n\nM.H. Perrott\nMIT OCW\nNeutralization\nConsider canceling the effect of Cgd\n- Choose CN = Cgd\n- Charging of Cgd now provided by CN\nBenefit: Impact of Cgd removed\nIssues:\n- How do we create the inverting amplifier?\n- What happens if CN is not precisely matched to Cgd?\nM1\nRL\nvout\nCL\nId\nVbias\nvin\nCgd\nZin\nRs\nCgs\n-1\nCN\n\nM.H. Perrott\nMIT OCW\nPractical Implementation of Neutralization\nLeverage differential signaling to create an inverted signal\nOnly issue left is matching CN to Cgd\n- Often use lateral metal caps for CN (or CMOS transistor)\n- If CN too low, residual influence of Cgd\n- If CN too high, input impedance has inductive component\nCauses peaking in frequency response\nOften evaluate acceptable level of peaking using eye diagrams\nM1\nRL\nVbias\nvin\nCgd\nRs\nCN\nM2\nRL\nCgd\n2Ibias\nCN\n-vin\nRs\n\nM.H. Perrott\nMIT OCW\nShunt-peaked Amplifier\nUse inductor in load to extend bandwidth\n- Often implemented as a spiral inductor\nWe can view impact of inductor in both time and\nfrequency\n- In frequency: peaking of frequency response\n- In time: delay of changing current in RL\nIssue - can we extend bandwidth without significant\npeaking?\nM1\nRL\nvout\nM2\nCfixed\nId\nVbias\nvin\nVdd\nLd\n\nM.H. Perrott\nMIT OCW\nShunt-peaked Amplifier - Analysis\nExpression for gain\nParameterize with\n- Corresponds to ratio of RC to LR time constants\nM1\nRL\nvout\nM2\nCfixed\nId\nVbias\nvin\nVdd\nLd\nRL\nLd\nCtot\niin=gmvin\nvout\nSmall Signal Model\nZout\n\nM.H. Perrott\nMIT OCW\nThe Impact of Choosing Different Values of m - Part 1\nParameterized gain expression\nComparison of new and old\n3 dB frequencies\nWant to solve for w2/w1\nRL\nLd\nCtot\niin=gmvin\nvout\nSmall Signal Model\nZout\n\nM.H. Perrott\nMIT OCW\nThe Impact of Choosing Different Values of m - Part 2\nFrom previous slide, we have\nAfter much algebra\nWe see that m directly sets the amount of bandwidth\nextension!\n- Once m is chosen, inductor value is\n\nM.H. Perrott\nMIT OCW\nPlot of Bandwidth Extension Versus m\n1.1\n1.2\n1.3\n1.4\n1.5\n1.6\n1.7\n1.8\n1.9\nBandwidth Extension (w2/w1) Versus m\nw1/w2\nm\nHighest extension: w2/w1 = 1.85 at m ≈1.41\n- However, peaking occurs!\n\nM.H. Perrott\nMIT OCW\nPlot of Transfer Function Versus m\nMaximum\nbandwidth:\nm = 1.41\n(extension = 1.85)\nMaximally flat\nresponse:\nm = 2.41\n(extension = 1.72)\nBest phase\nresponse:\nm = 3.1\n(extension = 1.6)\nNo peaking:\nm = infinity\nEye diagrams often\nused to evaluate\nbest m\n1/100\n1/10\n-45\n-40\n-35\n-30\n-25\n-20\n-15\n-10\n-5\nNormalized Gain (dB)\nNormalized Frequency (Hz)\nNormalized Gain for Shunt Peaked Amplifier For Different m Values\nm=1.41\nm=2.41\nm=3.1\nm=infinity\n\nM.H. Perrott\nMIT OCW\nTo Do\nAdd eye diagrams\n\nM.H. Perrott\nMIT OCW\nZero-peaked Common Source Amplifier\nInductors are expensive with respect to die area\nWe can instead achieve bandwidth extension with\ncapacitor\n- Idea: degenerate gain at low frequencies, remove\ndegeneration at higher frequencies (i.e., create a zero)\nIssues:\n- Must increase RL to keep same gain (lowers pole)\n- Lowers achievable gate voltage bias (lowers device ft)\nM1\nRL\nvout\nM2\nCfixed\nId\nVbias\nvin\nVdd\nRs\nCs\nvout\nvin\nf\ngmRL\n2πCtotRL\n2πCsRs\n1+gmRs\nzero\noverall\nresponse\n\nM.H. Perrott\nMIT OCW\nBack to Inductors - Shunt and Series Peaking\nCombine shunt peaking with a series inductor\n- Bandwidth extension by converting to a second order\nfilter response\nCan be designed for proper peaking\nIncreases delay of amplifier\nM1\nRL\nvout\nM2\nCfixed\nId\nVbias\nvin\nVdd\nL1\nL2\nvout\nvin\nf\ngmRL\n2πCtotRL\n-40 dB/dec\n-20 dB/dec\n\nM.H. Perrott\nMIT OCW\nT-Coil Bandwidth Enhancement\nUses coupled inductors to realize T inductor network\n- Works best if capacitance at drain of M1 is much less than\nthe capacitance being driven at the output load\nSee Chap. 8 of Tom Lee's book (pp 187-191) for analysis\nSee S. Galal, B. Ravazi, \"10 Gb/s Limiting Amplifier and\nLaser/Modulator Driver in 0.18u CMOS\", ISSCC 2003, pp\n188-189 and \"Broadband ESD Protection ...\", pp. 182-183\nM1\nRL\nvout\nM2\nCfixed\nId\nVbias\nvin\nVdd\nL1\nL2\nL3\nM1\nvout\nM2\nCfixed\nVbias\nvin\nL2\nL1\nCB\nk\nRL\nVdd\n\nM.H. Perrott\nMIT OCW\nBandwidth Enhancement With ft Doublers\nA MOS transistor has ft calculated as\nft doubler amplifiers attempt to\nincrease the ratio of\ntransconductance to capacitance\nM1\nM2\n2Ibias\nI1\nI2\nVbias\nvin\nWe can make the argument that differential amplifiers\nare ft doublers\n- Capacitance seen by Vin for single-ended input:\n- Difference in current:\n\nTransconductance to Cap ratio is doubled:\n\nM.H. Perrott\nMIT OCW\nCreating a Single-Ended Output\nInput voltage is again dropped across two transistors\n- Ratio given by voltage divider in capacitance\nIdeally is 1⁄2 of input voltage on Cgs of each device\nInput voltage source sees the series combination of\nthe capacitances of each device\n- Ideally sees 1⁄2 of the Cgs of M1\nCurrents of each device add to ideally yield ratio:\nM1\nM2\n2Ibias\nI1\nI2\nVbias\nvin\nM1\nM2\nIbias\nIo\nVbias\nvin\nIbias\n\nM.H. Perrott\nMIT OCW\nCreating the Bias for M2\nUse current mirror for bias\n- Inspired by bipolar circuits (see Tom Lee's book, page 198)\nNeed to set Vbias such that current through M1 has the\ndesired current of Ibias\n- The current through M2 will ideally match that of M1\nProblem: achievable bias voltage across M1 (and M2) is\nseverely reduced (thereby reducing effective ft of device)\n- Do ft doublers have an advantage in CMOS?\nM1\nM2\n2Ibias\nI1\nI2\nVbias\nvin\nM1\nM2\nIbias\nIo\nVbias\nvin\nIbias\nM1\nM2\nIo\nVbias\nvin\nIbias\nM3\n\nM.H. Perrott\nMIT OCW\nIncreasing Gain-Bandwidth Product Through Cascading\nWe can significantly increase the gain of an amplifier\nby cascading n stages\n- Issue - bandwidth degrades, but by how much?\nAmp\nAmp\nCfixed\nAmp\nCfixed\nA\n1 + s/wo\nA\n1 + s/wo\nA\n1 + s/wo\nvin\nvout\nvin\nvout\n\nM.H. Perrott\nMIT OCW\nAnalytical Derivation of Overall Bandwidth\nThe overall 3-db bandwidth of the amplifier is where\n- w1 is the overall bandwidth\n- A and wo are the gain and bandwidth of each section\n- Bandwidth decreases much slower than gain increases!\nOverall gain bandwidth product of amp can be increased!\n\nM.H. Perrott\nMIT OCW\nTransfer Function for Cascaded Sections\n1/100\n1/10\n-80\n-70\n-60\n-50\n-40\n-30\n-20\n-10\nNormalized Gain (dB)\nNormalized Frequency (Hz)\nNormalized Transfer Function for Cascaded Sections\nn=1\nn=2\nn=3\nn=4\n-3\n\nM.H. Perrott\nMIT OCW\nChoosing the Optimal Number of Stages\nTo first order, there is a constant gain-bandwidth\nproduct for each stage\n- Increasing the bandwidth of each stage requires that we\nlower its gain\n- Can make up for lost gain by cascading more stages\nWe found that the overall bandwidth is calculated as\nAssume that we want to achieve gain G with n stages\nFrom this, Tom Lee finds optimum gain ≈1.65\n- See Tom Lee's book, pp 207-211\n\nM.H. Perrott\nMIT OCW\nAchievable Bandwidth Versus G and n\n0.05\n0.1\n0.15\n0.2\n0.25\nAchievable Bandwidth (Normalized to f )\nt\nVersus Gain (G) and Number of Stages (n)\nn\nw1/wt\n0.3\nA=1.65\nA=3\nG=10\nG=100\nG=1000\nOptimum gain per\nstage is about 1.65\n- Note than gain\nper stage derived\nfrom plot as\n- Maximum is fairly\nsoft, though\nCan dramatically\nlower power (and\nimprove noise) by\nusing larger gain\nper stage\n\nM.H. Perrott\nMIT OCW\nMotivation for Distributed Amplifiers\nWe achieve higher gain for a given load resistance by\nincreasing the device size (i.e., increase gm)\n- Increased capacitance lowers bandwidth\nWe therefore get a relatively constant gain-bandwidth product\nWe know that transmission lines have (ideally) infinite\nbandwidth, but can be modeled as LC networks\n- Can we lump device capacitances into transmission line?\nM1\nM2\nM3\nvout\nvin\nRs=Z0\nRL=Z0\nCin\nCin\nCin\nCout\nCout\nCout\n\nM.H. Perrott\nMIT OCW\nDistributing the Input Capacitance\nLump input capacitance into LC network corresponding\nto a transmission line\n- Signal ideally sees a real impedance rather than an RC\nlowpass\n- Often implemented as lumped networks such as T-coils\n- We can now trade delay (rather than bandwidth) for gain\nIssue: outputs are delayed from each other\nM1\nM2\nM3\nZo\nZo\nZo\nZo\nvout\nRL=Z0\ndelay\nvin\nRs=Z0\nRL=Z0\nCout\nCout\nCout\n\nM.H. Perrott\nMIT OCW\nDistributing the Output Capacitance\nDelay the outputs same amount as the inputs\n- Now the signals match up\n- We have also distributed the output capacitance!\nBenefit - high bandwidth\nNegatives - high power, poorer noise performance,\nexpensive in terms of chip area\n- Each transistor gain is adding rather than multiplying!\nM1\nZo\nZo\nZo\nZo\nM2\nM3\nZo\nZo\nZo\nZo\nRL=Z0\nvout\nRL=Z0\ndelay\ndelay\nvin\nRs=Z0\nRL=Z0\n\nM.H. Perrott\nMIT OCW\nNarrowband Amplifiers\nFor wireless systems, we are interested in\nconditioning and amplifying the signal over a narrow\nfrequency range centered at a high frequency\n- Allows us to apply narrowband transformers to create\nmatching networks\nCan we take advantage of this fact when designing\nthe amplifier?\nVL\nC1\nRL\nL1\nDelay = x\nCharacteristic Impedance = Zo\nTransmission Line\nZ1\nVin\nC2\ndie\nConnector\nControlled Impedance\nPCB trace\npackage\nOn-Chip\nDriving\nSource\nAmp\nVout\nMatching\nNetwork\nMatching\nNetwork\n\nM.H. Perrott\nMIT OCW\nTuned Amplifiers\nPut inductor in parallel across RL to create bandpass\nfilter\n- It will turn out that the gain-bandwidth product is\nroughly conserved regardless of the center frequency!\nAssumes that center frequency (in Hz) << ft\nTo see this and other design issues, we must look\ncloser at the parallel resonant circuit\nM1\nvout\nCL\nVbias\nvin\nRs\nVdd\nLT\nRL\n\nM.H. Perrott\nMIT OCW\nTuned Amp Transfer Function About Resonance\nEvaluate at s = jw\nLook at frequencies about resonance:\nRp\nLp\nCp\niin=gmvin\nZtank\nvout\nAmplifier transfer function\nNote that conductances\nadd in parallel\n\nM.H. Perrott\nMIT OCW\nTuned Amp Transfer Function About Resonance (Cont.)\nFrom previous slide\nSimplifies to RC circuit for bandwidth calculation!\n=0\nRp\nLp\nCp\niin=gmvin\nZtank\nvout\nvout\nvin\nw\nslope =\n-20 dB/dec\ngmRp\nRp2Cp\nwo\nRp2Cp\nRpCp\n\nM.H. Perrott\nMIT OCW\nGain-Bandwidth Product for Tuned Amplifiers\nThe gain-bandwidth product:\nThe above expression is independent of center\nfrequency!\n- In practice, we need to operate at a frequency less than\nthe ft of the device\nRp\nLp\nCp\niin=gmvin\nZtank\nvout\nvout\nvin\nw\nslope =\n-20 dB/dec\ngmRp\nRp2Cp\nwo\nRp2Cp\nRpCp\n\nM.H. Perrott\nMIT OCW\nBy definition\nFor parallel tank (see Tom Lee's book, pp 88-89)\nComparing to above:\nThe Issue of Q\nRp\nLp\nCp\niin=gmvin\nZtank\nvout\nvout\nvin\nw\nslope =\n-20 dB/dec\ngmRp\nRp2Cp\nwo\nRp2Cp\nRpCp\n\nM.H. Perrott\nMIT OCW\nThree key parameters\n- Gain = gmRp\n- Center frequency = wo\n- Q = wo/BW\nImpact of high Q\n- Benefit: allows achievement of high gain with low power\n- Problem: makes circuit sensitive to process/temp\nvariations\nDesign of Tuned Amplifiers\nRp\nLp\nCp\niin=gmvin\nZtank\nvout\nvout\nvin\nw\nslope =\n-20 dB/dec\ngmRp\nRp2Cp\nwo\nRp2Cp\nRpCp\n\nM.H. Perrott\nMIT OCW\nIssue: Cgd Can Cause Undesired Oscillation\nAt frequencies below resonance, tank looks inductive\nM1\nvout\nCL\nVbias\nvin\nCgd\nZin\nRs\nCgs\nVdd\nLT\nRL\nNegative\nResistance!\n\nM.H. Perrott\nMIT OCW\nUse Cascode Device to Remove Impact of Cgd\nAt frequencies above and below resonance\nM1\nvout\nCL\nVbias\nvin\nCgd\nZin\nRs\nCgs\nVbias2\nM2\nVdd\nLT\nRL\nPurely\nCapacitive!\n\nM.H. Perrott\nMIT OCW\nActive Real Impedance Generator\nInput impedance:\nZin\nAv(s)\nVout\nVin\nAv(s) = -Aoe-jΦ\nCf\nResistive component!\n\nM.H. Perrott\nMIT OCW\nThis Principle Can Be Applied To Impedance Matching\nWe will see that it's advantageous to make Zin real\nwithout using resistors\n- For the above circuit (ignoring Cgd)\nM1\nVbias\nvin\nRs\nLs\nZin\nIout\nLs\nvgs\ngmvgs\nCgs\nItest\nVtest\nLooks like series resonant circuit!\n\nM.H. Perrott\nMIT OCW\nUse A Series Inductor to Tune Resonant Frequency\nCalculate input impedance with added inductor\nOften want purely resistive component at frequency wo\n- Choose Lg such that resonant frequency = wo\nM1\nVbias\nvin\nRs\nLs\nZin\nIout\nM1\nVbias\nvin\nRs\nLs\nZin\nIout\nLg"
    },
    {
      "category": "Lecture Notes",
      "title": "lec7.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/d24bf4b690b79170cb92a1ed29e5cbf9_lec7.pdf",
      "content": "6.976\nHigh Speed Communication Circuits and Systems\nLecture 7\nNoise Modeling in Amplifiers\nMichael Perrott\nMassachusetts Institute of Technology\nCopyright (c) 2003 by Michael H. Perrott\n\nM.H. Perrott\nMIT OCW\nNotation for Mean, Variance, and Correlation\nConsider random variables x and y with probability\ndensity functions fx(x) and fy(y) and joint probability\nfunction fxy(x,y)\n- Expected value (mean) of x is\nNote: we will often abuse notation and denote\nas a random variable (i.e., noise) rather than its mean\n- The variance of x (assuming it has zero mean) is\n- A useful statistic is\nIf the above is zero, x and y are said to be uncorrelated\n\nM.H. Perrott\nMIT OCW\nRelationship Between Variance and Spectral Density\nTwo-sided spectrum\n- Since spectrum is symmetric\nOne-sided spectrum defined over positive frequencies\n- Magnitude defined as twice that of its corresponding\ntwo-sided spectrum\nIn the next few lectures, we assume a one-sided\nspectrum for all noise analysis\nSx(f)\nf\nA\nf1\nf2\n-f2 -f1\nSx(f)\nf\n2A\nf1\nf2\nTwo-Sided Spectrum\nOne-Sided Spectrum\n\nM.H. Perrott\nMIT OCW\nThe Impact of Filtering on Spectral Density\nFor the random signal passing through a linear,\ntime-invariant system with transfer function H(f)\n- We see that if x(t) is amplified by gain A, we have\nSy(f)\nf\nAB\nH(f)\nx(t)\ny(t)\n|H(f)|2\nf\nB\nf\nA\nSx(f)\n\nM.H. Perrott\nMIT OCW\nNoise in Resistors\nCan be described in terms of either voltage or current\nk is Boltzmann's constant\nT is temperature (in Kelvins)\n- Usually assume room temperature of 27 degrees Celsius\nR\nen\nR\nin\n\nM.H. Perrott\nMIT OCW\nNoise In Inductors and Capacitors\nIdeal capacitors and inductors have no noise!\nIn practice, however, they will have parasitic resistance\n- Induces noise\n- Parameterized by adding resistances in parallel/series\nwith inductor/capacitor\nInclude parasitic resistor noise sources\nL\nC\n\nM.H. Perrott\nMIT OCW\nNoise in CMOS Transistors (Assumed in Saturation)\nModeling of noise in transistors must include several noise\nsources\n- Drain noise\nThermal and 1/f - influenced by transistor size and bias\n- Gate noise\nInduced from channel - influenced by transistor size and bias\nCaused by routing resistance to gate (including resistance of\npolysilicon gate)\nCan be made negligible with proper layout such as fingering of\ndevices\nID\nG\nD\nS\nDrain Noise (Thermal and 1/f)\nGate Noise (Induced and Routing Parasitic)\nTransistor Noise Sources\n\nM.H. Perrott\nMIT OCW\nDrain Noise - Thermal (Assume Device in Saturation)\nThermally agitated carriers in the\nchannel cause a randomly varying\ncurrent\n- γ is called excess noise factor\n= 2/3 in long channel\n= 2 to 3 (or higher!) in short\nchannel NMOS (less in PMOS)\n- gdo will be discussed shortly\nind\nf\n4kTγgdo\n∆f\nS\nD\nG\nVGS\nVD>∆V\nind\n\nM.H. Perrott\nMIT OCW\nDrain Noise - 1/f (Assume Device in Saturation)\nind\nf\n4kTγgdo\n∆f\ndrain\n1/f noise\ndrain thermal noise\n1/f noise\ncorner frequency\nTraps at channel/oxide interface\nrandomly capture/release carriers\n- Parameterized by Kf and n\nProvided by fab (note n ≈1)\nCurrently: Kf of PMOS << Kf of\nNMOS due to buried channel\nS\nD\nG\nVGS\nVD>∆V\nind\n- To minimize: want large area (high WL)\n\nM.H. Perrott\nMIT OCW\nInduced Gate Noise (Assume Device in Saturation)\ning\nf\n4kTδgdo\n∆f\nα\nft\nslope =\n20 dB/decade\nS\nD\nG\nVGS\nVD>∆V\ning\nindg\nFluctuating channel potential\ncouples capacitively into the gate\nterminal, causing a noise gate\ncurrent\n- δ is gate noise coefficient\nTypically assumed to be 2γ\n- Correlated to drain noise!\n\nM.H. Perrott\nMIT OCW\nUseful References on MOSFET Noise\nThermal Noise\n- B. Wang et. al., \"MOSFET Thermal Noise Modeling for\nAnalog Integrated Circuits\", JSSC, July 1994\nGate Noise\n- Jung-Suk Goo, \"High Frequency Noise in CMOS Low\nNoise Amplifiers\", PhD Thesis, Stanford University,\nAugust 2001\nhttp://www-tcad.stanford.edu/tcad/pubs/theses/goo.pdf\n- Jung-Suk Goo et. al., \"The Equivalence of van der Ziel and\nBSIM4 Models in Modeling the Induced Gate Noise of\nMOSFETS\", IEDM 2000, 35.2.1-35.2.4\n- Todd Sepke, \"Investigation of Noise Sources in Scaled\nCMOS Field-Effect Transistors\", MS Thesis, MIT, June 2002\nhttp://www-mtl.mit.edu/research/sodini/sodinitheses.html\n\nM.H. Perrott\nMIT OCW\nDrain-Source Conductance: gdo\ngdo is defined as channel resistance with Vds=0\n- Transistor in triode, so that\n- Equals gm for long channel devices\nKey parameters for 0.18μ NMOS devices\n\nM.H. Perrott\nMIT OCW\nPlot of gm and gdο versus Vgs for 0.18μ NMOS Device\n0.4\n0.6\n0.8\n1.2\n1.4\n1.6\n1.8\n0.5\n1.5\n2.5\n3.5\nGate Voltage Vgs (Volts)\nTransconductance (milliAmps/Volts)\nTransconductances gm and gdo versus Gate Voltage Vgs\ngm (simulated in Hspice)\ngd0=μnCoxW/L(Vgs-VT)\nFor Vgs bias voltages around 1.2 V:\nM1\nId\nVgs\nW\nL = 1.8μ\n0.18μ\n\nM.H. Perrott\nMIT OCW\nPlot of gm and gdο versus Idens for 0.18μ NMOS Device\n0.5\n1.5\n2.5\n3.5\nCurrent Density (microAmps/micron)\nTransconductance (milliAmps/Volts)\nTransconductances gm and gdo versus Current Density\ngm (simulated in Hspice)\ngd0=μnCoxW/L(Vgs-VT)\nM1\nId\nVgs\nW\nL = 1.8μ\n0.18μ\n\nM.H. Perrott\nMIT OCW\nNoise Sources in a CMOS Amplifier\nRS\nRG\nRD\nRD\nRgpar\n-gmbvs\nvgs\nvs\nro\ngmvgs\nID\nCsb\nCgs\nCgd\nCdb\nind\ning\nengpar\ngg\nRG\nenG\nRdeg\nenD\nendeg\nVin\nVout\n\nM.H. Perrott\nMIT OCW\nRemove Model Components for Simplicity\nRS\nRG\nRD\nRD\nRgpar\n-gmbvs\nvgs\nvs\nro\ngmvgs\nID\nCsb\nCgs\nCgd\nCdb\nind\ning\nengpar\ngg\nRG\nenG\nRdeg\nenD\nendeg\nVin\nVout\n\nM.H. Perrott\nMIT OCW\nKey Noise Sources for Noise Analysis\nTransistor drain noise\nThermal noise\n1/f noise\nTransistor gate noise\nRS\nRG\nRD\nRD\nvgs\nvs\ngmvgs\nID\nCgs\nind\ning\nRG\nenG\nRdeg\nenD\nendeg\nVin\nVout\n\nM.H. Perrott\nMIT OCW\nApply Thevenin Techniques to Simplify Noise Analysis\nAssumption: noise independent of load resistor on drain\nvgs\ngmvgs\nCgs\nind\ning\nD\nS\nG\nZgs\nZg\nZdeg\niout\nvgs\ngmvgs\nCgs\nindg\nD\nS\nG\nZgs\nZg\nZdeg\niout\n\nM.H. Perrott\nMIT OCW\nvgs\ngmvgs\nCgs\nind\ning\nD\nS\nG\nZgs\nZg\nZdeg\niout\nvgs\ngmvgs\nCgs\nindg\nD\nS\nG\nZgs\nZg\nZdeg\niout\nCalculation of Equivalent Output Noise for Each Case\n\nM.H. Perrott\nMIT OCW\nCalculation of Zgs\nWrite KCL equations\nAfter much algebra:\nvgs\ngmvgs\nCgs\nD\nS\nG\nZgs\nZg\nZdeg\niout\nvtest\nitest\nv1\n\nM.H. Perrott\nMIT OCW\nDetermine Vgs to find iout in terms of itest\nAfter much algebra:\nCalculation of η\nvgs\ngmvgs\nCgs\nitest\nD\nS\nG\nZgs\nZg\nZdeg\niout\nv1\n\nM.H. Perrott\nMIT OCW\nCalculation of Output Current Noise Variance (Power)\nTo find noise variance:\nIout\nG\nD\nS\nvgs\ngmvgs\nCgs\nindg\nD\nS\nG\nZgs\nZg\nZdeg\niout\nZg\nZdeg\n\nM.H. Perrott\nMIT OCW\nVariance (i.e., Power) Calc. for Output Current Noise\nNoise variance calculation\nDefine correlation coefficient c between ing and ind\n\nM.H. Perrott\nMIT OCW\nParameterized Expression for Output Noise Variance\nKey equation from last slide\nSolve for noise ratio\nDefine parameters Zgsw and χd\n\nM.H. Perrott\nMIT OCW\nSmall Signal Model for Noise Calculations\nIout\nG\nD\nS\nvgs\ngmvgs\nCgs\nindg\nD\nS\nG\nZgs\nZg\nZdeg\niout\nZg\nZdeg\n\nM.H. Perrott\nMIT OCW\nExample: Output Current Noise with Zs = Rs, Zdeg = 0\nStep 1: Determine key noise parameters\n- For 0.18μ CMOS, we will assume the following\nStep 2: calculate η and Zgsw\nvgs\ngmvgs\nCgs\nindg\nZgs\nRs\nens\nSource\nVin\niout\n\nM.H. Perrott\nMIT OCW\n- For w << 1/(RsCgs):\n- For w >> 1/(RsCgs):\nCalculation of Output Current Noise (continued)\nStep 3: Plug values into the previously derived expression\nGate noise contribution\nDrain Noise Multiplying Factor\nGate noise contribution\n\nM.H. Perrott\nMIT OCW\nPlot of Drain Noise Multiplying Factor (0.18μ NMOS)\nConclusion: gate noise has little effect on common\nsource amp when source impedance is purely resistive!\n0.75\n0.8\n0.85\n0.9\n0.95\n1/100\n1/10\nNormalized Frequency --- f/(2πRsCgs) (Hz)\nDrain Noise Multiplying Factor Versus Frequency for 0.18μ NMOS Device\nDrain Noise Gain Factor\nf >> 1/(2πRsCgs)\nf << 1/(2πRsCgs)\n\nM.H. Perrott\nMIT OCW\nBroadband Amplifier Design Considerations for Noise\nDrain thermal noise is the chief issue of concern\nwhen designing amplifiers with > 1 GHz bandwidth\n- 1/f noise corner is usually less than 1 MHz\n- Gate noise contribution only has influence at high\nfrequencies (such noise will likely be filtered out)\nNoise performance specification is usually given in\nterms of input referred voltage noise\nindg\nf\n2πRsCgs\n4kTγgdo\n∆f\ndrain\n1/f noise\ngate noise contribution\nwith purely resistive\nsource impedance\ndrain thermal noise\n1/f noise\ncorner frequency\n\nM.H. Perrott\nMIT OCW\nNarrowband Amplifier Noise Requirements\nHere we focus on a narrowband of operation\n- Don't care about noise outside that band since it will be\nfiltered out\nGate noise is a significant issue here\n- Using reactive elements in the source dramatically\nimpacts the influence of gate noise\nSpecification usually given in terms of Noise Figure\nindg\nf\n2πRsCgs\n4kTγgdo\n∆f\ndrain\n1/f noise\ndrain thermal noise\n1/f noise\ncorner frequency\nNarrowband\namplifier\nfrequency range\ngate noise contribution\nwith purely resistive\nsource impedance\n\nM.H. Perrott\nMIT OCW\nThe Impact of Gate Noise with Zs = Rs+sLg\nStep 1: Determine key noise parameters\n- For 0.18μ CMOS, again assume the following\nStep 2: Note that η =1 , calculate Zgsw\nvgs\ngmvgs\nCgs\nindg\nZgs\nRs\nens\nSource\nVin\niout\nLg\n\nM.H. Perrott\nMIT OCW\nEvaluate Zgsw At Resonance\nSet Lg such that it resonates with Cgs at the center\nfrequency (wo) of the narrow band of interest\nCalculate Zgsw at frequency wo\nvgs\ngmvgs\nCgs\nindg\nZgs\nRs\nens\nSource\nVin\niout\nLg\n\nM.H. Perrott\nMIT OCW\nSubstitute in for Zgsw\nGate noise contribution\nGate noise contribution is a function of Q!\n- Rises monotonically with Q\nKey noise expression derived earlier\nThe Impact of Gate Noise with Zs = Rs+sLg (Cont.)\n\nM.H. Perrott\nMIT OCW\nDetermine crossover point for Q value\n- Critical Q value for crossover is primarily set by process\nAt What Value of Q Does Gate Noise Exceed Drain Noise?\n=1\nindg\nf\n4kTγgdo\n∆f\ngate noise contribution\ndrain thermal noise\nNarrowband\namplifier\nfrequency range\nwo/2π\nQ2\n\nM.H. Perrott\nMIT OCW\nCalculation of the Signal Spectrum at the Output\nFirst calculate relationship between vin and iout\nAt resonance:\nSpectral density of signal at output at resonant frequency\nvgs\ngmvgs\nCgs\nindg\nZgs\nRs\nens\nSource\nVin\niout\nLg\n\nM.H. Perrott\nMIT OCW\nSNR (assume constant spectra, ignore noise from Rs):\nFor small Q such that gate noise < drain noise\n- SNRout improves dramatically as Q is increased\nFor large Q such that gate noise > drain noise\n- SNRout improves very little as Q is increased\nImpact of Q on SNR (Ignoring Rs Noise)\nindg\nf\n4kTγgdo\n∆f\ngate noise contribution\ndrain thermal noise\nNarrowband\namplifier\nfrequency range\nwo/2π\nQ2\nsignal spectrum\nQ2\n\nM.H. Perrott\nMIT OCW\nNoise Factor and Noise Figure\nDefinitions\nCalculation of SNRin and SNRout\niout\nRs\nenRs\nvin\nLinear,Time Invariant\nCircuit\n(Noiseless)\nZin\nvx\nZL\ninout\nZout\nEquivalent output\nreferred current noise\n(assumed to be independent\nof Zout and ZL)\n\nM.H. Perrott\nMIT OCW\nFirst calculate SNRout (must include Rs noise for this)\n- Rs noise calculation (same as for Vin)\n- SNRout:\nThen calculate SNRin:\nCalculate Noise Factor (Part 1)\nvgs\ngmvgs\nCgs\nindg\nZgs\nRs\nens\nSource\nVin\niout\nLg\n\nM.H. Perrott\nMIT OCW\nNoise Factor calculation:\nFrom previous analysis\nCalculate Noise Factor (Part 2)\n\nM.H. Perrott\nMIT OCW\nModify denominator using expressions for Q and wt\nResulting expression for noise factor:\n- Noise factor primarily depends on Q, wo/wt, and process specs\nCalculate Noise Factor (Part 3)\nNoise Factor scaling coefficient\n\nM.H. Perrott\nMIT OCW\nMinimum Noise Factor\nWe see that the noise factor will be minimized for\nsome value of Q\n- Could solve analytically by differentiating with respect\nto Q and solving for peak value (i.e. where deriv. = 0)\nIn Tom Lee's book (pp 272-277), the minimum noise\nfactor for the MOS common source amplifier (i.e. no\ndegeneration) is found to be:\nHow do these compare?\nNoise Factor scaling coefficient\nNoise Factor scaling coefficient\n\nM.H. Perrott\nMIT OCW\nPlot of Minimum Noise Factor and Noise Factor Vs. Q\nQ\nNoise Factor Scaling Coefficient\nNoise Factor Scaling Coefficient Versus Q for 0.18μ NMOS Device\nc = -j0\nc = -j0.55\nc = -j1\nc = -j1\nc = -j0.55\nc = -j0\nMinimum across\nall values of Q and\nAchievable values as\na function of Q under\nthe constraint that\nLgCgs\n= wo\nLgCgs\nNote: curves\nmeet if we\napproximate\nQ2+1 Q2\n\nM.H. Perrott\nMIT OCW\nAchieving Minimum Noise Factor\nFor common source amplifier without degeneration\n- Minimum noise factor can only be achieved at\nresonance if gate noise is uncorrelated to drain noise\n(i.e., if c = 0) - we'll see this next lecture\n- We typically must operate slightly away from resonance\nin practice to achieve minimum noise factor since c will\nbe nonzero\nHow do we determine the optimum source impedance\nto minimize noise figure in classical analysis?\n- Next lecture!"
    },
    {
      "category": "Resource",
      "title": "proj1.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/272e5f91c59be500532f83f96e9c0de3_proj1.pdf",
      "content": "Massachusetts Institute of Technology\nDepartment of Electrical Engineering and Computer Science\n6.976\nHigh Speed Communication Circuits and Systems\nSpring 2003\nProject #1: Design of a High Speed Divide-by-32/33 Prescaler\nPassed Out: March 21, 2003\nDue: April 11, 2003\nCopyright c\n⃝2003 by Michael H. Perrott\nObjective\nThis project will introduce you to the art of designing high speed frequency dividers. Your\ngoal will be to design a divide-by-32/33 prescaler, as shown in Figure 1, that supports a\nminimum input frequency of 5 GHz with maximum power dissipation of 10 mW. Calculation\nof power dissipation must include all blocks in Figure 1 (including bias sources) except for\ninput voltage sources Vin and Vin. You should strive to exceed one of these specifications\nsuch that\n- You achieve an input frequency higher than 5 GHz with power dissipation not exceeding\n10 mW, OR\n- You achieve power dissipation less than 10 mW with an input frequency equal to or\nabove 5 GHz.\nIn other words, you should explore either a high speed or low power approach under the\ngiven constraints.\nCload=100 fF\nVin\n32/33\nVin\n50 Ω\n50 Ω\n1.8 V\n0.9 V\n5 GHz\nT <\nIN\nIN\n32/33\nOUT\n1.8 V\n0.9 V\nrise/fall time = 40 ps\nD\nQ\nReg\nCON\nOUT\nFigure 1: High Speed Divide-by-32/33 Circuit.\n\nReport\nYour report should consist of the sections described below. Note that one report is turned in\nfor each project team (consisting of exactly 2 people), and must be no longer than 15 pages\nincluding all plots and figures.\n- A brief introduction of the project and a statement of your overall goal (i.e., a high\nspeed or low power divider design)\n- A brief summary of the performance you achieved, which includes a table of the val-\nues you obtained for the following specifications (assume a temperature of 25 degrees\nCelsius except where otherwise stated):\n1. Maximum input frequency of overall divider\n- At 25 degrees Celsius\n- At 0 degrees Celsius\n- At 80 degrees Celsisus\n2. Maximum input frequency achieved by each major section of the divider (i.e., the\nfront end divider circuit, the differential-to-full swing circuit (if used), and the\nback end divider circuits)\n3. Total power dissipation (including bias sources)\n4. A breakdown of power dissipation in the divider (i.e., list the power consumed for\neach major block in the divider)\n5. Overall speed/power metric for the entire divider (i.e., Maximum speed (GHz)/Power\ndissipation (mW))\n- A brief summary of simulated results that includes Hspice plots of the divider input\nand each divider stage output at the highest working frequency (with temperature set\nto 25 degrees Celsius). The plots must clearly show both the divide-by-32 and divide-\nby-33 operations as part of the same simulation run (i.e., you must switch the value of\ndivision during the simulation).\n- A brief summary of the merits of your approach, which includes the following two\nsections:\n- The benefits and shortcomings of your architectural approach to the divider (i.e,\nwhy is it good for attaining high speed, or low power operation?) Also, explain\nthe bottleneck in your architecture that prevents achievement of even higher input\nfrequencies.\n- A brief description of the function and performance tradeoffs for each circuit\nblock. (Example: first stage performs such and such operation, and was designed\nfor high speed by doing so and so. Power dissipation was minimized by doing so\nand so.)\n\n- A brief, qualitative summary of the impact of temperature variations on the divider\nperformance. Specifically, is the performance better or worse at low and high tem-\nperatures, and why? (Note that the quantitative impact of temperature variations on\ndivider speed is specified in the specification table described above.) In practice, one\nwould also need to account for variations in transistor performance (i.e., using slow\nand fast models) and for resistor variations (typically ± 20 %), but we will ignore these\nissues in this project for the sake of simplicity.\n- Conclusion\nConstraints\nThe following constraints must be met when stating results of your divider performance\n- The model file /mit/6.976/Models/0.18u/mos018.mod must be used when simulating\nNMOS and PMOS devices\n- Minimum length of all devices is 0.18 μm, and minimum width should be assumed\nto be 0.5 μm. (Note that the actual process would allow smaller widths, but these\nwouldn't be practical if wiring capacitance was included (i.e., the overall capacitance\nwould then be dominated by the wires). We are not considering wire capacitance in\nthis project, but we do want to be realistic in our consideration of its impact on sizing)\n- Source and drain junction capacitances must be included for all transistors by speci-\nfying the perimeter and areas of each source/drain junction. You should use hspc for\nthis as described on page 6 of the hspc manual (at\nhttp://www-mtl.mit.edu/research/perrottgroup/tools.html), where hdin = 0.4 μm, hd-\nout = 0.5μ m, and a four sided perimeter should not be assumed. You are free to make\nuse of fingers (as specified by the m and geo parameters) to reduce the impact of\njunction capacitance.\n- Capacitance associated with poly resistors (in SCL logic) must be included in the\nsimulation.\nThe overall capacitance of a given resistor, Cp, is calculated based on\nits area and perimeter values, which are set by its resistance value and the required\naverage current it must handle. Given the area and perimeter of the resistor, the overall\ncapacitance is then calculated using the area and perimeter capacitances of poly over\nfield (i.e., substrate).\nTo perform the above calculations, the relevant parameters for unsilicided P-doped\npoly (which will be assumed to be used for resistors in this project) are\n- Area capacitance from poly to field: 100 aF/μm2\n- Fringe capacitance from poly to field: 50 aF/μm2\n- Sheet resistance of poly: 150 Ohms/square\n- Electromigration rule for poly: ≤1 mA/μm (applies to average current)\n\n- Minimum poly width/length for resistors is 0.5 μm (to avoid dogbone layout of\nresistors when contacts are included)\nFinally, a distributed model should be assumed for the impact of the total resistor\ncapacitance, Cp, as shown in Figure 2.\nR/2\nR/2\nCp/2\nCp/4\nCp/4\nFigure 2: Modeling of distributed capacitance for resistor load.\n- The maximum supply voltage is 1.8 Volts.\n- The input to the divider is assumed to consist of two signal sources with 50 Ωsource\nresistances, Vin and Vin, which are 180 degrees out of phase from one another and have\nthe following properties\nVhigh = 1.8 V, Vlow = 0.9 V, risetime = 40 ps, falltime = 40 ps\nNote that 5 GHz versions of these signals can be achieved using the hspc program with\nthe following lines\n% timing 0n 40p 100p 0.9 1.8\n% input vin [set 1 0 R]\n% input vinb [set 0 1 R]\n- The output to the divider must drive a load capacitance of 100 fF and a register that\nclocks in the CON signal ( on either its rising of falling edge -- your choice) as shown\nin Figure 1.\n- You are allowed one ideal current source of any value that you choose (you must include\nits power dissipation when specifying the overall power dissipation of the divider). The\nsource may be hooked between any nodes of your choice so long as one of the nodes is\nVdd or ground.\n- Inductors can not be used in this project (in practice, they yield better performance\nat the cost of significant die area).\n\nGrading\nThe project will be graded as follows\n- Understanding (10 %) -- does your description of the architecture and circuits reveal\nthat you understand the basic principles of designing a divide-by-32/33 circuit? Why\ndid you choose the architecture, the type of logic style that was used in different parts of\nthe divider, and did you clearly state the bottlenecks to achieving better performance?\n- Originality (20 %) -- is your divider implemented in a unique way that offers some\nparticular advantage?\n- Performance (30 %) -- how fast does your divider operate (if speed was your goal)?\nHow much power does it consume (if low power was your goal)?\n- Practicality (10 %) -- Are there any issues that would prevent your design from being\neasily manufacturable?\n- Description (20 %) -- are the fundamental concepts of your design clearly explained?\nAre the advantages of using your approach clearly spelled out? Is your writeup concise\nand to the point?\n- Simulation (10 %) -- did you adequately verify the performance of your design?\nSuggested Design Procedure\nDetermine the achievable speed of a divide-by-2 configuration implemented with several\ndifferent logic styles. Try to understand why some logic styles perform better than others.\n(A good, brief description comparing a few logic styles you tried and explaining the reasons\nfor their performance differences will boost the grade you receive in the \"Understanding\"\ncategory.) Repeat this process for a divide-by-2/3 circuit.\nOnce you decide on logic styles for different parts of the divider, cascade the resulting\ndivide-by-2/3 with divide-by-2 sections and then design the control qualifying logic to achieve\nproper timing of the control signal to the divide-by-2/3 stage. Verify that the control quali-\nfying logic works properly by varying the divide value in a SPICE simulation and verifying\nthat pulse swallowing occurs at the proper time.\nNote that phase shifting techniques will achieve higher speed than gated approaches to\nthe divide-by-2/3 implementation, but are much more difficult to design. I would suggest\nstarting with a gated design, and then tackle phase shifting if you have the interest and time."
    },
    {
      "category": "Resource",
      "title": "proj2.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/6-976-high-speed-communication-circuits-and-systems-spring-2003/359d0ff7de5ad5b6cd7418d272d11d78_proj2.pdf",
      "content": "Massachusetts Institute of Technology\nDepartment of Electrical Engineering and Computer Science\n6.976\nHigh Speed Communication Circuits and Systems\nSpring 2003\nProject #2: GMSK Transceivers\nPassed Out: April 25, 2003\nDue: May 14, 2003\nCopyright c\n⃝2003 by Michael H. Perrott\nReading: Chapter 18 of Thomas H. Lee's book. Chapter 5 of Behzad Razavi's book.\nIntroduction\nThis project will explore issues associated with implementing a GMSK (Gaussian Minimum\nShift Keying) transmitter that is intended for use in GSM cell phones. This communication\nstandard encodes information using phase modulation of a constant envelope sine wave\nsignal. By constraining the transmitter output to have constant envelope, a nonlinear power\namplifier can be used that broadcasts the signal with high efficiency (usually around 50%\nefficiency, as compared to about 10% efficiency encountered with linear power amps).\nA proposed transmitter for this task is shown in Figure 1, which employs a PLL that\ncontains an I/Q modulator in its feedback loop. As you proceed through the project, you\nwill (hopefully) come to understand the value of placing the I/Q modulator in the PLL\nfeedback loop rather than directly using its output as the transmitter output, and develop\na good understanding of RF transceivers in general.\nFigure 2 displays the proposed receiver used to select and demodulate the desired GMSK\nRF signal, which is implemented using a direct conversion architecture. For simplicity, we\nwill ignore the many difficulties encountered with this structure, such as high sensitivity\nto DC offsets, antennae impedance variations, and local oscillator feedthrough. The noise\nsource in the figure represents the overall input-referred noise of the receiver (it is not, of\ncourse, purposefully added!).\nBackground\nTwo common phase/frequency modulation schemes are in use today -- GMSK and GFSK\nmodulation. GMSK modulation focuses on phase as the modulation variable, while GFSK\n(Gaussian Frequency Shift Keying) focuses on frequency. It turns out that GMSK is superior\nin terms of its spectral efficiency, but GFSK is easier to implement. As a result, GMSK is\ntypically used for cell phones (using the GSM standard), while GFSK is often employed in\n\nKv = 30 MHz/V\nfo = 900 MHz\nGaussian\nLPF\nData\nGenerator\nDigital I/Q Generation\nout(t)\nT\nT\nt\nTd\nt\nT\nLoop Filter\nReference\nFrequency\nvin(t)\nPFD\nN\nRF Transmit\nSpectrum\nf\nfRF\nTrans.\nNoise\nPower\nAmp\nKph\n1 - z-1\ncos(Φ)\nsin(Φ)\nD/A\nD/A\nΦ\nfinst\n90o\nI\nQ\nPeak-to-Peak\nFrequency\nDeviation\nTd\nt\nInstantaneous\nFrequency\nData Eye\nLimit\nAmp\n(100 MHz)\n=\n1 MHz\nIncludes\nZero-Order\nHold\nIcp\nH(s)\nFigure 1: A GMSK modulator implemented as an offset PLL.\nf\nf\nfRF\nfRF\nReceived\nSpectrum\nReceiver\nNoise\nf\nBaseband\nSpectrum\ncos(2πfRFt)\nIR\nQR\nNR\nReceiver\nNoise\nModulation\nSignal\nTransmitter\nNoise\nS(IR+jQR)\nTrans.\nNoise\nLNA\nBand\nSelect\nFilter\nChannel\nSelect\nFilter\nsin(2πfRFt)\nFigure 2: A direct conversion receiver for GMSK detection.\ncordless phones (using the DECT standard). Note that cordless phones can get by with much\nlower performance (and lower cost)than their cell phone counterparts for reasons discussed\nin class.\nBoth modulation methods use a Gaussian transmit filter to smooth the data signal, as\nillustrated in Figure 1, in order to reduce its spectral content. This filter is implemented\n\nin discrete-time with a sample period of T, and will be denoted as P[k]. If the input data\npattern consists of modulated, unit area impulses with symbol period (Td) spacing between\nthem, then the transmit filter is formulated as P[k] = P(Tk) such that\nP(t) = hT\n√\n2πσe-1\n2( t\nσ)\n∗rect(Td, t)\n(1)\nwhere '*' denotes convolution, and\nσ =\n.833Td\n(BTd)2π,\nrect(Td, t) =\n\n1/Td,\n-Td\n2 ≤t ≤Td\n0,\nelsewhere.\nIn the case where the data is \"square-wave\" in nature, as shown in Figure 1, then one\nsimply removes the rect function (and the associated convolution operation) in the above\nformulation (note that you will need to appropriately scale the response, as discussed later).\nIn either case, P[k] is parameterized by two characteristics:\n- BTd: ratio of bandwidth of P(ej2πfT) to data rate\n- h: modulation index, defined as:\nh = peak-to-peak frequency deviation\nbit rate\nFor the popular standards of GSM and DECT, we are required to have:\n- GSM: BTd = 0.3, h = 0.5\n- DECT: BTd = 0.5, h = 0.5 ± .05\nTherefore, both specify the modulation index to be h=0.5 -- for GSM, this value must be\nexactly maintained, while for DECT it can vary ±10% about that nominal value. However,\nGSM requires the BTd product to be much lower, which implies a much better spectral\nefficiency (i.e., required bandwidth for a given data rate).\nThe impact of the different BTd products for GSM and DECT can be viewed in the\ntime or frequency domains. Here we focus on the time domain, and use eye diagrams to\nconvey the key issues. Figure 3 illustrates ideal eye diagrams for the instantaneous frequency\nand phase signals corresponding to a GSM transmitter with BTd = 0.3. In this case, we\nare interested only in phase (since GMSK is used), and therefore the I/Q diagrams are of\nprimary interest. Note that the eye for instantaneous frequency is relatively poor compared\nto its I/Q counterpart -- extraction of the modulation information based on frequency would\ntherefore yield rather poor performance (which is further exacerbated by issues related to\nsynchronous vs asynchronous demodulation, a topic we will not touch on here).\nFigure 3 illustrates ideal eye diagrams corresponding to a DECT transmitter implement-\ning GFSK with BTd = 0.5. For GFSK, we are concerned with the instantaneous frequency\nrather than the I/Q components. Note that the eyes for instantaneous frequency (as well as\nits I/Q counterpart) are quite open compared to the GSM modulator. We therefore see that\nhigh vales of BTd lower the level of intersymbol interference at the cost of poorer spectral\n\n0.2\n0.4\n0.6\n0.8\n1.2\n1.4\n1.6\nx 10\n-6\n-8\n-6\n-4\n-2\nx 10\nFrequency (Hz)\ntime (Seconds)\nSimulated Eye Diagram of Instantaneous Frequency\nx 10\n-7\n-1\n-0.5\n0.5\nAmplitude\nTime (Seconds)\nSimulated Eye Diagram of I Component\nx 10\n-7\n-1\n-0.5\n0.5\nAmplitude\nTime (Seconds)\nSimulated Eye Diagram of Q Component\n(a)\n(b)\nFigure 3: Eye diagrams correponding to GMSK modulation with BTd = 0.3: (a) eye diagram\nof instantaneous frequency, (b) eye diagrams of I and Q components\nefficiency. A final issue is that one would observe the I/Q eye diagrams undergo catastrophic\ndegradation should the value of h vary even slightly from 0.5, while the instantaneous fre-\nquency eye diagram would simply change in amplitude while still remaining wide open. Since\nfrequency is the signal of interest in this case, GFSK systems allow such sloppiness in the\ncontrol of h, whereas GMSK system are intolerant of it.\n0.2\n0.4\n0.6\n0.8\n1.2\n1.4\n1.6\nx 10\n-6\n-8\n-6\n-4\n-2\nx 10\nFrequency (Hz)\ntime (Seconds)\nSimulated Eye Diagram of Instantaneous Frequency\nx 10\n-7\n-1\n-0.5\n0.5\nAmplitude\nTime (Seconds)\nSimulated Eye Diagram of I Component\nx 10\n-7\n-1\n-0.5\n0.5\nAmplitude\nTime (Seconds)\nSimulated Eye Diagram of Q Component\n(a)\n(b)\nFigure 4: Eye diagrams correponding to GFSK modulation with BTd = 0.5: (a) eye diagram\nof instantaneous frequency, (b) eye diagrams of I and Q components\nThe transmitter structure shown in Figure 1 achieves accurate phase modulation, and\ncan be used for either GMSK or GFSK systems. However, the ability of GFSK systems to\nendure sloppiness in their modulation index, h, allows for simpler transmitter structures. In\nfact, it is not uncommon for GFSK modulators to be implemented by directly modulating\n\na VCO.\nWhile the GMSK receiver shown in Figure 2 appears to be quite simple, it is quite chal-\nlenging to implement in practice. In comparison, Figure 5 illustrates a GFSK receiver based\non a phase-locked loop architecture. Here the receive VCO tracks the phase of the input\nsignal after it has been filtered and passed into a limit amplifier, and the resulting instanta-\nneous frequency signal is obtained by observing the input voltage to the VCO. Though this\ndesign may appear to be more complex than its GMSK counterpart, it is easier to implement\nin practice.\nDemodulated\nData Signal\nChannel\nFilter\nChannel\nFilter 2\nsin(2π(fc-fif)t)\nsin(2π(fift+Fout(t)))\nNR\nFout(t)\nLoop\nFilter\nLimiter\nPhase\nDet.\nFigure 5: A GFSK receiver based on a PLL frequency descriminator.\nTasks\nWe now turn our attention entirely to GMSK, and focus first on the design of the transmitter\nstructure shown in Figure 1. We will do so in steps, examining first the I/Q generation, then\nthe PLL design, and then simulation of the overall system. We will then turn our attention\non the receiver, particularly with respect to its simulation. In all cases, you should assume\nthe following:\n- Modulation data rate (1/Td) = 1 Mbit/s\n- Reference clock rate (1/T) = 100 MHz\n- Center frequency of RF output spectrum fRF = 900 MHz\n- Tristate PFD is used for the PLL,\n- VCO has no parastic poles, so that its small signal voltage-to-phase model is simply\n2πKv/s,\n- VCO noise (output referred) has a slope of -20 dB/dec over the frequency range of\ninterest, with a value of -140 dBc/Hz at 10 MHz offset\n- Simulation sample rate = 9 GHz.\nNote that, in practice, the GSM standard actually has a data rate of roughly 270 kbit/s --\nwe are striving to increase it by a factor of 4.\n\n1. In this task we will implement the I/Q generator block shown in Figure 6 using the\nCppSim simulator. The following subsections will guide you through this process.\nGaussian\nLPF\nData\nGenerator\nDigital I/Q Generation\nT\nT\nt\nTd\nt\nT\nReference\nFrequency\nKph\n1 - z-1\ncos(Φ)\nsin(Φ)\nD/A\nD/A\nΦ\nfinst\nPeak-to-Peak\nFrequency\nDeviation\nTd\nt\nInstantaneous\nFrequency\nData Eye\n(100 MHz)\n=\n1 MHz\nIncludes\nZero-Order\nHold\nFigure 6: digital I/Q generator.\n(a) Implement the data generator and Gaussian transmit filter in CppSim, and plot\nthe resulting eye diagrams produced by a data sequence consisting of 30 symbols.\ni. Use Matlab to compute the filter tap coefficients of the Gaussian transmit\nfilter over 5 symbol periods. Assume the sampling period of the tap coeffi-\ncients corresponds to that of the reference frequency, and that the input data\nsequence will be \"square\" wave in nature (i.e., don't convolve with the rect-\nangle function, but you do need to figure out the appropriate scaling factor\nbased on the reference frequency and symbol rate value. To do so, recall that\nthe peak-to-peak frequency deviation that occurs after passing the prbs data\nsequence into the Gaussian filter must match that specified by h and Td. As-\nsume that the prbs data sequence alternates between 1 and -1 and is sampled\naccording to the reference frequency). Plot the filter impulse response over 5\nsymbol periods using the stem command in Matlab.\nii. Create the prbs data source module in CppSim using the Rand class (\"bernoulli\"\nbehavior). To do so, you will need to clock the Rand object according to an\ninput clock (which will be fed by the reference frequency) such that it updates\nits output value at the correct data rate. Note: see the next part to see how\nto \"clock\" objects. Plot the output of the module and its eye diagram over 30\nsymbols (you can use the vco module to create the 100 MHz reference clock).\nNote that the output should alternate between 1 and -1.\niii. Create the Gaussian transmit filter module in CppSim. To do so, save the\n\nfilter coefficients computed in Matlab to a file (make sure that you save in\nASCII format, and that the coefficients are in \"vertical\" format in the file\n(i.e., one coefficient per line)). To give you an idea of how to realize the\nmodule code in modules.par, consider the following example:\nmodule: sqrt raised cos filter\nparameters:\ninputs: double in, double clk\noutputs: double out\nclasses: Filter filt(\"1\",\"1\"), List list1(), EdgeDetect clkedge()\nstatic variables:\ninit:\nlist1.load(\"rcosflt.dat\");\nfilt.set(list1,\"1\");\ncode:\nif (clkedge.inp(clk))\n{\nfilt.inp(in);\nout = filt.out;\n}\nPlot the output of the cascaded data source and Guassian filter, and its eye\ndiagram, over 30 symbols. Label the peak-to-peak frequency deviation and\nsymbol period in the eye diagram.\n(b) Implement the remaining I/Q generator blocks, simulate its output over 30 sym-\nbols, and then create an overall symbol for it.\ni. Compute the value of Kph in the frequency-to-phase converter block. To do\nso, assume that the sample period corresponds to the reference frequency,\n1/T, and recall that z corresponds to ejwT and phase is related to frequency\nby the equation\nΦ(t) = 2π\nt\n0 finst(τ)dτ\nii. Implement the frequency-to-phase converter block and the cosine and sine\nconverter functions in CppSim (combine the cosine and sine converters in one\nmodule). Again assume that all blocks are clocked by the reference frequency,\nand be sure to use the Filter class to implement the accumulator function for\nthe frequency-to-phase converter block. Plot the I and Q signals, along with\ntheir eye diagrams, over 30 symbols.\niii. You have now completed the digital portion of the I/Q generator, so place\neach of your blocks (though not the reference frequency source) into a schematic\ncalled dig iq generator that has a clock input and I/Q outputs. For the ex-\nercises that follow, note that the D/A converters do not need to be added in\nCppSim since our digital blocks are implemented in analog fashion, and the\nzero-order hold function is implemented intrinsicly.\n(c) Now put RC lowpass filters at the outputs of the I and Q outputs of the I/Q\nGenerator (note that these will *not* be clocked by the reference). Set the cutoff\n\nfrequency of the filters first to 500 kHz and then to 10 MHz, and plot the resulting\nI/Q diagrams at the filter outputs for each case. Why does the 500 kHz version\nlook distorted? Assume that the cutofffrequency will be 10 MHz for the following\ntask sections.\n2. We will now focus on modeling and design of the PLL portion of the transmitter shown\nin Figure 7. You will need to use the PLL Design Assistant program, as used in HW6,\nto complete the design exercises.\nKv = 30 MHz/V\nfo = 900 MHz\nout(t)\nT\nLoop Filter\nReference\nFrequency\nvin(t)\nPFD\nN\nRF Transmit\nSpectrum\nf\nfRF\nTrans.\nNoise\nPower\nAmp\n90o\nI\nQ\nLimit\nAmp\n(100 MHz)\nIcp\nH(s)\ncos(Φ)\nsin(Φ)\nFigure 7: PLL portion of the GMSK transmitter.\n(a) Model the relationship between the phase signal, Φ(t), the phase of the VCO\noutput, Φout(t), and the output phase of the I/Q modulator block, Φout2(t), as\nlabeled in Figure 8. Do this in two steps. First, express the VCO output as a sine\nwave, and compute the resulting I/Q modulator output in terms of a sine wave.\nBased on this result, draw a block diagram of the relationship between the phase\nsignals.\nout(t)\n90o\nI\nQ\ncos(Φ)\nsin(Φ)\nout2(t)\nFigure 8: Analog I/Q modulator block.\n\n(b) Based on your block diagram in the previous part, draw the linearized, frequency-\ndomain block diagram model of the PLL system shown in Figure 7. Provide an\nexpression for the open loop gain function, A(s). For parts to follow, we will\ndefine the closed loop function G(f) to be\nG(f) =\nA(f)\n1 + A(f)\n(c) Compute the transfer function from the phase signal, Φ(t), to the VCO output\nphase, Φout(t) in terms of G(f). We will refer to this function as B(s) in the parts\nto follow.\ni. Is B(s) lowpass, bandpass, or highpass?\nii. If we instead look at the sine wave signals associated with out(t), etc., rather\nthan their respective phases, is the filtering action performed by the PLL\nlowpass, bandpass, or highpass? What are the advantages of using the PLL\nto implement the filter over simply using a passive filter?\n(d) Given your answer in the previous part, do you see any advantage of incorporating\nthe I/Q modulator in the feedback loop of the PLL rather than simply using the\nI/Q modulator as the transmitter (i.e., with a PLL only being used to provide a\nstatic local oscillator signal)? Consider noise, as well as mixer nonidealities such\nas LO feedthrough, in formulating your answer.\n(e) Design the PLL such that the B(s) transfer function corresponds to a second\norder Butterworth filter response with a bandwidth of 2 MHz. Assume a type I\nimplementation for the PLL, a charge pump current of 100 μA, and a Kv value\nof 30 MHz/V. In particular, compute the divide value, N, the loop filter transfer\nfunction, H(s), and the PFD gain factor, α.\n(f) Repeat the previous design exercise for the case where B(s) corresponds to a\nsecond order Butterworth filter response with a bandwidth of 4 MHz that is\ncascaded with two real-valued parasitic poles placed at 12 and 17 MHz.\n(g) Calculate the input-referred voltage noise to the VCO that yields to its phase\nnoise conforming to the specifications given at the beginning of the Tasks section\n(i.e., -140 dBc/Hz at 10 MHz offset).\n3. We will now implement the PLL circuit in CppSim and combine it with the I/Q\ngenerator module. This task should be fairly straightforward given your experience in\nHomework 6, but there are a few hurdles to overcome that we will step you through.\n(a) Implement the I/Q modulator shown in Figure 8 in CppSim by creating ideal\nmixer blocks and the limit amp module, and then combining those modules with\nthe adder module in a schematic/symbol called phase shifter. Assume that the\nI/Q modulator has two inputs corresonding to the VCO output and its quadrature\ncomponent (i.e., don't implement the 90 degree phase shifter).\n\ni. When creating the limit amp module, you must understand that the output of\nthe I/Q modulator is essentially a sine wave, but that the input to the divider\nassumes a square-wave with interpolated edges as discussed in the paper\nlocated at /mit/6.976/CppSim/Doc/paper.pdf. The following is suggested\ncode to implement the limit amp -- explain what the code is doing.\nmodule: phase shifter limit amp\nparameters:\ninputs: double in\noutputs: double out\nclasses:\nstatic variables: double prev in, int state\ninit:\nstate = -2;\nprev in = 0.0;\nout = -1.0;\ncode:\nif (state == -2 && in >= 0.0) /∗positive transition ∗/\n{\nout = (in+prev in)/(in-prev in);\nstate = 1;\n}\nelse if (state == 1)\n{\nout = 1.0;\nstate = 2;\n}\nelse if (state == 2 && in < 0.0) /∗negative transition ∗/\n{\nout = -(in+prev in)/(in-prev in);\nstate = -1;\n}\nelse if (state == -1)\n{\nout = -1.0;\nstate = -2;\n}\nprev in = in;\n(b) Implement the VCO by modifying the vco module already included in the Cpp-\nModules library such that it now has quadrature sine wave outputs (i.e., cosine\nand sine functions of the VCO phase). These outputs will connect up to the\ninputs of the I/Q modulator just implemented.\n(c) Now implement the overall PLL in CppSim, and choose the various parameters so\nthat the dynamics conform to those calculated in Task 2, part (e) (do not include\nnoise sources).\nInclude the I/Q generator from Task 1, and name the overall\nschematic pll transmitter. Simulate the overall system over 30 symbols and plot\nthe voltage at the input to the VCO and its eye diagram (you may want to cut\nout the initial transient when plotting the eye diagram). Relate this signal to the\n\ninstantaneous frequency waveform that you should expect to see. Troubleshoot\nyour simulation if it does not agree with what you expect to see.\n(d) In Cadence, copy pll transmitter to a new schematic called pll transmitter2. Ad-\njust the parameters in pll transmitter2 so that its dynamics conform to those\ncalculated in Task 2, part (f). As in the previous part, simulate the overall sys-\ntem over 30 symbols and plot the voltage at the input to the VCO and its eye\ndiagram. Do you see any change in performance in the eye diagram (i.e., is it\nbetter or worse?)? Why did it change?\n(e) Plot the output spectrum of the pll transmitter module using the comp psd Mat-\nlab script as done in Homework 6 (note that you may need to adjust some things\nin the script to match the given system). You will want to dramatically increase\nthe number of symbols to achieve a nice plot. Also, you will need to take advan-\ntage of CppSim's ability to decimate signals before they are saved in the output\nfile in order to simulate over a long enough time span -- see the description of\nthe \"output:\" command on pages 32-33 of the CppSim manual.\n(f) Add VCO noise according to your calculations in Task 2, part (g), and then\nplot the resulting output spectrum as done in the previous part. Compare the\nspectrum before and after adding VCO noise -- do the results make sense? Note\nthat, in practice, there would also be detector noise in the PLL and quantization\nnoise from the D/A. We have ignored such sources in the current assignment for\nthe sake of simplicity, but they would be fairly straightforward to add to the\nsimulation.\n4. We now examine the receiver, and will implement a simplified version of it shown in\nFigure 9 in the CppSim framework.\nf\nf\nfRF\nfRF\nReceived\nSpectrum\nReceiver\nNoise\nf\nBaseband\nSpectrum\ncos(2πfRFt)\nIR\nQR\nNR\nReceiver\nNoise\nModulation\nSignal\nTransmitter\nNoise\nS(IR+jQR)\nTrans.\nNoise\nChannel\nSelect\nFilter\nsin(2πfRFt)\npll_transmitter\noutput\nSNR\nFigure 9: Simplified GMSK receiver to be implemented in CppSim.\n(a) Implement the receiver shown in Figure 9. Assume that the noise source has zero\nvariance (for now), and that each channel select filter is simply a pair of cascaded\nfirst order filters with a cutofffrequency of 5 MHz (DC gain of 1). Create an\noverall Cadence symbol for the receiver called simple iq receiver that has 3 inputs\n\n(to receive transmitter output and the quadrature sine waves at frequency fRF)\nand two outputs (the baseband I/Q signals).\n(b) Now create a schematic that combines the pll transmitter and simple iq receiver\nblocks and also supplies the required LO frequency to the receiver. We will assume\nan ideal channel, so simply connect the transmitter output to the receiver input.\nTo create the quadrature LO signal, use the VCO block you created in Task 3 that\nproduces quadrature sine waves. Simulate the system over 30 symbol periods and\nplot the resulting I/Q signals at the receiver output along with their eye diagrams.\nNote that you may need to adjust the phase of the LO signal to the receiver in\norder to get your eye diagrams to look right -- explain why that is the case (hint:\nthink about the I/Q signals in terms of constellation points).\n(c) Compute the value of the receiver noise variance that will yield an SNR of 10 dB\nat the I/Q outputs of the receiver (assume that the noise is added as shown in\nFigure 9). Here we define SNR as the ratio of the spectral density of the received\nsignal to the spectral density of the noise at low frequencies, as shown in the\nfigure. Simulate the overall system with the included noise and plot the resulting\nI/Q eye diagrams.\n(d) Given the added noise of the receiver, what are the tradeoffs between having a\nlarge versus small bandwidth for the receiver channel select filter?\n5. We have so far assumed that we only want to modulate in a channel that is centered at\n900 MHz. Suppose that you wanted to use the same RF transmit architecture (with a\nconstant reference freqeuncy of 100 MHz), but wanted to be able to change the center\nfrequency in 1 MHz steps. Explain how you would modify the transmitter architecture\nto accomplish this task, and prove it by simulating your modified structure in CppSim\nwith fRF = 901 MHz."
    }
  ]
}