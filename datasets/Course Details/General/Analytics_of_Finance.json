{
  "course_name": "Analytics of Finance",
  "course_description": "This course covers the key quantitative methods of finance: financial econometrics and statistical inference for financial applications; dynamic optimization; Monte Carlo simulation; stochastic (Itô) calculus. These techniques, along with their computer implementation, are covered in depth. Application areas include portfolio management, risk management, derivatives, and proprietary trading.",
  "topics": [
    "Business",
    "Finance",
    "Mathematics",
    "Probability and Statistics",
    "Social Science",
    "Economics",
    "Econometrics",
    "Financial Economics",
    "Business",
    "Finance",
    "Mathematics",
    "Probability and Statistics",
    "Social Science",
    "Economics",
    "Econometrics",
    "Financial Economics"
  ],
  "syllabus_content": "Course Meeting Times\n\nLectures: 2 sessions / week, 1.5 hours / session\n\nRecitations: 1 session / week, 1.5 hours / session\n\nCourse Description\n\nThis course covers the main quantitative methods of finance. The course covers three broad sets of topics: derivative pricing using stochastic calculus, dynamic optimization, and financial econometrics. The emphasis is on rigorous and in-depth development of the key techniques and their application to practical problems.\n\nPrerequisites\n\n15.401 Finance Theory I\nis a prerequisite for this course.\n15.437 Options and Futures Markets\nis a recommended co-requisite.\n\nRudimentary programming skills are necessary. Homework assignments involve computer implementation of quantitative methods in MATLAB(r). Prior knowledge of MATLAB(r) is not required. In addition to formal prerequisites, the course assumes solid undergraduate-level background in calculus, probability, and statistics.\n\nGrading\n\nACTIVITIES\n\nPERCENTAGES\n\nGroup problem sets (6 total)\n\n50%\n\nFinal exam\n\n50%\n\nCourse Textbooks\n\n[Back]= Back, Kerry.\nA Course in Derivative Securities:\n\nIntroduction to Theory and Computation\n. New York, NY: Springer, 2005. ISBN: 9783540253730.\n\n[CL&M]= Campbell, John Y., Andrew W. Lo, and A. Craig MacKinlay.\nThe Econometrics of Financial Markets\n. Princeton, NJ: Princeton University Press, 1996. ISBN: 9780691043012.\n\n[Cochrane]= Cochrane, John H.\nAsset Pricing\n. Revised ed. Princeton, NJ: Princeton University Press, 2005. ISBN: 9780691121376.\n\n[D&S]= DeGroot, Morris, and Mark J. Schervish.\nProbability and Statistics\n. 3rd ed. Reading, MA: Addison-Wesley, 2002. ISBN: 9780201524888.\n\n[Tsay]= Tsay, Ruey S.\nAnalysis of Financial Time Series\n. 2nd ed. New York, NY: John Wiley & Sons, 2005. ISBN: 978047169074.\n\nThe lectures will include suggestions for additional readings for each topic. Since there is no single textbook covering all the relevant topics, several books will be used. [Back] covers topics in stochastic calculus and derivative pricing. [Tsay] covers time-series methods in financial econometrics, and is the most frequently used textbook. [Cochrane] and [CL&M] cover advanced topics in financial econometrics. [D&S] covers basic background in probability and statistics and can be used for review as necessary.\n\nList of Topics\n\nThe class will cover the following core topics:\n\nAbsence of arbitrage and risk-neutral pricing;\n\nIto stochastic calculus, Black-Scholes model and extensions, interest rate models;\n\nDynamic programming, asset allocation, Merton's solution, numerical methods for dynamic portfolio choice;\n\nMonte Carlo simulation for derivative pricing;\n\nMaximum likelihood and quasi-maximum likelihood estimation;\n\nGeneralized method of moments (GMM) basics, regression as GMM, standard errors, delta-method;\n\nSmall-sample inference, bootstrap;\n\nVolatility models, GARCH.\n\nAdvanced topics include:\n\nDerivative pricing and dynamic portfolio choice;\n\nExtensions of GARCH, MIDAS models, multivariate volatility models;\n\nExploiting return predictability.\n\nCalendar\n\nWEEK #\n\nKEY DATES\n\nProblem set 1 due\n\nProblem set 2 due\n\nProblem set 3 due\n\nProblem set 4 due\n\nProblem set 5 due\n\nProblem set 6 due",
  "files": [
    {
      "category": "Resource",
      "title": "MIT15_450F10_assn01.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/b6c47f2537652157a768d7f0640f243e_MIT15_450F10_assn01.pdf",
      "content": "M.I.T.\n15.450-Fall 2010\nSloan School of Management\nProfessor Leonid Kogan\nProblem Set 1\n1. (To be solved individually) Consider a one-period model of the market. Assume there\nare three possible states at time t = 1: 0, 1, and 2, all equally likely. There are two\nassets traded in this market: the stock and the risk-free bond. Assume that at time\nt = 1 the bond pays $1 in each state, and stock pays $0, $1, and $2 in states 0, 1, and\n2 respectively. The time-0 price of the stock is $0.8, and the initial price of the bond\nis $0.9. When dealing with the state-price densities, always normalize them to be 1 at\ntime 0.\n(a) Show that the above model is free from arbitrage. (Hint: demonstrate that there\nexists at least one state-price density in this model).\n(b) How many state-price densities exist in this model? Characterize all of them.\n(c) Suppose that an option is introduced into the above market, which pays max(S1 -\n1, 0) at time 1. Using payoff dominance arguments, show that the time-0 price\nof the option is bounded from below by $0, and from above by $0.4. (Hint: try\nto bound the payoff of the option by the payoff of a portfolio including the stock\nand the bond).\n(d) Compute the time-0 price of the option under each of the state-price densities\nyou have derived in item (1b). What is the lowest and the highest possible price\nof the option consistent with absence of arbitrage? Compare with the answer in\nitem (1c).\n(e) Suppose that the option in item (1c) trades at $0.2 at time 0. Show that the SPD\nis unique and derive it.\n(f) Continuing with the assumptions in the item (1e), suppose that there is one more\noption available for trading, paying max(S1 - 0.5, 0) at time 1. Compute the\ntime-0 price of this option. Argue why there is a unique price consistent with no\narbitrage.\n(g) Replicate the payoff of the option paying max(S1 - 0.5, 0) at time 1 using a\nportfolio of the stock, the bond, and the option paying max(S1 - 1, 0) at time 1.\n2. (To be solved in a group) Consider an extension of the Black-Scholes model. Assume\nthat the gross return on the stock between t = 0 and t = 1 is given by\nRT = exp (μ + σε1 - νξ1) ,\n\nwhere ε1 and ξ1 are independent. Assume that ε1 ∼N (0, 1), while ξ1 is exponentially\ndistributed: for any a, Prob(ξ1 > a) = exp(-a). Assume that ν > 0. Assume that the\ngross return on the risk-free bond between 0 and 1 is given by exp(r).\nThe above model adds a single negative jump to the Black-Scholes setting. ν parame\nterizes the distribution of the jump.\nAssume the following parameter values:\nr = 0.05, σ = 0.2, ν = 0.05.\nAssume that under the risk-neutral probability, the jump remains exponentially dis\ntributed: the risk-neutral distribution of ξ1 is the same as physical, while the risk-\nneutral jump distribution parameter is νQ = 0.2. Moreover, assume that the risk-\nneutral distribution of ε1 is normal with variance 1 and mean -η, η = 0.25.\n(a) Compute μ (Hint: you may want to look up the moment-generating function for\nan exponential random variable).\n(b) Assume that the initial stock price is S0 = 1. Consider European put options\nmaturing at T = 1 with strike prices K = 0.5, 0.6, ..., 1, ..., 1.5. Compute the\nBlack-Scholes implied volatilities for these put options and plot them as a func\ntion of the strike price. (Hint: Conditional on ξ1, stock return distribution is\nlognormal, like in the Black-Scholes model). Compute the absolute value of the\nSharpe ratio of returns on each put option. Repeat this exercise for νQ = 0.05.\nComment on the differences in results.\n3. (To be solved individually) Consider a zero-coupon corporate bond maturing at time\nt = 1, with the face value of $1. Assume that the state of the firm is captured by\nthe random variable X1. The bond defaults if X1 ≤ A, in which case it pays nothing.\nAssume that X1 ∼N (0, 1). Let the state-price density be given by\nπ1 = exp -rf - η2/2 - ηY1 ,\nπ0 = 1\nwhere Yp\n1 ∼N (0, 1). Assume that corr(X1, Y1) = ρ. (Hint: Y1 can be written as\nρ X1 +\n(1 - ρ2) Z1 where X1 and Z1 are independent).\nYou are supposed to perform the following analysis analytically. To help your intuition,\nyou may want to perform numerical calculations first by assuming specific parameter\nvalues.\n(a) Derive the default probability pdef .\n(b) Derive the price of the bond at time t = 0. (Hint: It is simpler to perform\ncalculations under the risk-neutral probability measure).\n(c) Derive the bond yield and the Sharpe ratio of bond returns. Relate both to ρ, η,\npdef , and comment on the relationship.\n\n(d) This question is relatively open-ended. A qualitative answer would be acceptable.\nHow would you build a model of corporate bond prices, so that bond yields\nchange significantly over time (e.g., widen in times of economic distress), while\nthe likelihood of default changes much less?\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\n\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_assn02.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/03fd39b380d3fffe6a809a75367a90e1_MIT15_450F10_assn02.pdf",
      "content": "M.I.T.\n15.450-Fall 2010\nSloan School of Management\nProfessor Leonid Kogan\nProblem Set 2\n1. (To be solved in a group) This problem illustrates how to extend a static model like\nCAPM to a dynamic setting, allowing us to price risky streams of cash flows.\nTime is discrete, t = 0, 1, 2, .... Consider a project with free cash flows Ct following an\nAR(1) process:\n\nCt - C = θ(Ct-1 - C) + σεt,\nθ ∈ (0, 1)\n(1)\nwhere εt are IID, N (0, 1) shocks. Assume that the project generates an infinite stream\nof free cash flows according to the above distribution.\nNext, suppose that the state-price density in the economy is given by\nπt = πt-1 exp (-a - b(rt\nm - rm)) ,\na, b > 0\nm\nm\nwhere rt are market returns, distributed identically over time, rt ∼N (rm, (σm)2).\nAssume that the correlation between εt and rt\nm is constant and equal to ρ > 0.\n(a) Derive the one-period risk-free interest rate in this economy.\n(b) Derive the T -period interest rate in this economy.\n(c) Consider a stock in this economy, with IID returns rj ∼N (μj , (σj )2), corr(rj , rm) =\nt\nt\nt\nρjm. Derive the expected excess return on this stock, discuss how your answer de\npends on the parameters. Relate your finding to the CAPM formula for expected\nreturns, in particular, relate the expected return of stock j to its market beta.\n(d) Derive the process for free cash flows Ct in (1) under the risk-neutral probability\ndistribution corresponding to the SPD πt. Show that it is still and AR(1) process,\nbut with different parameters. (Hint: compare this problem to our analysis of\nfutures prices).\n(e) Compute the market value of the project. If this project was tradable, what would\nbe the conditional expected return on this project? Discuss the role of parameter\nθ: how does the risk of the project depend on persistence of cash flows?\n(f) This question is qualitative. What would be the naive definition of cash flow beta\nof the project in (1)? Relate the cash flow beta to your answer in item (1e) and\ndiscuss the potential problems with the naive application of CAPM to pricing\nrisky cash flows.\n\np\n2. (To be solved individually) Consider the process Xt satisfying an SDE\ndXt = -θ(Xt - X) dt + σXγ dZt\nt\nUsing the Ito's formula, derive an SDE on\n(a) Yt = 1/(1 + Xt);\n(b) Yt = exp(Xt);\n(c) Yt = ln(Xt).\n3. (To be solved individually) Solve the SDE\ndXt = -θ(Xt - X) dt + σ dZt\nCompute conditional mean and variance\nEt[Xt+s] and Vart[Xt+s]\n4. (To be solved in a group) Consider a square-root process\ndXt = -θ(Xt - X) dt + σ\nXt dZt\nYour objective is to compute the conditional expectation\nEt[XT |Xt],\nT > t\n(a) Assume that the conditional expectation can be expressed as a function\nEt[XT |Xt] = f(t, Xt)\nCharacterize f(t, X) as a solution of a PDE with appropriate boundary conditions.\n(b) Find the solution, assuming the functional form\nf(t, X) = a0(t) + a1(t)X\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\n\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_assn03.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/f3ec782f9ab98938e3a78d4705b12896_MIT15_450F10_assn03.pdf",
      "content": "M.I.T.\n15.450-Fall 2010\nSloan School of Management\nProfessor Leonid Kogan\nProblem Set 3\n1. (To be solved in a group) Consider the Black-Scholes model for stock returns, with\nconstant interest rate r and constant drift and diffusion of stock returns, μ and σ.\nYour objective is to price and replicate an exotic European option with the payoff\nequal to the square of the terminal stock price, (ST )2 .\n(a) Describe the price of the option, f(t, St), as a solution of a PDE with appropriate\nboundary conditions.\n(b) Solve the PDE in item (1a) to obtain the option price. Use a guess for the solution\nf(t, St) = a(t)(St)2 .\n(c) Show how to replicate the payoff of the option by trading in the stock and the\nbond.\n(d) Using the risk-neutral pricing approach, express the option price as an expecta\ntion.\n(e) Compute the option price using the risk-neutral valuation formula and show that\nyou obtain the same expression for the price as in item (1b).\n(f) Compute the instantaneous Sharpe ratio of returns on the option, defined as\nexpected return - risk-free rate\n|return volatility|\nShow that this is the same as the Sharpe ratio of stock returns. Explain why this\nresult is intuitive.\n(g) Explain why in the Black-Scholes model all options must exhibit the same instan\ntaneous Sharpe ratio of returns (up to the sign).\n2. (To be solved individually) This problem illustrates that the strike price of the variance\nswap can be derived from prices of European options without explicitly specifying the\nstock return volatility process. It's a model-free approach to variance swap pricing.\nConsider a model of stock return with stochastic volatility\ndSt = μt dt + σt dZt\nSt\n\nwhere μt and σt are Ito processes. Assume that the interest rate is constant, r. A\ntime-0 variance swap delivers a time-T payment of\nZ T\n\n(d ln St)2 - K0\n(a) Using Ito's lemma, show that under the risk-neutral probability measure Q the\nlog of the stock price satisfies\nσ2\nt\nd ln St = r -\ndt + σt dZQ\nt\n(b) Show that under the risk-neutral probability measure\nZ T\n\nE Q\n[ln ST - ln S0 - rT ] = - E\nQ\nσ2\nt dt\nand derive the time-0 strike price of a variance swap, K0, using a risk-neutral\nexpectation of ln ST .\n3. (To be solved individually) Consider the Black-Scholes model with stock return param\neters μ and σ and interest rate r. You need to analyze a digital option which matures\nat time T and pays $1 if ST > K and nothing otherwise. Strike price K > 0.\n(a) Express the price of the digital option using the risk-neutral pricing approach.\nYou do not need to compute the expectation at this point.\n(b) Characterize the option price as a solution of a PDE. Write down the boundary\nconditions.\n(c) Suppose the function P (t, St) is the option price. Describe the replicating portfolio\nfor this option using derivatives of function P .\n(d) Compute the expected instantaneous excess return on the digital option as a\nfunction of time and the stock price. You should express the answer in terms of\nderivatives of P without computing P .\n(e) Derive the analytical formula for P (t, St).\n4. (To be solved in a group) Consider an interest rate model. The short-term interest\nrate follows the following process under the risk-neutral probability measure Q:\ndrt = -θ(rt - r) dt + σ√rt dZQ\nt\n(a) Derive the PDE on the price of a zero-coupon bond maturing at time T . Specify\nthe terminal condition on the bond price at time T .\n(b) Show that the bond price can be expressed in the form P (t) = exp(a(t) + b(t)rt).\n\n(c) Compute the instantaneous volatility of bond returns as a function of t and rt.\n(d) Taking the bond price above as given, assume that the price of risk associated\nwith the Brownian motion Zt\nQ is constant, η. Derive the expected excess return\non the bond as a function of the interest rate and time.\n(e) Under the above assumptions, derive the process for the interest rate under the\nphysical probability measure P.\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\n\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_assn04.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/184b8d8f29d03dc8eacd869c0797e0db_MIT15_450F10_assn04.pdf",
      "content": "M.I.T.\n15.450-Spring 2010\nSloan School of Management\nProfessor Leonid Kogan\nProblem Set 4\n1. (To be solved in a group) Consider the Black-Scholes model with stock returns following\ndSt = μ dt + σ dZt\nSt\nAssume that the interest rate is r and the stock pays no dividends. Consider an Asian\ncall option on the stock paying\nmax(0, ST - K)\nat time T , where\nJ\n1 X\nST =\nS(tj )\nJ j=1\nT\ntj = j J\nAssume μ = 0.1, σ = 0.3, r = 0.05, S0 = 100, T = 1, J = 252.\n(a) Show that, conditionally on ln S(tj-1), ln S(tj ) is normally distributed under Q.\n(b) Using 10,000 simulated paths of the stock price under Q, estimate the price of the\nAsian call option with strike prices K = 80, 100, 120. Derive the 95% confidence\nintervals around your price estimates.\n(c) Use antithetic variates to reduce the variance of your estimates. Use 5,000 paths\nto have a fair comparison with the direct Monte Carlo approach. To use antithetic\nvariates, for each path reverse the sign of each normal random variable used to\ngenerate it. Derive the 95% confidence intervals around your price estimates and\ncompare them to the intervals obtained without variance reduction.\n(d) Use the control variates to reduce the variance of your estimates. In particular, for\nan Asian call option with strike K, use the discounted payoff of a European call\noption with the same strike price as the control variate. Use 500 simulated stock\nprice paths to estimate the loading on the control variate, bb?, and 9,500 paths\nto estimate the option price for K = 80, 100, 120. Derive the 95% confidence\nintervals around your price estimates and compare them to the intervals obtained\nwithout variance reduction.\n\nX\n2. (To be solved in a group) Consider a firm with assets valued at At. Firm's total asset\nvalue evolves according to\ndAt = μ dt + σ dZt\nAt\nThe firm has multiple bonds outstanding maturing at various points in time. Assume\nthat the firm will default on all of its debt obligations as soon as the total asset value\nAt falls below A.\n(a) Using Monte Carlo simulation, estimate the default probability pτ for bonds ma\nturing at date τ. You need to decide how many simulations to use to achieve\nreasonable accuracy. Justify your choice.\nPlot pτ as a function of τ for τ = 1, 2, ..., 10. Also, compute the term structure of\nforward hazard rates, λt, defined by\nt-1\n1 - pt = exp(-\nλs)\ns=0\nPlot the term structure of forward hazard rates.\nUse the following parameter values:\nA0 = 1, A = 0.4, μ = 0.1, σ = 0.3\n(b) Using control variates, improve the accuracy of your estimation. (Hint: for any\nt, you can compute the probability of At ≤ A) analytically).\n(c) Repeat the exercise in item (2a) for A = 0.1 and A = 0.85. Comment on your\nresults: what conclusions can you draw from this exercise about the term structure\nof default risk of corporate bonds?\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_assn05.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/fee95f7e440c67cbc802c6b4e5e1fcb5_MIT15_450F10_assn05.pdf",
      "content": "M.I.T.\n15.450-Spring 2010\nSloan School of Management\nProfessor Leonid Kogan\nProblem Set 5\n1. (To be solved individually)\nConsider a commodity with the price process Pt following\nPt - P = ρ(Pt-1 - P ) + εt,\nt = 1, 2, ..., T,\n|ρ| < 1\nwhere εt are IID N (0, σε\n2) shocks.\nYou can trade in the risk-free asset with constant interest rate rf and in a futures\ncontract with futures price Φt following\nΦt - Φ = κ(Φt-1 - Φ) + ut,\n|κ| < 1\nwhere ut are IID N (0, σ2) shocks, and corr(εt, ut) = γ. You start with initial capital\nu\nequal to P0 and your objective is to hedge, as close as possible, the terminal value of\nthe commodity price using the futures contract, i.e., you want to minimize\nE0 (PT - WT )2\n(a) Set up this problem as a DP. Be explicit about the dynamic budget constraint on\nyour portfolio and the state space.\n(b) Write down the Bellman equation.\n(c) Compute the value function for t = T - 1 and t = T - 2.\n2. (To be solved in a group) Consider a futures contract with price process under risk-\nneutral probability\nln Pt - ln P = ρ(ln Pt-1 - ln P ) + εt,\nt = 1, 2, ..., T,\n|ρ| < 1\nwhere εt are IID N (0, σ2) shocks under Q. Assume that the interest rate is constant,\nequal to rf . Consider an American option on this futures contract, which can be\nexercised at any time period with the payoff\nmax(0, K - Pt)\nThe option matures at T .\nAssume the following parameter values\nT = 52, rf = 0.001, ρ = 0.995, P = $10, σ = 0.03, K = $9\nLet the initial futures price be P0 = $10.5.\n\n(a) Consider a European option with the same payoff and the same parameters. Com\npute the price of this option numerically on a grid (Hint: use the code for numer\nical DP\n\nto\n\nhelp\n\nyou\n\napproximate\n\nthe\n\ndynamics\n\nof\n\nfutures\n\nprices\n\non\n\na\n\ngrid).\n\n(b) Check the accuracy of your answer using Monte Carlo simulation. Refine the grid\nso your answer is accurate up to a penny.\n(c) Compute numerically the price of the American option.\n(d) At time t = 26, under what conditions would it be optimal to exercise the option?\n(e) What is the early exercise premium for the American option above, defined as the\ndifference between the price of the American option and the otherwise identical\nEuropean option?\n3. (To be solved individually) (Optional, extra credit) Consider a binomial-tree model of\nstock returns. Assume that the steps of the tree are given by\nσ\n√\nΔt\nu = e\n,\nd = u\nand the probability of the \"up\" move is\nμΔt\ne\n- d\np = u - d\nwhere\nσ = 0.2,\nμ = 0.1,\nΔt = 52\nThe time step is Δt. (This tree is supposed to model weekly price changes).\nAssume that the short-term interest rate is constant, and the single-period simple\ninterest rate is\n0.04\nr = 52\nConsider and investor with initial wealth W0 = 1 maximizing expected utility\nE0[ln WT ]\nAssume T = 2 (the investor has a two-year horizon, so there are 2 × 52 time periods in\nthis problem). The investor is subject to a constraint that the terminal portfolio value\ncannot fall below 0.9:\nWT ≥ 0.9\n(E.g., a pension fund with a floor on portfolio value dictated by liabilities). Your\nobjective is to find the optimal dynamic portfolio strategy for this investor using the\nstatic approach.\n, available in the Lecture Notes section of the OCW page,\n\n(a) Formulate the static optimization problem for this investor.\n(b) Relax the budget constraint using the Lagrange multiplier λ and derive the opti\nmal terminal wealth W ?\nT as a function of the SPD and λ. Make sure you satisfy\nthe lower bound WT\nand the SPD πT : what's the intuition?\n0 9: the first-order optimality conditions hold only if the\n≥ .\n?\ninequality constraint is not binding. Comment on the relationship between WT\n(c) Find the value of λ such that W ?\nT satisfies the budget constraint. For that you\nneed to compute the time-0 market value of the state-contingent cash flow W ?\nT\nand make sure it equals W0. You can use backward induction on the tree or Monte\nCarlo simulation. To use backward induction, show explicitly how the optimal\nchoice W ?\nT depends on the terminal stock price (and not on the entire path of the\nstock price between 0 and T ).\n(d) Having derived the optimal terminal wealth, you can now compute the optimal\nportfolio policy. Compute the optimal stock holding at time 0. For that you need\nto compute the optimal wealth at nodes u and d at time Δt and use the formula\nfor option replication on a binomial tree. Again, you can use backward induction\non the tree or Monte Carlo simulation. Note that Monte Carlo simulation may\nrequire many trajectories to achieve high degree of accuracy.\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_assn06.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/070f700a443cba57fbce2ed39c1e6109_MIT15_450F10_assn06.pdf",
      "content": "b\nM.I.T.\n15.450-Fall 2010\nSloan School of Management\nProfessor Leonid Kogan\nProblem Set 6\n1. (To be solved in a group) Suppose we observe returns of N trading strategies over the\nsame time period, xt\nn , n = 1, ..., N, t = 1, ..., T . We want to develop a test of the null\nhypothesis that all n strategies produce the same average return.\n(a) Assuming that returns are independent and identically distributed over time but\npotentially correlated contemporaneously, derive the estimator of the average re\nturn for the N strategies, μbn. Derive the asymptotic variance-covariance matrix\nΩ for the estimated mean vector.\n(b) Argue that the estimates μbn have multivariate normal distribution asymptotically.\n(c) Define δk = μbk - μb1, k = 2, ..., N. Argue that the asymptotic distribution of\nthe vector δ = (δ2, ..., δN )0 is multivariate normal. What is the mean and var-cov\nmatrix of this distribution under the null hypothesis? Show (i) how to derive the\nvar-cov matrix of δ from bΩ; and (ii) how to estimate it directly from return data\nn\nxt .\n(d) Denote the var-cov matrix of the distribution of δ in (1c) by V . Argue that the\ntest statistic\nW = δ0V -1δ\nis distributed as χ2(N - 1).\n(e) Using the cumulative distribution function for the χ2 distribution,1 construct a\ntest of the null hypothesis with 5% size. Your test should rely on the statistic W\nin (1d).\n2. (To be solved in a group) Conduct a Monte Carlo study to illustrate the performance\nof the test developed above. Assume that N = 5 and T = 60. Assume that the\nreturn series are normally distributed with mean 0.01 and standard deviation 0.05. All\npairwise correlations between the return series are equal to 0.25. Thus, the variance-\ncovariance matrix of returns has diagonal elements of 0.052 and off-diagonal elements\nof 0.052 × 0.25.\n(a) Simulate 100,000 independent samples of N return series of length T according to\nthe above distribution. Perform the test developed in (1a-1e) for each simulated\n1χ2(K) CDF is available in MATLAB(R) Function call is cdf('chi2',x,K), where x is the argument, and K is\nthe degrees of freedom parameter.\n.\n\nsample and compute the frequency of rejecting the null hypothesis. What is the\nsize of the test according to your Monte Carlo study?\n(b) Repeat the Monte Carlo study under a different distribution of returns. In par\nticular, assume that the null hypothesis is false and the five average returns are\n0.02, 0.015, 0.01, 0.015, 0.025\nThe variance-covariance matrix of returns is the same as in (2a), returns are\nstill multi-variate normal. Estimate the probability of the test rejecting the null\nhypothesis when it's false. This probability is called the power of the test against\ndifferent alternatives above.\n(c) Assuming the return distribution in (2b), approximately how many observations\nT would it take for the above test to reject the null hypothesis of equal average\nreturns with probability 99%? You should use your Monte Carlo set-up to support\nthe answer this question.\n3. (To be solved individually) In this problem we test for predictability of excess stock\nreturns. Download the market data in file ReturnPred.xls,\n\nThe\n\nfile\n\ncontains\n\nhistorical\n\ndata\n\non\n\nS&P\n\nreturns,\n\ninterest\n\nrates,\n\ndividend-price\n\nratio\n\nfor\n\nthe\n\nS&P\n\nindex,\n\nand\n\nthe\n\nterm\n\nspread,\n\ndefined\n\nas\n\nthe\n\ndifference\n\nin\n\nten-year\n\nand\n\nthree-month\n\nTreasury\n\nyields\n.\n\nConsider\n\nthe\n\nfollowing\n\npredictive\n\nmodel:\n\nrt\ne\n+1 = a0 + a1(D/P )t + a2(Term spread)t + εt+1\nwhere rt\ne denotes the monthly return on the S&P 500 value-weighted index in excess\nof the interest rate, approximated by the three-month Treasury Bill yield (the interest\nrate series is available at http://research.stlouisfed.org/fred2/series/TB3MS?cid=116).\n(a) Using OLS, estimate the predictive model above. Compute standard errors for\nthe coefficients a1, a2. Use the Newey-West procedure, defend your choice of the\nband width parameter.\n(b) Test the null hypothesis that a1 = a2 = 0. Can you reject the null at 5% level?\nCan you reject the null at 1% level? Describe the details of the test.\n(this file is unavailable\non MIT OpenCourseWare).\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_final2010.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/e3f739ff2ef359308846613829607d11_MIT15_450F10_final2010.pdf",
      "content": "Last Name\nFirst Name\nID Number\nM.I.T.\n15.450-Spring 2010\nSloan School of Management\nProfessor Leonid Kogan\nFinal Exam\nInstructions: Carefully read these instructions! Failure to follow them may lead to deduc\ntions from your grade.\n1. Immediately write your name at the top of this page.\n2. You will turn in only the exam, so write all answers on the exam.\n3. Do not in any way communicate with other people taking the exam. Any communica\ntion - even if it is not about the exam - will result in a grade of zero.\n4. Do not use computers during the exam. Do not use notes or books other than the\n\"cheat sheet\" permitted by me.\n5. Write your answers clearly and provide explanations.\nProblem Maximum Points Points\nTotal\n\n1.\n[15 points] Suppose Xt solves a stochastic differential equation\ndXt = μXt dt + σXt(1 - Xt) dZt\nDescribe ln Xt as an Ito process, i.e., derive the drift and the diffusion coefficients for\nln Xt as functions of Xt.\n\n2.\n[25 points] You observe two return series (Xt\n1, Xt\n2), t = 1, ..., T . Assume that these\nreturns are correlated with each other, but independently distributed across time.\n(a) Describe a test of the hypothesis that the two return series have the same mean.\nYou are looking for a test with the 5% size. Use large-T asymptotic approxima\ntions to construct your test.\n(b) Assume now that your sample is relatively short and you are not comfortable re\nlying on large-sample approximations. Describe how you could use the bootstrap\nmethodology to improve the accuracy of your tests, i.e., to make sure that the\nsize of your new test is closer to 5% than the size of the test in part (a).\n\n3.\n[30 points] Consider a market with a riskless bond, paying a constant interest rate r,\nand a stock paying no dividends with the price process following\ndSt = μ exp(Xt)St dt + σSt dZt\ndXt = -θXt dt + βdZ0\nt\ndZtdZt\n0 = 0\nConsider a digital option paying $1 at time T if and only if ST ≥ K. K is the strike\nprice of the option.\n(a) Characterize the price of the digital option using the risk-neutral approach.\n(b) Derive a PDE (with the terminal condition) on the option price.\n(c) Using the risk-neutral representation, derive the option price as a function of the\nstock price and time.\n(d) Denote the option price by D(t, St). Treating the function D(t, St) as known,\ncompute the instantaneous expected excess rate of return on the option at time t\ngiven the stock price St.\n\n4. [30 points] Your task is to estimate a volatility forecasting model. You observe a time\nseries of observation pairs (Xt-1, Yt), t = 1, ..., T . Assume that T is large enough so\nyou can use large-sample asymptotic approximations.\nThe model states that the conditional volatility of Yt is a function of Xt:\nYt = exp\n(a0 + a1Xt-1) εt,\nwhere εt are IID over time, independent of Xt-1, and have zero mean: Et-1[εt] = 0,\nbut the exact distribution of εt is not known.\nYour task is to estimate parameters a0 and a1.\n(a) Using the QMLE approach, assume that Yt has a normal distribution\nYt ∼N (0, exp(a0 + a1Xt-1))\nWrite down the log-likelihood function L(a0, a1).\n(b) Using the QMLE approach, derive the two moment conditions that can be used\nto estimate a0 and a1. Show that these are valid moment conditions.\n(c) Outline how you could compute standard errors for your parameter estimates.\n(d) Describe how you would test the hypothesis that a1 = 0. You need a test with the\n5% size. If you were not able to solve the previous part of the question, for this\npart you can assume that you know the variance-covariance matrix of (ba0, ba1),\ndenoted by Vb.\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_probs_sol.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/ab692c6361cddb9c5bab48edd006548f_MIT15_450F10_probs_sol.pdf",
      "content": "M.I.T.\n15.450-Fall 2010\nSloan School of Management\nProfessor Leonid Kogan\nSolutions for Practice Problems\n1. Consider a 3-period model with t = 0, 1, 2, 3. There are a stock and a risk-free asset.\nThe initial stock price is $4 and the stock price doubles with probability 2/3 and drops\nto one-half with probability 1/3 each period. The risk-free rate is 1/4.\n(a) Compute the risk-neutral probability at each node.\nSolution: Let q denote the risk-neutral probability of up-node and 1 - q denote\nrisk-neutral probability of the down-node. Then by the definition of the risk-neutral\nprobabilities,\n\nSt = EQ\n1 + r St+1\n\n= 1 + r q (2St) + (1 - q) 2 St\nwith r = 1 . Solving this equation gives q = 1\n2. Notice that this calculation holds\ntrue at every non-terminal node. We conclude that the risk-neutral probability at each\nnode is given by 1\n2 probability of up-node and 1\n2 probability of down-node.\n(b) Compute the Radon-Nikodym derivative (dQ/dP) of the risk-neutral measure with\nrespect to the physical measure at each node.\nSolution: The original (physical) measure assigns probabilities pu = 2\n3 and pd = 1\n3 to\nthe up- and down-node, respectively. The risk-neutral measure assigns probabilities\nqu =\nand qd = 1\n2. The Radon-Nikodym derivative at each node is a random variable\nthat takes on the value\n\ndQ\nqu\n1/2\n(u) =\n=\n=\ndP\npu\n2/3\nin the up-node and the value\ndQ\nqd\n1/2\n(d) =\n=\n=\ndP\npd\n1/3\nin the down-node. Again, notice that this calculation is valid at each and every node.\n(c) Compute the state-price density at each node.\nSolution: Fix the current node at time t and let the state-price density at this node\nbe denoted by πt. Denoting the values of state-price densities at the childen nodes by\n\nπt+1 (u) and πt+1 (d), we have the following pricing equations:\n2 πt+1 (u)\n1 πt+1 (d)\nSt =\n2St +\nSt\nπt\n·\nπt\n· 2\n4 πt+1 (u)\n1 πt+1 (d)\n=\n+\nSt\nπt\nπt\n2 πt+1 (u)\n1 πt+1 (d)\n=\n+\nπt\n· 4\nπt\n· 4\n5 πt+1 (u)\n5 πt+1 (d)\n=\n+\nπt\nπt\nπt+1(u)\nπt+1(d)\nSolving this system of equations in the unknowns\nπt\nand\nπt\n, we get the solution\nπt+1 (u)\n=\nπt\nπt+1 (d)\n=\nπt\nNow, starting at the initial node at time t = 0 and setting π0 = 1 allows us to solve for\nthe state-price density at every node recursively. This calculation leads us to conclude\nthat at a node ω whose history consists of i up-movements and j down-movements,\nthe state-price density is given by\ni j\nπt (ω) =\n(d) Price a lookback option with payoff at t = 3 equal to (max0≤t≤3 St) - S3 using\nrisk-neutral probability.\nSolution: The following binomial tree describes the evolution of stock price and the\nbold-face numbers next to the final stock price are the payoffs from the lookback option:\n\nX\n$4\n$2\n$1\n$0.5, $3.5\n$2, $2\n$4\n$2, $2\n$8, $0\n$8\n$4\n$2, $6\n$8, $0\n$16\n$8, $8\n$32, $0\nRecalling from part (a) that the risk-neutral probabilities of an up-movement and a\ndown-movement are both 1\n2 , all terminal nodes have the same Q-probability of\n=\n1 . Therefore the price of the lookback option is given by\n\nC =\nEQ [D3]\n1 + r\n\n=\n8 + 6 + 2 + 2 +\n· 8\n= 125 · 8 · 2\n= 125\n(e) Price the lookback option using state-price density and compare your answer to\n(d).\nSolution: Using the state-price density we computed in part (c), we can calculate the\nprice of the lookback option as\nC = E [π3D3]\n=\nP (ω) π3 (ω) D3 (ω)\nω\nwhere the sum is across all the possible time-3 nodes ω. But note that for any ω,\ndenoting the number of up-movements by i and the number of down-movements by j,\n\nX\nh\ni\nh\ni\nwe have\n\" 2 i 1 j # \" 3 i 6 j #\nP (ω) π3 (ω) =\n2 i 2 j\n=\n2 i+j\n=\n2 3\n=\nTherefore,\nC =\nP (ω) π3 (ω) D3 (ω)\nω\n3 X\n=\nD3 (ω)\nω\n\n=\n8 + 6 + 2 + 2 +\n= 125\nOf course, we get the same answer as we did in part (d) using the risk-neutral proba\nbilities.\n2. Show that, under the risk-neutral measure, the discounted gain process\nt\nPt\nX Ds\nGˆt =\n+\nBt\nBs\ns=1\nis a martingale (i.e. Et\nQ Gˆt+1 = Gˆt) from the definition of risk-neutral measure in\nlecture notes\n\"\n#\nT\n= EQ\nX Bt\nPt\nt\nDu\nBu\nu=t+1\nThat is the reason why the risk-neutral measure is also called the \"equivalent martingale\nmeasure\" (EMM).\nSolution: We want to show Et\nQ Gˆt+1 = Gˆt.\n\n\"\n#\nh\ni\nX\n\"\n#\n\"\n\"\n#\n#\nX\n\"\n\"\n#\n#\n\"\n#\n\"\n#\nX\n\"\n#\nh\ni\nt+1\nEt\nQ Gˆt+1\n= Et\nQ Pt+1 +\nX Ds\nBt+1\nBs\ns=1\nNow recall that\n\"\n#\nT\nPt+1 = Et\nQ\n+1\nX Bt+1 Du\nBu\nu=t+2\nSubstituting this into the first expression, we have\nt+1\nEt\nQ Gˆt+1\n= Et\nQ Pt+1 +\nDs\nBt+1\nBs\ns=1\nX\nT\nBt+1\nt+1 Ds\n= Et\nQ\nEt\nQ\n+1\nDu +\nBt+1\nBu\nBs\nu=t+2\ns=1\nT\nt+1\nEQ EQ\nX Du\nX Ds\n=\nt\nt+1\n+\nBu\nBs\nu=t+2\ns=1\nT\nEQ X Ds\n=\nt\nBs\ns=1\nEQ\nX\nT\nDu\nt\nDs\n=\n+\nt\nBu\nBs\nu=t+1\ns=1\nT\nt\n=\n1 Et\nQ\nX Bt Du +\nX Ds\nBt\nBu\nBs\nu=t+1\ns=1\nt\nPt\nX Ds\n=\n+\nBt\nBs\ns=1\n= Gˆt\nThis shows that Gˆt is a martingale under the risk-neutral measure.\n3. Consider the following model of interest rates. Under the physical probability measure\nP, the short-term interest rate is exp(rt), where rt follows\ndrt = -θ(rt - r) dt + σrdZt,\nwhere Zt is a Brownian motion.\nAssume that the SPD is given by\n\nZ\nZ\nZ\n\nt\nt\nt\nπt = exp -\nru -\n0 2 ηu\n2 du -\nηu dZu\n\nwhere ηt is stochastic, and follows\ndηt = -κ(ηt - η) dt + ση dZη\nt\nwhere Zt\nη is a Brownian motion independent of Zt.\n(a) Derive the dynamics of the interest rate under the risk-neutral probability Q.\nSolution: From the form of SPD πt, the price of risk at time t is ηt. Therefore\nunder the risk-neutral measure Q,\ndZP = dZQ - ηtdt\nt\nt\nand the shock that drives the price of risk process, dZt\nη remains unchanged under\nQ. Thus, the dynamics of the risk-free rate rt can be written as\ndrt = -θ (rt - r ) dt + σrdZt\n= -θ (rt - r ) dt + σr dZt\nQ - ηtdt\n=\n(-θ (rt - r ) - σrηt) dt + σrdZt\nQ\n(b) Compute the spot interest rates for all maturities. (Hint: look for bond prices in\nthe form P (t, T ) = exp(a(T - t) + b(T - t)rt + c(T - t)ηt)).\nSolution: Suppose the current time is t and assume that the bond matures at\ntime T . Denote its price P (t, T ). By the definition of risk-neutral measure Q,\n\nZ T\n\nP (t, T ) = Et\nQ exp -\nt\nrsds\nNow let us guess the bond price P (t, T ) in the functional form\nP (t, T ) = exp (a (T - t) + b (T - t) rt + c (T - t) ηt)\nOn the one hand, by the definition of the risk-neutral measure, we know that\nEt\nQ dP (t, T )\n= rtdt\nP (t, T )\nOn the other hand, we can calculate the same expression using Ito's Lemma:\ndP (t, T ) = - (a0 (T - t) + b0 (T - t) rt + c0 (T - t) ηt) dt\nP (t, T )\n+b (T - t) (-θ (rt - r ) - σrηt) dt + σrdZt\nQ\n+c (T - t) -κ (ηt - η ) dt + σηdZt\nη,Q\n+ (b (T - t))2 · 2\n1 σr\n2dt + (c (T - t))2 · 2\n1 ση\n2dt\n\nand therefore,\nEQ dP (t, T )\n= - (a0 (T - t) + b0 (T - t) rt + c0 (T - t) ηt) dt\nt\nP (t, T )\n+b (T - t) (-θ (rt - r ) - σrηt) dt + c (T - t) (-κ (ηt - η )) dt\n+1\n(b (T - t))2 σ2 + (c (T - t))2 σ2\ndt\nr\nη\nEquating this expression to rtdt, we get a system of three ODEs (match the\ncoefficients on constant, rt, and ηt terms):\n=\nrb (τ) + 1\nr (b (τ))2 + 1 ση\n2 (c (τ ))2\n-a0 (τ ) + θ\nσ2\n= -b0 (τ) - 1 - θb (τ)\n= -c0 (τ) - σrb (τ) - κc (τ)\nAlso, we have a terminal condition that P (T, T ) = 1, so that a (0) = 0, b (0) = 0,\nand c (0) = 0.\nNote that the second equation is an autonomous equation in b (τ ) and it is straight\nforward to solve. Given the solution for b (τ ) , we can then solve the third equation\nfor c (τ). Then, finally, we can solve for a (τ) from the first equation. The solutions\nare\nb (τ)\n=\n1 - e-θτ\n-θ\n\nσr\n\nc (τ)\n=\nθ\nκ 1 - e-κτ - κ - θ e-θτ - e-κτ\nand a (τ) is not reported here for simplicity (it's not difficult to compute, but the\nresulting expression is long and messy). The solutions for a (τ), b (τ), and c (τ )\ncomplete the characterization of bond price\nP (t, T ) = exp (a (T - t) + b (T - t) rt + c (T - t) ηt)\n(c) Compute the instantaneous expected rate of return on a zero-coupon bond with\ntime to maturity τ.\nSolution: Suppose T - t = τ, i.e., time to maturity is equal to τ. Then,\nEt\nP dP (t, T ) - rtdt = Et\nP dP (t, T ) - Et\nQ dP (t, T )\nP (t, T )\nP (t, T )\nP (t, T )\n= b (τ) σrηtdt\nTo understand this calculation, recall that the only difference between the two\ninstantaneous drifts is\ndZt = dZQ - ηtdt\nt\nand the coefficient in front of dZt in dP (t,T ) is b (T - t) σr.\nP (t,T )\n\n(d) Show that the slope of the term structure of interest rates predicts the excess\nreturns on long-term bonds. Discuss the intuition. Show that more volatility in\nthe price of risk, η, means more predictability in bond returns.\nSolution: First, let us discuss what we mean by predictability. In the case that\nreturns are serially i.i.d and independent from any other random variables, there\nis no predictability because there is no other piece of information that allows us\nto \"predict\" the returns. In this question, we have shown in part (b) that the\nbond prices are of the form\nP (t, T ) = exp (a (T - t) + b (T - t) rt + c (T - t) ηt)\nand in part (c) that the expected excess return on a bond with time to maturity\nτ = T - t is given by\ndP (t, T )\nEt\n- rtdt = b (T - t) σrηtdt\nP (t, T )\nWhen ηt is high, we can see from the first equation that the term structure of\ninterest rates is steep and from the second equation that excess returns on long-\nterm bonds are high. Therefore, when the term structure is steeper, and excess\nreturns on long-term bonds are higher. The intuition is as follows: times of high\nprice of risk ηt are typically thought of as recessions when people are more risk-\naverse. High price of risk drives down the price of bonds, resulting in high excess\nreturns (the terminal value of the bond is constant at $1 at maturity).\nAnother observation we can make is that more dispersion in the distribution of ηt\nmeans more predictability in excess bond returns. Note that in the extreme case\nwhen ηt is a constant, our problem reduces to a setting where returns are i.i.d over\ntime and we do not have any predictability (because expected excess bond returns\nwould equal b (T - t) σrη , and excess bond returns would be random noise plus\nthis mean). As ηt becomes more variable, the fraction of variation in the excess\nbond returns due to variation in the mean of the excess returns, b (T - t) σrηt,\nbecomes larger and we have more predictability. We can show that the variance\nσ2\nof the stationary distribution of ηt is 2κ\nη , so more variability in ηt could be due to\nhigher volatility of shocks (higher ση) or lower rate of mean-reversion (lower κ).\n4. Suppose that uncertainty in the model is described by two independent Brownian\nmotions, Z1,t and Z2,t. Assume that there exists one risky asset, paying no dividends,\nfollowing the process\ndSt = μ(Xt) dt + σ dZ1,t\nSt\nwhere\ndXt = -θXt dt + dZ2,t\nThe risk-free interest rate is constant at r.\n\nZ\nZ\nR\nR\n(a) What is the price of risk of the Brownian motion Z1,t?\n\nT\nSolution: Let the price of risk for Z1,t and Z2,t be ηt =\nη1,t η2,t\n. Then we\nmust have\nμ (Xt) St -\nσSt 0 η = rSt\nThis gives\nμ (Xt) St - ση1,tSt = rSt\nwhereas there is no constraint for η2,t. Hence, the price of risk of Z1,t is\nη1,t = μ (Xt) St - rSt = μ (Xt) - r\nσSt\nσ\n(b) Give an example of a valid SPD in this model.\nSolution:\ndπt = -rdt - η\n0 dZt, π0 = 1\nπt\nt\nAny η2,t such that ηt satisfies the Novikov's condition will be allowed. The simplest\nexample would be to let η2,t = 0.\n(c) Suppose that the price of risk of the second Brownian motion, Z2,t, is zero. Char\nacterize the SPD in this model.\nSolution:\ndπt = -rdt - η1,tdZ1,t\nπt\nLet yt = ln πt, by Ito's lemma,\ndyt =\ndπt -\n(dπt)\nπt\n2πt\n= -rdt - η1,tdZ1,t - η2 dt\n2 1,t\nSo\nt\nt\nyt = -rt -\nη2 dt -\nη1,tdZ1,t\n1,t\nπt = e-rt- 1\nt η2 dt- t η1,tdZ1,t\n1.t\n(d) Derive the price of a European Call option on the risky asset in this model, with\nmaturity T and strike price K.\nSolution: Existence of SPD implies existence of risk-neutral measure. Under\nrisk-neutral measure, all traded assets must have drift r and the volatility is\nunchanged. So under risk-neutral measure,\ndSt = rdt + σdZ1\nQ\n,t\nSt\n\nThe physical drift does not matter at all.\nCt = Et\nQ e-r(T -t) [ST - K]+\nStandard Black-Scholes formula applies. So\nCt = StN (d1) - Ke-r(T -t)N (d2)\nwhere\n\nln (S/K) +\n1 σ2 T\nd1,2 =\nσ\n√\nT\nr ± 2\n5. Consider a European call option on a stock. The stock pays no dividends and the stock\nprice follows an Ito process. Is it possible that, while the stock price declines between\nt1 and t2 > t1, the price of the Call increases? Justify your answer.\nSolution: Yes, it is possible. For instance, if volatility becomes extremely large once\nprice hits a low level, we could have the situation described in the question. The\nunderlying reason is that call option is an increasing function of both volatility and\nstock price. So if price drop is accompanied by large increase in volatility, we may a\nhigher call price.\nThe easiest way to see this is through a 3-period binomial tree example: Suppose price\nat time-0 is 100. At time-1, it may go up to 120 or go down to 10. If price goes up\nto 120, it may go further up to 140 or down to 100 at time-2. If price goes down to\n10, the volatility becomes huge. As a result, price may go up to 10000 or down to 1\nat time-2. Let interest rate be 0 and consider an European call with strike at 150 and\nmaturity of two periods.\nLet's find the call option price at each node. If price goes up to 120 at time-1, then the\ncall is worth 0 since, under no circumstances at time-2, the call will be in the money\n(both 140 and 100 are less than strike 150). If price goes down to 10, let's find the call\nprice by solving the contingent claim prices. Let the time-1 price of 1 unit of payoff at\ntime-2 and state S2 = 10000 be q10000 and the time-1 price of 1 unit of payoff at time-2\nand state S2 = 1 be q1. Since interest rate is 0, we have\nq10000 + q1 = 1\nSince the time-1 stock price is 10, we also have\n10000q10000 + q1 = 10\nSolving the simultaneous equation, we have\nq10000 =\nand q1 =\n\nSince the call pays (10000 - 150) = 9850 dollars if price goes up to 10000 at time-2 and\n0 dollars if price goes down to 1. We have the call price, at time-1 and state S1 = 10,\nC10 = 9850q10000 = 9850 ≈ 9 .\nLet's solve for time-0 contingent claim prices q120 and q10 of time-1 payoffs. Zero\ninterest rate implies\nq120 + q10 = 1\nStock price movements implies\n120q120 + 10q10 = 100\nThis gives\nq120 =\nand q10 =\nHence, the call price at time-0 is C100 = C10q10\n11 << 9 = C10. So stock price\n≈\ndeclines at time-1 but call price increases.\nThe same principle applies in continuous-time as long as we allow volatility to become\nlarge once stock price hits a low level. This is certainly possible since the stock price\nprocess follows a general Ito process.\n6. Suppose that the stock price St follows a Geometric Brownian motion with parameters\nμ and σ. Compute\n\nE0 (ST )λ .\nSolution: Using Ito's lemma, we have\ndSt\nλ = λSλ-1dSt + 1 λ (λ - 1) St\nλ-2 (dSt)2\nt\n= λSλ-1 (μStdt + σStdZt) + λ (λ - 1) σ2Sλdt\nt\nt\n\n= Sλ λ\nμ +\n(λ - 1) σ2 dt + λσdZt\nt\nLet Xt = St\nλ . Then we have\ndXt = μX dt + σX dZt\nXt\nwhere\nμX = λ\nμ +\n(λ - 1) σ2\nσX = λσ\n\nHence, Xt also follows geometric Brownian motion. As a result,\nX )T +σX ZT\n(μX -σ\nXT = X0e\nTherefore,\nE ST\nλ\n= E [XT ]\n= X0eμX T\n= S0\nλ e λ(μ+ 1\n2 (λ-1)σ2)T\n7. Suppose that, under P, the price of a stock paying no dividends follows\ndSt = μ(St) dt + σ(St) dZt\nSt\nAssume that the SPD in this market satisfies\ndπt = -r dt - ηtdZt\nπt\n(a) How does ηt relate to r, μt, and σt?\nSolution: By definition of SPD, we must have πtSt as a martingale. By Ito's\nlemma,\nd (πtSt)\n= πtdSt + Stdπt + dStdπt\n= μ (St) πtStdt - rπtStdt - σ (St) ηtπtSt + [...] dZt\n= πtSt (μ (St) - r - σ (St) ηt) dt + [...] dZt\nTo qualify for a martingale process, the drift of πtSt must be 0. So\nμ (St) - r - σ (St) ηt =\nμ (St) - r\nηt =\nσ (St)\n(b) Suppose that there exists a derivative asset with price C(t, St). Derive the instan\ntaneous expected return on this derivative as a function of t and St.\nSolution: Recall that in general, if Xt is the price of a traded asset with the\ndynamics\ndXt = μX dt + σX dZt\nXt\nthen the expected excess return is given by\n(μX - r) dt = EP dXt - EQ dXt\nXt\nXt\n= σX ηt\n·\n\nNow note that the price of our derivative asset C (t, St) satisfies\n∂C (t, St)\n∂C (t, St)\n1 ∂2C (t, St)\ndC (t, St)\n=\ndt +\ndSt +\n(dSt)\n∂t\n∂St\n∂St\n∂C (t, St)\n∂C (t, St)\n1 ∂2C (t, St)\n=\n+\n(μ (St) St) +\n(σ (St) St)\ndt\n∂t\n∂St\n∂S2\n\nt\n∂C (t, St)\n+\n(σ (St) St) dZt\n∂St\nand thus\ndC (t, St)\n∂C (t, St)\n∂C (t, St)\n1 ∂2C (t, St)\nC (t, St)\n= C (t, St)\n∂t\n+\n∂St\n(μ (St) St) + 2\n∂St\n(σ (St) St)\ndt\n∂C (t, St)\n+\n(σ (St) St) dZt\nC (t, St)\n∂St\n= μC (t, St) dt + σC (t, St) dZt\nSo we can express the expected excess return on this derivative as\n∂C (t, St)\n∂C (t, St)\n1 ∂2C (t, St)\nμC (t, St)-r = C (t, St)\n∂t\n+\n∂St\n(μ (St) St) + 2\n∂St\n(σ (St) St)\n-r\nor\n\nσC (t, St) ηt =\n∂C (t, St) (σ (St) St)\nμ (St) - r\nC (t, St)\n∂St\n·\nσ (St)\n(c) Derive the PDE on the price of the derivative C(t, S), assuming that its payoff is\ngiven by H(ST ) at time T .\nSolution: Under risk-neutral measure, all traded securities have instantaneous\nexpected return r. So under risk-neutral measure, the stock has drift rSt and the\nderivative\nEt\nQ dC = ∂C + ∂C rSt + 1 ∂2C σ (St)2 St\n2 dt/C = rdt\nC\n∂t\n∂S\n2 ∂S2\nWe have a PDE\n∂C\n∂C\n1 ∂2C\n2 S2\n∂t + ∂S rSt + 2 ∂S2 σ (St)\nt - rC = 0\n(d) Suppose that there is another derivative trading, with a price D(t, St) which\ndoes not satisfy the PDE you have derived above. Construct a trading strategy\ngenerating arbitrage profits using this derivative, the risk-free asset and the stock.\nSolution: Suppose for derivative D (t, St), we have\n∂D\n∂D\n1 ∂2D\n+\nrSt +\nσ (St)2 S2 - rD > 0\n∂t\n∂S\n2 ∂S2\nt\n\nat some (t, St). Then consider holding the derivative, shorting ∂D shares and\n∂S\nfinancing the above position (D - ∂D St) by borrowing at short rate. The instan\n∂S\ntaneous gain is\n∂D\n∂D\n1 ∂2D\n∂D\n∂D\n∂t dt + ∂S dSt + 2 ∂S2 (dSt)\n- ∂S dSt\n- D - ∂S St rdt\n|\n{z\n} |\n{z\n} |\n{z\n}\nGain from derivative\nGain from stock\nInterest payment\n∂D\n1 ∂2D\n∂D\n=\ndt +\nσ (St)2 St\n2dt - D -\nSt rdt\n∂t\n2 ∂S2\n∂S\n=\n∂D + ∂D rSt + 1 ∂2Dσ (St)2 S2 - rD dt > 0\n∂t\n∂S\n2 ∂S2\nt\nThis is a riskless arbitrage. We can form a similar riskless arbitrage if\n∂D\n∂D\n1 ∂2D\n+\nrSt +\nσ (St)2 St\n2 - rD < 0\n∂t\n∂S\n2 ∂S2\n8. Consider a futures contract with price changing according to\nFt+1 = Ft + λ + μt + σF εt,\nμt+1 = ρμt + σμut\nwhere εt and ut are independent IID N (0, 1) random variables. Assume that the\ninterest rate is constant at r. Your objective is to construct an optimal strategy of\ntrading futures between t = 0 and T to maximize the terminal objective\nE -e-αWT\nwhere WT is the terminal value of the portfolio. Assume the initial portfolio value of\nW0.\n(a) Formulate the problem as a dynamic program. Describe the state vector, verify\nthat it follows a controlled Markov process.\nSolution: The state vector for this problem is (t, Wt, μt). Let θt be the control\nvariable that represents the number of futures contracts at time t. Clearly, μt+1\nfollows a Markov process given the state variable μt. Furthermore, to verify that\nWt is a controlled Markov process, note that\nWt+1 = θt (Ft+1 - Ft) + (1 + r) Wt\n= θt (λ + μt + t+1) + (1 + r) Wt\nand as such, the conditional distribution of Wt+1 only depends on the state vari\nables Wt and μt.\n\n(b) Derive the value function at T and T - 1 and optimal trading strategy at T - 1\nand T - 2.\nSolution: Let us start from t = T . The value function is simply given by\nJ (T, WT , μT ) = - exp (-αWT )\nNow, for t = T - 1, the Bellman equation says\nJ (T - 1, WT -1, μT -1) = max ET -1 [J (T, WT , μT )]\nθT -1\n= max ET -1 [- exp (-αWT )]\nθT -1\n= max ET -1 [- exp (-α (θT -1 (λ + μT -1 + T ) + (1 + r) WT -1))]\nθT -1\nSimple algebra leads to the first order condition\nθ∗\n= λ + μT -1\nT -1\nασF\nPlugging this into the Bellman equation, we get the value function at time t =\nT - 1:\nJ (T - 1, WT -1, μT -1) = - exp -2σF\n2 (λ + μT -1) - α (1 + r) WT -1\nFor t = T - 2, the Bellman equation is given by\nJ (T - 2, WT -2, μT -2) = max ET -2 [J (T - 1, WT -1, μT -1)]\nθT -2\n= max ET -2 - exp\n(λ + μT -1)2 - α (1 + r) WT -1\nθT -2\n-2σ2\nF\nwhere\n=\nFT -1\nFT -2 + λ + μT -2 + σF T -1\nμT -1 = ρμT -2 + σuuT -1\nWT -1 = θT -2 (λ + μT -2 + T -1) + (1 + r) WT -2\nWe can repeat a similar calculation as before and arrive at the optimal control\nθ∗\n= λ + μT -2\nT -2\nα (1 + r) σF\n9. Suppose you can trade two assets, a risk-free bond with interest rate r and a risky\nstock, paying no dividends, with price St. Assume St+1 = St × exp(μ + σεt) where εt\nare IID N (0, 1) random variables.\n\nAssume that whenever you buy the stock you must pay transaction costs, but you can\nsell stock without costs. Specifically, when you buy X dollars worth of stock, you must\npay (1 + τ)X, so the fee is proportional, given by τ. Your objective is to figure out\nhow to trade optimally to maximize the objective\nE -e-αWT\nwhere WT is the terminal value of the portfolio.\n(a) What should be the state vector for this problem? Formulate the problem as\na dynamic program, verify the assumptions on the state vector and the payoff\nfunction.\nSolution: The state vector for this problem is (t, Xt, Bt), where Xt and Bt rep\nresent the dollar value of stock holdings and bond holdings at the beginning of\nperiod t. Let λt be the control variable that represents the net increase in the\ndollar value of the stock holdings as a result of rebalancing at time t. So, for\nexample, if λt > 0, then we invest more in the stock at time t. Note that we incur\na transaction cost of τλt in period t if λt > 0 and none otherwise. Under this\ndefinition, the dollar value of stock holdings at the end of the period t is Xt + λt.\nThen the dynamics of Xt and Bt are given by\nXt+1 = exp (μ + σt+1) (Xt + λt)\nBt+1 = (1 + r) (Bt - λt - τ max (λt, 0))\n·\nIt is clear that Xt and Bt are controlled Markov processes because their conditional\ndistributions of Xt+1 and Bt+1 only depend on the state variables Xt and Bt and\nthe control variable λt. Furthermore, as such, these state variables capture all the\nrelevant information regarding the dynamics of the variable of ultimate interest,\nWt = Xt + Bt.\n(b) Write down the Bellman equation.\nSolution: The Bellman equation is given by\nJ (t, Xt, Bt) = max Et [J (t + 1, Xt+1, Bt+1)]\nλt\nwhere\nXt+1 = exp (μ + σt+1) (Xt + λt)\nBt+1 = (1 + r) (Bt - λt - τ max (λt, 0))\n·\nThe Bellman equation in the terminal time period is simply\nJ (T, XT , BT ) = - exp (-α (XT + BT ))\n\n10. Suppose we observe returns on N independent trading strategies, rt\nn , n = 1, 2, t =\n1, ..., T . Assume that returns are IID over time, and each strategy has normal distri\nbution:\nn\nrt ∼N (μn, σ2)\nAssume μ1 > μ2.\n(a) Estimate the mean return on each strategy by maximum likelihood. Express μbn\nas a function of observed returns on strategy n.\nSolution: It is a standard calculation (see, for example, lecture notes) to show\nthat the maximum likelihood estimate of the mean of a normal distribution is the\nsample mean. Hence\nT\n1 X\nμˆn =\nr n\nT\nt\nt=1\n(b) Since returns are normally distributed, μbn is also normally distributed. Describe\nits distribution. (In general, for arbitrary return distribution, μbn is only approxi\nmately normal).\nSolution: Since rt\nn , t = 1, . . . , T , are drawn from IID normal distribution, the\nsample mean ˆμn is a sum of independent normal variables and is again normally\ndistributed. Since rt\nn ∼ N (μn, σ2), the sample mean ˆμn is distributed N\nμn, σ\nT\n2 .\n(c) What is the distribution of maxn(μbn)? characterize it using the CDF function.\nSolution: Note that ˆμ1 and ˆμ2 are independent so that the cumulative distribu\ntion function (CDF) of max (ˆμ1, μˆ2), denoted Fmax ( ), is given by\n·\nFmax (x) = P (max (ˆμ1, ˆμ2) ≤ x)\n= P (ˆμ1 ≤ x) · P (ˆμ2 ≤ x)\n=\n=\nF1 (x) · F2 (x)\nΦ\n√\nT (x - μ1)\nσ\n!\n· Φ\n√\nT (x - μ2)\nσ\n!\n\nσ2\nwhere we use the fact that ˆμn ∼ N\nμn,\n.\nT\n(d) Suppose you are interested in identifying the strategy with the higher mean return.\nYou pick the strategy with the higher estimated mean. What is the probability\nthat you have made a mistake?\nSolution: We are interested in the probability that ˆμ2 is greater than ˆμ1 (so\nthat we mistakenly infer that the second trading strategy has the higher mean).\nRecalling that ˆμ1 and ˆμ2 are independent and ˆμn ∼ N\nμn, σ\nT\n2 , we know that\n2σ2\nμˆ1 - μˆ2 ∼ N\nμ1 - μ2, T\n\nX\n\nFurthermore,\nP (ˆμ1 ≤ μˆ2)\n= P (ˆμ1 - μˆ2 ≤ 0)\n=\n1 - Φ T (μ\nσ\n-\nμ2)\nWe see that this probability is decreasing in the distance between the true means\nμ1 - μ2 and decreasing in the number of observations T . On the other hand, this\nprobability is increasing in σ2, reflecting the difficulty to estimate the mean when\nthe distribution has large variance.\n11. Suppose interest rate follows an AR(1) process\nrt - r = θ(rt-1 - r) + εt\nwhere εt are IID N (0, σ2) random variables. You want to estimate the average rate, r,\nbased on the sample rt, t = 0, 1, ..., T . Assume that we know the true value of θ.\n(a) Derive the estimate of r by maximum likelihood.\nSolution: It is easily seen that\nT\n\nY\n\nL\n|r1, . . . , rT\n=\nf rt|r, θ, σ2; r0, . . . , rt-1\nr, θ, σ2\n\nt=1\nso that\n\nT\n\nL r, θ, σ\n\n2|r0, . . . , rT\n=\nln f rt|r, θ, σ2\n\n; r1, . . . , rt-1\nt=1\nT\nX\n=\nln √\n2πσ2 exp -2σ2 ((rt - r ) - θ (rt-1 - r ))\nt=1\nIn particular, the maximum likelihood estimate of r , call it rˆ , satisfies the first\norder condition\n∂L\n= ∂r\nT\n=\n1 - θ X\n((rt - r ) - θ (rt-1 - r ))\nσ2\nt=1\nIt follows that\nT\nX\nrˆ = T (1 - θ)\n(rt - θrt-1)\nt=1\n\n(b) Show that this estimate is valid even if the shocks εt are not normally distributed,\nas long as the mean of εt is zero.\nSolution: Now we assume that t are independent over time and E [t] = 0. Note\nthat\nT\nX\nr ˆ = T (1 - θ)\n(rt - θrt-1)\nt=1\nT\nX\n= T (1 - θ)\n((1 - θ) r + t)\nt=1\nT\nX\n= r +\nt\nT (1 - θ) t=1\nBy the Law of Large Numbers,\nT\nX\nT (1 - θ)\nt → 0\nt=1\nin probability, and hence we establish that rˆ converges in probability to the true\nvalue r and therefore is consistent.\n(c) Treating εt as IID, derive the asymptotic variance of your estimator of r. Do\nnot use Newey-West, derive the result from first principles. How does the answer\ndepend on θ?\nSolution: For this part, we maintain that t are IID over time, E [t] = 0, and\nV ar[t] = σ2 . In the last part, we saw that\nT\nX\nrˆ = r +\nt\nT (1 - θ) t=1\nand hence\nT\n√\nT\n\nr ˆ - r\n\n= 1 -\nθ √1\nT\nX\nt\nt=1\nBy the Central Limit Theorem,\nT\n1 X\n\n√\nT\nt ⇒ N 0, σ2\nt=1\nand we conclude that\n√\nT\n\nrˆ - r\n\n⇒ N 0,\n(1 -\nσ2\nθ)2\n\nNote that the asymptotic variance of our estimator is increasing in θ. This makes\nsense, because in the limiting case where θ = 0, rt are actually IID over time and\nasymptotic variance of the sample mean is equal to the variance of the shocks.\nIn the other limiting case where θ\n1, we are very close to the unit-root case\n→\n(random walk) where we do not have mean-reversion and hence estimation of the\nlong-run mean becomes increasingly difficult and imprecise.\nMoreover, calculating theoretical asymptotic variance of the estimator as in this\nquestion provides an alternative to constructing standard errors using the Newey-\nWest method. There are advantages and disadvantages to each method. The\noretical asymptotic variance is a convenient way to see inner workings of the\nestimator (in our example, the dependence of asymptotic variance on the persis\ntence of AR(1) process) with excellent finite sample properties, assuming correct\nmodel specification. However, derivation of asymptotic variance of an estimator\nmay not be so straightforward in more complex situations and standard errors\nobtained this way are more sensitive to model misspecification compared to the\nmore model-independent Newey-West standard errors.\n12. Suppose you observe two time series, Xt and Yt. You have a model for Yt:\nYt+1 = ρYt + (a0 + a1Xt) εt+1, t = 0, 1, ..., T\nwhere εt+1 ∼N (0, 1), IID. Assume that the shocks εt are independent of the process\nXt and the lagged values of Yt. There is no model for Xt.\n(a) Using the GMM framework, which moment condition can be used to estimate ρ?\nSolution: We first want to establish that\nE [(a0 + a1Xt) t+1|Yt] = 0\nTo see why this is true, note that\nE [(a0 + a1Xt) t+1|Yt]\n= E [a0 + a1Xt|Yt] · E [t+1|Yt]\n= E [a0 + a1Xt|Yt] · E [t+1]\n= E [a0 + a1Xt|Yt] · 0\n=\nwhere the first equality follows from independence of the processes Xt and t, the\nsecond equality follows from independence of t+1 with the lagged values of Xt,\nand the third equality follows from the assumption that t+1 ∼ N (0, 1).\nNow having derived this condition, our usual arguments now allow us to derive\nthe moment conditions\nE [g (Yt) (a0 + a1Xt) t+1] = 0\nfor any function g.\n\n(b) Argue why it is valid to estimate ρ using an OLS regression of Yt+1 on Yt.\nSolution: In particular, if we pick g (Yt) = Yt, then the moment condition be\ncomes\nE [Yt · (a0 + a1Xt) t+1] = 0\nand our sample analogue is\nET [Yt · (a0 + a1Xt) t+1] = 0\nor\nET [Yt · (Yt+1 - ρYt)] = 0\nNote that the GMM estimate ˆρ that solves this sample moment condition is also\nthe OLS estimate from the regression\nYt+1 = ρYt + ut\nwhere ut represents unspecified error terms. The reason why the GMM estimate\nof ρ coincides with the OLS estimate is that the sample moment condition for ˆρ\nsimply says that the residual term Yt+1 - ˆ\nis orthogonal to the regressor Yt,\nρYt\nand this orthogonality between the fitted residuals and the regressors is the first\norder condition of the OLS estimate. Hence it is valid to estimate ˆρ by simply\nrunning the regression\nYt+1 = ρYt + ut\nto find the OLS estimate of ρ.\n(c) Suppose that the variance of the estimator ρb is (1/T )σρ\n2 . Describe how you would\ntest the hypothesis that ρ = 0.\nSolution: We are assuming that\nV ar (ˆρ) =\nσ2\nT\nρ\nTo test the hypothesis that ρ = 0, we make use of the χ2 test (refer to page 32 of\nLecture Notes 8). We construct the test statistic as\nρˆ2\nρˆ2\nξ =\n= T\nV ar (ˆρ)\nσρ\nWe reject the null hypothesis of ρ = 0 if the test statistic is sufficiently large, i.e.,\nif\nξ ≥ ξ\n\nwhere the cutoff point ξ is such that\n\nCDFχ2(1) ξ = 1 - α\nand α is the size of our hypothesis test.\n\nX\nX\n\n!!\n\n!\nX\n\n(d) Write down the conditional log-likelihood function L(ρ, a0, a1).\nSolution: Given the model\nYt+1 = ρYt + (a0 + a1Xt) t+1\nwhere t+1 are IID N (0, 1), the log-likelihood function is\nT\nL (ρ, a0, a1)\n=\nln f (Yt|X0, . . . , Xt-1, Y0, . . . , Yt-1; ρ, a0, a1)\nt=1\nT\n=\nln\np 1\nexp\n(Yt - ρYt-1)\nt=1\n2πσt\n-1\n-\n2σt\n-1\nT\n=\nX\n1 ln\n\n2πσ2\n(Yt - ρYt-1)\n-2\nt-1 -\n2σ2\nt=1\nt-1\nwhere the conditional standard deviation of Yt+1, denoted σt\n2, is given by\nσ2 = (a0 + a1Xt)2\nt\nTherefore,\nT\nT\nT\n1 X\n\n1 X\nYt - ρYt-1\nL (ρ, a0, a1) = - 2 ln (2π) - 2\nln (a0 + a1Xt-1)\n- 2\na0 + a1Xt-1\nt=1\nt=1\n(e) Suppose that the parameters a0 and a1 are known. Derive the maximum-likelihood\nestimate for ρ.\nSolution: We now suppose that a0 and a1 are known. Then the maximum\nlikelihood estimate of ρ satisfies the first order condition\n∂L\n= ∂ρ\n\nT\nX\nYt - ρYt-1\nYt-1\n=\na0 + a1Xt-1\na0 + a1Xt-1\nt=1\nT\nYt-1 (Yt - ρYt-1)\n=\n(a0 + a1Xt-1)2\nt=1\nand hence\nPT\nYt-1Yt\nt=1 (a0+a1Xt-1)2\nρˆ = PT\nYt\n-1\nt=1 (a0+a1Xt-1)2\n\nX\nX\nX\n\n13. Suppose we observe a sequence of IID random variables Xt ≥ 0, t = 1, ..., T , with\nprobability density\npdf(X) = λe-λX ,\nX ≥ 0\n(a) Write down the log-likelihood function L(λ).\nSolution: The log-likelihood function is given by\nT\nL (λ X1, . . . , XT )\n=\nln p (Xt λ)\n|\nt=1\n|\nT\n=\n(ln λ - λXt)\nt=1\nT\n= T ln λ - λ\nXt\nt=1\n(b) Compute the maximum likelihood estimate λb.\nSolution: The maximum likelihood estimate λˆ satisfies the first order condition\n∂L\n= ∂λ\nT\nT\nX\n=\nXt\nλ -\nt=1\nand we get\n\nT\n!-1\n1 X\nλˆ =\nXt\nT t=1\n(c) Derive the standard error for λb.\nSolution: To compute the standard error of the maximum likelihood estimator\nλˆ, we resort to the general GMM standard errors (refer to page 28 of the Lecture\nNotes 8). We have\n∂2 ln p (Xt λ)\nˆ\nˆ\nˆ\nd = E\n∂λ2\n|\n|λ = λ\nT\nX ∂2 ln p (Xt\n= 1\nT t=1\n∂λ2\nλ)\n|\n|λ = ˆλ\nT\nX\n= T t=1\n- ˆλ2\n= - ˆλ2\n\n!\n\n!\n\n!\n\n!!\n\n!!\nand\n\"\n#\nSˆ\n= Eˆ\n∂ ln p (Xt|λ)\nλ = λˆ\n∂λ\n|\nT\n1 X 1\n=\nλ\n- Xt\nT\nˆ\nt=1\nT\nT\n1 X\n1 X\n=\nλˆ2 -\nλˆ\nT\nXt\n+\nT\nXt\nt=1\nt=1\nBut we note that\n\n!\nT\n-1\n1 X\nλˆ =\nXt\nT t=1\nand we can simplify Sˆ to\nT\n1 X\nSˆ = -\nλˆ2 +\nT\nXt\nt=1\nFinally, the variance of our estimator is given by\nV ar\n\nλˆ\n\n=\nSˆ\nT\ndˆ2\n·\nwhere all the matrix multiplications simplify a great deal since we are working in\nthe scalar case. In particular, putting together expressions for dˆ and Sˆ, we get\nT\n\n1 X\nV ar λˆ\n= T λˆ4\n-\nλˆ2 +\nT\nX2\nt\nt=1\nT\n1 X\n=\n-λˆ2 + λˆ4\nX2\nT\nT\nt\nt=1\nwhere\n\nT\n!-1\n1 X\nλˆ =\nXt\nT t=1\n14. Suppose you observe a series of observations Xt, t = 1, ..., T . You need to fit a model\nXt+1 = f(Xt, Xt-1; θ) + εt+1\nwhere E[εt+1|Xt, Xt-1, ..., X1] = 0. Innovations εt+1 have zero mean conditionally on\nXt, Xt-1,...,X1. You also know that innovations εt+1 have constant conditional vari\nance:\nE[ε2\nt+1|Xt, Xt-1, ..., X1] = σ2\n\nX\nX\n\nThe parameter σ is not known. θ is the scalar parameter affecting the shape of the\nfunction f(Xt, Xt-1; θ).\n(a) Describe how to estimate the parameter θ using the quasi maximum likelihood\napproach. Derive the relevant equations.\nSolution: Assume that εt+1|Xt, ...X1 follows Gaussian distribution N (0, σ2).\nThen the logged likelihood is\nT -1\nε2\nt+1\nl (X3, ..., XT ; θ, σ)\n=\n-2 ln 2π - ln σ - 2σ2\nt=2\nT -1\n(Xt+1 - f (Xt, Xt-1; θ))2\n=\n-2 ln 2π - ln σ -\n2σ2\nt=2\nTo maximize the logged likelihood, we differentiate w.r.t θ and F.O.C gives\nT -1\n1 X\n∂f (Xt, Xt-1; θ)\nθ :\n(Xt+1 - f (Xt, Xt-1; θ))\n= 0\nσ2\n∂θ\nt=2\nUpon simplifying, we have\nX\nT -1\n∂f\nθ\nX\n∂f Xt, Xt-1; ˆ\n\nXt, Xt-1; ˆ\nT -1\nθ\n0 =\nXt+1 - f\nXt, Xt-1; θˆ\n∂θ\n=\nεˆt+1\n∂θ\nt=2\nt=2\nThe equivalent moment condition is\n∂f (Xt, Xt-1; θ)\nE εt+1\n= 0\n∂θ\nwhich is valid.\n(b) Describe in detail how to use parametric bootstrap to estimate a 95% confidence\ninterval for θ.\nSolution: Parametric bootstrap can be done through the following steps:\n(1)Estimate θˆ using QMLE and obtain a sample of residuals εˆt+1 = Xt+1\n\n-\nf\nXt, Xt-1; θˆ\n(2)Fix θˆ. Generate ith sample (for i = 1, 2, ..., N) of X1\n(i), ..., XT\n(i)\nby drawing\n(i)\n(i)\nrandomly from the sample residuals with replacement to get ˆεt+1 and Xt+1 =\nf\nX(i), X(i) θ + ˆε(i)\nNote that we need to exclude the \"burn-in\" sample and\nt\nt-1; ˆ\nt+1.\nkeep only last T observations. For ith sample, estimate θˆ(i) with X1\n(i), ..., XT\n(i) .\n(3) Get θˆ2.5% and θˆ97.5% (5th and 95th percentile) from the sample of estimates\nθˆ(i), i = 1, 2, ..., N.\n\n(4) The bootstrapped confidence interval is given by θˆ- θˆ97.5% - θˆ , θˆ- θˆ2.5% - θˆ\n.\n\nh\ni\nh\ni\n\n(c) Describe how to estimate the bias in your estimate of θ using parametric boot\nstrap.\nSolution: The bias can be estimated using\nE θˆ- θ ≈ EˆN θˆ(i) - θˆ\nwhere EˆN [ ] represents the sample average of N bootstrapped estimates.\n·\n(d) Derive the asymptotic standard error for θb (large T ) using GMM standard error\nformulas.\nSolution: Recall that the moment condition for θ is\nE (Xt+1 - f (Xt, Xt-1; θ)) ∂f (Xt, Xt-1; θ) = 0\n∂θ\nAsymptotic variance of θˆ is T\ndˆ0Sˆ-1dˆ\n-1\n.\nˆd =\nˆET\n\"\n(Xt+1 - f (Xt, Xt-1; θ)) ∂2f (Xt, Xt-1; θ)\n∂θ2\n-\n∂f (Xt, Xt-1; θ)\n∂θ\n2 #\n→ E\n\"\n(Xt+1 - f (Xt, Xt-1; θ)) ∂2f (Xt, Xt-1; θ)\n∂θ2\n-\n∂f (Xt, Xt-1; θ)\n∂θ\n2 #\n= E\n\nεt+1\n∂2f (Xt, Xt-1; θ)\n∂θ2\n\n- E\n\" ∂f (Xt, Xt-1; θ)\n∂θ\n2 #\n= 0 - E\n\" ∂f (Xt, Xt-1; θ)\n∂θ\n2 #\n= -E\n\" ∂f (Xt, Xt-1; θ)\n∂θ\n2 #\nSince for j > 0,\nE εt+1\n∂f (Xt, Xt-1; θ)εt-j+1\n∂f (Xt-j , Xt-j-1; θ)\n∂θ\n∂θ\n∂f (Xt, Xt-1; θ)\n∂f (Xt-j , Xt-j-1; θ)\n= E E [εt+1|Xt, Xt-1, ...]\n∂θ\nεt-j+1\n∂θ\n=\n\nh\ni\nthere is no autocorrelation. As a result,\nˆS =\nˆET\n\"\n(Xt+1 - f (Xt, Xt-1; θ))2\n∂f (Xt, Xt-1; θ)\n∂θ\n2 #\n→ E\n\"\n(Xt+1 - f (Xt, Xt-1; θ))2\n∂f (Xt, Xt-1; θ)\n∂θ\n2 #\n= E\n\"\nε2\nt+1\n∂f (Xt, Xt-1; θ)\n∂θ\n2 #\n= E\n\"\nE\n\nε2\nt+1|Xt, Xt-1\n∂f (Xt, Xt-1; θ)\n∂θ\n2 #\n= σ2E\n\" ∂f (Xt, Xt-1; θ) 2 #\n∂θ\n\nThus, asymptotic variance is 1 σ2/E\n∂f(Xt,Xt-1;θ)\n.\nT\n∂θ\n15. Consider an estimator θb for a scalar-valued parameter θ. Suppose you know, as a\nfunction of the true parameter value θ0, the distribution function of the estimator, i.e.,\nyou know\nCDFθb-θ0 (x)\n(In practice, you may be able to estimate the above CDF using bootstrap). Note that\nthis CDF does not depend on model parameters.\nBased on the definition of the confidence interval, derive a formula for a confidence\ninterval which covers the true parameter value with probability 95%.\nSolution: Since the CDF of θˆ - θ0 is independent of the paramter θ0, the 2.5 and\n97.5 percentiles of the distribution, denoted as α2.5% and α97.5%, are fixed numbers\nindependent of θ0. As a result,\nPr α2.5% < θˆ- θ0 < α97.5% = 0.95\nRearranging the inequalities, we have\nPr θˆ- α97.5% < θ0 < θˆ- α2.5% = 0.95\nHence, a 95% confidence interval is θˆ- α97.5%, θˆ- α2.5% , which illustrates why we\nh\n\ni\nhave ˆ\nθ∗\nθ , ˆ\nθ∗\nθ\nas the bootstrapped confidence interval. θ∗-θˆ\nθ -\n97.5% - ˆ\nθ -\n2.5% - ˆ\n\nhas approximately the same distribution as θˆ- θ0. The 2.5 and 97.5 percentiles of the\ntwo distributions are also approximately the same. As a result, α2.5% and α97.5% can\nbe approximated by θ∗\nθ and θ∗\nθ .\n2.5% - ˆ\n97.5% - ˆ\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\n\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_probs.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/d78bd3079a320a67177e97c0014a834b_MIT15_450F10_probs.pdf",
      "content": "h\ni\nZ\nZ\n\nM.I.T.\n15.450-Fall 2010\nSloan School of Management\nProfessor Leonid Kogan\nPractice Problems\n1. Consider a 3-period model with t = 0, 1, 2, 3. There are a stock and a risk-free asset.\nThe initial stock price is $4 and the stock price doubles with probability 2/3 and drops\nto one-half with probability 1/3 each period. The risk-free rate is 1/4.\n(a) Compute the risk-neutral probability at each node.\n(b) Compute the Radon-Nikodym derivative (dQ/dP) of the risk-neutral measure with\nrespect to the physical measure at each node.\n(c) Compute the state-price density at each node.\n(d) Price a lookback option with payoff at t = 3 equal to (max0≤t≤3 St) - S3 using\nrisk-neutral probability.\n(e) Price the lookback option using state-price density and compare your answer to\n(d).\n2. Show that, under the risk-neutral measure, the discounted gain process\nt\nˆ\nPt\nX Ds\nGt =\n+\nBt\nBs\ns=1\nis a martingale (i.e. Et\nQ Gˆt+1 = Gˆt) from the definition of risk-neutral measure in\nlecture notes\n\"\n#\nT\nPt = EQ\nX Bt Du\nt\nBu\nu=t+1\nThat is the reason why the risk-neutral measure is also called the \"equivalent martingale\nmeasure\" (EMM).\n3. Consider the following model of interest rates. Under the physical probability measure\nP, the short-term interest rate is exp(rt), where rt follows\ndrt = -θ(rt - r) dt + σrdZt,\nwhere Zt is a Brownian motion.\nAssume that the SPD is given by\nt\nt\nπt = exp -\nru + 2 η2 du -\nηu dZu\nu\n\nwhere ηt is stochastic, and follows\ndηt = -κ(ηt - η) dt + ση dZη\nt\nwhere Zt\nη is a Brownian motion independent of Zt.\n(a) Derive the dynamics of the interest rate under the risk-neutral probability Q.\n(b) Compute the spot interest rates for all maturities. (Hint: look for bond prices in\nthe form P (t, T ) = exp(a(T - t) + b(T - t)rt + c(T - t)ηt)).\n(c) Compute the instantaneous expected rate of return on a zero-coupon bond with\ntime to maturity τ.\n(d) Show that the slope of the term structure of interest rates predicts the excess\nreturns on long-term bonds. Discuss the intuition. Show that more volatility in\nthe price of risk, η, means more predictability in bond returns.\n4. Suppose that uncertainty in the model is described by two independent Brownian\nmotions, Z1,t and Z2,t. Assume that there exists one risky asset, paying no dividends,\nfollowing the process\ndSt = μ(Xt) dt + σ dZ1,t\nSt\nwhere\ndXt = -θXt dt + dZ2,t\nThe risk-free interest rate is constant at r.\n(a) What is the price of risk of the Brownian motion Z1,t?\n(b) Give an example of a valid SPD in this model.\n(c) Suppose that the price of risk of the second Brownian motion, Z2,t, is zero. Char\nacterize the SPD in this model.\n(d) Derive the price of a European Call option on the risky asset in this model, with\nmaturity T and strike price K.\n5. Consider a European call option on a stock. The stock pays no dividends and the stock\nprice follows an Ito process. Is it possible that, while the stock price declines between\nt1 and t2 > t1, the price of the Call increases? Justify your answer.\n6. Suppose that the stock price St follows a Geometric Brownian motion with parameters\nμ and σ. Compute\n\nE0 (ST )λ .\n\n7. Suppose that, under P, the price of a stock paying no dividends follows\ndSt = μ(St) dt + σ(St) dZt\nSt\nAssume that the SPD in this market satisfies\ndπt = -r dt - ηtdZt\nπt\n(a) How does ηt relate to r, μt, and σt?\n(b) Suppose that there exists a derivative asset with price C(t, St). Derive the instan\ntaneous expected return on this derivative as a function of t and St.\n(c) Derive the PDE on the price of the derivative C(t, S), assuming that its payoff is\ngiven by H(ST ) at time T .\n(d) Suppose that there is another derivative trading, with a price D(t, St) which\ndoes not satisfy the PDE you have derived above. Construct a trading strategy\ngenerating arbitrage profits using this derivative, the risk-free asset and the stock.\n8. Consider a futures contract with price changing according to\nFt+1 = Ft + λ + μt + σF εt,\nμt+1 = ρμt + σμut\nwhere εt and ut are independent IID N (0, 1) random variables. Assume that the\ninterest rate is constant at r. Your objective is to construct an optimal strategy of\ntrading futures between t = 0 and T to maximize the terminal objective\nE -e-αWT\nwhere WT is the terminal value of the portfolio. Assume the initial portfolio value of\nW0.\n(a) Formulate the problem as a dynamic program. Describe the state vector, verify\nthat it follows a controlled Markov process.\n(b) Derive the value function at T and T - 1 and optimal trading strategy at T - 1\nand T - 2.\n9. Suppose you can trade two assets, a risk-free bond with interest rate r and a risky\nstock, paying no dividends, with price St. Assume St+1 = St × exp(μ + σεt) where εt\nare IID N (0, 1) random variables.\nAssume that whenever you buy the stock you must pay transaction costs, but you can\nsell stock without costs. Specifically, when you buy X dollars worth of stock, you must\n\npay (1 + τ)X, so the fee is proportional, given by τ. Your objective is to figure out\nhow to trade optimally to maximize the objective\nE -e-αWT\nwhere WT is the terminal value of the portfolio.\n(a) What should be the state vector for this problem? Formulate the problem as\na dynamic program, verify the assumptions on the state vector and the payoff\nfunction.\n(b) Write down the Bellman equation.\n10. Suppose we observe returns on N independent trading strategies, rt\nn , n = 1, 2, t =\n1, ..., T . Assume that returns are IID over time, and each strategy has normal distri\nbution:\nn\nr ∼N (μn, σ2)\nt\nAssume μ1 > μ2.\n(a) Estimate the mean return on each strategy by maximum likelihood. Express μbn\nas a function of observed returns on strategy n.\n(b) Since returns are normally distributed, μbn is also normally distributed. Describe\nits distribution. (In general, for arbitrary return distribution, μbn is only approxi\nmately normal).\n(c) What is the distribution of maxn(μbn)? characterize it using the CDF function.\n(d) Suppose you are interested in identifying the strategy with the higher mean return.\nYou pick the strategy with the higher estimated mean. What is the probability\nthat you have made a mistake?\n11. Suppose interest rate follows an AR(1) process\nrt - r = θ(rt-1 - r) + εt\nwhere εt are IID N (0, σ2) random variables. You want to estimate the average rate, r,\nbased on the sample rt, t = 0, 1, ..., T . Assume that we know the true value of θ.\n(a) Derive the estimate of r by maximum likelihood.\n(b) Show that this estimate is valid even if the shocks εt are not normally distributed,\nas long as the mean of εt is zero.\n(c) Treating εt as IID, derive the asymptotic variance of your estimator of r. Do\nnot use Newey-West, derive the result from first principles. How does the answer\ndepend on θ?\n\n12. Suppose you observe two time series, Xt and Yt. You have a model for Yt:\nYt+1 = ρYt + (a0 + a1Xt) εt+1, t = 0, 1, ..., T\nwhere εt+1 ∼N (0, 1), IID. Assume that the shocks εt are independent of the process\nXt and the lagged values of Yt. There is no model for Xt.\n(a) Using the GMM framework, which moment condition can be used to estimate ρ?\n(b) Argue why it is valid to estimate ρ using an OLS regression of Yt+1 on Yt.\n(c) Suppose that the variance of the estimator ρb is (1/T )σρ\n2 . Describe how you would\ntest the hypothesis that ρ = 0.\n(d) Write down the conditional log-likelihood function L(ρ, a0, a1).\n(e) Suppose that the parameters a0 and a1 are known. Derive the maximum-likelihood\nestimate for ρ.\n13. Suppose we observe a sequence of IID random variables Xt ≥ 0, t = 1, ..., T , with\nprobability density\npdf(X) = λe-λX ,\nX ≥ 0\n(a) Write down the log-likelihood function L(λ).\n(b) Compute the maximum likelihood estimate bλ.\n(c) Derive the standard error for bλ.\n14. Suppose you observe a series of observations Xt, t = 1, ..., T . You need to fit a model\nXt+1 = f(Xt, Xt-1; θ) + εt+1\nwhere E[εt+1|Xt, Xt-1, ..., X1] = 0. Innovations εt+1 have zero mean conditionally on\nXt, Xt-1,...,X1. You also know that innovations εt+1 have constant conditional vari\nance:\nE[ε2\nt+1|Xt, Xt-1, ..., X1] = σ2\nThe parameter σ is not known. θ is the scalar parameter affecting the shape of the\nfunction f(Xt, Xt-1; θ).\n(a) Describe how to estimate the parameter θ using the quasi maximum likelihood\napproach. Derive the relevant equations.\n(b) Describe in detail how to use parametric bootstrap to estimate a 95% confidence\ninterval for θ.\n(c) Describe how to estimate the bias in your estimate of θ using parametric boot\nstrap.\n\n(d) Derive the asymptotic standard error for θb (large T ) using GMM standard error\nformulas.\n15. Consider an estimator θb for a scalar-valued parameter θ. Suppose you know, as a\nfunction of the true parameter value θ0, the distribution function of the estimator, i.e.,\nyou know\nCDFθb-θ0 (x)\n(In practice, you may be able to estimate the above CDF using bootstrap). Note that\nthis CDF does not depend on model parameters.\nBased on the definition of the confidence interval, derive a formula for a confidence\ninterval which covers the true parameter value with probability 95%.\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\n\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_handout01.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/5f3897c31fcee91702b8aef2d4db2ff4_MIT15_450F10_handout01.pdf",
      "content": "M.I.T.\n15.450-Spring 2010\nSloan School of Management\nProfessor Leonid Kogan\nHandout: Crossing Probabilities of the Brownian Motion\nConsider the process Xt, dXt = σdZt. Assume that X0 = 0. We want to compute the\nprobability that Xt reaches a > 0 before reaching -b < 0. Let f(Xt) denote such probability,\nconditional on the starting value Xt at time t. Note that f does not depend on time explicitly.\nBy definition of f(Xt) as the probability of hitting the upper boundary first,\nf(Xt) = Et[f(Xt+dt)]\nand therefore f(X) satisfies the Kolmogorov backward equation\n∂2f\nσ2\n= 0\n∂X2\nNote that there are no other terms in this equation, since f does not depend on time explicitly,\nand Xt has zero drift. The equation f 00(X) = 0 has a general solution\nf(X) = A(x + b)\nNote that in addition to solving the PDE, function f(X) must satisfy the boundary\nconditions\nf(a) = 1,\nf(-b) = 0\nThese conditions follow from the definition of f as the probability of reaching the upper\nboundary first. With these boundary conditions, we find\nx + b\nf(X) = a + b\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms ."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_handout02.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/ab2510b021bee94c384057c138c343d4_MIT15_450F10_handout02.pdf",
      "content": "Key Points: Derivatives\nLeonid Kogan\nMIT, Sloan\n15.450, Fall 2010\nc\nLeonid Kogan ( MIT, Sloan )\nKey Points: Derivatives\n15.450, Fall 2010\n1 / 1\n\n\"\n#\n\"\n#\nDiscrete Models\nDefinitions of SPD (π) and risk-neutral probability (Q).\nAbsence of arbitrage is equivalent to existence of the SPD or a\nrisk-neutral probability:\nT\nT\nPt = EP\nt\nX π\nπ\nu\nt\nDu = EQ\nt\nX\nB\nB\nu\nt Du\nu=t+1\nu=t+1\nPrice of risk: under Gaussian P and Q distributions,\nεQ = εP + ηt\nt\nt\nLog-normal model (discrete version of Black-Scholes):\nμt - rt = σt ηt\nc\nLeonid Kogan ( MIT, Sloan )\nKey Points: Derivatives\n15.450, Fall 2010\n3 / 1\n\nStochastic Calculus\nBrownian motion, basic properties (IID Gaussian increments,\ncontinuous trajectories, nowhere differentiable).\nQuadratic variation. [Z ]T = T . Heuristically,\n(dZt )2 = dt.\nStochastic integral.\nIto's lemma:\ndf (t, Xt ) = ∂f (t, Xt ) dt + ∂f (t, Xt ) dXt + 1 ∂2f (t, Xt ) (dXt )2\n∂t\n∂Xt\n∂Xt\nMultivariate Ito's lemma.\n∂f\n∂f\n∂f\ndf (t, Xt , Yt ) =\ndt +\ndXt +\ndYt +\n∂t\n∂Xt\n∂Yt\n1 ∂2f\n1 ∂2f\n∂2f\n(dXt )2 +\n(dYt )2 +\ndXt dYt\n2 ∂Xt\n2 ∂Yt\n∂Xt ∂Yt\nc\nLeonid Kogan ( MIT, Sloan )\nKey Points: Derivatives\n15.450, Fall 2010\n4 / 1\n\nBlack-Scholes Model\nArbitrage-free pricing of options by replication.\nEuropean option with payoff H(ST ).\nReplicating portfolio delta is\n∂f (t, St )\nθt =\n∂St\n∂f (t, S)\n∂f (t, S)\n1 σ2S2 ∂2f (t, S)\n-r f (t, S) +\n+ rS\n+\n= 0\n∂t\n∂S\n∂S2\nwith the boundary condition f (T , S) = H(S).\nc\nLeonid Kogan ( MIT, Sloan )\nKey Points: Derivatives\n15.450, Fall 2010\n5 / 1\n\nPricing by Replication: Limitations\nIn many models cannot derive a unique price for a derivative.\nTerm structure models, stochastic volatility.\nPrice assets relative to each other. Replication argument combined\nwith assumptions on prices of risk.\nAlternatively, specify dynamics directly under Q.\nc\nLeonid Kogan ( MIT, Sloan )\nKey Points: Derivatives\n15.450, Fall 2010\n6 / 1\n\nRisk-Neutral Pricing\nGeneral pricing formula\n\nZ T\n\n= EQ exp -\nrs ds\nPt\nt\nHT\nt\nNeed to specify dynamics of the underlying under Q.\nIf underlying is a stock, only one way to do this: set expected return to\nr .\nQ dynamics is related to P through price of risk\ndZt\nP = -ηt dt + dZt\nQ\nRisk premium\nEP\nt\ndSt - rt dt = EP\nt\ndSt - EQ\nt\ndSt\nSt\nSt\nSt\nc\nLeonid Kogan ( MIT, Sloan )\nKey Points: Derivatives\n15.450, Fall 2010\n7 / 1\n\nRisk-Neutral Pricing and PDEs\nDerive a PDE on derivative prices using Ito's lemma.\nOne-factor term structure model\nEt [df (t, rt )] = rtf (t, rt ) dt\nVasicek model:\ndrt = -κ(rt - r ) dt + σ dZt\nQ\nf (t, rt ) must satisfy the PDE\n∂f (t, r ) - κ(r - r ) ∂f (t, r ) + 1 σ2 ∂2f (t, r) = rf (t, r )\n∂t\n∂r\n∂r 2\nwith the boundary condition\nf (T , r ) = 1\nExpected bond returns satisfy\ndP(t, T )\nEt\nP(t, T )\n= (rt + σP\nt ηt ) dt\nc\nLeonid Kogan ( MIT, Sloan )\nKey Points: Derivatives\n15.450, Fall 2010\n8 / 1\n\nMonte Carlo Simulation\nRandom number generation: inverse transform, acceptance-rejection\nmethod.\nVariance reduction: antithetic variates, control variates.\nIntuition behind control variates: carve out the part of the estimated\nmoment that is known in closed form, no need to estimate that by\nMonte Carlo.\nGood control variates: highly correlated with the variable of interest,\nexpectation known in closed form.\nExamples of control variates: stock price, payoff of similar option, etc.\nc\nLeonid Kogan ( MIT, Sloan )\nKey Points: Derivatives\n15.450, Fall 2010\n9 / 1\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms ."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_handout03.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/cf1324b59f64e482761348947a1a97da_MIT15_450F10_handout03.pdf",
      "content": "M.I.T.\n15.450-Fall 2010\nSloan School of Management\nProfessor Leonid Kogan\nDynamic Programming: Justification of the Principle of\nOptimality\nThis handout adds more details to the lecture notes on the Principle of Optimality. As\nin the notes, we are dealing with the case of IID return distribution.\nRecall that the portfolio policy φt is a flexible function of the entire observed history up\nto time t. We suppress this dependence in our notation. We will use notation\nEt(U(WT )|φt,...,T -1)\nto denote the time-t conditional expectation of terminal utility under the portfolio policy\n(φt, φt+1, ..., φT -1).\nRecall the definition of the value function\nEt U(WT )|(t)φ?\n= J(t, Wt)\n(1)\nt,...,T -1\nWe assume it has been established that at t, t + 1, ..., T , the value function depends only\non W , and we verify below that the same is true at t - 1.\nBy Law of Iterated Expectations, for any portfolio policy φt-1,...,T -1,\nEt-1 [U(WT )|φt-1,...,T -1] = Et-1 [Et [U(WT )|φt,...,T -1]|φt-1]\n(2)\nThe expected utility achieved by any portfolio policy cannot exceed the expected utility\nunder the optimal policy, and therefore\nEt [U(WT )|φt,...,T -1] ≤ Et U(WT )|(t)φ?\n= J(t, Wt)\n(3)\nt,...,T -1\nfor any policy φt-1,...,T -1. We have used the definition of the value function in the last\nequality above.\nSubstitute the upper bound from (3) into the right hand side of (2). We are replacing\nEt [U(WT )|φt,...,T -1] with something at least as large, J(t, Wt), to obtain an inequality:\nEt-1 [U(WT )|φt-1,...,T -1] ≤ Et-1 [J(t, Wt)|φt-1] ,\n(4)\n\nh\ni\nh\ni\n\nh\ni\nh\ni\nNow, maximize the right hand side of (4) with respect to φt-1. This clearly produces a\nvalid upper bound on expected utility:\nEt-1 [U(WT ) φt-1,...,T -1] ≤ Et-1 [J(t, Wt) φt-1] ≤ max Et-1 J(t, Wt) φt-1\n(5)\n|\n|\nφet-1\n|e\nLet's denote the optimal choice of φet-1 in (5) by J φ?\nt-1:\nmax\nJ(t, Wt) e\n= Et-1 J(t, Wt) J φ?\nφet-1\nEt-1\n|φt-1\n|\nt-1\nThe upper bound on the expected terminal utility in (5) is achievable. Consider the policy\n(J)φ?\nt-1, (t)φt\n? , ..., (t)φ?\nT -1.\nUnder this policy, according to (5),\n\nIterated Expectations\nEt-1 U(WT )|(J)φt\n?\n-1, (t)φ?\nt , ...,(t) φT\n?\n-1\n=\n\n(1)\n\n(5)\nEt-1 Et U(WT )|(t)φt\n? , ...,(t) φT\n?\n-1 |(J)φt\n?\n-1\n= Et-1 J(t, Wt)|(J)φt\n?\n-1\n≥\nEt-1 [U(WT )|φt-1,...,T -1] ,\n∀φt-1,...,T -1\n(6)\nAgain, we have used the definition of the value function.\nThus, we have shown that the policy\n(J)φ?\nt-1, (t)φ?\nt , ..., (t)φ?\nT -1\nis optimal at time t - 1, and it generates the time-(t - 1) value function, which equals\nJ(t - 1, Wt-1) = max Et-1 J(t, Wt) φet-1\nφet-1\n|\nThe above equation is the Bellman equation. Moreover, by inspecting the optimal policy,\nwe see that\n(t-1)φ?\ns = (t) φs\n? ,\ns = t, t + 1, ..., T - 1\nand\n(t-1)φ?\nt-1 =(J) φt\n?\n-1 = arg max Et-1 J(t, Wt) φet-1\nφet-1\n|\nThe optimal portfolio policy is time-consistent, and can be computed from the Bellman\nequation.\n\nh\ni\nh\ni\nNote that, as a part of our argument, we have shown that the value function indeed\ndepends only on time and portfolio value:\nJ(t - 1, Wt-1) = max\nJ(t, Wt) e\nφet-1\nEt-1\n|φt-1\nThe above equality is meaningful because returns are IID, and therefore maxφet-1 Et-1 J(t, Wt)|φet-1\ndepends on the past history only through Wt-1. A related important implication is that the\noptimal control policy, φ?\nt-1, also depends on the past history only through Wt-1. We call\nsuch φ? a feedback control policy.\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\n\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_handout04.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/61aa22bf83cfa1059fc8a7546eb4b3d8_MIT15_450F10_handout04.pdf",
      "content": "M.I.T.\n15.450-Fall 2010\nSloan School of Management\nProfessor Leonid Kogan\nExamples of Dynamic Programming Problems\nProblem 1 A given quantity X of a single resource is to be allocated optimally among N\nproduction processes. Each process produces an output of the same good in the amount √x,\nwhere x is the amount of input (x has to be nonnegative). Use dynamic programming to\ndetermine the allocation of the resource x∗\nn, n = 1, . . . , N, among the production processes\nthat maximizes the aggregate output.\n1. Enumerate the production processes 1 to n. Suppose that certain amount of the resource\nhas been already allocated among the first n-1 processes. Let the remaining amount be\nXn. Let Jn(Xn) be the aggregate output of the remaining N - n production processes,\ngiven that the input Xn is distributed optimally among them. Show by induction that\nthe value function Jn(Xn) has the form Jn(Xn) = cn\n√Xn. Calculate the constants cn\nfor n = 1, . . . , N.\n2. Use the fact that X1 = X to find xn\n∗ , n = 1, . . . , N, and the optimal aggregate output\nJ1\n∗.\nProblem 2 Consider the following dynamic investment problem. The market consists of\ntwo assets: the riskless asset and the risky asset. Both assets are traded periodically at time\nperiods t = 0, 1, . . . , T . The net simple return over a single holding period on the riskless\nasset is denoted by Rft (e.g., Rft = 5%), while the net simple return on the risky asset is\ndenoted by Rt. It is assumed that the distribution of the returns on the risky asset is given\nby\nRt = μ + σt,\nwhere t, t = 0, 1, . . . , T - 1 are independently and identically distributed standard normal\nrandom variables, i.e., t ∼N (0, 1).\nInvestor seeks to maximize the expected utility of wealth at time T . Her utility function\nis exponential: U(x) = -e-γx . The initial wealth is denoted by W0. There are no constraints\non short-sales and borrowing and there are no transactions costs.\n1. Let the control variable be xt - the amount of wealth invested in the risky asset at time\nt. Express the wealth Wt+1 at time t + 1 as a function of the wealth Wt at time t and\nxt.\n2. Let Jt(Wt) denote the value function (the indirect utility function) of wealth Wt at time\nt. Show using induction that the value function has the functional form\nJt(x) = -ate-btx .\n\nq\n∗\nx ,\nt\nShow that the optimal amount of wealth allocated into the risky asset,\ndoes not\ndepend on the current level of wealth Wt.\n∗\nt , t =\n3. Find a recursive relation for at and bt. What is the optimal investment strategy x\n0, 1, . . . , T - 1? How does it depend on the risk-aversion parameter γ, the mean and\nthe variance of the returns on the risky asset and on the investment horizon T - t?\nSolution of Problem 1\n1. When n = N, all the remaining resource XN should be allocated into a single remaining\nproduction process N, i.e.,\np\nJN (XN ) =\nXN .\nThus, cN = 1.\nLet's assume that for n ≥ k + 1, Jn(Xn) = cn\n√Xn. Note that Xk+1 = Xk - xk.\nTherefore, according to the Bellman optimality principle,\nJk(Xk) = max (√xk + Jk+1(Xk - xk)) , s.t. xk ≤ Xk.\n(1)\nxk\n∗\nk can be found from the first-order condition\nThe solution of this problem x\nck+1\np\n+ p\n= 0.\n(2)\nx ∗\nk\n2 Xk - x∗\nk\nFrom (2) we find that\n∗\nxk(Xk) =\nXk\n.\n1 + ck\n+1\n(3)\n∗\nThen, according to (1),\nq\np\nJk(Xk) =\n1 + ck\n+1\nXk.\nThus, ck =\n1 + c2\nk+1 and we conclude the induction argument.\nIn order to find all constants\nexplicitly, note that\n= 1 and c2 = 1 + c2\nTherefore, c = N - n + 1 and\nc\nc\nn\nn =\n√\nN - n + 1.\ncN\nn\nn+1.\nn\nn - x\n∗\n∗\n∗\n2. Using the relation X\n= X\n(X ) and 3, we conclude that\nn+1\nn\nn\nN - n\nc n+1\n∗\n=\n∗\nn\n∗\nX\nX\nX\n=\n.\nn+1\nn\n1 + c\nN - n + 1\nn+1\nSince X ∗\n1 = X,\nN - 1 N - 2\nN - n + 1 X = N - n + 1\n∗\nX\nX.\n=\nN\nN - 1 · · · N - n + 2\nN\nn\n\nWe use (3) again to conclude that\nx∗ =\nN - k + 1 X = X .\nn\n1 + N - k\nN\nN\nThus, the resource has to be allocated evenly among all N production processes. Also\nJ1\n∗ = c1\np\nX1\n∗ =\n√\nN\n√\nX.\nSolution of Problem 2\nLet Zt denote the excess return on the risky asset, i.e.,\nZt = Rt - Rft.\n1. If xt is the amount of wealth allocated into the risky asset, Wt - xt must be allocated\ninto the riskless asset. Then\nWt+1 = xt(1 + Rt) + (Wt - xt)(1 + Rft) = Wt(1 + Rft) + xtZt.\n(4)\n2. When t = T , JT = -e-γWT . Thus, aT = 1 and bt = γ.\nLet's assume that for n ≥ t + 1, Jn(Wn) = -ane-bnWn . Then, according to the Bellman\noptimality principle and (4),\nJt(Wt) = max E [-at exp(-btWt(1 + Rft) - btxtZt)] .\nxt\nNext, note that\nE [exp(-btxtZt)] = E [exp(-btxt(μ - Rft + σt))] = exp -btxt(μ - Rft) + 2\n1 σ2b2\nt xt\n2 .\nThus,\n\nJt(Wt) = max E -at exp -btWt(1 + Rft) - btxt(μ - Rft) + σ2b2 x\n.\nxt\nt\nt\nThe first-order condition for the maximization problem is equivalent to\n-bt(μ - Rft) + σ2b2 x∗ = 0,\nt\nt\nwhich implies that\nx∗\nt (Wt) = μ\nσ\n-\n2b\nR\nt\nft .\n(5)\nThus, the optimal amount of wealth allocated into the risky asset x∗\nt does not depend\non the current level of wealth Wt.\nWe find that\nJt(Wt\n∗) = -at exp -btWt\n∗(1 + Rft) - 1 (μ - Rft)2\n,\n(6)\nσ2\nwhich concludes the step of induction.\n\n3. From (6) we observe that\n1 (μ - Rft)2\nat = at+1 exp\n,\nbt = bt+1(1 + Rft).\n-2\nσ2\nWe can solve these recursive equations using the terminal conditions\naT = 1,\nbT = γ\nto obtain\n\nT - t (μ - Rft)2\nat = γ exp - 2\nσ2\n,\nbt = (1 + Rft)T -t .\nWe now combine this with (5) to obtain\nx∗\nt = 1 μ -\nσ2\nRft (1 + Rft)-(T -t).\nγ\nFrom this we conclude that x∗\nt is higher when the risk-aversion parameter γ is lower; it\nincreases linearly with the mean excess return on the riskless asset and it is inversely\nproportional to the variance of the returns; it is lower for longer investment horizons\nT - t.\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms."
    },
    {
      "category": "Lecture Notes",
      "title": "MIT15_450F10_lec01.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/219406be97b96bc540e0be6aa778c0b7_MIT15_450F10_lec01.pdf",
      "content": "Introduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nArbitrage-Free Pricing Models\nLeonid Kogan\nMIT, Sloan\n15.450, Fall 2010\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n1 / 48\nc\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nOutline\n1 Introduction\n2 Arbitrage and SPD\n3 Factor Pricing Models\n4 Risk-Neutral Pricing\n5 Option Pricing\n6 Futures\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n2 / 48\n\nP\nP\nHH\nH\n\nP\n\nHH\nH\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nOption Pricing by Replication\nThe original approach to option pricing, going back to Black, Scholes, and\nMerton, is to use a replication argument together with the Law of One Price.\nConsider a binomial model for the stock price\nPayoff of any option on the stock can be replicated by dynamic trading in the\nstock and the bond, thus there is a unique arbitrage-free option valuation.\nProblem solved?\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n4 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nDrawbacks of the Binomial Model\nThe binomial model (and its variants) has a few issues.\nIf the binomial depiction of market dynamics was accurate, all options would\nbe redundant instruments. Is that realistic?\nEmpirically, the model has problems: one should be able to replicate option\npayoffs perfectly in theory, that does not happen in reality.\nWhy build models like the binomial model? Convenience. Unique option price\nby replication is a very appealing feature.\nHow can one make the model more realistic, taking into account lack of\nperfect replication?\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n5 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nArbitrage and Option Pricing\n\nSTOCK\nBOND\nARBITRAGE\nARGUMENT\nOPTION\nPRICE\nPRICING REDUNDANT OPTIONS\nARBITRAGE‐\nFREE MODEL:\n- STOCK\n- BOND\n- OPTION\nEMPIRICAL\nESTIMATION\nPRICING NON‐REDUNDANT OPTIONS\nOPTION\nPRICE\n\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n6 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nArbitrage and Option Pricing\nTake an alternative approach to option pricing.\nEven when options cannot be replicated (options are not redundant), there\nshould be no arbitrage in the market.\nThe problem with non-redundant options is that there may be more than one\nvalue of the option price today consistent with no arbitrage.\nChange the objective: construct a tractable joint model of the primitive assets\n(stock, bond, etc.) and the options, which is\nFree of arbitrage;\nConforms to empirical observations.\nWhen options are redundant, no need to look at option price data: there is a\nunique option price consistent with no arbitrage.\nWhen options are non-redundant, there may be many arbitrage-free option\nprices at each point in time, so we need to rely on historical option price data\nto help select among them.\nWe know how to estimate dynamic models (MLE, QMLE, etc.). Need to learn\nhow to build tractable arbitrage-free models.\nc\nArbitrage-Free Pricing Models\n7 / 48\nLeonid Kogan ( MIT, Sloan )\n15.450, Fall 2010\n\nHHHH\nH\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nAbsence of Arbitrage\nConsider a finite-horizon discrete-time economy, time = {0, ..., T }.\nAssume a finite number of possible states of nature, s = 1, ..., N\nt = 0\nt = 1\nt = 2\n��\ns1\n�\nPP�\ns2\ns3\nHHH� �\ns4\nDefinition (Arbitrage)\nArbitrage is a feasible cash flow (generated by a trading strategy) which is\nnon-negative in every state and positive with non-zero probability.\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n9 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nAbsence of Arbitrage\nDefinition (Arbitrage)\nArbitrage is a feasible cash flow (generated by a trading strategy) which is\nnon-negative in every state and positive with non-zero probability.\nWe often describe arbitrage as a strategy with no initial investment, no risk of\na loss, and positive expected profit. It's a special case of the above definition.\nAbsence of arbitrage implies the Law of One Price: two assets with the same\npayoff must have the same market price.\nAbsence of arbitrage may be a very weak requirement in some settings and\nquite strong in others:\nEquities: few securities, many states. Easy to avoid arbitrage.\nFixed income: many securities, few states. Not easy to avoid arbitrage.\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n10 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nAbsence of Arbitrage\nFundamental Theorem of Asset Pricing (FTAP)\nProposition (FTAP)\nAbsence of arbitrage is equivalent to existence of a positive stochastic process\n{πt (s) > 0} such that for any asset with price Pt (PT = 0) and cash flow Dt ,\nPt (s) = Et\n\"\nT\nX\nu=t+1\nπu (s)\nπt (s) Du(s)\n#\nor, in return form,\nEt\nπt+1(s)\nπt (s) Rt+1(s)\n\n= 1,\nRt+1(s) = Pt+1(s) + Dt+1(s)\nPt (s)\nStochastic process πt (s) is also called the state-price density (SPD).\nFTAP implies the Law of One Price.\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n11 / 48\n\nX\nX\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nAbsence of Arbitrage\nFrom SPD to No Arbitrage\nProve one direction (the easier one): if SPD exists, there can be no arbitrage.\nLet Wt denote the portfolio value, (θ1 , ..., θN ) are holdings of risky assets\n1, ..., N.\nManage the portfolio between t = 0 and t = T .\nAn arbitrage is a strategy such that W0 6 0 while WT > 0, WT =6\n0.\nThe trading strategy is self-financing if it does not generate any cash in- or\nout-flows except for time 0 and T .\nFormal self-financing condition\nWt+1 =\nθt\ni\n+1Pt\ni\n+1 =\nθt\ni (Pt\ni\n+1 + Dt\ni\n+1)\ni\ni\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n12 / 48\n\nX\nX\n\"\n#\nX\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nAbsence of Arbitrage\nFrom SPD to No Arbitrage\nShow that self-financing implies that πtWt = Et [πt+1Wt+1]:\nself financing\nEt [πt+1Wt+1] = Et [πt+1\nθt\ni\n+1Pt\ni\n+1]\n=\nEt πt+1\nθt\ni (Pt\ni\n+1 + Dt\ni\n+1)\ni\ni\nFTAP\n=\nθt\ni πtPt\ni = πtWt\ni\nStart at 0 and iterate forward\nπ0W0 = E0[π1W1] = E0[E1[π2W2]]\n= E0[π2W2] = ...\n= E0[πT WT ]\nGiven that the SPD is positive, it is impossible to have W0 6 0 while WT > 0,\nWT = 0. Thus, there can be no arbitrage.\nc\nArbitrage-Free Pricing Models\n13 / 48\nLeonid Kogan ( MIT, Sloan )\n15.450, Fall 2010\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nAbsence of Arbitrage\nFundamental Theorem of Asset Pricing (FTAP)\nWhen there exists a full set of state-contingent claims (markets are\ncomplete), there is a unique SPD consistent with absence of arbitrage:\nπt (s) is the price of a state-contingent claim paying $1 in state s at time t,\nnormalized by the probability of that state, pt .\nThe reverse is also true: if there exists only one SPD, all options are\nredundant.\nWhen there are fewer assets than states of nature, there can be many SPDs\nconsistent with no arbitrage.\nFTAP says that if there is no arbitrage, there must be at least one way to\nintroduce a consistent system of positive state prices.\nWe drop explicit state-dependence and write πt instead of πt (s).\nc\nArbitrage-Free Pricing Models\n14 / 48\nLeonid Kogan ( MIT, Sloan )\n15.450, Fall 2010\n\nHHHHH\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nExample: Binomial Tree\nSPD\nOptions are redundant: any payoff can\nbe replicated by dynamic trading.\nFTAP implies that\np πt+1(u)(1 + r) + (1 - p) πt+1(d)(1 + r)\n=\nSt+1 = uS , πt+1(u)\nπt\nπt\np\nπt+1(u)\nπt+1(d)\np\nu + (1 - p)\nd\n=\n1 St , πt\nπt\nπt\n(1 - p)\nSPD is unique up to normalization\nSt+1 = dS , πt+1(d)\nπ0 = 1:\nπt+1(u)\n1 + r - d\n=\nπt\np(1 + r)\nu - d\nπt+1(d)\n=\nu - (1 + r)\nπt\n(1 - p)(1 + r)\nu - d\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n15 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nArbitrage-Free Models using SPD\nDiscounted Cash Flow Model (DCF)\nAlgorithm: A DCF Model\n1 Specify the process for cash flows, Dt .\n2 Specify the SPD, πt .\n3 Derive the asset price process as\nPt = Et\n\"\nT\nX\nu=t+1\nπu\nπt\nDu\n#\n(DCF)\nTo make this practical, need to learn how to parameterize SPDs in step (2),\nso that step (3) can be performed efficiently.\nCan use discrete-time conditionally Gaussian processes.\nSPDs are closely related to risk-neutral pricing measures. Useful for building\nintuition and for computations.\nc\nArbitrage-Free Pricing Models\n16 / 48\nLeonid Kogan ( MIT, Sloan )\n15.450, Fall 2010\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nSPD and the Risk Premium\nLet Rt+1 be the gross return on a risky asset between t and t + 1:\nπt+1\nEt\nRt+1 = 1\nπt\nEt\nπt+1 (1 + rt )\n= 1\nπt\nUsing the definition of covariance,\nConditional Risk Premium and SPD Beta\nRisk Premiumt ≡ Et [Rt+1] - (1 + rt ) = -(1 + rt )Covt\n\nRt+1, πt+1\nπt\n\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n18 / 48\n\nh\ni\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nSPD and CAPM\nCAPM says that risk premia on all stocks must be proportional to their market\nbetas.\nCAPM can be re-interpreted as a statement about the SPD pricing all assets.\nAssume that\nπt+1/πt = a - bRt\nM\n+1\nwhere RM is the return on the market portfolio. (The above formula may be\nviewed as approximation, if it implies negative values of π).\nUsing the general formula for the risk premium, for any stock j,\nEt Rt\nj\n+1 -(1 + rt ) = const × Covt (Rt\nj\n+1, Rt\nM\n+1)\nThe above formula works for any asset, including the market return. Use this\nto find the constant:\nh\ni\n\nCovt (Rt\nj\n+1, Rt\nM\n+1)\nEt Rt\nj\n+1 -(1 + rt ) = Et Rt\nM\n+1 -(1 + rt )\nVart (Rt\nM\n+1)\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n19 / 48\n\nX\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nSPD and Multi-Factor Models\nAlternative theories (e.g., APT), imply that there are multiple priced factors in\nreturns, not just the market factor.\nMulti-factor models are commonly used to describe the cross-section of stock\nreturns (e.g., the Fama-French 3-factor model).\nAssume that\nπt+1/πt = a + b1Ft\n+1 + ...bK Ft\nK\n+1\nwhere F k , k = 1, ..., K are K factors. Factors may be portfolio returns, or\nnon-return variables (e.g., macro shocks).\nThen risk premia on all stocks have factor structure\nh\ni\nK\n\nEt Rt\nj\n+1 -(1 + rt ) =\nλk Covt Rt\nj\n+1, Ft\nk\n+1\nk=1\nFactor models are simply statements about the factor structure of the SPD.\nc\nArbitrage-Free Pricing Models\n20 / 48\nLeonid Kogan ( MIT, Sloan )\n15.450, Fall 2010\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nSPDs and Risk-Neutral Pricing\nOne can build models by specifying the SPD and computing all asset prices.\nIt is typically more convenient to use a related construction, called\nrisk-neutral pricing.\nRisk-neutral pricing is a mathematical construction. It is often convenient and\nadds something to our intuition.\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n22 / 48\n\nY\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nRisk-Neutral Measures\nThe DCF formulation with an SPD is mathematically equivalent to a change\nof measure from the physical probability measure to the risk-neutral\nmeasure. The risk-neutral formulation offers a useful and tractable alternative\nto the DCF model.\nLet P denote the physical probability measure (the one behind empirical\nobservations), and Q denote the risk-neutral measure. Q is a mathematical\nconstruction used for pricing and only indirectly connected to empirical data.\nLet Bt denote the value of the risk-free account:\nt-1\nBt =\n(1 + ru )\nu=0\nwhere ru is the risk-free rate during the period [u, u + 1).\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n23 / 48\n\n\"\n#\n\"\n#\nX\nX\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nRisk-Neutral Measures\nQ is a probability measure under which\n= EP\nT\nπu\n= EQ\nT\nBt\nPt\nt\nDu\nt\nDu ,\nfor any asset with cash flow D\nπt\nBu\nu=t+1\nu=t+1\nUnder Q, the standard DCF formula holds.\nUnder Q, expected returns on all assets are equal to the risk-free rate:\nEQ [Rt+1] = 1 + rt\nt\nIf Q has positive density with respect to P, there is no arbitrage.\nThere may exist multiple risk-neutral measures.\nQ is also called an equivalent martingale measure (EMM).\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n24 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nSPD and Change of Measure\nConstruct risk-neutral probabilities from the SPD.\nConsider our tree-model of the market and let C(νt ) denote the set of\ntime-(t + 1) nodes which are children of node νt .\nDefine numbers q(νt+1) for all nodes νt+1 ∈ C(νt ) by the formula\nq(νt+1) = (1 + rt )q(νt ) π(νt+1)p(νt+1)\nπ(νt )p(νt )\nRecall that the ratio p(νt+1)/p(νt ) is the node-νt conditional probability of\nνt+1.\nq(νt+1) > 0 and\nX\nX\nπ(νt+1)p(νt+1)\nq(νt+1) = q(νt )\n(1 + rt )\nπ(νt )p(νt )\nνt+1∈C(νt )\nνt+1∈C(νt )\n= q(νt )EP\nt\nπ(νt+1)(1 + rt )\n= q(νt )\nπ(νt )\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n25 / 48\n\nX\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nSPD and Change of Measure\nq(νt ) define probabilities. Are these risk-neutral probabilities?\nFor any asset i,\nX\nq(νt+1)\nQ\nRi\nt+1\nRi\nt+1\nE\n=\nt\n1 + rt\nq(νt ) 1 + rt\nνt+1∈C(νt )\n(1 + rt ) π(νt+1)p(νt+1)\nRt\ni\n+1\n=\nπ(νt )p(νt )\n1 + rt\nνt+1∈C(νt )\n=\nX\np\np\n(ν\n(ν\nt+\nt )\n1) π\nπ\n(ν\n(ν\nt+\nt )\n1) Rt\ni\n+1\nνt+1∈C(νt )\nπt+1 Rt\ni\n+1\n= EP\nt\n= 1\nπt\nConclude that q(νt ) define risk-neutral probabilities.\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n26 / 48\n\nHHHHH\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nExample: Binomial Tree\nRisk-Neutral Measure\nFTAP implies that\nSt+1 = uS , πt+1(u)\nq\n1 + r - d\nqu+(1-q)d = 1+rt\nq =\nSt , πt\n⇒\nu - d\nAlternatively, compute transition\n(1 - q)\nprobability under Q using the SPD\nSt+1 = dS , πt+1(d)\nπ:\nq = p(1 + rt ) πt+1(u)\nπt\n1 + rt - d\n1 + rt - d\n= p(1 + rt )\n=\np(1 + rt )\nu - d\nu - d\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n27 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nNormality-Preserving Change of Measure\nResults\nUnder P, εP ∼N(0, 1). Define a new measure Q, such that under Q,\nεP ∼N(-η, 1).\nLet ξ = d\nd\nQ\nP . Then,\nξ(εP) = exp -(εP + η)2\n+ (εP)2\n= exp -ηεP - η2\nThe change of measure is given by a log-normal random variable ξ(εP)\nserving as the density of the new measure.\nNormality-Preserving Change of Measure\ndQ\ndP = e-ηεP-η2/2 ⇒ εQ = εP + η ∼ N(0, 1) under Q\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n28 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nPrice of Risk\nWhen P and Q are both Gaussian, we can define the price of risk (key notion\nin continuous-time models).\nConsider an asset with gross return\nRt+1 = exp μt - σt\n2/2 + σt εP\nt+1 ,\nEt [Rt+1] = exp(μt )\nwhere εP\nt+1 ∼N(0, 1), IID, under the physical P-measure.\nLet the short-term risk-free interest rate be\nexp(rt ) - 1\nLet the SPD be\n\nπt+1 = πt exp -rt - ηt\n2/2 - ηt εP\nt+1\nRecall\nεQ = εP + ηt\nt\nt\nUnder Q, the return distribution becomes\nRt+1 = exp μt - σt\n2/2 - σt ηt + σt εQ\nt+1\nwhere εQ\nt+1 ∼N(0, 1), IID, under the Q-measure.\nc\nArbitrage-Free Pricing Models\n29 / 48\nLeonid Kogan ( MIT, Sloan )\n15.450, Fall 2010\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nPrice of Risk\nUnder Q,\nεQ\nRt+1 = exp μt - σt\n2/2 - σt ηt + σt εQ\nt+1 ,\nt+1 ∼N(0, 1)\nBy definition of the risk-neutral probability measure,\nEQ\nt [Rt+1] = exp(rt )\nμt - σt ηt = rt\n⇒\nThe risk premium (measured using log expected gross returns) equals\nμt - rt = σt ηt\nσt is the quantity of risk,\nηt is the price of risk.\nModels with time-varying price of risk, ηt , exhibit return predictability.\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n30 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nOverview\nAs an example of how risk-neutral pricing is used, we consider the problem of\noption pricing when the underlying asset exhibits stochastic volatility.\nThe benchmark model is the Black-Scholes model.\nStock (underlying) volatility in the B-S model is constant.\nEmpirically, the B-S model is rejected: the implied volatility is not the same for\noptions with different strikes.\nThere are many popular generalizations of the B-S model. We explore the\nmodel with an EGARCH volatility process.\nThe EGARCH model addresses some of the empirical limitations of the B-S\nmodel.\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n32 / 48\n\nh\ni\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nThe Black-Scholes Model\nConsider a stock with price St , no dividends. Assume that\nSt+1\n\n= exp μ - σ2/2 + σεP\nt+1 ,\nSt\nwhere εP\nt+1 ∼N(0, 1), IID, under the physical P-measure.\nAssume that the short-term interest rate is constant.\nAssume that under the Q-measure,\nSt+1\n\n= exp\n/2 + σεQ\nt+1 ,\nt+1 ∼N(0, 1), IID\nr - σ2\nεQ\nSt\nThe time-t price of any European option on the stock, with a payoff\nCT = H(ST ), is given by\n= EQ e-r(T -t)H(ST )\nCt\nt\nThis is an arbitrage-free model. Prices of European call and put options are\ngiven by the Black-Scholes formula.\nc\nArbitrage-Free Pricing Models\n33 / 48\nLeonid Kogan ( MIT, Sloan )\n15.450, Fall 2010\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nImplied Volatility\nThe Black-Scholes model expresses the price of the option as a function of\nthe parameters and the current stock price.\nEuropean Call option price\nC(St , K , r, σ, T )\nImplied volatility σbi of a Call option with strike Ki and time to maturity Ti is\ndefined by\nCi = C(St , Ki , r, σbi , Ti )\nImplied volatility reconciles the observed option price with the B-S formula.\nOption prices are typically quoted in terms of implied volatilities.\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n34 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nImplied Volatility Smile (Smirk)\nIf option prices satisfied the B-S assumptions, all implied volatilities would be\nthe same, equal to σ, the volatility of the underlying price process.\nEmpirically, implied volatilities depend on the strike and time to maturity.\nFIGURE 2. Implied Volatilities of S&P 500 Options on May 5, 1993\n(a)\n(b)\nO\nO\nO\nO\nO\nO\nO\nO\nO\nO\noption strike (% of spot)\n100 102 104\nO\nO\nO\nO\nO\noption expiration (days)\noption implied volatility (%)\noption implied volatility (%)\nSource: E. Derman, I. Kani, 1994, The Volatility Smile and Its Implied Tree, Quantitative Strategies Research Notes, Goldman Sachs\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n35 / 48\n\nr !\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nEGARCH Model\nConsider a model of stock returns with EGARCH volatility process.\nAssume the stock pays no dividends, and short-term interest rate is constant.\nStock returns are conditionally log-normally distributed under the Q-measure\nln S\nS\nt-\nt\n= r - σt\n-1 + σt-1εQ\nt ,\nεQ\nt ∼N(0, 1), IID\nConditional expected gross return on the underlying asset equals exp(r).\nConditional volatility σt follows an EGARCH process under Q\n\nσ2\n\nσ2\nεQ -\nln\nt = a0 + b1 ln\nt-1 + θεQ\nt-1 + γ\nt-1\nπ\nOption prices can be computed using the risk-neutral valuation formula.\nc\nArbitrage-Free Pricing Models\n36 / 48\nLeonid Kogan ( MIT, Sloan )\n15.450, Fall 2010\n\nh\ni\nX\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nOption Valuation by Monte Carlo\nWe use Monte Carlo simulation to compute option prices.\nUsing the valuation formula\n= EQ e-r(T -t)H(ST )\nCt\nt\nCall option price can be estimated by simulating N trajectories of the\nunderlying asset Su\nn , n = 1, ..., N, under Q, and averaging the discounted\npayoff\nCt ≈ N\nN\ne-r (T -t) max(ST\nn - K , 0)\nn=1\nResulting option prices are arbitrage-free because they satisfy the\nrisk-neutral pricing relationship.\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n37 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nSimulation\nUse one-week time steps.\nCalibrate the parameters using the estimates in Day and Lewis (1992, Table\n3)\na0\nb1\nθ\nγ\n-3.620\n0.529\n-0.273\n0.357\nCalibrate the interest rate\nexp(52 × r) = exp(0.05)\nStart all N trajectories with the same initial stock price and the same initial\nvolatility, σ0 = 15.5%/\n√\n52.\nCompute implied volatilities for Call/Put options with different strikes.\nPlot implied volatilities against Black-Scholes deltas of Put options\n(Δt = ∂Pt /∂St ).\nc\nArbitrage-Free Pricing Models\n38 / 48\nLeonid Kogan ( MIT, Sloan )\n15.450, Fall 2010\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nVolatility Smile\n0.2\n0.25\n0.3\n0.35\n0.4\n0.45\n0.5\n0.55\n0.6\n14.5\n15.5\n16.5\n|Option Delta|\nImplied Volatility (%)\n\n12 Weeks\n24 Weeks\n36 Weeks\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n39 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nFutures\nWe want to build an arbitrage-free model of futures prices.\nIn case of deterministic interest rates and costless storage of the underlying\nasset, futures price is the same as the forward price.\nIn most practical situations, storage is not costless, so simple replication\narguments are not sufficient to derive futures prices.\nWant to model futures prices for multiple maturities in an arbitrage-free\nframework.\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n41 / 48\n\n\"\n#\nX\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nRisk-Neutral Pricing\nΦT\nt is the time-t futures price for a contract maturing at T .\nFutures are continuously settled, so the holder of the long position collects\nΦT - ΦT\nt\nt-1\neach period. Continuous settlement reduces the likelihood of default.\nThe market value of the contract is always equal to zero.\nIn the risk-neutral pricing framework\nT\nBt\nQ\nΦT\nu - ΦT\nu-1\nE\n= 0 for all t\nt\nBu\nu=t+1\nWe conclude (using backwards induction and iterated expectations) that the\nfutures prices must satisfy\nEQ\nt ΦT\nt+1 - ΦT\nt\n= 0 for all t\nand thus\nΦT\nt = EQ ΦT\nT = EQ\nt [ST ]\nt\nwhere ST is the spot price at T .\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n42 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nAR(1) Spot Price\nSuppose that the spot price follows an AR(1) process under the P-measure\nSt - S = θ(St-1 - S) + σεP\nt ,\nεP\nt ∼N(0, 1), IID\nAssume that the risk-neutral Q-measure is related to the physical P-measure\nby the state-price density\nπ\nπ\nt+\nt\n1 = exp -rt - η\n- ηεP\nt+1\nMarket price of risk η is constant.\nTo compute futures prices, use εQ\nt = εP\nt + η.\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n43 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nAR(1) Spot Price\nUnder the risk-neutral measure, spot price follows\n\nSt =\nS - ησ\n+ θ St-1 - S - ησ\n+ σεQ\n1 - θ\n1 - θ\nt\nDefine a new constant\nS\nQ ≡ S - ησ\n1 - θ\nThen\n\nSt - S\nQ = θ St-1 - S\nQ\n+ σεQ\nt\nUnder Q, spot price is still AR(1), same mean-reversion rate, but different\nlong-run mean.\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n44 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nAR(1) Spot Price\nTo compute the futures price, iterate the AR(1) process forward\nQ\nQ\nQ\nt+1\nSt+1 - S\n= θ St - S\n+ σε\nQ\nQ + σεQ\nt+2\nSt+2 - S\n= θ St+1 - S\n= θ2 St - S\nQ + σεt+2 + θσε\nQ\nQ\nt+\n. . .\nQ\nQ + σεQ\nt+n + ... + θn-2\nQ\nσεt+2 + θn-1σεQ\nt+1\n= θn\nSt+n - S\nSt - S\nWe conclude that\n[ST ] = S\nQ\n1 - θT -t\nΦT\nt = EQ\nt\n+ θT -tSt\nFutures prices of various maturities given by the above model do not admit\narbitrage.\nc\nArbitrage-Free Pricing Models\n45 / 48\nLeonid Kogan ( MIT, Sloan )\n15.450, Fall 2010\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nExpected Gain on Futures Positions\nWhat is the expected gain on a long position in a futures contract?\nUnder Q, the expected gain is zero:\nEQ\nΦT\nt+1 - ΦT\n= 0 for all t\nt\nt\nFutures contracts provides exposure to risk, εP. This risk is compensated,\nwith the market price of risk η.\nΦT\nt+1 - ΦT\nt = σθT -t-1εQ\nt+1 = ησθT -t-1 + σθT -t-1εP\nt+1\n(Use εQ\nt+1 = η + εP\nt+1)\nUnder P, expected gain is non-zero, because εQ has non-zero mean under P\nEP\nΦT\nt+1 - ΦT\n= ησθT -t-1\nfor all t\nt\nt\nCan estimate model parameters, including η, from historical futures prices.\nc\nArbitrage-Free Pricing Models\n46 / 48\nLeonid Kogan ( MIT, Sloan )\n15.450, Fall 2010\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nSummary\nExistence of SPD or risk-neutral probability measure guarantees absence of\narbitrage.\nFactor pricing models, e.g., CAPM, are models of the SPD.\nCan build consistent models of multiple options by specifying the risk-neutral\ndynamics of the underlying asset.\nBlack-Scholes model, volatility smiles, and stochastic volatility models.\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n47 / 48\n\nIntroduction\nArbitrage and SPD\nFactor Pricing Models\nRisk-Neutral Pricing\nOption Pricing\nFutures\nReadings\nBack 2005, Chapter 1.\nE. Derman, I. Kani, 1994, The Volatility Smile and Its Implied Tree,\nQuantitative Strategies Research Notes, Goldman Sachs.\nT. Day, C. Lewis, 1992, Stock Market Volatility and the Information Content of\nStock Index Options, Journal of Econometrics 52, 267-287.\nc\nLeonid Kogan ( MIT, Sloan )\nArbitrage-Free Pricing Models\n15.450, Fall 2010\n48 / 48\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms ."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_rec01.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/5400591d3f74831b80abc10a288282f6_MIT15_450F10_rec01.pdf",
      "content": "Fundamental Theorem of Asset Pricing\nBrandon Lee\n15.450 Recitation 1\nBrandon Lee\nFundamental Theorem of Asset Pricing\n\noughly speaking, an arbitrage is a possibility of profit at zero\nost.\nften implicit is an assumption that such an arbitrage\npportunity is scalable (can repeat it over and over).\nn this situation, presumably someone with a deep pocket and\nn ability to recognize the arbitrage opportunity (called\nrbitrageur) will exploit the arbitrage and in the course will\nliminate the arbitrage oppportunity in the market.\nrom the point of view of an average investor, all arbitrage\npportunities are already taken up by the arbitrageurs and\nherefore there is\"no arbitrage\".\ne're not saying there cannot be an arbitrage -- arbitrageurs,\nimits to arbitrage, or systemic mispricing.\nowever,\"no arbitrage\"is a very sensible and realistic\nescription of the world we live in. We take\"no arbitrage\"as\nn axiom for the discussion in this class.\nNo Arbitrage\nR\nc\nO\no\nI\na\na\ne\nF\no\nt\nW\nl\nH\nd\na\nBrandon Lee\nFundamental Theorem of Asset Pricing\n\nFundamental Theorem of Asset Pricing\nThe condition of no arbitrage is intuitive and primitive. Yet,\nit's reasonable to imagine that asset prices are determined by\nthe total supply and demand of assets by the entire group of\ninvestors, each of whom has his or her own preferences (this\napproach won't get us far, it's just too difficult to analyze this\neconomy).\nThe breakthrough is the Fundamental Theorem of Asset\nPricing. It allows us to study asset prices without having to\nworry about individual preferences or cross-sectional\ndistribution of investors.\nThe theorem states that the absence of arbitrage is equivalent\nto the existence of a state price density. One implies the other\n-- the implications in both directions are important.\nBrandon Lee\nFundamental Theorem of Asset Pricing\n\nState Price Density\nAnother name for the state price density is stochastic discoun\nfactor.\nRecall straightforward bond pricing from 15.401/15.415.\nB =\nC +\n1+r\nC +...+\n(1+r)\n(C +P)\nT\n(1+r)\nThe terms\nt are (time) discount factors. They do not\n(1+r)\ntake into account risk. The stochastic discount factor (or\nstate price density) is a generalization of the simple discount\nfactor that incorporates both risk and time value of money.\nRoughly speaking, state price density is large in\"bad states\"\nwhere a dollar is more valuable and small in\"good states\"\nwhere a dollar is less valuable.\nA state price density can price any asset (where an asset\nrepresents a stream of stochastic cashflows) (see page 11 of\nLectures Notes 1).\nt\nBrandon Lee\nFundamental Theorem of Asset Pricing\n\nRelated Concepts\nExistence of a state price density is equivalent to existence of\ntwo other objects: state prices and risk neutral probabilities.\nTherefore, by the Fundamental Theorem of Asset Pricing, no\narbitrage is equivalent to existence of any one of the three\nrelated objects: state price density, state prices, or risk neutral\nprobabilities.\nWhy have so many different concepts? Each provides a\ndifferent perspective and insight, but the three concepts, as a\ngroup, are really the same thing!\nIn what follows, to fix the idea and simplify notation, assume\nthe following: we have date 0 and date 1, there are N possible\nstates of nature at date 1, and state i occurs with probability\npi.\nBrandon Lee\nFundamental Theorem of Asset Pricing\n\nState Price Density\nConsider an asset that pays offxi dollars in state i at date 1.\nhe question is what is the value (price) of this asset at date\n.\nsing the SPD π, we calculate it as follows:\nP = E [πx]\nN\n≡∑piπixi\ni=1\nn words, the price is the expected value of payoffs, discounted\ny the state price density.\nT\nU\nI\nb\nBrandon Lee\nFundamental Theorem of Asset Pricing\n\nState Prices\nThe state-contingent security in state i is an asset that pays\noff$1 in state i and 0 in all other states. The price of this\nstate-contingent security is the state price in state i, denoted\nφi.\nState prices refer to the vector of state prices (φ1,...φN).\nUsing the state prices, the price of our asset is\nN\nP = ∑φixi\ni=1\nIntuition: John Cochrane's Happy Meal analogy - The price of\na happy meal is the price of a hamburger plus the price of a\nsoft drink plus the price of fries (and plus the price of a toy).\nBrandon Lee\nFundamental Theorem of Asset Pricing\n\nRisk Neutral Probabilities\nThe actual probabilities are given by (p1,...,pN). Are there a\ndifferent set of probabilities and a risk-free rate such that the\nprice of the asset is given by the expected payoff(under the\nalternative probabilities) at date 1, only discounted by the\nrisk-free rate?\nCall such probabilities (q1,...,qN) and the risk-free rate r.\nThen\nP =\nE Q [x]\n1+r\n≡\ni\n∑\nN\nqix\n+r i=1\nThinking of an asset price as the expected payoffis somewhat\nnaive because it doesn't take into account risk, but it's not\ncompletely wrong! Under the alternative probabilities Q, this\nis actually correct (hence the name risk neutral probabilities).\nBrandon Lee\nFundamental Theorem of Asset Pricing\n\nThe Three Concepts Are Equivalent\nExistence of state prices ⇔existence of state price density\nP = ∑\nN\nφixi\ni=1\nN\n= ∑piπixi\ni=1\n= E [πx]\nhere π\nφ\ni =\ni . We can also reverse the direction of the proof.\npi\nw\nBrandon Lee\nFundamental Theorem of Asset Pricing\n\nContinued\nExistence of state prices ⇔existence of risk neutral\nprobabilities\nN\nP = ∑φixi\ni=1\nN\n= (φ1 +...φ\ni\n) ∑\nφ\nN\ni=1\nx\nφ1 +...φ\ni\nN\n=\n∑\nN\nqixi\n1+r i=1\nφ\nwhere we define qi =\ni\nand make use of the fact that\nφ1+...φN\n= φ1 +...φN. Alternatively, given (q1,...,qN) and r, we\n1+r\ncan solve for (φ1,...φN).\nBrandon Lee\nFundamental Theorem of Asset Pricing\n\nSummary\nA very intuitive, primitive, and simple restriction of no\narbitrage has powerful consequences and guarantees existence\nof powerful pricing tools (Fundamental Theorem of Asset\nPricing).\nEach of the three objects, state price density, state prices, and\nrisk neutral probabilities, can price any asset (again, an asset\nis merely a stream of stochastic payoffs).\nThe value of an asset depends on three elements:\nprobabilities, attitude towards risk, and time value of money.\nThe state prices incorporate all three elements. The state\nprice density contain all the information about attitude\ntowards risk and time value of money. The risk neutral\nprobabilities contain all the information about (actual)\nprobabilities and attitude towards risk.\nBrandon Lee\nFundamental Theorem of Asset Pricing\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms ."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_rec02.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/1d01e61c8c6e2a275a1c8c3c68879db9_MIT15_450F10_rec02.pdf",
      "content": "Black-Scholes Formula\nBrandon Lee\n15.450 Recitation 2\nBrandon Lee\nBlack-Scholes Formula\n\nExpectation of a Lognormal Variable\nSuppose X ∼N\n,\n2 . We want to know how to compute E eX .\nhis calculation is often needed (e.g., page 30 of Lecture Notes 1)\necause we usually assume that log return is distributed normally.\nh\neXi\n=\nZ inf\nexφ (x)dx\n-inf\n=\nZ inf\nexp(x)\n-inf\n√\nexp\n2πσ2\n\n-\n(x\n2σ2\n-μ)\n\ndx\n=\nZ inf\n-inf\n√\nexp\n2πσ2\n\n-\n(x\n2σ2\n-μ) +x\n\ndx\n=\nZ inf\n-inf\n√\nexp\n2πσ2\n\n-\nx\n2σ2\n2 +\n-2μ -2σ2\nx + μ2\ndx\n=\nZ inf\n-inf\n√\nexp\n2πσ2\n\n-\nx2 +\nσ\n2σ2\n-2 μ +σ2 x + μ +\nexp\n\n= exp\n\nμ +\ninf\nσ2\nZ\n-inf\n√\nexp\n2πσ2\n\n-\nx\n2σ2\n-\nμ +σ2\ndx\n= exp\nμ +\nσ2\nμ σ\n\nT\nb\nE\n\nBrandon Lee\nBlack-Scholes Formula\n\nChange of Measure\nGiven a probability measure (think probability distribution), a\nandom variable that is positive and integrates to one defines\nchange of measure. In other words, suppose we have a\nrobability measure P and a random variable ξ such that\nP [ξ] = 1. Then we can define a new probability measure Q\nhrough ξ by\nQ (A) =\nZ\nξdP\nA\ne can think of ξ as a redistribution of probability weights\nrom P to Q. Hence it's called\"change of measure\"and\nenoted dQ .\ndP\nr\na\np\nE\nt\nW\nf\nd\nBrandon Lee\nBlack-Scholes Formula\n\nNormality-Preserving Change of Measure\nNow, there is a special class of random variables called\nexponential martingales that, as change of measures, preserve\nnormality. In more concrete terms, suppose probability\nmeasure P is given by the normal distribution N\nμP,σ2 .\nThen, if dQ\n\nis an exponential martingale, then the new\ndP\nprobability measure Q is also normally distributed, with a\ndifferent mean but with the same variance, N μQ,σ2 .\nSuch exponential martingales take on the form\n\nξ = exp\n\n-ηεP -\nη2\n\nfor arbitrary numbers η (later in Lecture Notes 2, we'll see\nthat η can be stochastic processes as well).\nFurthermore, we know the exact relationship between μP and\nμQ: μP -μQ = ησ (the previous notes had a typo and had\nσ2 instead of σ).\nBrandon Lee\nBlack-Scholes Formula\n\nBlack-Scholes Formula\nSuppose under Q (the risk-neutral measure), the stock return\nis given by\nSt+1\n= exp\nSt\n\nr -\nσ2 +σεQ\n\nwhere εQ ∼N (0,1) under the Q-measure.\nLet's derive the Black-Scholes formula in this simple setting.\nSuppose S0 = 1 and we have a call option that matures at\nT = 1 with a strike price K. The price of this call option is\nC = e-rE Q\nZ\n[max(S1 -K,0)]\ninf\n= e-r\n(S1 -K)dQ\n= e-r\nZS1=K\ninf\nS1dQ\nS1=K\n-e-r\nZ inf\nKdQ\nS1=K\nBrandon Lee\nBlack-Scholes Formula\n\nContinued\nCall the first term C1 and the second term C2.\nLet's calc\nZulate them separately.\ninf\nC1 = e-r\nS1dQ\nS1=K\n= e-r\nZ inf\nσ2\nlnK-r+ 2\nσ\nexp\nσ\n\nr -\n+σεQ\n\n· √\nexp\n2π\n\n-\nε\nQ\n=\nZ inf\nσ2\nlnK-r+ 2\nσ\n√\nexp\n2π\n\n-\nε\nQ2 -2σεQ +σ2\ndε\n=\nZ inf\nσ2\nlnK-r+ 2\nσ\n√\nexp\n2π\n\n-\nε\nQ -σ\ndε\n= Φ\n\nlnK\nσ\n-\nσ2\nr +\n-\nσ\n!\n= Φ\n-\nσ2\nlnK +r + 2\nσ\ndε\n\n!\nBrandon Lee\nBlack-Scholes Formula\n\nContinued\nNow for C2\nC2 = e-r\nZ inf\nKdQ\nZ\nS1=K\ninf\n= e-r\nσ2\nlnK-r+ 2\nK\nσ\n√\nexp\n2π\n\n-\nε\nQ2\ndε\n= e-rK\nZ inf\nσ2\nlnK-r+ 2\nσ\n√\nexp\n2π\n\n-\nε\nQ2\ndε\n= e-rKΦ\n\n-lnK +r -σ2\nσ\n!\nSo the option price is given by the Black-Scholes formula\nC = C1 -C2\n= Φ\n-\nσ2\nlnK +r + 2\nσ\nl\ne\nσ\n-\n-rKΦ\n-nK +r -\nσ\n\n!\n\n!\nBrandon Lee\nBlack-Scholes Formula\n\nNumerical Integration\nDefinite integrals can rarely be computed analytically. In those\ncases, we need to resort to numerical methods. Here, we\npresent the simplest method using the Riemann sum\napproximation.\nAs an example, let's say we want to compute\nZ inf1\ndx\nx2\nWe have to worry about two things: summation on the right\ntail and fineness of approximating rectangles.\nRefer to the MATLAB\ncode.\nBrandon Lee\nBlack-Scholes Formula\n(r)\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms ."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_rec03.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/511a32446b77d2566dae5d97253e83c9_MIT15_450F10_rec03.pdf",
      "content": "Stochastic Calculus\nBrandon Lee\n15.450 Recitation 3\nBrandon Lee\nStochastic Calculus\n\nBrownian Motion\nDefining properties of Brownian motion Zt are\nZ0 = 0.\nIt has continuous paths.\nIt has independent increments: if t1 < t2 ≤s1 < s2, then\nZt2 -Zt1 and Zs2 -Zs1 are independent random variables.\nIts increments are normally distributed: Zt2\nt1 ∼N (0,t2 -t1).\n-\nBrownian motion is the continuous time analogue of random\nwalk in discrete time. Brownian motion is the basic building\nblock that we use to model uncertatinty or random\nmovements in our continous time finance models.\nBrandon Lee\nStochastic Calculus\n\nIto Processes\nAn Ito process Xt is of the form\nZ t\nt\nXt =\nμsds +\nZ\nσsdZs\nr in differential form\ndXt = μtdt +σtdZt\neuristically speaking, over a very small time interval ∆, the\ncrement Xt+∆-Xt has normal distribution with mean μt∆\nnd variance σ2\nt ∆. Call μt the instantaneous drift and σt th\nstantaneous volatility or diffusion coefficient.\no\nH\nin\na\ne\nin\nBrandon Lee\nStochastic Calculus\n\nIto's Lemma\nSuppose Xt is an Ito process. Ito's Lemma states that f (t,Xt)\nis an Ito process as well and shows how to compute the drift\nand diffusion coefficient of df (t,Xt).\nIto's Lemma: Suppose\ndXt = μtdt +σtdZt\nthen\n∂f (t,Xt)\nd (f (t,Xt)) =\n\n∂f (t,Xt)\n+\n∂t\nμ\n∂\nt +\nXt\n∂2f (t,Xt)\n∂\nσ2\n∂X 2\nt\nt\n\nf (t,Xt)\ndt +\nσtdZ\n∂\nt\nXt\nRemember the rule\n(dt) = o (dt)\ndt ·dZt = o (dt)\n(dZt) = dt\nIn other words, the first two are of smaller order than dt, and\nwe can ignore them in Ito's lemma.\nBrandon Lee\nStochastic Calculus\n\nExample of Ito's Lemma\nSuppose\ndSt = rdt +σdZt\nSt\nand define Y\nrt\nt = f (t,St) = e-St. Calculate dYt.\nUse's Ito's lemma:\ndYt =\n∂f (t,St)\n∂f (t,St)\n+\n∂t\nrS\n∂\nt +\nSt\n∂2f (t,St)\n∂\nσ2S2\n∂S2\nt\nt\n\nf (t,St)\ndt +\nσS\n∂\ntdZt\nSt\n=\n-re-rtSt +re-rtSt +0\n\ndt +e-rtσStdZt\n= σYtdZt\nWhy does Yt have zero drift?\nBrandon Lee\nStochastic Calculus\n\nSuppose ηt is some stochastic process. Define\nξt = exp\n\n-\nZ t\nηsdZs\n-\nZ t η2\ns\nds\n\nCalculate dξt.\nt\nt η2\nDefine X\ns\nt =\nR\n0 ηsdZs +\nR\nds. Note that\nη2\ndXt =\nt dt +ηtdZt\nand ξt = exp(-Xt).\nApply Ito's Lemma and we get\ndξt = -ξ\ntdXt +ξt (dXt)\n= -ξtηtdZt\nPractice and make sure you can do those calculations!\nAnother Example\nBrandon Lee\nStochastic Calculus\n\nExample of Multivariate Ito's Lemma\nSuppose\ndXt = μxdt +σxdZ 1\nX\nt\nt\ndYt = μydt +σydZ 2\nY\nt\nt\nwhere\ndZ 1\nt ·dZ 2\nt = ρdt\nDefine\nXt\nMt = Yt\nWhat is the instantaneous volatility of dMt ?\nMt\nBrandon Lee\nStochastic Calculus\n\nContinued\nLet Mt = f (Xt,Yt) = Xt . Then by Ito's Lemma,\nYt\n∂f (Xt,Yt)\ndMt =\n∂f (Xt,Yt)\ndX\n∂\nt +\nXt\ndY\n∂\nt\nYt\n+\n∂\n\n2f (Xt,Yt)\n∂f (Xt,Yt)\n(dX\n∂\nt) +2\nX 2t\n∂2f (X\ndX\n∂Xt∂\nt\nYt\n·\nt,Yt)\ndYt +\n(dY\n∂\nt)\nY 2t\n\nCarry out the\ncalculation and arrive at\ndMt = Mt μx -μy -ρσxσy +σ2\ny\ndMt\n\ndt +MtσxdZ 1\nt -MtσydZ 2\nt\n=\nμx -μy -ρσxσy +σ2\ny\n\ndt +σxdZ 1\nM\nt\nt\n-σydZ 2\nt\nNote that\ndMt\nd\nM\n=\nx\nt\nσ dZ 1\nt -σy Z 2\nt\n=\n\nσ2\nx +σ2\ny -ρσxσy\n\ndt\nso that instantaneous volatility of dMt is\nMt\nq\nσ2x +σ2y -ρσxσy\nBrandon Lee\nStochastic Calculus\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms ."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_rec04.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/73dd078e204b725d93c69b754cac8d31_MIT15_450F10_rec04.pdf",
      "content": "Stochastic Calculus II\nBrandon Lee\n15.450 Recitation 4\nBrandon Lee\nStochastic Calculus II\n\nKolmogorov Backward Equation\nConsider a stochastic process Xt. Xt is a martingale if for s > t,\nEt [Xs] = Xt\nIn other words, conditional expectation of future value is simply the\ncurrent value (example: fair gamble). The notion of a martingale\nmakes sense for both discrete and continuous time processes.\nNow let's look at this concept when Xt is an Ito process. Suppose\ndXt = μ (t,Xt)dt +σ (t,Xt)dZt\nIf Xt were a martingale, then over a small time interval dt,\nEt [Xt+dt] = Xt\nEt [Xt+dt -Xt] = 0\nEt [dXt] = 0\nThis is another way of thinking about martingales: expected\nchanges are zero.\nBrandon Lee\nStochastic Calculus II\n\nContinued\nBut now recall the dynamics of dXt:\nEt [dXt] = Et [μ (t,Xt)dt +σ (t,Xt)dZt]\n= μ (t,Xt)dt\nSo Xt is a martingale if and only if μ (t,Xt) = 0. This is\nintuitive: the drift term is responsible for expected change\nwhereas the diffusion term is responsible for variance of\nchange.\nThe Kolmogorov Backward Equation simply formalizes this\nidea.\nBrandon Lee\nStochastic Calculus II\n\nContinued\nSuppose we have an underlying process Xt where\ndXt = μ (t,Xt)dt +σ (t,Xt)dZt\nConsider Yt = f (t,Xt). Suppose we know for some reason\nthat Yt is a martingale. We have seen two such examples: 1)\nconditional expectation, 2) security price discounted at\nrisk-free rate under the risk-neutral measure. Then by the\nabove argument, we know that the drift term of\ndYt = d (f (t,Xt)) should be zero.\nBy Ito's Lemma,\n∂\n)\ndf ( ,Xt) =\n\nf (t,Xt\nt\n∂f (t,Xt)\n+\n∂t\nμ (t,X\n∂\nt)+\nXt\n∂2f (t,Xt)\n(σ (t,X\n∂\nt))\nX 2t\n!\n∂f (t,Xt)\ndt +\nσ (t,Xt)dZ\n∂\nt\nXt\nSo if Yt = f (t,Xt) is a martingale, then\n∂f (t,Xt)\n∂f (t,Xt)\n+\n∂t\nμ (t,X\n∂\nt)+\nXt\n∂2f (t,Xt)\n(\n∂X 2\nσ (t,Xt)) = 0\nt\nBrandon Lee\nStochastic Calculus II\n\nOption Replication\nHow do you dynamically replicate an European option in the\nlack-Scholes setting? Answer: Match the\"delta\".\nuppose you have the option price f (t,St) on the one hand and the\nalue of a replicating portfolio consisting of the stock and the bond,\nt. At time t, this replicating portfolio holds θt number of stocks\nnd the rest is invested in the risk-free bond. This means\ndWt = θtdSt +r (Wt -θtSt)dt\no have perfect replication, we need\nd (f (t,St)) = dWt\nn particular we need the coefficient in front of dSt to match:\n∂f (t,St) = θ\n∂\nt\nSt\nhis argument is exactly as in yesterday's lecture where we tried to\neplicate an option in an environment with stochastic volatility using\nB\nS\nv\nW\na\nT\nI\nT\nr\na stock and another option.\nBrandon Lee\nStochastic Calculus II\n\ne can always move from one to the other very easily in both\niscrete time and continuous time settings.\nn discrete time, if the state price density is given by\nπt\n= exp\nπt-1\n\n-rt-1 -ηt-1εt -\nη2\nt-1\n\nhen the change\n\nof measure from P to Q is given by\ndQ\n=\ndP\n\nexp\nt\n\n-ηt-1εt -\nη2\nt-1\n\nn continuous time,\n\nif the state price density is given by\nπt = exp\n-\nZ t\nt\nrsds -\nZ\nηsdZs\n-\nt\nZ\nη2\ns ds\n\nhen the chan\n\nge of measure from P to Q is given by\ndQ\nt\n=\ndP\n\nexp\nt\n\n-\nZ\nηsdZs\n-\ns\nZ t\nη2\ns d\n\ne can always decompose the state price density into time discount\nnd change of measure from P to Q.\nState Price Density and Risk-Neutral Measure\nW\nd\nI\nt\nI\nt\nW\na\nBrandon Lee\nStochastic Calculus II\n\nChange of Measure in Continuous Time\nSimilar asin the discrete time case. If\ndQ\nt\n=\ndP\n\nexp\nt\n\n-\nZ\nηsdZs\n-\nd\nZ t\nη2\ns s\n\nthen the Brownian motion under P, Z P\nt acquires a drift but its\ndiffusion coefficient does not change. Therefore\ndZ P\nt = dZ Q\nt -ηtdt\nSuppose W P\nt\nis another Brownian motion under P and it has\ncorrelation ρ with Z P\nP\nt . How does Wt\nlook under the\nQ-measure?\nDo the decomposition\nW P\nt = ρZ P\nt +\np\n1-ρ2V P\nt\nwhere V P\nt\nis another Brownian motion under P that's\nindependent of Z P\nt . Conclude\ndW P = dW Q\nt\nρηtdt\nt\n-\nBrandon Lee\nStochastic Calculus II\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms ."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_rec05.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/385af023f7b57fc1e031896d93d7a516_MIT15_450F10_rec05.pdf",
      "content": "Applications of Risk-neutral Pricing\nBrandon Lee\n15.450 Recitation 5\nBrandon Lee\nApplications of Risk-neutral Pricing\n\nOutline\nWe are going to study two examples that illustrate the\nconcepts we have learned in the lectures.\nThe first example will go over pricing of a futures contract\nand analyze a European option on the futures contract.\nThe second example concerns the valuation of a quanto\nderivative.\nBrandon Lee\nApplications of Risk-neutral Pricing\n\nFutures on a Stock\nAssume the basic Black-Scholes economy where the stock\nprice follows\ndSt = μdt +σdZt\nSt\nand the risk-free rate is r.\nNow suppose there is a futures market for the stock. A trader\nbuying a futures contract enters into an obligation to buy the\nstock at a pre-specified price (futures price) at a pre-specified\ntime (maturity, call it TF here). Let Ft be the futures price at\ntime t.\nBrandon Lee\nApplications of Risk-neutral Pricing\n\nFutures Price\nSince the futures price is such that the futures contract is\nworth zero to both parties today, it satisfies\nE Q\nt [exp(-r (TF -t))(STF -Ft)] = 0\nFrom this characterization of Ft under the risk-neutral\nmeasure, we would like to solve for Ft.\nHere, the risk-free rate is deterministic and Ft is known at\ntime t, hence the above equation can be rewritten as\nexp(-r (TF -t))Ft = E Q\nt [exp(-r (TF -t))STF ]\nBrandon Lee\nApplications of Risk-neutral Pricing\n\nContinued\nBut notice that the right hand side is simply the stock price at\nime t, St, by the definition of the risk-neutral measure.\nherefore\nexp(-r (TF -t))Ft = St\nFt = exp(r (TF -t))St\nsing this result, we can also calculate dFt using Ito's Lemma:\ndS\ndFt = -\nt\nrFtdt +Ft St\n= Ft ((μ -r)dt +σdZt)\nlso note that un\n\nder the risk-neutral measure,\ndFt = Ft\n(μ -r)dt +σ\n\ndZ Q\nμ\nt\n-r\n-\ndt\nσ\n\n= σFtdZ Q\nt\nt\nT\nU\nA\nBrandon Lee\nApplications of Risk-neutral Pricing\n\nOption on the Futures Contract\nSuppose we have a European call option on the futures\ncontract, with strike price K and maturity T < TF (the only\nnovelty here is that the underlying security is a Futures\ncontract, not a stock). Denote the option price at time t by\nC (Ft,t). How do we compute this?\nJust as we did for the Black-Scholes formula! Again observe\nthat the only difference is that the option is written on the\nfutures price and it behaves according to\ndFt = (μ\n)\nt\n-r dt +σdZt\nF\nThis is very similar to the dynamics of the stock price in the\nBlack-Scholes formula.\nBrandon Lee\nApplications of Risk-neutral Pricing\n\nThe Black-Scholes Formula, Once Again\nThis calculation yields\nC (Ft,t) = exp(-r (T -t))[FtΦ(d1)-KΦ(d2)]\nwhere\nlog\nt\nd =\n\nF\n+\nK\n\n2σ (T -t)\nσ\n√\nT -t\nand\nd2 = d1 -σ\n√\nT -t\nBrandon Lee\nApplications of Risk-neutral Pricing\n\nPDE Method\nThere is another way of characterizing the option price\nC (Ft,t) using the PDEs.\nUnder the risk-neutral measure,\nC (Ft,t) = E Q\nt [ex\n\np(-r (T -t))max(FT -K,0)]\ne-rtC (Ft,t) = E Q\nt\ne-rT max(FT -K,0)\ntherefore, e-rtC (Ft,t) is a martingale under t\n\nhe risk-neutral\nmeasure. In fact, for any security whose value at time t is Xt,\ne-rtXt is a martingale under the risk-neutral measure. Why is\nthis true?\nBrandon Lee\nApplications of Risk-neutral Pricing\n\nContinued\nNow we're back to Kolmogorov Backward Equation. We need\nto compute the drift of e-rtC (Ft,t) and set it to zero to\nderive the PDE.\nUsing Ito's Lemma, the drift of e-rtC (Ft,t) is\n-re-rt\n∂\n)\nC (Ft, )+e-rt\nC (Ft,t\nt\n+\n∂t\n∂2\ne-rt\nC (Ft,t)\nσ2F 2\n∂F 2\nt\nt\nso the PDE we're after is\n∂C (F,t)\n0 = -rC (F,t)+\n+\n∂t\n∂2\nσ2\nC (F,t)\nF 2\n∂F 2\nBrandon Lee\nApplications of Risk-neutral Pricing\n\nDynamic Replication\nFinally, how do we replicate the option on the futures\ncontract? Suppose we can trade the riskless bond and the\nfutures contract.\nThe answer is, of course, we match the delta:\n∂C (F\nθ\nt,t)\nt =\n∂Ft\nSince we already solved for C (Ft,t) explicitly, we can say\nmore:\nθt = exp(-r (T -t))Φ(d1)\nwhere\nlog\nd1 =\n\nFt\n+\nK\n\n2σ (T -t)\nσ\n√\nT -t\nBrandon Lee\nApplications of Risk-neutral Pricing\n\nQuanto\nA quanto is a type of a derivative where the underlying is\ndenominated in one currency but the settlement is in another\ncurrency. This is useful for traders who wish to have exposure\nto the foreign asset but do not want to face the exchange rate\nrisk.\nTo be concrete, suppose that the level of the UK FTSE 100\nindex (in British pounds) evolves according to\ndSt = μSdt +σSdZ S\nS\nt\nt\nand the dollar value of a single British Pound, call it Xt,\nfollows\ndXt = μXdt +σXdZ X\nX\nt\nt\nand dZ S\nt dZ X\nt = ρdt.\nSuppose the riskfree rate in US and UK are rUS and rUK,\nrespectively.\nBrandon Lee\nApplications of Risk-neutral Pricing\n\nQuanto Derivative\nNow consider a derivative that pays ST dollars at time T\n(note dollars, not pounds). We want to find the price of this\nderivative security.\nAccording to the risk-neutral pricing, its value, call it V0, is\ngiven by\nV0 = E Q\n0 [exp(-rUST)ST]\nwhere Q is the risk-neutral measure of the US investor.\nNow the question boils down to finding the dynamics of St\nunder the measure Q.\nBrandon Lee\nApplications of Risk-neutral Pricing\n\nWrite\ndSt\nQ\n= μQ\nS\nS dt +σ\n,S\nSdZt\nt\ndXt\nQ\n= μQ\nX dt +σ\n,X\nXdZt\nXt\nQ,S\nQ,X\nand dZt\ndZt\n= ρdt. It remains to find the drifts μQ\nS and\nμQ\nX .\nThe important observation here is that the US investor can\ninvest in British risk-free bond or British stock market, but\ntheir instantaneous returns under the risk-neutral measure Q\nhave to be rUS. Therefore\n(\n)\nrUSdt\nQ\nt\nd XtSt\n= E\n=\nμQ + μQ +ρσSσX\ndt\nX\nS\nX\ntSt\nand\n\nrUSdt = E Q\nd XtBUK\nt\nt\n=\nX BUK\nμQ\nX +rUK\ndt\nContinued\n\"\n\nt\nt\n#\n\nBrandon Lee\nApplications of Risk-neutral Pricing\n\nContinued\nTherefore\nμQ\nX = rUS -rUK\nand\nμQ\nS = rUK -ρσSσX\nWe can solve for ST explicitly:\nST = S0 exp\n\nμQ\nS -\nσ2\nS\nS\n\nT +σ\nQ,\nSZ\nT\n\nFinally,\nV0 = E Q\n0 [exp(-rUST)ST]\n= S0 exp\n\n-r\n+ μQ\nUS\nS -\nσ2\nS\n\nT +\nσ2\nST\n\n= S0 exp\n\n-rUS + μQ\nS\n\nT\n= S0 exp((rUK\nrUS\nρσS\n\nσX)T)\n-\n-\nBrandon Lee\nApplications of Risk-neutral Pricing\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms ."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_rec09.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/d7f48c59f46e769a43713beff7aa5799_MIT15_450F10_rec09.pdf",
      "content": "Introduction to Econometrics\nBrandon Lee\n15.450 Recitation 9\nBrandon Lee\nIntroduction to Econometrics\n\nLaw of Large Numbers\nSuppose xt are IID and E [xt] = μ. Then the Law of Large\nNumbers states that\nplim\n=\nT ∑\nT\nxt\nμ\nt=1\nIntuitively, the LLN says that as the sample gets larger, the\nsample average approaches the true mean.\nThe LLN is often the basis for establishing consistency of\nstatistical estimators.\nBrandon Lee\nIntroduction to Econometrics\n\nConsistency of OLS Estimator\nSuppose\nyi = xiβ +εi\nwhere E [εi|xi] = 0 (which then implies that the error term is\nuncorrelated to the sample: E [xiεi] = 0)\nThe OLS estimator is given by\nβˆ =\nX ′X\n-1 X ′y\nβˆ\nˆ\nLet's verify that\nis consistent: that is, plim β = β.\nBrandon Lee\nIntroduction to Econometrics\n\nContinued\nNote\nβˆ =\n′\nX X\n-X ′y\n=\nX ′X\n\n-X ′ X ′β +ε\n= β +\nX ′X\n-1 X ′ε\n\nTherefore,\nˆ\nplim β = β\n+plim X ′X\n-X ′ε\nX ′X\n= β +plim\n\n-\nN\n1 X ′ε\nN\n!\nBrandon Lee\nIntroduction to Econometrics\n\nContinued\n′\nThe key here is that\n\nX X\n-\nN\nwill converge to some limit and\nso will\n\nX ′ε . But by the Law of Large Numbers, we know\nN\nthat\n\nplim\nX ′ε\n=\nN\n\nE [xiεi] = 0\nTherefore,\nˆ\nplim β = β\nBrandon Lee\nIntroduction to Econometrics\n\nCentral Limit Theorem\nSuppose that xt is a random vector such that E [xt] = μ and\nVar(xt) = Ω. The Central Limit Theorem states that\n√\nN\nT ∑\nT\n(xt\n)\nt=1\n-μ ⇒\n(0,Ω)\nHere, the convergence is in\"convergence in distribution\".\nThe CLT is often used to derive asymptotic distribution of\nstatistical estimators.\nBrandon Lee\nIntroduction to Econometrics\n\nMaximum Likelihood Estimator\nHaving observed the sample x1,...,xT, we want to estimate\nthe unknown true parameter θ0 of the data generating process\nf (x;θ).\nMaximum likelihood estimation is an intuitive procedure in\nwhich the probability of observing our sample is maximized at\nour maximum likelihood estimate θˆMLE.\nLikelihood function (it is a function of the parameter θ,\ntaking as given the sample): L(θ|x1,...,xT)\nLog-likelihood function (this is typically what we work with):\nL (θ|x1,...,xT)\nThe goal is to find θˆ that maximizes our (log-)likelihood\nfunction. Sometimes we can do this by finding a solution to\nthe first order condition, but in other situations we may have\nto resort to numerical optimization routines.\nBrandon Lee\nIntroduction to Econometrics\n\nExample: Mixture of Normals\nAssu\nme that asset returns are IID and normally distributed,\nμ,σ2\n. We've seen in the lectures that the MLE of μ and\n2 are simply given by the sample mean and sample variance,\nespectively.\net's assume instead that returns are IID over time, but now\nrawn from a mixture of normal di stributions: that is with\nrobability λ, it is drawn from N μ1,σ2\n\nand with probability\n-λ, it is drawn from N μ2,σ2\n2 . This is one of the popular\npproaches to modelling fat-tail distributions.\now the parameters of the model are λ,μ1,σ2\n1 ,μ2,σ2\n\n.\nN\nσ\nr\nL\nd\np\na\nN\nBrandon Lee\nIntroduction to Econometrics\n\nContinued\nNote that\nf\nRt|λ,μ1,σ2\n1 ,μ2,σ2\n= λ\n\n· q\n(\n-\nRt -μ1)\ne\n2πσ2\n2σ\n+(1-λ)· q\n(\n-\nRt -μ2)\ne\n2πσ2\n2σ2\nand since we have IID sample,\nL\nT\nλ,μ ,σ2,μ ,σ2|R ,...,R\n\n= ∏f\nR |λ,μ ,σ2\nT\nt\n1 ,μ\n2,σ2\nt=1\nThe log-likelihood function is given by\n\nL\nλ,μ\n1,σ1 ,μ2,σ2\n\n2 |R1,...,RT\nT\n=\n\n∑\nlog\nλ\nt=1\n·\n(\n-\nRt -μ1)\ne\n2πσ2\n2σ\n+(1-λ)·\n(\n-\nRt -μ2)\ne\n2πσ2\n2σ2\n\nq\nq\n\nBrandon Lee\nIntroduction to Econometrics\n\nExample: GARCH\nSuppose Rt ∼N\nμ,σ2\nt\n\n. The interesting aspect of this\nspecification is time-varying volatility. In particular, we assume\nGARCH(1,1) structure:\nσ2\nt = α +β\n(R\nt\n+\n--μ)\nγσt-1\nWe have in mind β > 0 and γ > 0 so that past realized and\nlatent volatility carry over to the current period. These kinds\nof specifications can capture the volatility clustering we see in\nthe data.\nThe parameters of our model are\nμ,α,β,γ,σ2\n0 .\n\nBrandon Lee\nIntroduction to Econometrics\n\nContinued\nThe likelihood function is given by\nT\nL\nμ,α,β,γ,σ2\n0 |R1,...,R\n\n= ∏f\nR |μ,α,β,γ,σ2\nT\nt\n0 ;R1,...,Rt-1\nt=1\nT\n\n= ∏\nt=1\np\n(\ne\n-Rt -μ)\n2πσ2t\n2σt\nNote that σ2\nt is included in the information set (R1,...,Rt-1).\nOptimizing this objective function cannot be done analytically\nbecause evolution of σ2\nt depends on all the parameters in a\nnon-trivial manner. We have to resort to numerical methods\nto find the optimum.\nBrandon Lee\nIntroduction to Econometrics\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms ."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_rec10.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/2710a11d17cae67d02173ffb15859784_MIT15_450F10_rec10.pdf",
      "content": "OLS: Estimation and Standard Errors\nBrandon Lee\n15.450 Recitation 10\nBrandon Lee\nOLS: Estimation and Standard Errors\n\nOrdinary Least Squares\nThe model:\ny = Xβ +ε\nwhere y and ε are column vectors of length n (the number of\nobservations), X is a matrix of dimensions n by k (k is the\nnumber of parameters), and β is a column vector of length k.\nFor every observation i = 1,2,...,n, we have the equation\nyi = xi1β1 +···+xikβk +εi\nRoughly speaking, we need the orthogonality condition\nE [εixi] = 0\nfor the OLS to be valid (in the sense of consistency).\nBrandon Lee\nOLS: Estimation and Standard Errors\n\nOLS Estimator\nβˆ\nWe want to find\nthat solves\nmin(y -Xβ)′ (y -Xβ)\nβ\nThe first order condition (in vector notation) is\nˆ\n0 = X ′\ny -Xβ\nand solving this leads to the well-known\n\nOLS estimator\nβˆ =\nX ′X\n-1 X ′y\nBrandon Lee\nOLS: Estimation and Standard Errors\n\nGeometric Interpretation\nThe left-hand variable is a vector in the n-dimensional space.\nEach column of X (regressor) is a vector in the n-dimensional\nspace as well, and we have k of them. Then the subspace\nspanned by the regressors forms a k-dimensional subspace of\nthe n-dimensional space. The OLS procedure is nothing more\nthan finding the orthogonal projection of y on the subspace\nspanned by the regressors, because then the vector of residuals\nis orthogonal to the subspace and has the minimum length.\nThis interpretation is very important and intuitive. Moreover,\nthis is a unique characterization of the OLS estimate.\nLet's see how we can make use of this fact to recognize OLS\nestimators in disguise as more general GMM estimators.\nBrandon Lee\nOLS: Estimation and Standard Errors\n\nInterest Rate Model\nRefer to pages 35-37 of Lecture 7.\nThe model is\nrt+1 = a0 +a1rt +εt+1\nwhere\nE [εt+1] = 0\nE ε2\nt+1 = b0 +b1rt\nOne easy set of momen\n\nt cond\n\nitions:\n0 = E\n\n(1,rt)′\nh\n(rt+1 -a0 -a1rt)\n0 = E (1,rt)′\n(rt+1 -a0 -a1rt\n\n) -b0 -b1rt\ni\nBrandon Lee\nOLS: Estimation and Standard Errors\n\nContinued\nSolving these sample moment conditions for the unknown\nparameters is exactly equivalent to a two-stage OLS\nprocedure.\nNote that the first two moment conditions give us\nET\n\n(1,rt)′ (rt+1 -ˆa0 -ˆa1rt) = 0\nBut this says that the estimated residuals a\n\nre orthogonal to\nthe regressors and hence ˆa0 and ˆa1 must be OLS estimates of\nthe equation\nrt+1 = a0 +a1rt +εt+1\nBrandon Lee\nOLS: Estimation and Standard Errors\n\nContinued\nNow define\nεˆt+1 = rt+1 -ˆa0 -ˆa1rt\nthen the sample moment conditions\nET\nh\n(1,rt)′\n(rt+1 -ˆa0 -\nˆa1rt) -bˆ0 -bˆ1rt\ni\n= 0\ntell us that bˆ0 and bˆ1 are OLS estimates from the equation\nεˆ2\nt+1 = b0 +b1rt +ut+1\nby the same logic.\nBrandon Lee\nOLS: Estimation and Standard Errors\n\nStandard Errors\nLet's suppose that E ε2\ni |X = σ2 and E [εiεj|X] = 0 for i = j.\nIn other words, we are assuming independent and\nhomoskedastic errors.\nWhat is the standard error of the OLS estimator under this\nassumption?\nVar\n\nβˆ|X\n\n= Var\n\nβˆ -β|X\n= Var\n\n= X ′X\n-1\nX ′X\nX ′ε|X\n-1 X ′Var (ε\nX\n\n| )X\nX ′X\n-\nUnder the above assumption,\nVar (ε|X) = σ2In\nand so\nˆ\nVar\nβ X\n= σ2 X ′X\n-\n\n|\n\nBrandon Lee\nOLS: Estimation and Standard Errors\n\nContinued\nWe can estimate σ2 by\nσc\n2 = n ∑\nn\nεˆ2\ni\ni=1\nand the standard error for the OLS estimator is given by\nd\nar\n\nβˆ\nV\n|X\n\n= σc2 X ′X\n-\nThis is the standard error that most (less sophisticated)\nstatistical softwares report.\nBut it is rarely the case that it is safe to assume independent\nhomoskedastic errors. The Newey-West procedure is a\nstraightforward and robust method of calculating standard\nerrors in more general situations.\nBrandon Lee\nOLS: Estimation and Standard Errors\n\nNewey-West Standard Errors\nAgain,\nVar\n\nβˆ|X\n\nˆ\n= Var\n=\n\nβ -β|X\nVar\nX ′X\n-\n\n=\n\nX ′ε|X\n\nX ′X\n-Var\n′ε|\nX\nX\nX ′X\n-\nThe Newey-West procedure boils down to an altern\n\native way\nof looking at Var(X ′ε|X).\nIf we suspect that the error terms may be heteroskedastic, but\nstill independent, then\nVd\nar\nX ′ε|X\n\nn\n= ∑εˆ2\ni ·xixi\n′\ni=1\nand our standard error for the OLS estimate is\nn\nˆ\nVar\nβ|X\n= X ′X\n-1 ∑ε2\nˆi ·xixi\n′\nX ′X\n-\nd\n\ni=1\n!\n\nBrandon Lee\nOLS: Estimation and Standard Errors\n\nContinued\nIf we suspect correlation between error terms as well as\nheteroskedasticity, then\nVd\nar\nk\nk\nj\nX ′ε\n\n= ∑\n-| |\n|X\nj=-k\ni\nk\n\n∑\nn\nε ε\n′\nˆiˆ +j ·xixi+j\nt=1\n!\nand our standard error for the OLS estimator is\nVd\nar\n\nβˆ|X\n\nk\nk\nj\n=\nX ′X\n-\n\n∑\n-| |\nj=-k\n∑\nn\nk\n\nεˆiεˆi+j\nt=1\n·\n′\nxixi+j\n!!\nX ′X\n-1\nBrandon Lee\nOLS: Estimation and Standard Errors\n\nContinued\nWe can also write these standard errors to resemble the\ngeneral GMM standard errors (see page 23 of Lecture 8).\nIn the uncorrelated errors case, we have\nVd\nar\n\nβˆ|X\n\n=\nn\nX ′\nX\n-1\n\n∑εˆ2\ni\ni=1\n·xixi\n′\n!\nX ′X\n-\n=\nX\nn\n\n′X\n-\nn\n1 ∑\nn\nεˆ2\nn\ni\ni=1\n·xixi\n′\n!X ′X\n-\nn\n=\nEˆ\nn\nxixi\n′-\n\n1 ∑\nn\nεˆ2\ni ·\nx\nEˆ\nix′\n′ -\nn\ni\nxixi\ni=1\n!\nand for the general Newey-West standard errors,\nwe h\n\nave\nVd\nar\n\n∑\nk\nβˆ X\n\n=\nX ′X\n-1\n\nk -|j|\n|\nj=-k\nn\nε\n′\nˆiεˆi+j xix\nX ′X -1\nk\n\n∑\ni+j\nt=1\n·\n!!\n\n=\nEˆ xixi\n′ -\n1 ∑\nk\nk -|j|\n∑\nn\nεˆiε\n′\nˆi+j xix\nˆ\ni+j\nE xixi\n′ -1\nn\n\nn j=-k\nk\n\nt=1\n·\n!!\n\nBrandon Lee\nOLS: Estimation and Standard Errors\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms ."
    },
    {
      "category": "Resource",
      "title": "MIT15_450F10_rec11.pdf",
      "type": "PDF",
      "source_url": "https://ocw.mit.edu/courses/15-450-analytics-of-finance-fall-2010/c794896c8caac45622d274f47a5e632d_MIT15_450F10_rec11.pdf",
      "content": "Nonlinear Least Squares\nApplications to MIDAS and Probit Models\nBrandon Lee\n15.450 Recitation 11\nBrandon Lee\nNonlinear Least Squares\n\nNonlinear Least Sqaures\nConsider the model\nyt = h(xt,θ)+εt\nHere we assume that we know the functional form of h(xt,θ)\nand we need to estimate the unknown parameter θ. The\nlinear regression specification is a special case where\nh(xt,θ) = xt\n′ ·θ.\nThe nonlinear least squares (NLS) estimator minimizes the\nsquared residuals (exactly the same as in the OLS):\nT\nθˆNLS = argmin\nθ ∑(yt\nt=1\n-h(xt,θ\n))\nThe first order condition is\nT ∂h\n0 = ∑\nt=1\n\nxt,θˆNLS\n\ny\n∂θ\nt -h xt,θˆNLS\n\nBrandon Lee\nNonlinear Least Squares\n\nNLS through QMLE\nPretend thatthe errors are normally distributed\nεt ∼N 0,σ2 . Then the log-likelihood function is\nT\nL (θ) = ∑\n√\n=1\n\"\n-ln\nt\n\n(\n2πσ2\n\ny\n-\nt -h(xt,θ))\n2σ2\n#\nWe can obtain a QMLE estimate of θ from the first order\ncondition when maximizing the log-likelihood function:\n∂L\n0 = ∂θ\n=\n∑\nT ∂h(xt,θ)\nσ2\nt=1\n(\n∂θ\n· yt -h(xt,θ))\nThis is exactly the same condition as before.\nBrandon Lee\nNonlinear Least Squares\n\nNLS Viewed as GMM\nNote that our optimality condition\nT\n0 = ∑\n∂h(xt,θ)\nt=1\n(\n∂θ\n· yt -h(xt,θ))\ncan be rewritten as\n0 = Eˆ\n∂h(xt,θ) (\nθ\n· yt -h(xt,θ))\n∂\n\nThis is a GMM moment condition and thus our NLS estimator\ncan be interpreted as a GMM estimator. This is a simple, yet\nextremely powerful observation because now we can use the\nexpressions for GMM standard errors (with Newey-West\nprocedure that is robust to both heteroskedastic and\ncorrelated errors).\nBrandon Lee\nNonlinear Least Squares\n\nContinued\nThis moment condition is not surprising because the\nidentification assumption E [εt|xt] = 0 leads to the moment\ncondition\nE [g (xt)εt] = 0\nor\nE [g (xt)(yt -h(xt,θ))] = 0\nfor any function g (·). We are simply picking\n∂h(xt,θ)\ng (xt) =\n∂θ\nThis choice of g (·) is motivated by QMLE.\nBrandon Lee\nNonlinear Least Squares\n\nMIDAS\nSuppose we are interested in the behavior of a monthly\nvolatility measure (say, sum of daily squared returns over a\nmonth).\nOne possibility is to specify a GARCH structure to monthly\ndata series, but this approach throws away lots of valuable\ndata. Or we could use GARCH on daily data series, and try to\ninfer the behavior of monthly volatility measure from the\nestimated daily volatility dynamics. A potential problem here,\nthough, is that small specification errors that may be\nacceptable in the daily series may add up to large errors in the\nmonthly volatility measure.\nThe idea of Mixed Data Sampling (MIDAS) is to allow for a\nvery flexible and direct relationship between current month's\ndaily data and next month's monthly volatility measure.\nBrandon Lee\nNonlinear Least Squares\n\nContinued\nSpecification:\nK\nV H\nt+H,t = aH +φH ∑bH (k,θ)Xt-k,t-k-1 +εHt\nk=0\nWe have flexibility in 1) predictive variables: we could use\nsquared daily returns, absolute daily returns, etc and 2) the\nfunctional form bH (k,θ): this facilitates easier curve fitting.\nOnce specified (after picking a functional form bH (k,θ)), we\ncan use NLS to estimate the unknown parameter θ. Use\nnumerical optimization routines to minimize the squared\nresiduals.\nA very practical way to forecast volatility over a relevant\nholding period.\nBrandon Lee\nNonlinear Least Squares\n\nProbit Model\nSuppose our dependent variable yi is binary and takes on\nvalues 0 and 1. The running example will be models of\ncorporate defaults. In this case, let's say yi = 1 means that\nfirm i defaults and yi = 0 if otherwise. We also have a set of\nregressors Xi that influence yi. In our example, they may be\nleverage ratios, profitability, or macroeconomic conditions.\nThe Probit specification says that yi and Xi are linked through\nProb(yi = 1|Xi) = Φ Xi\n′β\nWe can also write this as\n\nyi = Φ Xi\n′β +εi\nwhere E [εi|Xi] = 0. We can se\ne ho\n\nw the Probit model is a\nspecial case of nonlinear regression specification.\nBrandon Lee\nNonlinear Least Squares\n\nContinued\nNote that yi can only be either 0 or 1. That means that the\nerror term εi can only take on two values, so it is not valid to\nassume that εi follows a continuous distribution (for example,\nnormal distribution).\nWe can write the likelihood function directly quite easily. Note\nthat\nProb(yi = 1|Xi,β) = Φ Xi\n′β\nProb(yi = 0|Xi,β) = 1-\nXi\n′\n\nβ\nand therefore the log-likelihood function\nis give\n\nn by\nN\nL (β|y,X) = ∑\ni=1\n\nyi ln\nˆ\nΦ\nXi\n′β\n\n+(1-yi)ln\n1-Φ\nXi\n′β\n\nWe can find β that maximizes the above log-likelihood\nfunction using very simple numerical algorithms.\nBrandon Lee\nNonlinear Least Squares\n\nMIT OpenCourseWare\nhttp://ocw.mit.edu\n15.450 Analytics of Finance\nFall 2010\nFor information about citing these materials or our Terms of Use, visit: http://ocw.mit.edu/terms ."
    }
  ]
}